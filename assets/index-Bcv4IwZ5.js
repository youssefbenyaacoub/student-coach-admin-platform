(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const u of o)if(u.type==="childList")for(const d of u.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&i(d)}).observe(document,{childList:!0,subtree:!0});function a(o){const u={};return o.integrity&&(u.integrity=o.integrity),o.referrerPolicy&&(u.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?u.credentials="include":o.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function i(o){if(o.ep)return;o.ep=!0;const u=a(o);fetch(o.href,u)}})();var gh={exports:{}},gl={};var Cx;function JN(){if(Cx)return gl;Cx=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function a(i,o,u){var d=null;if(u!==void 0&&(d=""+u),o.key!==void 0&&(d=""+o.key),"key"in o){u={};for(var f in o)f!=="key"&&(u[f]=o[f])}else u=o;return o=u.ref,{$$typeof:s,type:i,key:d,ref:o!==void 0?o:null,props:u}}return gl.Fragment=e,gl.jsx=a,gl.jsxs=a,gl}var Ax;function QN(){return Ax||(Ax=1,gh.exports=JN()),gh.exports}var r=QN(),xh={exports:{}},$e={};var Rx;function ZN(){if(Rx)return $e;Rx=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),u=Symbol.for("react.consumer"),d=Symbol.for("react.context"),f=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),x=Symbol.for("react.lazy"),b=Symbol.for("react.activity"),y=Symbol.iterator;function j(S){return S===null||typeof S!="object"?null:(S=y&&S[y]||S["@@iterator"],typeof S=="function"?S:null)}var N={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},k=Object.assign,T={};function R(S,D,M){this.props=S,this.context=D,this.refs=T,this.updater=M||N}R.prototype.isReactComponent={},R.prototype.setState=function(S,D){if(typeof S!="object"&&typeof S!="function"&&S!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,S,D,"setState")},R.prototype.forceUpdate=function(S){this.updater.enqueueForceUpdate(this,S,"forceUpdate")};function A(){}A.prototype=R.prototype;function C(S,D,M){this.props=S,this.context=D,this.refs=T,this.updater=M||N}var B=C.prototype=new A;B.constructor=C,k(B,R.prototype),B.isPureReactComponent=!0;var F=Array.isArray;function V(){}var O={H:null,A:null,T:null,S:null},H=Object.prototype.hasOwnProperty;function te(S,D,M){var I=M.ref;return{$$typeof:s,type:S,key:D,ref:I!==void 0?I:null,props:M}}function me(S,D){return te(S.type,D,S.props)}function de(S){return typeof S=="object"&&S!==null&&S.$$typeof===s}function ye(S){var D={"=":"=0",":":"=2"};return"$"+S.replace(/[=:]/g,function(M){return D[M]})}var Ae=/\/+/g;function Re(S,D){return typeof S=="object"&&S!==null&&S.key!=null?ye(""+S.key):D.toString(36)}function ze(S){switch(S.status){case"fulfilled":return S.value;case"rejected":throw S.reason;default:switch(typeof S.status=="string"?S.then(V,V):(S.status="pending",S.then(function(D){S.status==="pending"&&(S.status="fulfilled",S.value=D)},function(D){S.status==="pending"&&(S.status="rejected",S.reason=D)})),S.status){case"fulfilled":return S.value;case"rejected":throw S.reason}}throw S}function J(S,D,M,I,G){var ae=typeof S;(ae==="undefined"||ae==="boolean")&&(S=null);var xe=!1;if(S===null)xe=!0;else switch(ae){case"bigint":case"string":case"number":xe=!0;break;case"object":switch(S.$$typeof){case s:case e:xe=!0;break;case x:return xe=S._init,J(xe(S._payload),D,M,I,G)}}if(xe)return G=G(S),xe=I===""?"."+Re(S,0):I,F(G)?(M="",xe!=null&&(M=xe.replace(Ae,"$&/")+"/"),J(G,D,M,"",function(pe){return pe})):G!=null&&(de(G)&&(G=me(G,M+(G.key==null||S&&S.key===G.key?"":(""+G.key).replace(Ae,"$&/")+"/")+xe)),D.push(G)),1;xe=0;var je=I===""?".":I+":";if(F(S))for(var Se=0;Se<S.length;Se++)I=S[Se],ae=je+Re(I,Se),xe+=J(I,D,M,ae,G);else if(Se=j(S),typeof Se=="function")for(S=Se.call(S),Se=0;!(I=S.next()).done;)I=I.value,ae=je+Re(I,Se++),xe+=J(I,D,M,ae,G);else if(ae==="object"){if(typeof S.then=="function")return J(ze(S),D,M,I,G);throw D=String(S),Error("Objects are not valid as a React child (found: "+(D==="[object Object]"?"object with keys {"+Object.keys(S).join(", ")+"}":D)+"). If you meant to render a collection of children, use an array instead.")}return xe}function se(S,D,M){if(S==null)return S;var I=[],G=0;return J(S,I,"","",function(ae){return D.call(M,ae,G++)}),I}function he(S){if(S._status===-1){var D=S._result;D=D(),D.then(function(M){(S._status===0||S._status===-1)&&(S._status=1,S._result=M)},function(M){(S._status===0||S._status===-1)&&(S._status=2,S._result=M)}),S._status===-1&&(S._status=0,S._result=D)}if(S._status===1)return S._result.default;throw S._result}var we=typeof reportError=="function"?reportError:function(S){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var D=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof S=="object"&&S!==null&&typeof S.message=="string"?String(S.message):String(S),error:S});if(!window.dispatchEvent(D))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",S);return}console.error(S)},K={map:se,forEach:function(S,D,M){se(S,function(){D.apply(this,arguments)},M)},count:function(S){var D=0;return se(S,function(){D++}),D},toArray:function(S){return se(S,function(D){return D})||[]},only:function(S){if(!de(S))throw Error("React.Children.only expected to receive a single React element child.");return S}};return $e.Activity=b,$e.Children=K,$e.Component=R,$e.Fragment=a,$e.Profiler=o,$e.PureComponent=C,$e.StrictMode=i,$e.Suspense=m,$e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=O,$e.__COMPILER_RUNTIME={__proto__:null,c:function(S){return O.H.useMemoCache(S)}},$e.cache=function(S){return function(){return S.apply(null,arguments)}},$e.cacheSignal=function(){return null},$e.cloneElement=function(S,D,M){if(S==null)throw Error("The argument must be a React element, but you passed "+S+".");var I=k({},S.props),G=S.key;if(D!=null)for(ae in D.key!==void 0&&(G=""+D.key),D)!H.call(D,ae)||ae==="key"||ae==="__self"||ae==="__source"||ae==="ref"&&D.ref===void 0||(I[ae]=D[ae]);var ae=arguments.length-2;if(ae===1)I.children=M;else if(1<ae){for(var xe=Array(ae),je=0;je<ae;je++)xe[je]=arguments[je+2];I.children=xe}return te(S.type,G,I)},$e.createContext=function(S){return S={$$typeof:d,_currentValue:S,_currentValue2:S,_threadCount:0,Provider:null,Consumer:null},S.Provider=S,S.Consumer={$$typeof:u,_context:S},S},$e.createElement=function(S,D,M){var I,G={},ae=null;if(D!=null)for(I in D.key!==void 0&&(ae=""+D.key),D)H.call(D,I)&&I!=="key"&&I!=="__self"&&I!=="__source"&&(G[I]=D[I]);var xe=arguments.length-2;if(xe===1)G.children=M;else if(1<xe){for(var je=Array(xe),Se=0;Se<xe;Se++)je[Se]=arguments[Se+2];G.children=je}if(S&&S.defaultProps)for(I in xe=S.defaultProps,xe)G[I]===void 0&&(G[I]=xe[I]);return te(S,ae,G)},$e.createRef=function(){return{current:null}},$e.forwardRef=function(S){return{$$typeof:f,render:S}},$e.isValidElement=de,$e.lazy=function(S){return{$$typeof:x,_payload:{_status:-1,_result:S},_init:he}},$e.memo=function(S,D){return{$$typeof:p,type:S,compare:D===void 0?null:D}},$e.startTransition=function(S){var D=O.T,M={};O.T=M;try{var I=S(),G=O.S;G!==null&&G(M,I),typeof I=="object"&&I!==null&&typeof I.then=="function"&&I.then(V,we)}catch(ae){we(ae)}finally{D!==null&&M.types!==null&&(D.types=M.types),O.T=D}},$e.unstable_useCacheRefresh=function(){return O.H.useCacheRefresh()},$e.use=function(S){return O.H.use(S)},$e.useActionState=function(S,D,M){return O.H.useActionState(S,D,M)},$e.useCallback=function(S,D){return O.H.useCallback(S,D)},$e.useContext=function(S){return O.H.useContext(S)},$e.useDebugValue=function(){},$e.useDeferredValue=function(S,D){return O.H.useDeferredValue(S,D)},$e.useEffect=function(S,D){return O.H.useEffect(S,D)},$e.useEffectEvent=function(S){return O.H.useEffectEvent(S)},$e.useId=function(){return O.H.useId()},$e.useImperativeHandle=function(S,D,M){return O.H.useImperativeHandle(S,D,M)},$e.useInsertionEffect=function(S,D){return O.H.useInsertionEffect(S,D)},$e.useLayoutEffect=function(S,D){return O.H.useLayoutEffect(S,D)},$e.useMemo=function(S,D){return O.H.useMemo(S,D)},$e.useOptimistic=function(S,D){return O.H.useOptimistic(S,D)},$e.useReducer=function(S,D,M){return O.H.useReducer(S,D,M)},$e.useRef=function(S){return O.H.useRef(S)},$e.useState=function(S){return O.H.useState(S)},$e.useSyncExternalStore=function(S,D,M){return O.H.useSyncExternalStore(S,D,M)},$e.useTransition=function(){return O.H.useTransition()},$e.version="19.2.3",$e}var Dx;function $f(){return Dx||(Dx=1,xh.exports=ZN()),xh.exports}var v=$f(),bh={exports:{}},xl={},yh={exports:{}},vh={};var Ox;function WN(){return Ox||(Ox=1,(function(s){function e(J,se){var he=J.length;J.push(se);e:for(;0<he;){var we=he-1>>>1,K=J[we];if(0<o(K,se))J[we]=se,J[he]=K,he=we;else break e}}function a(J){return J.length===0?null:J[0]}function i(J){if(J.length===0)return null;var se=J[0],he=J.pop();if(he!==se){J[0]=he;e:for(var we=0,K=J.length,S=K>>>1;we<S;){var D=2*(we+1)-1,M=J[D],I=D+1,G=J[I];if(0>o(M,he))I<K&&0>o(G,M)?(J[we]=G,J[I]=he,we=I):(J[we]=M,J[D]=he,we=D);else if(I<K&&0>o(G,he))J[we]=G,J[I]=he,we=I;else break e}}return se}function o(J,se){var he=J.sortIndex-se.sortIndex;return he!==0?he:J.id-se.id}if(s.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var u=performance;s.unstable_now=function(){return u.now()}}else{var d=Date,f=d.now();s.unstable_now=function(){return d.now()-f}}var m=[],p=[],x=1,b=null,y=3,j=!1,N=!1,k=!1,T=!1,R=typeof setTimeout=="function"?setTimeout:null,A=typeof clearTimeout=="function"?clearTimeout:null,C=typeof setImmediate<"u"?setImmediate:null;function B(J){for(var se=a(p);se!==null;){if(se.callback===null)i(p);else if(se.startTime<=J)i(p),se.sortIndex=se.expirationTime,e(m,se);else break;se=a(p)}}function F(J){if(k=!1,B(J),!N)if(a(m)!==null)N=!0,V||(V=!0,ye());else{var se=a(p);se!==null&&ze(F,se.startTime-J)}}var V=!1,O=-1,H=5,te=-1;function me(){return T?!0:!(s.unstable_now()-te<H)}function de(){if(T=!1,V){var J=s.unstable_now();te=J;var se=!0;try{e:{N=!1,k&&(k=!1,A(O),O=-1),j=!0;var he=y;try{t:{for(B(J),b=a(m);b!==null&&!(b.expirationTime>J&&me());){var we=b.callback;if(typeof we=="function"){b.callback=null,y=b.priorityLevel;var K=we(b.expirationTime<=J);if(J=s.unstable_now(),typeof K=="function"){b.callback=K,B(J),se=!0;break t}b===a(m)&&i(m),B(J)}else i(m);b=a(m)}if(b!==null)se=!0;else{var S=a(p);S!==null&&ze(F,S.startTime-J),se=!1}}break e}finally{b=null,y=he,j=!1}se=void 0}}finally{se?ye():V=!1}}}var ye;if(typeof C=="function")ye=function(){C(de)};else if(typeof MessageChannel<"u"){var Ae=new MessageChannel,Re=Ae.port2;Ae.port1.onmessage=de,ye=function(){Re.postMessage(null)}}else ye=function(){R(de,0)};function ze(J,se){O=R(function(){J(s.unstable_now())},se)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(J){J.callback=null},s.unstable_forceFrameRate=function(J){0>J||125<J?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):H=0<J?Math.floor(1e3/J):5},s.unstable_getCurrentPriorityLevel=function(){return y},s.unstable_next=function(J){switch(y){case 1:case 2:case 3:var se=3;break;default:se=y}var he=y;y=se;try{return J()}finally{y=he}},s.unstable_requestPaint=function(){T=!0},s.unstable_runWithPriority=function(J,se){switch(J){case 1:case 2:case 3:case 4:case 5:break;default:J=3}var he=y;y=J;try{return se()}finally{y=he}},s.unstable_scheduleCallback=function(J,se,he){var we=s.unstable_now();switch(typeof he=="object"&&he!==null?(he=he.delay,he=typeof he=="number"&&0<he?we+he:we):he=we,J){case 1:var K=-1;break;case 2:K=250;break;case 5:K=1073741823;break;case 4:K=1e4;break;default:K=5e3}return K=he+K,J={id:x++,callback:se,priorityLevel:J,startTime:he,expirationTime:K,sortIndex:-1},he>we?(J.sortIndex=he,e(p,J),a(m)===null&&J===a(p)&&(k?(A(O),O=-1):k=!0,ze(F,he-we))):(J.sortIndex=K,e(m,J),N||j||(N=!0,V||(V=!0,ye()))),J},s.unstable_shouldYield=me,s.unstable_wrapCallback=function(J){var se=y;return function(){var he=y;y=se;try{return J.apply(this,arguments)}finally{y=he}}}})(vh)),vh}var Mx;function eS(){return Mx||(Mx=1,yh.exports=WN()),yh.exports}var wh={exports:{}},hs={};var Ux;function tS(){if(Ux)return hs;Ux=1;var s=$f();function e(m){var p="https://react.dev/errors/"+m;if(1<arguments.length){p+="?args[]="+encodeURIComponent(arguments[1]);for(var x=2;x<arguments.length;x++)p+="&args[]="+encodeURIComponent(arguments[x])}return"Minified React error #"+m+"; visit "+p+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(){}var i={d:{f:a,r:function(){throw Error(e(522))},D:a,C:a,L:a,m:a,X:a,S:a,M:a},p:0,findDOMNode:null},o=Symbol.for("react.portal");function u(m,p,x){var b=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:o,key:b==null?null:""+b,children:m,containerInfo:p,implementation:x}}var d=s.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function f(m,p){if(m==="font")return"";if(typeof p=="string")return p==="use-credentials"?p:""}return hs.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,hs.createPortal=function(m,p){var x=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!p||p.nodeType!==1&&p.nodeType!==9&&p.nodeType!==11)throw Error(e(299));return u(m,p,null,x)},hs.flushSync=function(m){var p=d.T,x=i.p;try{if(d.T=null,i.p=2,m)return m()}finally{d.T=p,i.p=x,i.d.f()}},hs.preconnect=function(m,p){typeof m=="string"&&(p?(p=p.crossOrigin,p=typeof p=="string"?p==="use-credentials"?p:"":void 0):p=null,i.d.C(m,p))},hs.prefetchDNS=function(m){typeof m=="string"&&i.d.D(m)},hs.preinit=function(m,p){if(typeof m=="string"&&p&&typeof p.as=="string"){var x=p.as,b=f(x,p.crossOrigin),y=typeof p.integrity=="string"?p.integrity:void 0,j=typeof p.fetchPriority=="string"?p.fetchPriority:void 0;x==="style"?i.d.S(m,typeof p.precedence=="string"?p.precedence:void 0,{crossOrigin:b,integrity:y,fetchPriority:j}):x==="script"&&i.d.X(m,{crossOrigin:b,integrity:y,fetchPriority:j,nonce:typeof p.nonce=="string"?p.nonce:void 0})}},hs.preinitModule=function(m,p){if(typeof m=="string")if(typeof p=="object"&&p!==null){if(p.as==null||p.as==="script"){var x=f(p.as,p.crossOrigin);i.d.M(m,{crossOrigin:x,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0})}}else p==null&&i.d.M(m)},hs.preload=function(m,p){if(typeof m=="string"&&typeof p=="object"&&p!==null&&typeof p.as=="string"){var x=p.as,b=f(x,p.crossOrigin);i.d.L(m,x,{crossOrigin:b,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0,type:typeof p.type=="string"?p.type:void 0,fetchPriority:typeof p.fetchPriority=="string"?p.fetchPriority:void 0,referrerPolicy:typeof p.referrerPolicy=="string"?p.referrerPolicy:void 0,imageSrcSet:typeof p.imageSrcSet=="string"?p.imageSrcSet:void 0,imageSizes:typeof p.imageSizes=="string"?p.imageSizes:void 0,media:typeof p.media=="string"?p.media:void 0})}},hs.preloadModule=function(m,p){if(typeof m=="string")if(p){var x=f(p.as,p.crossOrigin);i.d.m(m,{as:typeof p.as=="string"&&p.as!=="script"?p.as:void 0,crossOrigin:x,integrity:typeof p.integrity=="string"?p.integrity:void 0})}else i.d.m(m)},hs.requestFormReset=function(m){i.d.r(m)},hs.unstable_batchedUpdates=function(m,p){return m(p)},hs.useFormState=function(m,p,x){return d.H.useFormState(m,p,x)},hs.useFormStatus=function(){return d.H.useHostTransitionStatus()},hs.version="19.2.3",hs}var Lx;function Ky(){if(Lx)return wh.exports;Lx=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),wh.exports=tS(),wh.exports}var Px;function sS(){if(Px)return xl;Px=1;var s=eS(),e=$f(),a=Ky();function i(t){var n="https://react.dev/errors/"+t;if(1<arguments.length){n+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)n+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+t+"; visit "+n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function u(t){var n=t,l=t;if(t.alternate)for(;n.return;)n=n.return;else{t=n;do n=t,(n.flags&4098)!==0&&(l=n.return),t=n.return;while(t)}return n.tag===3?l:null}function d(t){if(t.tag===13){var n=t.memoizedState;if(n===null&&(t=t.alternate,t!==null&&(n=t.memoizedState)),n!==null)return n.dehydrated}return null}function f(t){if(t.tag===31){var n=t.memoizedState;if(n===null&&(t=t.alternate,t!==null&&(n=t.memoizedState)),n!==null)return n.dehydrated}return null}function m(t){if(u(t)!==t)throw Error(i(188))}function p(t){var n=t.alternate;if(!n){if(n=u(t),n===null)throw Error(i(188));return n!==t?null:t}for(var l=t,c=n;;){var h=l.return;if(h===null)break;var g=h.alternate;if(g===null){if(c=h.return,c!==null){l=c;continue}break}if(h.child===g.child){for(g=h.child;g;){if(g===l)return m(h),t;if(g===c)return m(h),n;g=g.sibling}throw Error(i(188))}if(l.return!==c.return)l=h,c=g;else{for(var w=!1,E=h.child;E;){if(E===l){w=!0,l=h,c=g;break}if(E===c){w=!0,c=h,l=g;break}E=E.sibling}if(!w){for(E=g.child;E;){if(E===l){w=!0,l=g,c=h;break}if(E===c){w=!0,c=g,l=h;break}E=E.sibling}if(!w)throw Error(i(189))}}if(l.alternate!==c)throw Error(i(190))}if(l.tag!==3)throw Error(i(188));return l.stateNode.current===l?t:n}function x(t){var n=t.tag;if(n===5||n===26||n===27||n===6)return t;for(t=t.child;t!==null;){if(n=x(t),n!==null)return n;t=t.sibling}return null}var b=Object.assign,y=Symbol.for("react.element"),j=Symbol.for("react.transitional.element"),N=Symbol.for("react.portal"),k=Symbol.for("react.fragment"),T=Symbol.for("react.strict_mode"),R=Symbol.for("react.profiler"),A=Symbol.for("react.consumer"),C=Symbol.for("react.context"),B=Symbol.for("react.forward_ref"),F=Symbol.for("react.suspense"),V=Symbol.for("react.suspense_list"),O=Symbol.for("react.memo"),H=Symbol.for("react.lazy"),te=Symbol.for("react.activity"),me=Symbol.for("react.memo_cache_sentinel"),de=Symbol.iterator;function ye(t){return t===null||typeof t!="object"?null:(t=de&&t[de]||t["@@iterator"],typeof t=="function"?t:null)}var Ae=Symbol.for("react.client.reference");function Re(t){if(t==null)return null;if(typeof t=="function")return t.$$typeof===Ae?null:t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case k:return"Fragment";case R:return"Profiler";case T:return"StrictMode";case F:return"Suspense";case V:return"SuspenseList";case te:return"Activity"}if(typeof t=="object")switch(t.$$typeof){case N:return"Portal";case C:return t.displayName||"Context";case A:return(t._context.displayName||"Context")+".Consumer";case B:var n=t.render;return t=t.displayName,t||(t=n.displayName||n.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case O:return n=t.displayName||null,n!==null?n:Re(t.type)||"Memo";case H:n=t._payload,t=t._init;try{return Re(t(n))}catch{}}return null}var ze=Array.isArray,J=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,se=a.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,he={pending:!1,data:null,method:null,action:null},we=[],K=-1;function S(t){return{current:t}}function D(t){0>K||(t.current=we[K],we[K]=null,K--)}function M(t,n){K++,we[K]=t.current,t.current=n}var I=S(null),G=S(null),ae=S(null),xe=S(null);function je(t,n){switch(M(ae,n),M(G,t),M(I,null),n.nodeType){case 9:case 11:t=(t=n.documentElement)&&(t=t.namespaceURI)?Z0(t):0;break;default:if(t=n.tagName,n=n.namespaceURI)n=Z0(n),t=W0(n,t);else switch(t){case"svg":t=1;break;case"math":t=2;break;default:t=0}}D(I),M(I,t)}function Se(){D(I),D(G),D(ae)}function pe(t){t.memoizedState!==null&&M(xe,t);var n=I.current,l=W0(n,t.type);n!==l&&(M(G,t),M(I,l))}function qe(t){G.current===t&&(D(I),D(G)),xe.current===t&&(D(xe),hl._currentValue=he)}var Oe,Xe;function vt(t){if(Oe===void 0)try{throw Error()}catch(l){var n=l.stack.trim().match(/\n( *(at )?)/);Oe=n&&n[1]||"",Xe=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Oe+t+Xe}var fe=!1;function ve(t,n){if(!t||fe)return"";fe=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(n){var oe=function(){throw Error()};if(Object.defineProperty(oe.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(oe,[])}catch(ee){var Q=ee}Reflect.construct(t,[],oe)}else{try{oe.call()}catch(ee){Q=ee}t.call(oe.prototype)}}else{try{throw Error()}catch(ee){Q=ee}(oe=t())&&typeof oe.catch=="function"&&oe.catch(function(){})}}catch(ee){if(ee&&Q&&typeof ee.stack=="string")return[ee.stack,Q.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var h=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");h&&h.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var g=c.DetermineComponentFrameRoot(),w=g[0],E=g[1];if(w&&E){var P=w.split(`
`),X=E.split(`
`);for(h=c=0;c<P.length&&!P[c].includes("DetermineComponentFrameRoot");)c++;for(;h<X.length&&!X[h].includes("DetermineComponentFrameRoot");)h++;if(c===P.length||h===X.length)for(c=P.length-1,h=X.length-1;1<=c&&0<=h&&P[c]!==X[h];)h--;for(;1<=c&&0<=h;c--,h--)if(P[c]!==X[h]){if(c!==1||h!==1)do if(c--,h--,0>h||P[c]!==X[h]){var ne=`
`+P[c].replace(" at new "," at ");return t.displayName&&ne.includes("<anonymous>")&&(ne=ne.replace("<anonymous>",t.displayName)),ne}while(1<=c&&0<=h);break}}}finally{fe=!1,Error.prepareStackTrace=l}return(l=t?t.displayName||t.name:"")?vt(l):""}function le(t,n){switch(t.tag){case 26:case 27:case 5:return vt(t.type);case 16:return vt("Lazy");case 13:return t.child!==n&&n!==null?vt("Suspense Fallback"):vt("Suspense");case 19:return vt("SuspenseList");case 0:case 15:return ve(t.type,!1);case 11:return ve(t.type.render,!1);case 1:return ve(t.type,!0);case 31:return vt("Activity");default:return""}}function Ee(t){try{var n="",l=null;do n+=le(t,l),l=t,t=t.return;while(t);return n}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}var Ie=Object.prototype.hasOwnProperty,ot=s.unstable_scheduleCallback,ss=s.unstable_cancelCallback,ks=s.unstable_shouldYield,pr=s.unstable_requestPaint,Jt=s.unstable_now,gr=s.unstable_getCurrentPriorityLevel,Ua=s.unstable_ImmediatePriority,La=s.unstable_UserBlockingPriority,kn=s.unstable_NormalPriority,xr=s.unstable_LowPriority,Pa=s.unstable_IdlePriority,Mt=s.log,ds=s.unstable_setDisableYieldValue,pn=null,Qt=null;function Ts(t){if(typeof Mt=="function"&&ds(t),Qt&&typeof Qt.setStrictMode=="function")try{Qt.setStrictMode(pn,t)}catch{}}var Ht=Math.clz32?Math.clz32:L,W=Math.log,_=Math.LN2;function L(t){return t>>>=0,t===0?32:31-(W(t)/_|0)|0}var U=256,z=262144,Z=4194304;function re(t){var n=t&42;if(n!==0)return n;switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return t&261888;case 262144:case 524288:case 1048576:case 2097152:return t&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return t&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return t}}function ue(t,n,l){var c=t.pendingLanes;if(c===0)return 0;var h=0,g=t.suspendedLanes,w=t.pingedLanes;t=t.warmLanes;var E=c&134217727;return E!==0?(c=E&~g,c!==0?h=re(c):(w&=E,w!==0?h=re(w):l||(l=E&~t,l!==0&&(h=re(l))))):(E=c&~g,E!==0?h=re(E):w!==0?h=re(w):l||(l=c&~t,l!==0&&(h=re(l)))),h===0?0:n!==0&&n!==h&&(n&g)===0&&(g=h&-h,l=n&-n,g>=l||g===32&&(l&4194048)!==0)?n:h}function ge(t,n){return(t.pendingLanes&~(t.suspendedLanes&~t.pingedLanes)&n)===0}function be(t,n){switch(t){case 1:case 2:case 4:case 8:case 64:return n+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Me(){var t=Z;return Z<<=1,(Z&62914560)===0&&(Z=4194304),t}function Be(t){for(var n=[],l=0;31>l;l++)n.push(t);return n}function Ve(t,n){t.pendingLanes|=n,n!==268435456&&(t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0)}function nt(t,n,l,c,h,g){var w=t.pendingLanes;t.pendingLanes=l,t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0,t.expiredLanes&=l,t.entangledLanes&=l,t.errorRecoveryDisabledLanes&=l,t.shellSuspendCounter=0;var E=t.entanglements,P=t.expirationTimes,X=t.hiddenUpdates;for(l=w&~l;0<l;){var ne=31-Ht(l),oe=1<<ne;E[ne]=0,P[ne]=-1;var Q=X[ne];if(Q!==null)for(X[ne]=null,ne=0;ne<Q.length;ne++){var ee=Q[ne];ee!==null&&(ee.lane&=-536870913)}l&=~oe}c!==0&&st(t,c,0),g!==0&&h===0&&t.tag!==0&&(t.suspendedLanes|=g&~(w&~n))}function st(t,n,l){t.pendingLanes|=n,t.suspendedLanes&=~n;var c=31-Ht(n);t.entangledLanes|=n,t.entanglements[c]=t.entanglements[c]|1073741824|l&261930}function Gt(t,n){var l=t.entangledLanes|=n;for(t=t.entanglements;l;){var c=31-Ht(l),h=1<<c;h&n|t[c]&n&&(t[c]|=n),l&=~h}}function Tt(t,n){var l=n&-n;return l=(l&42)!==0?1:mt(l),(l&(t.suspendedLanes|n))!==0?0:l}function mt(t){switch(t){case 2:t=1;break;case 8:t=4;break;case 32:t=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:t=128;break;case 268435456:t=134217728;break;default:t=0}return t}function St(t){return t&=-t,2<t?8<t?(t&134217727)!==0?32:268435456:8:2}function gn(){var t=se.p;return t!==0?t:(t=window.event,t===void 0?32:jx(t.type))}function to(t,n){var l=se.p;try{return se.p=t,n()}finally{se.p=l}}var ea=Math.random().toString(36).slice(2),ns="__reactFiber$"+ea,ys="__reactProps$"+ea,br="__reactContainer$"+ea,lu="__reactEvents$"+ea,Bj="__reactListeners$"+ea,zj="__reactHandles$"+ea,Bm="__reactResources$"+ea,Ti="__reactMarker$"+ea;function ou(t){delete t[ns],delete t[ys],delete t[lu],delete t[Bj],delete t[zj]}function yr(t){var n=t[ns];if(n)return n;for(var l=t.parentNode;l;){if(n=l[br]||l[ns]){if(l=n.alternate,n.child!==null||l!==null&&l.child!==null)for(t=ix(t);t!==null;){if(l=t[ns])return l;t=ix(t)}return n}t=l,l=t.parentNode}return null}function vr(t){if(t=t[ns]||t[br]){var n=t.tag;if(n===5||n===6||n===13||n===31||n===26||n===27||n===3)return t}return null}function Ei(t){var n=t.tag;if(n===5||n===26||n===27||n===6)return t.stateNode;throw Error(i(33))}function wr(t){var n=t[Bm];return n||(n=t[Bm]={hoistableStyles:new Map,hoistableScripts:new Map}),n}function Zt(t){t[Ti]=!0}var zm=new Set,Vm={};function Ia(t,n){jr(t,n),jr(t+"Capture",n)}function jr(t,n){for(Vm[t]=n,t=0;t<n.length;t++)zm.add(n[t])}var Vj=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),$m={},qm={};function $j(t){return Ie.call(qm,t)?!0:Ie.call($m,t)?!1:Vj.test(t)?qm[t]=!0:($m[t]=!0,!1)}function so(t,n,l){if($j(n))if(l===null)t.removeAttribute(n);else{switch(typeof l){case"undefined":case"function":case"symbol":t.removeAttribute(n);return;case"boolean":var c=n.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){t.removeAttribute(n);return}}t.setAttribute(n,""+l)}}function no(t,n,l){if(l===null)t.removeAttribute(n);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(n);return}t.setAttribute(n,""+l)}}function Tn(t,n,l,c){if(c===null)t.removeAttribute(l);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(l);return}t.setAttributeNS(n,l,""+c)}}function Bs(t){switch(typeof t){case"bigint":case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Hm(t){var n=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(n==="checkbox"||n==="radio")}function qj(t,n,l){var c=Object.getOwnPropertyDescriptor(t.constructor.prototype,n);if(!t.hasOwnProperty(n)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var h=c.get,g=c.set;return Object.defineProperty(t,n,{configurable:!0,get:function(){return h.call(this)},set:function(w){l=""+w,g.call(this,w)}}),Object.defineProperty(t,n,{enumerable:c.enumerable}),{getValue:function(){return l},setValue:function(w){l=""+w},stopTracking:function(){t._valueTracker=null,delete t[n]}}}}function cu(t){if(!t._valueTracker){var n=Hm(t)?"checked":"value";t._valueTracker=qj(t,n,""+t[n])}}function Gm(t){if(!t)return!1;var n=t._valueTracker;if(!n)return!0;var l=n.getValue(),c="";return t&&(c=Hm(t)?t.checked?"true":"false":t.value),t=c,t!==l?(n.setValue(t),!0):!1}function ao(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}var Hj=/[\n"\\]/g;function zs(t){return t.replace(Hj,function(n){return"\\"+n.charCodeAt(0).toString(16)+" "})}function uu(t,n,l,c,h,g,w,E){t.name="",w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"?t.type=w:t.removeAttribute("type"),n!=null?w==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+Bs(n)):t.value!==""+Bs(n)&&(t.value=""+Bs(n)):w!=="submit"&&w!=="reset"||t.removeAttribute("value"),n!=null?du(t,w,Bs(n)):l!=null?du(t,w,Bs(l)):c!=null&&t.removeAttribute("value"),h==null&&g!=null&&(t.defaultChecked=!!g),h!=null&&(t.checked=h&&typeof h!="function"&&typeof h!="symbol"),E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"?t.name=""+Bs(E):t.removeAttribute("name")}function Fm(t,n,l,c,h,g,w,E){if(g!=null&&typeof g!="function"&&typeof g!="symbol"&&typeof g!="boolean"&&(t.type=g),n!=null||l!=null){if(!(g!=="submit"&&g!=="reset"||n!=null)){cu(t);return}l=l!=null?""+Bs(l):"",n=n!=null?""+Bs(n):l,E||n===t.value||(t.value=n),t.defaultValue=n}c=c??h,c=typeof c!="function"&&typeof c!="symbol"&&!!c,t.checked=E?t.checked:!!c,t.defaultChecked=!!c,w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"&&(t.name=w),cu(t)}function du(t,n,l){n==="number"&&ao(t.ownerDocument)===t||t.defaultValue===""+l||(t.defaultValue=""+l)}function Nr(t,n,l,c){if(t=t.options,n){n={};for(var h=0;h<l.length;h++)n["$"+l[h]]=!0;for(l=0;l<t.length;l++)h=n.hasOwnProperty("$"+t[l].value),t[l].selected!==h&&(t[l].selected=h),h&&c&&(t[l].defaultSelected=!0)}else{for(l=""+Bs(l),n=null,h=0;h<t.length;h++){if(t[h].value===l){t[h].selected=!0,c&&(t[h].defaultSelected=!0);return}n!==null||t[h].disabled||(n=t[h])}n!==null&&(n.selected=!0)}}function Km(t,n,l){if(n!=null&&(n=""+Bs(n),n!==t.value&&(t.value=n),l==null)){t.defaultValue!==n&&(t.defaultValue=n);return}t.defaultValue=l!=null?""+Bs(l):""}function Ym(t,n,l,c){if(n==null){if(c!=null){if(l!=null)throw Error(i(92));if(ze(c)){if(1<c.length)throw Error(i(93));c=c[0]}l=c}l==null&&(l=""),n=l}l=Bs(n),t.defaultValue=l,c=t.textContent,c===l&&c!==""&&c!==null&&(t.value=c),cu(t)}function Sr(t,n){if(n){var l=t.firstChild;if(l&&l===t.lastChild&&l.nodeType===3){l.nodeValue=n;return}}t.textContent=n}var Gj=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Xm(t,n,l){var c=n.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?c?t.setProperty(n,""):n==="float"?t.cssFloat="":t[n]="":c?t.setProperty(n,l):typeof l!="number"||l===0||Gj.has(n)?n==="float"?t.cssFloat=l:t[n]=(""+l).trim():t[n]=l+"px"}function Jm(t,n,l){if(n!=null&&typeof n!="object")throw Error(i(62));if(t=t.style,l!=null){for(var c in l)!l.hasOwnProperty(c)||n!=null&&n.hasOwnProperty(c)||(c.indexOf("--")===0?t.setProperty(c,""):c==="float"?t.cssFloat="":t[c]="");for(var h in n)c=n[h],n.hasOwnProperty(h)&&l[h]!==c&&Xm(t,h,c)}else for(var g in n)n.hasOwnProperty(g)&&Xm(t,g,n[g])}function hu(t){if(t.indexOf("-")===-1)return!1;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Fj=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Kj=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ro(t){return Kj.test(""+t)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":t}function En(){}var fu=null;function mu(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var _r=null,kr=null;function Qm(t){var n=vr(t);if(n&&(t=n.stateNode)){var l=t[ys]||null;e:switch(t=n.stateNode,n.type){case"input":if(uu(t,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),n=l.name,l.type==="radio"&&n!=null){for(l=t;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+zs(""+n)+'"][type="radio"]'),n=0;n<l.length;n++){var c=l[n];if(c!==t&&c.form===t.form){var h=c[ys]||null;if(!h)throw Error(i(90));uu(c,h.value,h.defaultValue,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name)}}for(n=0;n<l.length;n++)c=l[n],c.form===t.form&&Gm(c)}break e;case"textarea":Km(t,l.value,l.defaultValue);break e;case"select":n=l.value,n!=null&&Nr(t,!!l.multiple,n,!1)}}}var pu=!1;function Zm(t,n,l){if(pu)return t(n,l);pu=!0;try{var c=t(n);return c}finally{if(pu=!1,(_r!==null||kr!==null)&&(Ko(),_r&&(n=_r,t=kr,kr=_r=null,Qm(n),t)))for(n=0;n<t.length;n++)Qm(t[n])}}function Ci(t,n){var l=t.stateNode;if(l===null)return null;var c=l[ys]||null;if(c===null)return null;l=c[n];e:switch(n){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(t=t.type,c=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!c;break e;default:t=!1}if(t)return null;if(l&&typeof l!="function")throw Error(i(231,n,typeof l));return l}var Cn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),gu=!1;if(Cn)try{var Ai={};Object.defineProperty(Ai,"passive",{get:function(){gu=!0}}),window.addEventListener("test",Ai,Ai),window.removeEventListener("test",Ai,Ai)}catch{gu=!1}var ta=null,xu=null,io=null;function Wm(){if(io)return io;var t,n=xu,l=n.length,c,h="value"in ta?ta.value:ta.textContent,g=h.length;for(t=0;t<l&&n[t]===h[t];t++);var w=l-t;for(c=1;c<=w&&n[l-c]===h[g-c];c++);return io=h.slice(t,1<c?1-c:void 0)}function lo(t){var n=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&n===13&&(t=13)):t=n,t===10&&(t=13),32<=t||t===13?t:0}function oo(){return!0}function ep(){return!1}function vs(t){function n(l,c,h,g,w){this._reactName=l,this._targetInst=h,this.type=c,this.nativeEvent=g,this.target=w,this.currentTarget=null;for(var E in t)t.hasOwnProperty(E)&&(l=t[E],this[E]=l?l(g):g[E]);return this.isDefaultPrevented=(g.defaultPrevented!=null?g.defaultPrevented:g.returnValue===!1)?oo:ep,this.isPropagationStopped=ep,this}return b(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=oo)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=oo)},persist:function(){},isPersistent:oo}),n}var Ba={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},co=vs(Ba),Ri=b({},Ba,{view:0,detail:0}),Yj=vs(Ri),bu,yu,Di,uo=b({},Ri,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:wu,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Di&&(Di&&t.type==="mousemove"?(bu=t.screenX-Di.screenX,yu=t.screenY-Di.screenY):yu=bu=0,Di=t),bu)},movementY:function(t){return"movementY"in t?t.movementY:yu}}),tp=vs(uo),Xj=b({},uo,{dataTransfer:0}),Jj=vs(Xj),Qj=b({},Ri,{relatedTarget:0}),vu=vs(Qj),Zj=b({},Ba,{animationName:0,elapsedTime:0,pseudoElement:0}),Wj=vs(Zj),e1=b({},Ba,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),t1=vs(e1),s1=b({},Ba,{data:0}),sp=vs(s1),n1={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},a1={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},r1={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function i1(t){var n=this.nativeEvent;return n.getModifierState?n.getModifierState(t):(t=r1[t])?!!n[t]:!1}function wu(){return i1}var l1=b({},Ri,{key:function(t){if(t.key){var n=n1[t.key]||t.key;if(n!=="Unidentified")return n}return t.type==="keypress"?(t=lo(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?a1[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:wu,charCode:function(t){return t.type==="keypress"?lo(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?lo(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),o1=vs(l1),c1=b({},uo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),np=vs(c1),u1=b({},Ri,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:wu}),d1=vs(u1),h1=b({},Ba,{propertyName:0,elapsedTime:0,pseudoElement:0}),f1=vs(h1),m1=b({},uo,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),p1=vs(m1),g1=b({},Ba,{newState:0,oldState:0}),x1=vs(g1),b1=[9,13,27,32],ju=Cn&&"CompositionEvent"in window,Oi=null;Cn&&"documentMode"in document&&(Oi=document.documentMode);var y1=Cn&&"TextEvent"in window&&!Oi,ap=Cn&&(!ju||Oi&&8<Oi&&11>=Oi),rp=" ",ip=!1;function lp(t,n){switch(t){case"keyup":return b1.indexOf(n.keyCode)!==-1;case"keydown":return n.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function op(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Tr=!1;function v1(t,n){switch(t){case"compositionend":return op(n);case"keypress":return n.which!==32?null:(ip=!0,rp);case"textInput":return t=n.data,t===rp&&ip?null:t;default:return null}}function w1(t,n){if(Tr)return t==="compositionend"||!ju&&lp(t,n)?(t=Wm(),io=xu=ta=null,Tr=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(n.ctrlKey||n.altKey||n.metaKey)||n.ctrlKey&&n.altKey){if(n.char&&1<n.char.length)return n.char;if(n.which)return String.fromCharCode(n.which)}return null;case"compositionend":return ap&&n.locale!=="ko"?null:n.data;default:return null}}var j1={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function cp(t){var n=t&&t.nodeName&&t.nodeName.toLowerCase();return n==="input"?!!j1[t.type]:n==="textarea"}function up(t,n,l,c){_r?kr?kr.push(c):kr=[c]:_r=c,n=ec(n,"onChange"),0<n.length&&(l=new co("onChange","change",null,l,c),t.push({event:l,listeners:n}))}var Mi=null,Ui=null;function N1(t){F0(t,0)}function ho(t){var n=Ei(t);if(Gm(n))return t}function dp(t,n){if(t==="change")return n}var hp=!1;if(Cn){var Nu;if(Cn){var Su="oninput"in document;if(!Su){var fp=document.createElement("div");fp.setAttribute("oninput","return;"),Su=typeof fp.oninput=="function"}Nu=Su}else Nu=!1;hp=Nu&&(!document.documentMode||9<document.documentMode)}function mp(){Mi&&(Mi.detachEvent("onpropertychange",pp),Ui=Mi=null)}function pp(t){if(t.propertyName==="value"&&ho(Ui)){var n=[];up(n,Ui,t,mu(t)),Zm(N1,n)}}function S1(t,n,l){t==="focusin"?(mp(),Mi=n,Ui=l,Mi.attachEvent("onpropertychange",pp)):t==="focusout"&&mp()}function _1(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return ho(Ui)}function k1(t,n){if(t==="click")return ho(n)}function T1(t,n){if(t==="input"||t==="change")return ho(n)}function E1(t,n){return t===n&&(t!==0||1/t===1/n)||t!==t&&n!==n}var Es=typeof Object.is=="function"?Object.is:E1;function Li(t,n){if(Es(t,n))return!0;if(typeof t!="object"||t===null||typeof n!="object"||n===null)return!1;var l=Object.keys(t),c=Object.keys(n);if(l.length!==c.length)return!1;for(c=0;c<l.length;c++){var h=l[c];if(!Ie.call(n,h)||!Es(t[h],n[h]))return!1}return!0}function gp(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function xp(t,n){var l=gp(t);t=0;for(var c;l;){if(l.nodeType===3){if(c=t+l.textContent.length,t<=n&&c>=n)return{node:l,offset:n-t};t=c}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=gp(l)}}function bp(t,n){return t&&n?t===n?!0:t&&t.nodeType===3?!1:n&&n.nodeType===3?bp(t,n.parentNode):"contains"in t?t.contains(n):t.compareDocumentPosition?!!(t.compareDocumentPosition(n)&16):!1:!1}function yp(t){t=t!=null&&t.ownerDocument!=null&&t.ownerDocument.defaultView!=null?t.ownerDocument.defaultView:window;for(var n=ao(t.document);n instanceof t.HTMLIFrameElement;){try{var l=typeof n.contentWindow.location.href=="string"}catch{l=!1}if(l)t=n.contentWindow;else break;n=ao(t.document)}return n}function _u(t){var n=t&&t.nodeName&&t.nodeName.toLowerCase();return n&&(n==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||n==="textarea"||t.contentEditable==="true")}var C1=Cn&&"documentMode"in document&&11>=document.documentMode,Er=null,ku=null,Pi=null,Tu=!1;function vp(t,n,l){var c=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;Tu||Er==null||Er!==ao(c)||(c=Er,"selectionStart"in c&&_u(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),Pi&&Li(Pi,c)||(Pi=c,c=ec(ku,"onSelect"),0<c.length&&(n=new co("onSelect","select",null,n,l),t.push({event:n,listeners:c}),n.target=Er)))}function za(t,n){var l={};return l[t.toLowerCase()]=n.toLowerCase(),l["Webkit"+t]="webkit"+n,l["Moz"+t]="moz"+n,l}var Cr={animationend:za("Animation","AnimationEnd"),animationiteration:za("Animation","AnimationIteration"),animationstart:za("Animation","AnimationStart"),transitionrun:za("Transition","TransitionRun"),transitionstart:za("Transition","TransitionStart"),transitioncancel:za("Transition","TransitionCancel"),transitionend:za("Transition","TransitionEnd")},Eu={},wp={};Cn&&(wp=document.createElement("div").style,"AnimationEvent"in window||(delete Cr.animationend.animation,delete Cr.animationiteration.animation,delete Cr.animationstart.animation),"TransitionEvent"in window||delete Cr.transitionend.transition);function Va(t){if(Eu[t])return Eu[t];if(!Cr[t])return t;var n=Cr[t],l;for(l in n)if(n.hasOwnProperty(l)&&l in wp)return Eu[t]=n[l];return t}var jp=Va("animationend"),Np=Va("animationiteration"),Sp=Va("animationstart"),A1=Va("transitionrun"),R1=Va("transitionstart"),D1=Va("transitioncancel"),_p=Va("transitionend"),kp=new Map,Cu="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Cu.push("scrollEnd");function Zs(t,n){kp.set(t,n),Ia(n,[t])}var fo=typeof reportError=="function"?reportError:function(t){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var n=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof t=="object"&&t!==null&&typeof t.message=="string"?String(t.message):String(t),error:t});if(!window.dispatchEvent(n))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",t);return}console.error(t)},Vs=[],Ar=0,Au=0;function mo(){for(var t=Ar,n=Au=Ar=0;n<t;){var l=Vs[n];Vs[n++]=null;var c=Vs[n];Vs[n++]=null;var h=Vs[n];Vs[n++]=null;var g=Vs[n];if(Vs[n++]=null,c!==null&&h!==null){var w=c.pending;w===null?h.next=h:(h.next=w.next,w.next=h),c.pending=h}g!==0&&Tp(l,h,g)}}function po(t,n,l,c){Vs[Ar++]=t,Vs[Ar++]=n,Vs[Ar++]=l,Vs[Ar++]=c,Au|=c,t.lanes|=c,t=t.alternate,t!==null&&(t.lanes|=c)}function Ru(t,n,l,c){return po(t,n,l,c),go(t)}function $a(t,n){return po(t,null,null,n),go(t)}function Tp(t,n,l){t.lanes|=l;var c=t.alternate;c!==null&&(c.lanes|=l);for(var h=!1,g=t.return;g!==null;)g.childLanes|=l,c=g.alternate,c!==null&&(c.childLanes|=l),g.tag===22&&(t=g.stateNode,t===null||t._visibility&1||(h=!0)),t=g,g=g.return;return t.tag===3?(g=t.stateNode,h&&n!==null&&(h=31-Ht(l),t=g.hiddenUpdates,c=t[h],c===null?t[h]=[n]:c.push(n),n.lane=l|536870912),g):null}function go(t){if(50<rl)throw rl=0,zd=null,Error(i(185));for(var n=t.return;n!==null;)t=n,n=t.return;return t.tag===3?t.stateNode:null}var Rr={};function O1(t,n,l,c){this.tag=t,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=n,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Cs(t,n,l,c){return new O1(t,n,l,c)}function Du(t){return t=t.prototype,!(!t||!t.isReactComponent)}function An(t,n){var l=t.alternate;return l===null?(l=Cs(t.tag,n,t.key,t.mode),l.elementType=t.elementType,l.type=t.type,l.stateNode=t.stateNode,l.alternate=t,t.alternate=l):(l.pendingProps=n,l.type=t.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=t.flags&65011712,l.childLanes=t.childLanes,l.lanes=t.lanes,l.child=t.child,l.memoizedProps=t.memoizedProps,l.memoizedState=t.memoizedState,l.updateQueue=t.updateQueue,n=t.dependencies,l.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext},l.sibling=t.sibling,l.index=t.index,l.ref=t.ref,l.refCleanup=t.refCleanup,l}function Ep(t,n){t.flags&=65011714;var l=t.alternate;return l===null?(t.childLanes=0,t.lanes=n,t.child=null,t.subtreeFlags=0,t.memoizedProps=null,t.memoizedState=null,t.updateQueue=null,t.dependencies=null,t.stateNode=null):(t.childLanes=l.childLanes,t.lanes=l.lanes,t.child=l.child,t.subtreeFlags=0,t.deletions=null,t.memoizedProps=l.memoizedProps,t.memoizedState=l.memoizedState,t.updateQueue=l.updateQueue,t.type=l.type,n=l.dependencies,t.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t}function xo(t,n,l,c,h,g){var w=0;if(c=t,typeof t=="function")Du(t)&&(w=1);else if(typeof t=="string")w=IN(t,l,I.current)?26:t==="html"||t==="head"||t==="body"?27:5;else e:switch(t){case te:return t=Cs(31,l,n,h),t.elementType=te,t.lanes=g,t;case k:return qa(l.children,h,g,n);case T:w=8,h|=24;break;case R:return t=Cs(12,l,n,h|2),t.elementType=R,t.lanes=g,t;case F:return t=Cs(13,l,n,h),t.elementType=F,t.lanes=g,t;case V:return t=Cs(19,l,n,h),t.elementType=V,t.lanes=g,t;default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case C:w=10;break e;case A:w=9;break e;case B:w=11;break e;case O:w=14;break e;case H:w=16,c=null;break e}w=29,l=Error(i(130,t===null?"null":typeof t,"")),c=null}return n=Cs(w,l,n,h),n.elementType=t,n.type=c,n.lanes=g,n}function qa(t,n,l,c){return t=Cs(7,t,c,n),t.lanes=l,t}function Ou(t,n,l){return t=Cs(6,t,null,n),t.lanes=l,t}function Cp(t){var n=Cs(18,null,null,0);return n.stateNode=t,n}function Mu(t,n,l){return n=Cs(4,t.children!==null?t.children:[],t.key,n),n.lanes=l,n.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},n}var Ap=new WeakMap;function $s(t,n){if(typeof t=="object"&&t!==null){var l=Ap.get(t);return l!==void 0?l:(n={value:t,source:n,stack:Ee(n)},Ap.set(t,n),n)}return{value:t,source:n,stack:Ee(n)}}var Dr=[],Or=0,bo=null,Ii=0,qs=[],Hs=0,sa=null,xn=1,bn="";function Rn(t,n){Dr[Or++]=Ii,Dr[Or++]=bo,bo=t,Ii=n}function Rp(t,n,l){qs[Hs++]=xn,qs[Hs++]=bn,qs[Hs++]=sa,sa=t;var c=xn;t=bn;var h=32-Ht(c)-1;c&=~(1<<h),l+=1;var g=32-Ht(n)+h;if(30<g){var w=h-h%5;g=(c&(1<<w)-1).toString(32),c>>=w,h-=w,xn=1<<32-Ht(n)+h|l<<h|c,bn=g+t}else xn=1<<g|l<<h|c,bn=t}function Uu(t){t.return!==null&&(Rn(t,1),Rp(t,1,0))}function Lu(t){for(;t===bo;)bo=Dr[--Or],Dr[Or]=null,Ii=Dr[--Or],Dr[Or]=null;for(;t===sa;)sa=qs[--Hs],qs[Hs]=null,bn=qs[--Hs],qs[Hs]=null,xn=qs[--Hs],qs[Hs]=null}function Dp(t,n){qs[Hs++]=xn,qs[Hs++]=bn,qs[Hs++]=sa,xn=n.id,bn=n.overflow,sa=t}var as=null,wt=null,We=!1,na=null,Gs=!1,Pu=Error(i(519));function aa(t){var n=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Bi($s(n,t)),Pu}function Op(t){var n=t.stateNode,l=t.type,c=t.memoizedProps;switch(n[ns]=t,n[ys]=c,l){case"dialog":Ke("cancel",n),Ke("close",n);break;case"iframe":case"object":case"embed":Ke("load",n);break;case"video":case"audio":for(l=0;l<ll.length;l++)Ke(ll[l],n);break;case"source":Ke("error",n);break;case"img":case"image":case"link":Ke("error",n),Ke("load",n);break;case"details":Ke("toggle",n);break;case"input":Ke("invalid",n),Fm(n,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0);break;case"select":Ke("invalid",n);break;case"textarea":Ke("invalid",n),Ym(n,c.value,c.defaultValue,c.children)}l=c.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||n.textContent===""+l||c.suppressHydrationWarning===!0||J0(n.textContent,l)?(c.popover!=null&&(Ke("beforetoggle",n),Ke("toggle",n)),c.onScroll!=null&&Ke("scroll",n),c.onScrollEnd!=null&&Ke("scrollend",n),c.onClick!=null&&(n.onclick=En),n=!0):n=!1,n||aa(t,!0)}function Mp(t){for(as=t.return;as;)switch(as.tag){case 5:case 31:case 13:Gs=!1;return;case 27:case 3:Gs=!0;return;default:as=as.return}}function Mr(t){if(t!==as)return!1;if(!We)return Mp(t),We=!0,!1;var n=t.tag,l;if((l=n!==3&&n!==27)&&((l=n===5)&&(l=t.type,l=!(l!=="form"&&l!=="button")||th(t.type,t.memoizedProps)),l=!l),l&&wt&&aa(t),Mp(t),n===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(i(317));wt=rx(t)}else if(n===31){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(i(317));wt=rx(t)}else n===27?(n=wt,ba(t.type)?(t=ih,ih=null,wt=t):wt=n):wt=as?Ks(t.stateNode.nextSibling):null;return!0}function Ha(){wt=as=null,We=!1}function Iu(){var t=na;return t!==null&&(Ss===null?Ss=t:Ss.push.apply(Ss,t),na=null),t}function Bi(t){na===null?na=[t]:na.push(t)}var Bu=S(null),Ga=null,Dn=null;function ra(t,n,l){M(Bu,n._currentValue),n._currentValue=l}function On(t){t._currentValue=Bu.current,D(Bu)}function zu(t,n,l){for(;t!==null;){var c=t.alternate;if((t.childLanes&n)!==n?(t.childLanes|=n,c!==null&&(c.childLanes|=n)):c!==null&&(c.childLanes&n)!==n&&(c.childLanes|=n),t===l)break;t=t.return}}function Vu(t,n,l,c){var h=t.child;for(h!==null&&(h.return=t);h!==null;){var g=h.dependencies;if(g!==null){var w=h.child;g=g.firstContext;e:for(;g!==null;){var E=g;g=h;for(var P=0;P<n.length;P++)if(E.context===n[P]){g.lanes|=l,E=g.alternate,E!==null&&(E.lanes|=l),zu(g.return,l,t),c||(w=null);break e}g=E.next}}else if(h.tag===18){if(w=h.return,w===null)throw Error(i(341));w.lanes|=l,g=w.alternate,g!==null&&(g.lanes|=l),zu(w,l,t),w=null}else w=h.child;if(w!==null)w.return=h;else for(w=h;w!==null;){if(w===t){w=null;break}if(h=w.sibling,h!==null){h.return=w.return,w=h;break}w=w.return}h=w}}function Ur(t,n,l,c){t=null;for(var h=n,g=!1;h!==null;){if(!g){if((h.flags&524288)!==0)g=!0;else if((h.flags&262144)!==0)break}if(h.tag===10){var w=h.alternate;if(w===null)throw Error(i(387));if(w=w.memoizedProps,w!==null){var E=h.type;Es(h.pendingProps.value,w.value)||(t!==null?t.push(E):t=[E])}}else if(h===xe.current){if(w=h.alternate,w===null)throw Error(i(387));w.memoizedState.memoizedState!==h.memoizedState.memoizedState&&(t!==null?t.push(hl):t=[hl])}h=h.return}t!==null&&Vu(n,t,l,c),n.flags|=262144}function yo(t){for(t=t.firstContext;t!==null;){if(!Es(t.context._currentValue,t.memoizedValue))return!0;t=t.next}return!1}function Fa(t){Ga=t,Dn=null,t=t.dependencies,t!==null&&(t.firstContext=null)}function rs(t){return Up(Ga,t)}function vo(t,n){return Ga===null&&Fa(t),Up(t,n)}function Up(t,n){var l=n._currentValue;if(n={context:n,memoizedValue:l,next:null},Dn===null){if(t===null)throw Error(i(308));Dn=n,t.dependencies={lanes:0,firstContext:n},t.flags|=524288}else Dn=Dn.next=n;return l}var M1=typeof AbortController<"u"?AbortController:function(){var t=[],n=this.signal={aborted:!1,addEventListener:function(l,c){t.push(c)}};this.abort=function(){n.aborted=!0,t.forEach(function(l){return l()})}},U1=s.unstable_scheduleCallback,L1=s.unstable_NormalPriority,It={$$typeof:C,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function $u(){return{controller:new M1,data:new Map,refCount:0}}function zi(t){t.refCount--,t.refCount===0&&U1(L1,function(){t.controller.abort()})}var Vi=null,qu=0,Lr=0,Pr=null;function P1(t,n){if(Vi===null){var l=Vi=[];qu=0,Lr=Fd(),Pr={status:"pending",value:void 0,then:function(c){l.push(c)}}}return qu++,n.then(Lp,Lp),n}function Lp(){if(--qu===0&&Vi!==null){Pr!==null&&(Pr.status="fulfilled");var t=Vi;Vi=null,Lr=0,Pr=null;for(var n=0;n<t.length;n++)(0,t[n])()}}function I1(t,n){var l=[],c={status:"pending",value:null,reason:null,then:function(h){l.push(h)}};return t.then(function(){c.status="fulfilled",c.value=n;for(var h=0;h<l.length;h++)(0,l[h])(n)},function(h){for(c.status="rejected",c.reason=h,h=0;h<l.length;h++)(0,l[h])(void 0)}),c}var Pp=J.S;J.S=function(t,n){v0=Jt(),typeof n=="object"&&n!==null&&typeof n.then=="function"&&P1(t,n),Pp!==null&&Pp(t,n)};var Ka=S(null);function Hu(){var t=Ka.current;return t!==null?t:pt.pooledCache}function wo(t,n){n===null?M(Ka,Ka.current):M(Ka,n.pool)}function Ip(){var t=Hu();return t===null?null:{parent:It._currentValue,pool:t}}var Ir=Error(i(460)),Gu=Error(i(474)),jo=Error(i(542)),No={then:function(){}};function Bp(t){return t=t.status,t==="fulfilled"||t==="rejected"}function zp(t,n,l){switch(l=t[l],l===void 0?t.push(n):l!==n&&(n.then(En,En),n=l),n.status){case"fulfilled":return n.value;case"rejected":throw t=n.reason,$p(t),t;default:if(typeof n.status=="string")n.then(En,En);else{if(t=pt,t!==null&&100<t.shellSuspendCounter)throw Error(i(482));t=n,t.status="pending",t.then(function(c){if(n.status==="pending"){var h=n;h.status="fulfilled",h.value=c}},function(c){if(n.status==="pending"){var h=n;h.status="rejected",h.reason=c}})}switch(n.status){case"fulfilled":return n.value;case"rejected":throw t=n.reason,$p(t),t}throw Xa=n,Ir}}function Ya(t){try{var n=t._init;return n(t._payload)}catch(l){throw l!==null&&typeof l=="object"&&typeof l.then=="function"?(Xa=l,Ir):l}}var Xa=null;function Vp(){if(Xa===null)throw Error(i(459));var t=Xa;return Xa=null,t}function $p(t){if(t===Ir||t===jo)throw Error(i(483))}var Br=null,$i=0;function So(t){var n=$i;return $i+=1,Br===null&&(Br=[]),zp(Br,t,n)}function qi(t,n){n=n.props.ref,t.ref=n!==void 0?n:null}function _o(t,n){throw n.$$typeof===y?Error(i(525)):(t=Object.prototype.toString.call(n),Error(i(31,t==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":t)))}function qp(t){function n(q,$){if(t){var Y=q.deletions;Y===null?(q.deletions=[$],q.flags|=16):Y.push($)}}function l(q,$){if(!t)return null;for(;$!==null;)n(q,$),$=$.sibling;return null}function c(q){for(var $=new Map;q!==null;)q.key!==null?$.set(q.key,q):$.set(q.index,q),q=q.sibling;return $}function h(q,$){return q=An(q,$),q.index=0,q.sibling=null,q}function g(q,$,Y){return q.index=Y,t?(Y=q.alternate,Y!==null?(Y=Y.index,Y<$?(q.flags|=67108866,$):Y):(q.flags|=67108866,$)):(q.flags|=1048576,$)}function w(q){return t&&q.alternate===null&&(q.flags|=67108866),q}function E(q,$,Y,ie){return $===null||$.tag!==6?($=Ou(Y,q.mode,ie),$.return=q,$):($=h($,Y),$.return=q,$)}function P(q,$,Y,ie){var De=Y.type;return De===k?ne(q,$,Y.props.children,ie,Y.key):$!==null&&($.elementType===De||typeof De=="object"&&De!==null&&De.$$typeof===H&&Ya(De)===$.type)?($=h($,Y.props),qi($,Y),$.return=q,$):($=xo(Y.type,Y.key,Y.props,null,q.mode,ie),qi($,Y),$.return=q,$)}function X(q,$,Y,ie){return $===null||$.tag!==4||$.stateNode.containerInfo!==Y.containerInfo||$.stateNode.implementation!==Y.implementation?($=Mu(Y,q.mode,ie),$.return=q,$):($=h($,Y.children||[]),$.return=q,$)}function ne(q,$,Y,ie,De){return $===null||$.tag!==7?($=qa(Y,q.mode,ie,De),$.return=q,$):($=h($,Y),$.return=q,$)}function oe(q,$,Y){if(typeof $=="string"&&$!==""||typeof $=="number"||typeof $=="bigint")return $=Ou(""+$,q.mode,Y),$.return=q,$;if(typeof $=="object"&&$!==null){switch($.$$typeof){case j:return Y=xo($.type,$.key,$.props,null,q.mode,Y),qi(Y,$),Y.return=q,Y;case N:return $=Mu($,q.mode,Y),$.return=q,$;case H:return $=Ya($),oe(q,$,Y)}if(ze($)||ye($))return $=qa($,q.mode,Y,null),$.return=q,$;if(typeof $.then=="function")return oe(q,So($),Y);if($.$$typeof===C)return oe(q,vo(q,$),Y);_o(q,$)}return null}function Q(q,$,Y,ie){var De=$!==null?$.key:null;if(typeof Y=="string"&&Y!==""||typeof Y=="number"||typeof Y=="bigint")return De!==null?null:E(q,$,""+Y,ie);if(typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case j:return Y.key===De?P(q,$,Y,ie):null;case N:return Y.key===De?X(q,$,Y,ie):null;case H:return Y=Ya(Y),Q(q,$,Y,ie)}if(ze(Y)||ye(Y))return De!==null?null:ne(q,$,Y,ie,null);if(typeof Y.then=="function")return Q(q,$,So(Y),ie);if(Y.$$typeof===C)return Q(q,$,vo(q,Y),ie);_o(q,Y)}return null}function ee(q,$,Y,ie,De){if(typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint")return q=q.get(Y)||null,E($,q,""+ie,De);if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case j:return q=q.get(ie.key===null?Y:ie.key)||null,P($,q,ie,De);case N:return q=q.get(ie.key===null?Y:ie.key)||null,X($,q,ie,De);case H:return ie=Ya(ie),ee(q,$,Y,ie,De)}if(ze(ie)||ye(ie))return q=q.get(Y)||null,ne($,q,ie,De,null);if(typeof ie.then=="function")return ee(q,$,Y,So(ie),De);if(ie.$$typeof===C)return ee(q,$,Y,vo($,ie),De);_o($,ie)}return null}function _e(q,$,Y,ie){for(var De=null,at=null,Te=$,Ge=$=0,Qe=null;Te!==null&&Ge<Y.length;Ge++){Te.index>Ge?(Qe=Te,Te=null):Qe=Te.sibling;var rt=Q(q,Te,Y[Ge],ie);if(rt===null){Te===null&&(Te=Qe);break}t&&Te&&rt.alternate===null&&n(q,Te),$=g(rt,$,Ge),at===null?De=rt:at.sibling=rt,at=rt,Te=Qe}if(Ge===Y.length)return l(q,Te),We&&Rn(q,Ge),De;if(Te===null){for(;Ge<Y.length;Ge++)Te=oe(q,Y[Ge],ie),Te!==null&&($=g(Te,$,Ge),at===null?De=Te:at.sibling=Te,at=Te);return We&&Rn(q,Ge),De}for(Te=c(Te);Ge<Y.length;Ge++)Qe=ee(Te,q,Ge,Y[Ge],ie),Qe!==null&&(t&&Qe.alternate!==null&&Te.delete(Qe.key===null?Ge:Qe.key),$=g(Qe,$,Ge),at===null?De=Qe:at.sibling=Qe,at=Qe);return t&&Te.forEach(function(Na){return n(q,Na)}),We&&Rn(q,Ge),De}function Ue(q,$,Y,ie){if(Y==null)throw Error(i(151));for(var De=null,at=null,Te=$,Ge=$=0,Qe=null,rt=Y.next();Te!==null&&!rt.done;Ge++,rt=Y.next()){Te.index>Ge?(Qe=Te,Te=null):Qe=Te.sibling;var Na=Q(q,Te,rt.value,ie);if(Na===null){Te===null&&(Te=Qe);break}t&&Te&&Na.alternate===null&&n(q,Te),$=g(Na,$,Ge),at===null?De=Na:at.sibling=Na,at=Na,Te=Qe}if(rt.done)return l(q,Te),We&&Rn(q,Ge),De;if(Te===null){for(;!rt.done;Ge++,rt=Y.next())rt=oe(q,rt.value,ie),rt!==null&&($=g(rt,$,Ge),at===null?De=rt:at.sibling=rt,at=rt);return We&&Rn(q,Ge),De}for(Te=c(Te);!rt.done;Ge++,rt=Y.next())rt=ee(Te,q,Ge,rt.value,ie),rt!==null&&(t&&rt.alternate!==null&&Te.delete(rt.key===null?Ge:rt.key),$=g(rt,$,Ge),at===null?De=rt:at.sibling=rt,at=rt);return t&&Te.forEach(function(XN){return n(q,XN)}),We&&Rn(q,Ge),De}function ft(q,$,Y,ie){if(typeof Y=="object"&&Y!==null&&Y.type===k&&Y.key===null&&(Y=Y.props.children),typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case j:e:{for(var De=Y.key;$!==null;){if($.key===De){if(De=Y.type,De===k){if($.tag===7){l(q,$.sibling),ie=h($,Y.props.children),ie.return=q,q=ie;break e}}else if($.elementType===De||typeof De=="object"&&De!==null&&De.$$typeof===H&&Ya(De)===$.type){l(q,$.sibling),ie=h($,Y.props),qi(ie,Y),ie.return=q,q=ie;break e}l(q,$);break}else n(q,$);$=$.sibling}Y.type===k?(ie=qa(Y.props.children,q.mode,ie,Y.key),ie.return=q,q=ie):(ie=xo(Y.type,Y.key,Y.props,null,q.mode,ie),qi(ie,Y),ie.return=q,q=ie)}return w(q);case N:e:{for(De=Y.key;$!==null;){if($.key===De)if($.tag===4&&$.stateNode.containerInfo===Y.containerInfo&&$.stateNode.implementation===Y.implementation){l(q,$.sibling),ie=h($,Y.children||[]),ie.return=q,q=ie;break e}else{l(q,$);break}else n(q,$);$=$.sibling}ie=Mu(Y,q.mode,ie),ie.return=q,q=ie}return w(q);case H:return Y=Ya(Y),ft(q,$,Y,ie)}if(ze(Y))return _e(q,$,Y,ie);if(ye(Y)){if(De=ye(Y),typeof De!="function")throw Error(i(150));return Y=De.call(Y),Ue(q,$,Y,ie)}if(typeof Y.then=="function")return ft(q,$,So(Y),ie);if(Y.$$typeof===C)return ft(q,$,vo(q,Y),ie);_o(q,Y)}return typeof Y=="string"&&Y!==""||typeof Y=="number"||typeof Y=="bigint"?(Y=""+Y,$!==null&&$.tag===6?(l(q,$.sibling),ie=h($,Y),ie.return=q,q=ie):(l(q,$),ie=Ou(Y,q.mode,ie),ie.return=q,q=ie),w(q)):l(q,$)}return function(q,$,Y,ie){try{$i=0;var De=ft(q,$,Y,ie);return Br=null,De}catch(Te){if(Te===Ir||Te===jo)throw Te;var at=Cs(29,Te,null,q.mode);return at.lanes=ie,at.return=q,at}}}var Ja=qp(!0),Hp=qp(!1),ia=!1;function Fu(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Ku(t,n){t=t.updateQueue,n.updateQueue===t&&(n.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,callbacks:null})}function la(t){return{lane:t,tag:0,payload:null,callback:null,next:null}}function oa(t,n,l){var c=t.updateQueue;if(c===null)return null;if(c=c.shared,(lt&2)!==0){var h=c.pending;return h===null?n.next=n:(n.next=h.next,h.next=n),c.pending=n,n=go(t),Tp(t,null,l),n}return po(t,c,n,l),go(t)}function Hi(t,n,l){if(n=n.updateQueue,n!==null&&(n=n.shared,(l&4194048)!==0)){var c=n.lanes;c&=t.pendingLanes,l|=c,n.lanes=l,Gt(t,l)}}function Yu(t,n){var l=t.updateQueue,c=t.alternate;if(c!==null&&(c=c.updateQueue,l===c)){var h=null,g=null;if(l=l.firstBaseUpdate,l!==null){do{var w={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};g===null?h=g=w:g=g.next=w,l=l.next}while(l!==null);g===null?h=g=n:g=g.next=n}else h=g=n;l={baseState:c.baseState,firstBaseUpdate:h,lastBaseUpdate:g,shared:c.shared,callbacks:c.callbacks},t.updateQueue=l;return}t=l.lastBaseUpdate,t===null?l.firstBaseUpdate=n:t.next=n,l.lastBaseUpdate=n}var Xu=!1;function Gi(){if(Xu){var t=Pr;if(t!==null)throw t}}function Fi(t,n,l,c){Xu=!1;var h=t.updateQueue;ia=!1;var g=h.firstBaseUpdate,w=h.lastBaseUpdate,E=h.shared.pending;if(E!==null){h.shared.pending=null;var P=E,X=P.next;P.next=null,w===null?g=X:w.next=X,w=P;var ne=t.alternate;ne!==null&&(ne=ne.updateQueue,E=ne.lastBaseUpdate,E!==w&&(E===null?ne.firstBaseUpdate=X:E.next=X,ne.lastBaseUpdate=P))}if(g!==null){var oe=h.baseState;w=0,ne=X=P=null,E=g;do{var Q=E.lane&-536870913,ee=Q!==E.lane;if(ee?(Je&Q)===Q:(c&Q)===Q){Q!==0&&Q===Lr&&(Xu=!0),ne!==null&&(ne=ne.next={lane:0,tag:E.tag,payload:E.payload,callback:null,next:null});e:{var _e=t,Ue=E;Q=n;var ft=l;switch(Ue.tag){case 1:if(_e=Ue.payload,typeof _e=="function"){oe=_e.call(ft,oe,Q);break e}oe=_e;break e;case 3:_e.flags=_e.flags&-65537|128;case 0:if(_e=Ue.payload,Q=typeof _e=="function"?_e.call(ft,oe,Q):_e,Q==null)break e;oe=b({},oe,Q);break e;case 2:ia=!0}}Q=E.callback,Q!==null&&(t.flags|=64,ee&&(t.flags|=8192),ee=h.callbacks,ee===null?h.callbacks=[Q]:ee.push(Q))}else ee={lane:Q,tag:E.tag,payload:E.payload,callback:E.callback,next:null},ne===null?(X=ne=ee,P=oe):ne=ne.next=ee,w|=Q;if(E=E.next,E===null){if(E=h.shared.pending,E===null)break;ee=E,E=ee.next,ee.next=null,h.lastBaseUpdate=ee,h.shared.pending=null}}while(!0);ne===null&&(P=oe),h.baseState=P,h.firstBaseUpdate=X,h.lastBaseUpdate=ne,g===null&&(h.shared.lanes=0),fa|=w,t.lanes=w,t.memoizedState=oe}}function Gp(t,n){if(typeof t!="function")throw Error(i(191,t));t.call(n)}function Fp(t,n){var l=t.callbacks;if(l!==null)for(t.callbacks=null,t=0;t<l.length;t++)Gp(l[t],n)}var zr=S(null),ko=S(0);function Kp(t,n){t=$n,M(ko,t),M(zr,n),$n=t|n.baseLanes}function Ju(){M(ko,$n),M(zr,zr.current)}function Qu(){$n=ko.current,D(zr),D(ko)}var As=S(null),Fs=null;function ca(t){var n=t.alternate;M(Ut,Ut.current&1),M(As,t),Fs===null&&(n===null||zr.current!==null||n.memoizedState!==null)&&(Fs=t)}function Zu(t){M(Ut,Ut.current),M(As,t),Fs===null&&(Fs=t)}function Yp(t){t.tag===22?(M(Ut,Ut.current),M(As,t),Fs===null&&(Fs=t)):ua()}function ua(){M(Ut,Ut.current),M(As,As.current)}function Rs(t){D(As),Fs===t&&(Fs=null),D(Ut)}var Ut=S(0);function To(t){for(var n=t;n!==null;){if(n.tag===13){var l=n.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||ah(l)||rh(l)))return n}else if(n.tag===19&&(n.memoizedProps.revealOrder==="forwards"||n.memoizedProps.revealOrder==="backwards"||n.memoizedProps.revealOrder==="unstable_legacy-backwards"||n.memoizedProps.revealOrder==="together")){if((n.flags&128)!==0)return n}else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return null;n=n.return}n.sibling.return=n.return,n=n.sibling}return null}var Mn=0,He=null,dt=null,Bt=null,Eo=!1,Vr=!1,Qa=!1,Co=0,Ki=0,$r=null,B1=0;function At(){throw Error(i(321))}function Wu(t,n){if(n===null)return!1;for(var l=0;l<n.length&&l<t.length;l++)if(!Es(t[l],n[l]))return!1;return!0}function ed(t,n,l,c,h,g){return Mn=g,He=n,n.memoizedState=null,n.updateQueue=null,n.lanes=0,J.H=t===null||t.memoizedState===null?Rg:pd,Qa=!1,g=l(c,h),Qa=!1,Vr&&(g=Jp(n,l,c,h)),Xp(t),g}function Xp(t){J.H=Ji;var n=dt!==null&&dt.next!==null;if(Mn=0,Bt=dt=He=null,Eo=!1,Ki=0,$r=null,n)throw Error(i(300));t===null||zt||(t=t.dependencies,t!==null&&yo(t)&&(zt=!0))}function Jp(t,n,l,c){He=t;var h=0;do{if(Vr&&($r=null),Ki=0,Vr=!1,25<=h)throw Error(i(301));if(h+=1,Bt=dt=null,t.updateQueue!=null){var g=t.updateQueue;g.lastEffect=null,g.events=null,g.stores=null,g.memoCache!=null&&(g.memoCache.index=0)}J.H=Dg,g=n(l,c)}while(Vr);return g}function z1(){var t=J.H,n=t.useState()[0];return n=typeof n.then=="function"?Yi(n):n,t=t.useState()[0],(dt!==null?dt.memoizedState:null)!==t&&(He.flags|=1024),n}function td(){var t=Co!==0;return Co=0,t}function sd(t,n,l){n.updateQueue=t.updateQueue,n.flags&=-2053,t.lanes&=~l}function nd(t){if(Eo){for(t=t.memoizedState;t!==null;){var n=t.queue;n!==null&&(n.pending=null),t=t.next}Eo=!1}Mn=0,Bt=dt=He=null,Vr=!1,Ki=Co=0,$r=null}function ps(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Bt===null?He.memoizedState=Bt=t:Bt=Bt.next=t,Bt}function Lt(){if(dt===null){var t=He.alternate;t=t!==null?t.memoizedState:null}else t=dt.next;var n=Bt===null?He.memoizedState:Bt.next;if(n!==null)Bt=n,dt=t;else{if(t===null)throw He.alternate===null?Error(i(467)):Error(i(310));dt=t,t={memoizedState:dt.memoizedState,baseState:dt.baseState,baseQueue:dt.baseQueue,queue:dt.queue,next:null},Bt===null?He.memoizedState=Bt=t:Bt=Bt.next=t}return Bt}function Ao(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Yi(t){var n=Ki;return Ki+=1,$r===null&&($r=[]),t=zp($r,t,n),n=He,(Bt===null?n.memoizedState:Bt.next)===null&&(n=n.alternate,J.H=n===null||n.memoizedState===null?Rg:pd),t}function Ro(t){if(t!==null&&typeof t=="object"){if(typeof t.then=="function")return Yi(t);if(t.$$typeof===C)return rs(t)}throw Error(i(438,String(t)))}function ad(t){var n=null,l=He.updateQueue;if(l!==null&&(n=l.memoCache),n==null){var c=He.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(n={data:c.data.map(function(h){return h.slice()}),index:0})))}if(n==null&&(n={data:[],index:0}),l===null&&(l=Ao(),He.updateQueue=l),l.memoCache=n,l=n.data[n.index],l===void 0)for(l=n.data[n.index]=Array(t),c=0;c<t;c++)l[c]=me;return n.index++,l}function Un(t,n){return typeof n=="function"?n(t):n}function Do(t){var n=Lt();return rd(n,dt,t)}function rd(t,n,l){var c=t.queue;if(c===null)throw Error(i(311));c.lastRenderedReducer=l;var h=t.baseQueue,g=c.pending;if(g!==null){if(h!==null){var w=h.next;h.next=g.next,g.next=w}n.baseQueue=h=g,c.pending=null}if(g=t.baseState,h===null)t.memoizedState=g;else{n=h.next;var E=w=null,P=null,X=n,ne=!1;do{var oe=X.lane&-536870913;if(oe!==X.lane?(Je&oe)===oe:(Mn&oe)===oe){var Q=X.revertLane;if(Q===0)P!==null&&(P=P.next={lane:0,revertLane:0,gesture:null,action:X.action,hasEagerState:X.hasEagerState,eagerState:X.eagerState,next:null}),oe===Lr&&(ne=!0);else if((Mn&Q)===Q){X=X.next,Q===Lr&&(ne=!0);continue}else oe={lane:0,revertLane:X.revertLane,gesture:null,action:X.action,hasEagerState:X.hasEagerState,eagerState:X.eagerState,next:null},P===null?(E=P=oe,w=g):P=P.next=oe,He.lanes|=Q,fa|=Q;oe=X.action,Qa&&l(g,oe),g=X.hasEagerState?X.eagerState:l(g,oe)}else Q={lane:oe,revertLane:X.revertLane,gesture:X.gesture,action:X.action,hasEagerState:X.hasEagerState,eagerState:X.eagerState,next:null},P===null?(E=P=Q,w=g):P=P.next=Q,He.lanes|=oe,fa|=oe;X=X.next}while(X!==null&&X!==n);if(P===null?w=g:P.next=E,!Es(g,t.memoizedState)&&(zt=!0,ne&&(l=Pr,l!==null)))throw l;t.memoizedState=g,t.baseState=w,t.baseQueue=P,c.lastRenderedState=g}return h===null&&(c.lanes=0),[t.memoizedState,c.dispatch]}function id(t){var n=Lt(),l=n.queue;if(l===null)throw Error(i(311));l.lastRenderedReducer=t;var c=l.dispatch,h=l.pending,g=n.memoizedState;if(h!==null){l.pending=null;var w=h=h.next;do g=t(g,w.action),w=w.next;while(w!==h);Es(g,n.memoizedState)||(zt=!0),n.memoizedState=g,n.baseQueue===null&&(n.baseState=g),l.lastRenderedState=g}return[g,c]}function Qp(t,n,l){var c=He,h=Lt(),g=We;if(g){if(l===void 0)throw Error(i(407));l=l()}else l=n();var w=!Es((dt||h).memoizedState,l);if(w&&(h.memoizedState=l,zt=!0),h=h.queue,cd(eg.bind(null,c,h,t),[t]),h.getSnapshot!==n||w||Bt!==null&&Bt.memoizedState.tag&1){if(c.flags|=2048,qr(9,{destroy:void 0},Wp.bind(null,c,h,l,n),null),pt===null)throw Error(i(349));g||(Mn&127)!==0||Zp(c,n,l)}return l}function Zp(t,n,l){t.flags|=16384,t={getSnapshot:n,value:l},n=He.updateQueue,n===null?(n=Ao(),He.updateQueue=n,n.stores=[t]):(l=n.stores,l===null?n.stores=[t]:l.push(t))}function Wp(t,n,l,c){n.value=l,n.getSnapshot=c,tg(n)&&sg(t)}function eg(t,n,l){return l(function(){tg(n)&&sg(t)})}function tg(t){var n=t.getSnapshot;t=t.value;try{var l=n();return!Es(t,l)}catch{return!0}}function sg(t){var n=$a(t,2);n!==null&&_s(n,t,2)}function ld(t){var n=ps();if(typeof t=="function"){var l=t;if(t=l(),Qa){Ts(!0);try{l()}finally{Ts(!1)}}}return n.memoizedState=n.baseState=t,n.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Un,lastRenderedState:t},n}function ng(t,n,l,c){return t.baseState=l,rd(t,dt,typeof c=="function"?c:Un)}function V1(t,n,l,c,h){if(Uo(t))throw Error(i(485));if(t=n.action,t!==null){var g={payload:h,action:t,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(w){g.listeners.push(w)}};J.T!==null?l(!0):g.isTransition=!1,c(g),l=n.pending,l===null?(g.next=n.pending=g,ag(n,g)):(g.next=l.next,n.pending=l.next=g)}}function ag(t,n){var l=n.action,c=n.payload,h=t.state;if(n.isTransition){var g=J.T,w={};J.T=w;try{var E=l(h,c),P=J.S;P!==null&&P(w,E),rg(t,n,E)}catch(X){od(t,n,X)}finally{g!==null&&w.types!==null&&(g.types=w.types),J.T=g}}else try{g=l(h,c),rg(t,n,g)}catch(X){od(t,n,X)}}function rg(t,n,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(c){ig(t,n,c)},function(c){return od(t,n,c)}):ig(t,n,l)}function ig(t,n,l){n.status="fulfilled",n.value=l,lg(n),t.state=l,n=t.pending,n!==null&&(l=n.next,l===n?t.pending=null:(l=l.next,n.next=l,ag(t,l)))}function od(t,n,l){var c=t.pending;if(t.pending=null,c!==null){c=c.next;do n.status="rejected",n.reason=l,lg(n),n=n.next;while(n!==c)}t.action=null}function lg(t){t=t.listeners;for(var n=0;n<t.length;n++)(0,t[n])()}function og(t,n){return n}function cg(t,n){if(We){var l=pt.formState;if(l!==null){e:{var c=He;if(We){if(wt){t:{for(var h=wt,g=Gs;h.nodeType!==8;){if(!g){h=null;break t}if(h=Ks(h.nextSibling),h===null){h=null;break t}}g=h.data,h=g==="F!"||g==="F"?h:null}if(h){wt=Ks(h.nextSibling),c=h.data==="F!";break e}}aa(c)}c=!1}c&&(n=l[0])}}return l=ps(),l.memoizedState=l.baseState=n,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:og,lastRenderedState:n},l.queue=c,l=Eg.bind(null,He,c),c.dispatch=l,c=ld(!1),g=md.bind(null,He,!1,c.queue),c=ps(),h={state:n,dispatch:null,action:t,pending:null},c.queue=h,l=V1.bind(null,He,h,g,l),h.dispatch=l,c.memoizedState=t,[n,l,!1]}function ug(t){var n=Lt();return dg(n,dt,t)}function dg(t,n,l){if(n=rd(t,n,og)[0],t=Do(Un)[0],typeof n=="object"&&n!==null&&typeof n.then=="function")try{var c=Yi(n)}catch(w){throw w===Ir?jo:w}else c=n;n=Lt();var h=n.queue,g=h.dispatch;return l!==n.memoizedState&&(He.flags|=2048,qr(9,{destroy:void 0},$1.bind(null,h,l),null)),[c,g,t]}function $1(t,n){t.action=n}function hg(t){var n=Lt(),l=dt;if(l!==null)return dg(n,l,t);Lt(),n=n.memoizedState,l=Lt();var c=l.queue.dispatch;return l.memoizedState=t,[n,c,!1]}function qr(t,n,l,c){return t={tag:t,create:l,deps:c,inst:n,next:null},n=He.updateQueue,n===null&&(n=Ao(),He.updateQueue=n),l=n.lastEffect,l===null?n.lastEffect=t.next=t:(c=l.next,l.next=t,t.next=c,n.lastEffect=t),t}function fg(){return Lt().memoizedState}function Oo(t,n,l,c){var h=ps();He.flags|=t,h.memoizedState=qr(1|n,{destroy:void 0},l,c===void 0?null:c)}function Mo(t,n,l,c){var h=Lt();c=c===void 0?null:c;var g=h.memoizedState.inst;dt!==null&&c!==null&&Wu(c,dt.memoizedState.deps)?h.memoizedState=qr(n,g,l,c):(He.flags|=t,h.memoizedState=qr(1|n,g,l,c))}function mg(t,n){Oo(8390656,8,t,n)}function cd(t,n){Mo(2048,8,t,n)}function q1(t){He.flags|=4;var n=He.updateQueue;if(n===null)n=Ao(),He.updateQueue=n,n.events=[t];else{var l=n.events;l===null?n.events=[t]:l.push(t)}}function pg(t){var n=Lt().memoizedState;return q1({ref:n,nextImpl:t}),function(){if((lt&2)!==0)throw Error(i(440));return n.impl.apply(void 0,arguments)}}function gg(t,n){return Mo(4,2,t,n)}function xg(t,n){return Mo(4,4,t,n)}function bg(t,n){if(typeof n=="function"){t=t();var l=n(t);return function(){typeof l=="function"?l():n(null)}}if(n!=null)return t=t(),n.current=t,function(){n.current=null}}function yg(t,n,l){l=l!=null?l.concat([t]):null,Mo(4,4,bg.bind(null,n,t),l)}function ud(){}function vg(t,n){var l=Lt();n=n===void 0?null:n;var c=l.memoizedState;return n!==null&&Wu(n,c[1])?c[0]:(l.memoizedState=[t,n],t)}function wg(t,n){var l=Lt();n=n===void 0?null:n;var c=l.memoizedState;if(n!==null&&Wu(n,c[1]))return c[0];if(c=t(),Qa){Ts(!0);try{t()}finally{Ts(!1)}}return l.memoizedState=[c,n],c}function dd(t,n,l){return l===void 0||(Mn&1073741824)!==0&&(Je&261930)===0?t.memoizedState=n:(t.memoizedState=l,t=j0(),He.lanes|=t,fa|=t,l)}function jg(t,n,l,c){return Es(l,n)?l:zr.current!==null?(t=dd(t,l,c),Es(t,n)||(zt=!0),t):(Mn&42)===0||(Mn&1073741824)!==0&&(Je&261930)===0?(zt=!0,t.memoizedState=l):(t=j0(),He.lanes|=t,fa|=t,n)}function Ng(t,n,l,c,h){var g=se.p;se.p=g!==0&&8>g?g:8;var w=J.T,E={};J.T=E,md(t,!1,n,l);try{var P=h(),X=J.S;if(X!==null&&X(E,P),P!==null&&typeof P=="object"&&typeof P.then=="function"){var ne=I1(P,c);Xi(t,n,ne,Ms(t))}else Xi(t,n,c,Ms(t))}catch(oe){Xi(t,n,{then:function(){},status:"rejected",reason:oe},Ms())}finally{se.p=g,w!==null&&E.types!==null&&(w.types=E.types),J.T=w}}function H1(){}function hd(t,n,l,c){if(t.tag!==5)throw Error(i(476));var h=Sg(t).queue;Ng(t,h,n,he,l===null?H1:function(){return _g(t),l(c)})}function Sg(t){var n=t.memoizedState;if(n!==null)return n;n={memoizedState:he,baseState:he,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Un,lastRenderedState:he},next:null};var l={};return n.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Un,lastRenderedState:l},next:null},t.memoizedState=n,t=t.alternate,t!==null&&(t.memoizedState=n),n}function _g(t){var n=Sg(t);n.next===null&&(n=t.alternate.memoizedState),Xi(t,n.next.queue,{},Ms())}function fd(){return rs(hl)}function kg(){return Lt().memoizedState}function Tg(){return Lt().memoizedState}function G1(t){for(var n=t.return;n!==null;){switch(n.tag){case 24:case 3:var l=Ms();t=la(l);var c=oa(n,t,l);c!==null&&(_s(c,n,l),Hi(c,n,l)),n={cache:$u()},t.payload=n;return}n=n.return}}function F1(t,n,l){var c=Ms();l={lane:c,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null},Uo(t)?Cg(n,l):(l=Ru(t,n,l,c),l!==null&&(_s(l,t,c),Ag(l,n,c)))}function Eg(t,n,l){var c=Ms();Xi(t,n,l,c)}function Xi(t,n,l,c){var h={lane:c,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null};if(Uo(t))Cg(n,h);else{var g=t.alternate;if(t.lanes===0&&(g===null||g.lanes===0)&&(g=n.lastRenderedReducer,g!==null))try{var w=n.lastRenderedState,E=g(w,l);if(h.hasEagerState=!0,h.eagerState=E,Es(E,w))return po(t,n,h,0),pt===null&&mo(),!1}catch{}if(l=Ru(t,n,h,c),l!==null)return _s(l,t,c),Ag(l,n,c),!0}return!1}function md(t,n,l,c){if(c={lane:2,revertLane:Fd(),gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},Uo(t)){if(n)throw Error(i(479))}else n=Ru(t,l,c,2),n!==null&&_s(n,t,2)}function Uo(t){var n=t.alternate;return t===He||n!==null&&n===He}function Cg(t,n){Vr=Eo=!0;var l=t.pending;l===null?n.next=n:(n.next=l.next,l.next=n),t.pending=n}function Ag(t,n,l){if((l&4194048)!==0){var c=n.lanes;c&=t.pendingLanes,l|=c,n.lanes=l,Gt(t,l)}}var Ji={readContext:rs,use:Ro,useCallback:At,useContext:At,useEffect:At,useImperativeHandle:At,useLayoutEffect:At,useInsertionEffect:At,useMemo:At,useReducer:At,useRef:At,useState:At,useDebugValue:At,useDeferredValue:At,useTransition:At,useSyncExternalStore:At,useId:At,useHostTransitionStatus:At,useFormState:At,useActionState:At,useOptimistic:At,useMemoCache:At,useCacheRefresh:At};Ji.useEffectEvent=At;var Rg={readContext:rs,use:Ro,useCallback:function(t,n){return ps().memoizedState=[t,n===void 0?null:n],t},useContext:rs,useEffect:mg,useImperativeHandle:function(t,n,l){l=l!=null?l.concat([t]):null,Oo(4194308,4,bg.bind(null,n,t),l)},useLayoutEffect:function(t,n){return Oo(4194308,4,t,n)},useInsertionEffect:function(t,n){Oo(4,2,t,n)},useMemo:function(t,n){var l=ps();n=n===void 0?null:n;var c=t();if(Qa){Ts(!0);try{t()}finally{Ts(!1)}}return l.memoizedState=[c,n],c},useReducer:function(t,n,l){var c=ps();if(l!==void 0){var h=l(n);if(Qa){Ts(!0);try{l(n)}finally{Ts(!1)}}}else h=n;return c.memoizedState=c.baseState=h,t={pending:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:h},c.queue=t,t=t.dispatch=F1.bind(null,He,t),[c.memoizedState,t]},useRef:function(t){var n=ps();return t={current:t},n.memoizedState=t},useState:function(t){t=ld(t);var n=t.queue,l=Eg.bind(null,He,n);return n.dispatch=l,[t.memoizedState,l]},useDebugValue:ud,useDeferredValue:function(t,n){var l=ps();return dd(l,t,n)},useTransition:function(){var t=ld(!1);return t=Ng.bind(null,He,t.queue,!0,!1),ps().memoizedState=t,[!1,t]},useSyncExternalStore:function(t,n,l){var c=He,h=ps();if(We){if(l===void 0)throw Error(i(407));l=l()}else{if(l=n(),pt===null)throw Error(i(349));(Je&127)!==0||Zp(c,n,l)}h.memoizedState=l;var g={value:l,getSnapshot:n};return h.queue=g,mg(eg.bind(null,c,g,t),[t]),c.flags|=2048,qr(9,{destroy:void 0},Wp.bind(null,c,g,l,n),null),l},useId:function(){var t=ps(),n=pt.identifierPrefix;if(We){var l=bn,c=xn;l=(c&~(1<<32-Ht(c)-1)).toString(32)+l,n="_"+n+"R_"+l,l=Co++,0<l&&(n+="H"+l.toString(32)),n+="_"}else l=B1++,n="_"+n+"r_"+l.toString(32)+"_";return t.memoizedState=n},useHostTransitionStatus:fd,useFormState:cg,useActionState:cg,useOptimistic:function(t){var n=ps();n.memoizedState=n.baseState=t;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return n.queue=l,n=md.bind(null,He,!0,l),l.dispatch=n,[t,n]},useMemoCache:ad,useCacheRefresh:function(){return ps().memoizedState=G1.bind(null,He)},useEffectEvent:function(t){var n=ps(),l={impl:t};return n.memoizedState=l,function(){if((lt&2)!==0)throw Error(i(440));return l.impl.apply(void 0,arguments)}}},pd={readContext:rs,use:Ro,useCallback:vg,useContext:rs,useEffect:cd,useImperativeHandle:yg,useInsertionEffect:gg,useLayoutEffect:xg,useMemo:wg,useReducer:Do,useRef:fg,useState:function(){return Do(Un)},useDebugValue:ud,useDeferredValue:function(t,n){var l=Lt();return jg(l,dt.memoizedState,t,n)},useTransition:function(){var t=Do(Un)[0],n=Lt().memoizedState;return[typeof t=="boolean"?t:Yi(t),n]},useSyncExternalStore:Qp,useId:kg,useHostTransitionStatus:fd,useFormState:ug,useActionState:ug,useOptimistic:function(t,n){var l=Lt();return ng(l,dt,t,n)},useMemoCache:ad,useCacheRefresh:Tg};pd.useEffectEvent=pg;var Dg={readContext:rs,use:Ro,useCallback:vg,useContext:rs,useEffect:cd,useImperativeHandle:yg,useInsertionEffect:gg,useLayoutEffect:xg,useMemo:wg,useReducer:id,useRef:fg,useState:function(){return id(Un)},useDebugValue:ud,useDeferredValue:function(t,n){var l=Lt();return dt===null?dd(l,t,n):jg(l,dt.memoizedState,t,n)},useTransition:function(){var t=id(Un)[0],n=Lt().memoizedState;return[typeof t=="boolean"?t:Yi(t),n]},useSyncExternalStore:Qp,useId:kg,useHostTransitionStatus:fd,useFormState:hg,useActionState:hg,useOptimistic:function(t,n){var l=Lt();return dt!==null?ng(l,dt,t,n):(l.baseState=t,[t,l.queue.dispatch])},useMemoCache:ad,useCacheRefresh:Tg};Dg.useEffectEvent=pg;function gd(t,n,l,c){n=t.memoizedState,l=l(c,n),l=l==null?n:b({},n,l),t.memoizedState=l,t.lanes===0&&(t.updateQueue.baseState=l)}var xd={enqueueSetState:function(t,n,l){t=t._reactInternals;var c=Ms(),h=la(c);h.payload=n,l!=null&&(h.callback=l),n=oa(t,h,c),n!==null&&(_s(n,t,c),Hi(n,t,c))},enqueueReplaceState:function(t,n,l){t=t._reactInternals;var c=Ms(),h=la(c);h.tag=1,h.payload=n,l!=null&&(h.callback=l),n=oa(t,h,c),n!==null&&(_s(n,t,c),Hi(n,t,c))},enqueueForceUpdate:function(t,n){t=t._reactInternals;var l=Ms(),c=la(l);c.tag=2,n!=null&&(c.callback=n),n=oa(t,c,l),n!==null&&(_s(n,t,l),Hi(n,t,l))}};function Og(t,n,l,c,h,g,w){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(c,g,w):n.prototype&&n.prototype.isPureReactComponent?!Li(l,c)||!Li(h,g):!0}function Mg(t,n,l,c){t=n.state,typeof n.componentWillReceiveProps=="function"&&n.componentWillReceiveProps(l,c),typeof n.UNSAFE_componentWillReceiveProps=="function"&&n.UNSAFE_componentWillReceiveProps(l,c),n.state!==t&&xd.enqueueReplaceState(n,n.state,null)}function Za(t,n){var l=n;if("ref"in n){l={};for(var c in n)c!=="ref"&&(l[c]=n[c])}if(t=t.defaultProps){l===n&&(l=b({},l));for(var h in t)l[h]===void 0&&(l[h]=t[h])}return l}function Ug(t){fo(t)}function Lg(t){console.error(t)}function Pg(t){fo(t)}function Lo(t,n){try{var l=t.onUncaughtError;l(n.value,{componentStack:n.stack})}catch(c){setTimeout(function(){throw c})}}function Ig(t,n,l){try{var c=t.onCaughtError;c(l.value,{componentStack:l.stack,errorBoundary:n.tag===1?n.stateNode:null})}catch(h){setTimeout(function(){throw h})}}function bd(t,n,l){return l=la(l),l.tag=3,l.payload={element:null},l.callback=function(){Lo(t,n)},l}function Bg(t){return t=la(t),t.tag=3,t}function zg(t,n,l,c){var h=l.type.getDerivedStateFromError;if(typeof h=="function"){var g=c.value;t.payload=function(){return h(g)},t.callback=function(){Ig(n,l,c)}}var w=l.stateNode;w!==null&&typeof w.componentDidCatch=="function"&&(t.callback=function(){Ig(n,l,c),typeof h!="function"&&(ma===null?ma=new Set([this]):ma.add(this));var E=c.stack;this.componentDidCatch(c.value,{componentStack:E!==null?E:""})})}function K1(t,n,l,c,h){if(l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(n=l.alternate,n!==null&&Ur(n,l,h,!0),l=As.current,l!==null){switch(l.tag){case 31:case 13:return Fs===null?Yo():l.alternate===null&&Rt===0&&(Rt=3),l.flags&=-257,l.flags|=65536,l.lanes=h,c===No?l.flags|=16384:(n=l.updateQueue,n===null?l.updateQueue=new Set([c]):n.add(c),qd(t,c,h)),!1;case 22:return l.flags|=65536,c===No?l.flags|=16384:(n=l.updateQueue,n===null?(n={transitions:null,markerInstances:null,retryQueue:new Set([c])},l.updateQueue=n):(l=n.retryQueue,l===null?n.retryQueue=new Set([c]):l.add(c)),qd(t,c,h)),!1}throw Error(i(435,l.tag))}return qd(t,c,h),Yo(),!1}if(We)return n=As.current,n!==null?((n.flags&65536)===0&&(n.flags|=256),n.flags|=65536,n.lanes=h,c!==Pu&&(t=Error(i(422),{cause:c}),Bi($s(t,l)))):(c!==Pu&&(n=Error(i(423),{cause:c}),Bi($s(n,l))),t=t.current.alternate,t.flags|=65536,h&=-h,t.lanes|=h,c=$s(c,l),h=bd(t.stateNode,c,h),Yu(t,h),Rt!==4&&(Rt=2)),!1;var g=Error(i(520),{cause:c});if(g=$s(g,l),al===null?al=[g]:al.push(g),Rt!==4&&(Rt=2),n===null)return!0;c=$s(c,l),l=n;do{switch(l.tag){case 3:return l.flags|=65536,t=h&-h,l.lanes|=t,t=bd(l.stateNode,c,t),Yu(l,t),!1;case 1:if(n=l.type,g=l.stateNode,(l.flags&128)===0&&(typeof n.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(ma===null||!ma.has(g))))return l.flags|=65536,h&=-h,l.lanes|=h,h=Bg(h),zg(h,t,l,c),Yu(l,h),!1}l=l.return}while(l!==null);return!1}var yd=Error(i(461)),zt=!1;function is(t,n,l,c){n.child=t===null?Hp(n,null,l,c):Ja(n,t.child,l,c)}function Vg(t,n,l,c,h){l=l.render;var g=n.ref;if("ref"in c){var w={};for(var E in c)E!=="ref"&&(w[E]=c[E])}else w=c;return Fa(n),c=ed(t,n,l,w,g,h),E=td(),t!==null&&!zt?(sd(t,n,h),Ln(t,n,h)):(We&&E&&Uu(n),n.flags|=1,is(t,n,c,h),n.child)}function $g(t,n,l,c,h){if(t===null){var g=l.type;return typeof g=="function"&&!Du(g)&&g.defaultProps===void 0&&l.compare===null?(n.tag=15,n.type=g,qg(t,n,g,c,h)):(t=xo(l.type,null,c,n,n.mode,h),t.ref=n.ref,t.return=n,n.child=t)}if(g=t.child,!Td(t,h)){var w=g.memoizedProps;if(l=l.compare,l=l!==null?l:Li,l(w,c)&&t.ref===n.ref)return Ln(t,n,h)}return n.flags|=1,t=An(g,c),t.ref=n.ref,t.return=n,n.child=t}function qg(t,n,l,c,h){if(t!==null){var g=t.memoizedProps;if(Li(g,c)&&t.ref===n.ref)if(zt=!1,n.pendingProps=c=g,Td(t,h))(t.flags&131072)!==0&&(zt=!0);else return n.lanes=t.lanes,Ln(t,n,h)}return vd(t,n,l,c,h)}function Hg(t,n,l,c){var h=c.children,g=t!==null?t.memoizedState:null;if(t===null&&n.stateNode===null&&(n.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.mode==="hidden"){if((n.flags&128)!==0){if(g=g!==null?g.baseLanes|l:l,t!==null){for(c=n.child=t.child,h=0;c!==null;)h=h|c.lanes|c.childLanes,c=c.sibling;c=h&~g}else c=0,n.child=null;return Gg(t,n,g,l,c)}if((l&536870912)!==0)n.memoizedState={baseLanes:0,cachePool:null},t!==null&&wo(n,g!==null?g.cachePool:null),g!==null?Kp(n,g):Ju(),Yp(n);else return c=n.lanes=536870912,Gg(t,n,g!==null?g.baseLanes|l:l,l,c)}else g!==null?(wo(n,g.cachePool),Kp(n,g),ua(),n.memoizedState=null):(t!==null&&wo(n,null),Ju(),ua());return is(t,n,h,l),n.child}function Qi(t,n){return t!==null&&t.tag===22||n.stateNode!==null||(n.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),n.sibling}function Gg(t,n,l,c,h){var g=Hu();return g=g===null?null:{parent:It._currentValue,pool:g},n.memoizedState={baseLanes:l,cachePool:g},t!==null&&wo(n,null),Ju(),Yp(n),t!==null&&Ur(t,n,c,!0),n.childLanes=h,null}function Po(t,n){return n=Bo({mode:n.mode,children:n.children},t.mode),n.ref=t.ref,t.child=n,n.return=t,n}function Fg(t,n,l){return Ja(n,t.child,null,l),t=Po(n,n.pendingProps),t.flags|=2,Rs(n),n.memoizedState=null,t}function Y1(t,n,l){var c=n.pendingProps,h=(n.flags&128)!==0;if(n.flags&=-129,t===null){if(We){if(c.mode==="hidden")return t=Po(n,c),n.lanes=536870912,Qi(null,t);if(Zu(n),(t=wt)?(t=ax(t,Gs),t=t!==null&&t.data==="&"?t:null,t!==null&&(n.memoizedState={dehydrated:t,treeContext:sa!==null?{id:xn,overflow:bn}:null,retryLane:536870912,hydrationErrors:null},l=Cp(t),l.return=n,n.child=l,as=n,wt=null)):t=null,t===null)throw aa(n);return n.lanes=536870912,null}return Po(n,c)}var g=t.memoizedState;if(g!==null){var w=g.dehydrated;if(Zu(n),h)if(n.flags&256)n.flags&=-257,n=Fg(t,n,l);else if(n.memoizedState!==null)n.child=t.child,n.flags|=128,n=null;else throw Error(i(558));else if(zt||Ur(t,n,l,!1),h=(l&t.childLanes)!==0,zt||h){if(c=pt,c!==null&&(w=Tt(c,l),w!==0&&w!==g.retryLane))throw g.retryLane=w,$a(t,w),_s(c,t,w),yd;Yo(),n=Fg(t,n,l)}else t=g.treeContext,wt=Ks(w.nextSibling),as=n,We=!0,na=null,Gs=!1,t!==null&&Dp(n,t),n=Po(n,c),n.flags|=4096;return n}return t=An(t.child,{mode:c.mode,children:c.children}),t.ref=n.ref,n.child=t,t.return=n,t}function Io(t,n){var l=n.ref;if(l===null)t!==null&&t.ref!==null&&(n.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(i(284));(t===null||t.ref!==l)&&(n.flags|=4194816)}}function vd(t,n,l,c,h){return Fa(n),l=ed(t,n,l,c,void 0,h),c=td(),t!==null&&!zt?(sd(t,n,h),Ln(t,n,h)):(We&&c&&Uu(n),n.flags|=1,is(t,n,l,h),n.child)}function Kg(t,n,l,c,h,g){return Fa(n),n.updateQueue=null,l=Jp(n,c,l,h),Xp(t),c=td(),t!==null&&!zt?(sd(t,n,g),Ln(t,n,g)):(We&&c&&Uu(n),n.flags|=1,is(t,n,l,g),n.child)}function Yg(t,n,l,c,h){if(Fa(n),n.stateNode===null){var g=Rr,w=l.contextType;typeof w=="object"&&w!==null&&(g=rs(w)),g=new l(c,g),n.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,g.updater=xd,n.stateNode=g,g._reactInternals=n,g=n.stateNode,g.props=c,g.state=n.memoizedState,g.refs={},Fu(n),w=l.contextType,g.context=typeof w=="object"&&w!==null?rs(w):Rr,g.state=n.memoizedState,w=l.getDerivedStateFromProps,typeof w=="function"&&(gd(n,l,w,c),g.state=n.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof g.getSnapshotBeforeUpdate=="function"||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(w=g.state,typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount(),w!==g.state&&xd.enqueueReplaceState(g,g.state,null),Fi(n,c,g,h),Gi(),g.state=n.memoizedState),typeof g.componentDidMount=="function"&&(n.flags|=4194308),c=!0}else if(t===null){g=n.stateNode;var E=n.memoizedProps,P=Za(l,E);g.props=P;var X=g.context,ne=l.contextType;w=Rr,typeof ne=="object"&&ne!==null&&(w=rs(ne));var oe=l.getDerivedStateFromProps;ne=typeof oe=="function"||typeof g.getSnapshotBeforeUpdate=="function",E=n.pendingProps!==E,ne||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(E||X!==w)&&Mg(n,g,c,w),ia=!1;var Q=n.memoizedState;g.state=Q,Fi(n,c,g,h),Gi(),X=n.memoizedState,E||Q!==X||ia?(typeof oe=="function"&&(gd(n,l,oe,c),X=n.memoizedState),(P=ia||Og(n,l,P,c,Q,X,w))?(ne||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount()),typeof g.componentDidMount=="function"&&(n.flags|=4194308)):(typeof g.componentDidMount=="function"&&(n.flags|=4194308),n.memoizedProps=c,n.memoizedState=X),g.props=c,g.state=X,g.context=w,c=P):(typeof g.componentDidMount=="function"&&(n.flags|=4194308),c=!1)}else{g=n.stateNode,Ku(t,n),w=n.memoizedProps,ne=Za(l,w),g.props=ne,oe=n.pendingProps,Q=g.context,X=l.contextType,P=Rr,typeof X=="object"&&X!==null&&(P=rs(X)),E=l.getDerivedStateFromProps,(X=typeof E=="function"||typeof g.getSnapshotBeforeUpdate=="function")||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(w!==oe||Q!==P)&&Mg(n,g,c,P),ia=!1,Q=n.memoizedState,g.state=Q,Fi(n,c,g,h),Gi();var ee=n.memoizedState;w!==oe||Q!==ee||ia||t!==null&&t.dependencies!==null&&yo(t.dependencies)?(typeof E=="function"&&(gd(n,l,E,c),ee=n.memoizedState),(ne=ia||Og(n,l,ne,c,Q,ee,P)||t!==null&&t.dependencies!==null&&yo(t.dependencies))?(X||typeof g.UNSAFE_componentWillUpdate!="function"&&typeof g.componentWillUpdate!="function"||(typeof g.componentWillUpdate=="function"&&g.componentWillUpdate(c,ee,P),typeof g.UNSAFE_componentWillUpdate=="function"&&g.UNSAFE_componentWillUpdate(c,ee,P)),typeof g.componentDidUpdate=="function"&&(n.flags|=4),typeof g.getSnapshotBeforeUpdate=="function"&&(n.flags|=1024)):(typeof g.componentDidUpdate!="function"||w===t.memoizedProps&&Q===t.memoizedState||(n.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||w===t.memoizedProps&&Q===t.memoizedState||(n.flags|=1024),n.memoizedProps=c,n.memoizedState=ee),g.props=c,g.state=ee,g.context=P,c=ne):(typeof g.componentDidUpdate!="function"||w===t.memoizedProps&&Q===t.memoizedState||(n.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||w===t.memoizedProps&&Q===t.memoizedState||(n.flags|=1024),c=!1)}return g=c,Io(t,n),c=(n.flags&128)!==0,g||c?(g=n.stateNode,l=c&&typeof l.getDerivedStateFromError!="function"?null:g.render(),n.flags|=1,t!==null&&c?(n.child=Ja(n,t.child,null,h),n.child=Ja(n,null,l,h)):is(t,n,l,h),n.memoizedState=g.state,t=n.child):t=Ln(t,n,h),t}function Xg(t,n,l,c){return Ha(),n.flags|=256,is(t,n,l,c),n.child}var wd={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function jd(t){return{baseLanes:t,cachePool:Ip()}}function Nd(t,n,l){return t=t!==null?t.childLanes&~l:0,n&&(t|=Os),t}function Jg(t,n,l){var c=n.pendingProps,h=!1,g=(n.flags&128)!==0,w;if((w=g)||(w=t!==null&&t.memoizedState===null?!1:(Ut.current&2)!==0),w&&(h=!0,n.flags&=-129),w=(n.flags&32)!==0,n.flags&=-33,t===null){if(We){if(h?ca(n):ua(),(t=wt)?(t=ax(t,Gs),t=t!==null&&t.data!=="&"?t:null,t!==null&&(n.memoizedState={dehydrated:t,treeContext:sa!==null?{id:xn,overflow:bn}:null,retryLane:536870912,hydrationErrors:null},l=Cp(t),l.return=n,n.child=l,as=n,wt=null)):t=null,t===null)throw aa(n);return rh(t)?n.lanes=32:n.lanes=536870912,null}var E=c.children;return c=c.fallback,h?(ua(),h=n.mode,E=Bo({mode:"hidden",children:E},h),c=qa(c,h,l,null),E.return=n,c.return=n,E.sibling=c,n.child=E,c=n.child,c.memoizedState=jd(l),c.childLanes=Nd(t,w,l),n.memoizedState=wd,Qi(null,c)):(ca(n),Sd(n,E))}var P=t.memoizedState;if(P!==null&&(E=P.dehydrated,E!==null)){if(g)n.flags&256?(ca(n),n.flags&=-257,n=_d(t,n,l)):n.memoizedState!==null?(ua(),n.child=t.child,n.flags|=128,n=null):(ua(),E=c.fallback,h=n.mode,c=Bo({mode:"visible",children:c.children},h),E=qa(E,h,l,null),E.flags|=2,c.return=n,E.return=n,c.sibling=E,n.child=c,Ja(n,t.child,null,l),c=n.child,c.memoizedState=jd(l),c.childLanes=Nd(t,w,l),n.memoizedState=wd,n=Qi(null,c));else if(ca(n),rh(E)){if(w=E.nextSibling&&E.nextSibling.dataset,w)var X=w.dgst;w=X,c=Error(i(419)),c.stack="",c.digest=w,Bi({value:c,source:null,stack:null}),n=_d(t,n,l)}else if(zt||Ur(t,n,l,!1),w=(l&t.childLanes)!==0,zt||w){if(w=pt,w!==null&&(c=Tt(w,l),c!==0&&c!==P.retryLane))throw P.retryLane=c,$a(t,c),_s(w,t,c),yd;ah(E)||Yo(),n=_d(t,n,l)}else ah(E)?(n.flags|=192,n.child=t.child,n=null):(t=P.treeContext,wt=Ks(E.nextSibling),as=n,We=!0,na=null,Gs=!1,t!==null&&Dp(n,t),n=Sd(n,c.children),n.flags|=4096);return n}return h?(ua(),E=c.fallback,h=n.mode,P=t.child,X=P.sibling,c=An(P,{mode:"hidden",children:c.children}),c.subtreeFlags=P.subtreeFlags&65011712,X!==null?E=An(X,E):(E=qa(E,h,l,null),E.flags|=2),E.return=n,c.return=n,c.sibling=E,n.child=c,Qi(null,c),c=n.child,E=t.child.memoizedState,E===null?E=jd(l):(h=E.cachePool,h!==null?(P=It._currentValue,h=h.parent!==P?{parent:P,pool:P}:h):h=Ip(),E={baseLanes:E.baseLanes|l,cachePool:h}),c.memoizedState=E,c.childLanes=Nd(t,w,l),n.memoizedState=wd,Qi(t.child,c)):(ca(n),l=t.child,t=l.sibling,l=An(l,{mode:"visible",children:c.children}),l.return=n,l.sibling=null,t!==null&&(w=n.deletions,w===null?(n.deletions=[t],n.flags|=16):w.push(t)),n.child=l,n.memoizedState=null,l)}function Sd(t,n){return n=Bo({mode:"visible",children:n},t.mode),n.return=t,t.child=n}function Bo(t,n){return t=Cs(22,t,null,n),t.lanes=0,t}function _d(t,n,l){return Ja(n,t.child,null,l),t=Sd(n,n.pendingProps.children),t.flags|=2,n.memoizedState=null,t}function Qg(t,n,l){t.lanes|=n;var c=t.alternate;c!==null&&(c.lanes|=n),zu(t.return,n,l)}function kd(t,n,l,c,h,g){var w=t.memoizedState;w===null?t.memoizedState={isBackwards:n,rendering:null,renderingStartTime:0,last:c,tail:l,tailMode:h,treeForkCount:g}:(w.isBackwards=n,w.rendering=null,w.renderingStartTime=0,w.last=c,w.tail=l,w.tailMode=h,w.treeForkCount=g)}function Zg(t,n,l){var c=n.pendingProps,h=c.revealOrder,g=c.tail;c=c.children;var w=Ut.current,E=(w&2)!==0;if(E?(w=w&1|2,n.flags|=128):w&=1,M(Ut,w),is(t,n,c,l),c=We?Ii:0,!E&&t!==null&&(t.flags&128)!==0)e:for(t=n.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Qg(t,l,n);else if(t.tag===19)Qg(t,l,n);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===n)break e;for(;t.sibling===null;){if(t.return===null||t.return===n)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}switch(h){case"forwards":for(l=n.child,h=null;l!==null;)t=l.alternate,t!==null&&To(t)===null&&(h=l),l=l.sibling;l=h,l===null?(h=n.child,n.child=null):(h=l.sibling,l.sibling=null),kd(n,!1,h,l,g,c);break;case"backwards":case"unstable_legacy-backwards":for(l=null,h=n.child,n.child=null;h!==null;){if(t=h.alternate,t!==null&&To(t)===null){n.child=h;break}t=h.sibling,h.sibling=l,l=h,h=t}kd(n,!0,l,null,g,c);break;case"together":kd(n,!1,null,null,void 0,c);break;default:n.memoizedState=null}return n.child}function Ln(t,n,l){if(t!==null&&(n.dependencies=t.dependencies),fa|=n.lanes,(l&n.childLanes)===0)if(t!==null){if(Ur(t,n,l,!1),(l&n.childLanes)===0)return null}else return null;if(t!==null&&n.child!==t.child)throw Error(i(153));if(n.child!==null){for(t=n.child,l=An(t,t.pendingProps),n.child=l,l.return=n;t.sibling!==null;)t=t.sibling,l=l.sibling=An(t,t.pendingProps),l.return=n;l.sibling=null}return n.child}function Td(t,n){return(t.lanes&n)!==0?!0:(t=t.dependencies,!!(t!==null&&yo(t)))}function X1(t,n,l){switch(n.tag){case 3:je(n,n.stateNode.containerInfo),ra(n,It,t.memoizedState.cache),Ha();break;case 27:case 5:pe(n);break;case 4:je(n,n.stateNode.containerInfo);break;case 10:ra(n,n.type,n.memoizedProps.value);break;case 31:if(n.memoizedState!==null)return n.flags|=128,Zu(n),null;break;case 13:var c=n.memoizedState;if(c!==null)return c.dehydrated!==null?(ca(n),n.flags|=128,null):(l&n.child.childLanes)!==0?Jg(t,n,l):(ca(n),t=Ln(t,n,l),t!==null?t.sibling:null);ca(n);break;case 19:var h=(t.flags&128)!==0;if(c=(l&n.childLanes)!==0,c||(Ur(t,n,l,!1),c=(l&n.childLanes)!==0),h){if(c)return Zg(t,n,l);n.flags|=128}if(h=n.memoizedState,h!==null&&(h.rendering=null,h.tail=null,h.lastEffect=null),M(Ut,Ut.current),c)break;return null;case 22:return n.lanes=0,Hg(t,n,l,n.pendingProps);case 24:ra(n,It,t.memoizedState.cache)}return Ln(t,n,l)}function Wg(t,n,l){if(t!==null)if(t.memoizedProps!==n.pendingProps)zt=!0;else{if(!Td(t,l)&&(n.flags&128)===0)return zt=!1,X1(t,n,l);zt=(t.flags&131072)!==0}else zt=!1,We&&(n.flags&1048576)!==0&&Rp(n,Ii,n.index);switch(n.lanes=0,n.tag){case 16:e:{var c=n.pendingProps;if(t=Ya(n.elementType),n.type=t,typeof t=="function")Du(t)?(c=Za(t,c),n.tag=1,n=Yg(null,n,t,c,l)):(n.tag=0,n=vd(null,n,t,c,l));else{if(t!=null){var h=t.$$typeof;if(h===B){n.tag=11,n=Vg(null,n,t,c,l);break e}else if(h===O){n.tag=14,n=$g(null,n,t,c,l);break e}}throw n=Re(t)||t,Error(i(306,n,""))}}return n;case 0:return vd(t,n,n.type,n.pendingProps,l);case 1:return c=n.type,h=Za(c,n.pendingProps),Yg(t,n,c,h,l);case 3:e:{if(je(n,n.stateNode.containerInfo),t===null)throw Error(i(387));c=n.pendingProps;var g=n.memoizedState;h=g.element,Ku(t,n),Fi(n,c,null,l);var w=n.memoizedState;if(c=w.cache,ra(n,It,c),c!==g.cache&&Vu(n,[It],l,!0),Gi(),c=w.element,g.isDehydrated)if(g={element:c,isDehydrated:!1,cache:w.cache},n.updateQueue.baseState=g,n.memoizedState=g,n.flags&256){n=Xg(t,n,c,l);break e}else if(c!==h){h=$s(Error(i(424)),n),Bi(h),n=Xg(t,n,c,l);break e}else for(t=n.stateNode.containerInfo,t.nodeType===9?t=t.body:t=t.nodeName==="HTML"?t.ownerDocument.body:t,wt=Ks(t.firstChild),as=n,We=!0,na=null,Gs=!0,l=Hp(n,null,c,l),n.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling;else{if(Ha(),c===h){n=Ln(t,n,l);break e}is(t,n,c,l)}n=n.child}return n;case 26:return Io(t,n),t===null?(l=ux(n.type,null,n.pendingProps,null))?n.memoizedState=l:We||(l=n.type,t=n.pendingProps,c=tc(ae.current).createElement(l),c[ns]=n,c[ys]=t,ls(c,l,t),Zt(c),n.stateNode=c):n.memoizedState=ux(n.type,t.memoizedProps,n.pendingProps,t.memoizedState),null;case 27:return pe(n),t===null&&We&&(c=n.stateNode=lx(n.type,n.pendingProps,ae.current),as=n,Gs=!0,h=wt,ba(n.type)?(ih=h,wt=Ks(c.firstChild)):wt=h),is(t,n,n.pendingProps.children,l),Io(t,n),t===null&&(n.flags|=4194304),n.child;case 5:return t===null&&We&&((h=c=wt)&&(c=_N(c,n.type,n.pendingProps,Gs),c!==null?(n.stateNode=c,as=n,wt=Ks(c.firstChild),Gs=!1,h=!0):h=!1),h||aa(n)),pe(n),h=n.type,g=n.pendingProps,w=t!==null?t.memoizedProps:null,c=g.children,th(h,g)?c=null:w!==null&&th(h,w)&&(n.flags|=32),n.memoizedState!==null&&(h=ed(t,n,z1,null,null,l),hl._currentValue=h),Io(t,n),is(t,n,c,l),n.child;case 6:return t===null&&We&&((t=l=wt)&&(l=kN(l,n.pendingProps,Gs),l!==null?(n.stateNode=l,as=n,wt=null,t=!0):t=!1),t||aa(n)),null;case 13:return Jg(t,n,l);case 4:return je(n,n.stateNode.containerInfo),c=n.pendingProps,t===null?n.child=Ja(n,null,c,l):is(t,n,c,l),n.child;case 11:return Vg(t,n,n.type,n.pendingProps,l);case 7:return is(t,n,n.pendingProps,l),n.child;case 8:return is(t,n,n.pendingProps.children,l),n.child;case 12:return is(t,n,n.pendingProps.children,l),n.child;case 10:return c=n.pendingProps,ra(n,n.type,c.value),is(t,n,c.children,l),n.child;case 9:return h=n.type._context,c=n.pendingProps.children,Fa(n),h=rs(h),c=c(h),n.flags|=1,is(t,n,c,l),n.child;case 14:return $g(t,n,n.type,n.pendingProps,l);case 15:return qg(t,n,n.type,n.pendingProps,l);case 19:return Zg(t,n,l);case 31:return Y1(t,n,l);case 22:return Hg(t,n,l,n.pendingProps);case 24:return Fa(n),c=rs(It),t===null?(h=Hu(),h===null&&(h=pt,g=$u(),h.pooledCache=g,g.refCount++,g!==null&&(h.pooledCacheLanes|=l),h=g),n.memoizedState={parent:c,cache:h},Fu(n),ra(n,It,h)):((t.lanes&l)!==0&&(Ku(t,n),Fi(n,null,null,l),Gi()),h=t.memoizedState,g=n.memoizedState,h.parent!==c?(h={parent:c,cache:c},n.memoizedState=h,n.lanes===0&&(n.memoizedState=n.updateQueue.baseState=h),ra(n,It,c)):(c=g.cache,ra(n,It,c),c!==h.cache&&Vu(n,[It],l,!0))),is(t,n,n.pendingProps.children,l),n.child;case 29:throw n.pendingProps}throw Error(i(156,n.tag))}function Pn(t){t.flags|=4}function Ed(t,n,l,c,h){if((n=(t.mode&32)!==0)&&(n=!1),n){if(t.flags|=16777216,(h&335544128)===h)if(t.stateNode.complete)t.flags|=8192;else if(k0())t.flags|=8192;else throw Xa=No,Gu}else t.flags&=-16777217}function e0(t,n){if(n.type!=="stylesheet"||(n.state.loading&4)!==0)t.flags&=-16777217;else if(t.flags|=16777216,!px(n))if(k0())t.flags|=8192;else throw Xa=No,Gu}function zo(t,n){n!==null&&(t.flags|=4),t.flags&16384&&(n=t.tag!==22?Me():536870912,t.lanes|=n,Kr|=n)}function Zi(t,n){if(!We)switch(t.tailMode){case"hidden":n=t.tail;for(var l=null;n!==null;)n.alternate!==null&&(l=n),n=n.sibling;l===null?t.tail=null:l.sibling=null;break;case"collapsed":l=t.tail;for(var c=null;l!==null;)l.alternate!==null&&(c=l),l=l.sibling;c===null?n||t.tail===null?t.tail=null:t.tail.sibling=null:c.sibling=null}}function jt(t){var n=t.alternate!==null&&t.alternate.child===t.child,l=0,c=0;if(n)for(var h=t.child;h!==null;)l|=h.lanes|h.childLanes,c|=h.subtreeFlags&65011712,c|=h.flags&65011712,h.return=t,h=h.sibling;else for(h=t.child;h!==null;)l|=h.lanes|h.childLanes,c|=h.subtreeFlags,c|=h.flags,h.return=t,h=h.sibling;return t.subtreeFlags|=c,t.childLanes=l,n}function J1(t,n,l){var c=n.pendingProps;switch(Lu(n),n.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return jt(n),null;case 1:return jt(n),null;case 3:return l=n.stateNode,c=null,t!==null&&(c=t.memoizedState.cache),n.memoizedState.cache!==c&&(n.flags|=2048),On(It),Se(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(t===null||t.child===null)&&(Mr(n)?Pn(n):t===null||t.memoizedState.isDehydrated&&(n.flags&256)===0||(n.flags|=1024,Iu())),jt(n),null;case 26:var h=n.type,g=n.memoizedState;return t===null?(Pn(n),g!==null?(jt(n),e0(n,g)):(jt(n),Ed(n,h,null,c,l))):g?g!==t.memoizedState?(Pn(n),jt(n),e0(n,g)):(jt(n),n.flags&=-16777217):(t=t.memoizedProps,t!==c&&Pn(n),jt(n),Ed(n,h,t,c,l)),null;case 27:if(qe(n),l=ae.current,h=n.type,t!==null&&n.stateNode!=null)t.memoizedProps!==c&&Pn(n);else{if(!c){if(n.stateNode===null)throw Error(i(166));return jt(n),null}t=I.current,Mr(n)?Op(n):(t=lx(h,c,l),n.stateNode=t,Pn(n))}return jt(n),null;case 5:if(qe(n),h=n.type,t!==null&&n.stateNode!=null)t.memoizedProps!==c&&Pn(n);else{if(!c){if(n.stateNode===null)throw Error(i(166));return jt(n),null}if(g=I.current,Mr(n))Op(n);else{var w=tc(ae.current);switch(g){case 1:g=w.createElementNS("http://www.w3.org/2000/svg",h);break;case 2:g=w.createElementNS("http://www.w3.org/1998/Math/MathML",h);break;default:switch(h){case"svg":g=w.createElementNS("http://www.w3.org/2000/svg",h);break;case"math":g=w.createElementNS("http://www.w3.org/1998/Math/MathML",h);break;case"script":g=w.createElement("div"),g.innerHTML="<script><\/script>",g=g.removeChild(g.firstChild);break;case"select":g=typeof c.is=="string"?w.createElement("select",{is:c.is}):w.createElement("select"),c.multiple?g.multiple=!0:c.size&&(g.size=c.size);break;default:g=typeof c.is=="string"?w.createElement(h,{is:c.is}):w.createElement(h)}}g[ns]=n,g[ys]=c;e:for(w=n.child;w!==null;){if(w.tag===5||w.tag===6)g.appendChild(w.stateNode);else if(w.tag!==4&&w.tag!==27&&w.child!==null){w.child.return=w,w=w.child;continue}if(w===n)break e;for(;w.sibling===null;){if(w.return===null||w.return===n)break e;w=w.return}w.sibling.return=w.return,w=w.sibling}n.stateNode=g;e:switch(ls(g,h,c),h){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}c&&Pn(n)}}return jt(n),Ed(n,n.type,t===null?null:t.memoizedProps,n.pendingProps,l),null;case 6:if(t&&n.stateNode!=null)t.memoizedProps!==c&&Pn(n);else{if(typeof c!="string"&&n.stateNode===null)throw Error(i(166));if(t=ae.current,Mr(n)){if(t=n.stateNode,l=n.memoizedProps,c=null,h=as,h!==null)switch(h.tag){case 27:case 5:c=h.memoizedProps}t[ns]=n,t=!!(t.nodeValue===l||c!==null&&c.suppressHydrationWarning===!0||J0(t.nodeValue,l)),t||aa(n,!0)}else t=tc(t).createTextNode(c),t[ns]=n,n.stateNode=t}return jt(n),null;case 31:if(l=n.memoizedState,t===null||t.memoizedState!==null){if(c=Mr(n),l!==null){if(t===null){if(!c)throw Error(i(318));if(t=n.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(i(557));t[ns]=n}else Ha(),(n.flags&128)===0&&(n.memoizedState=null),n.flags|=4;jt(n),t=!1}else l=Iu(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=l),t=!0;if(!t)return n.flags&256?(Rs(n),n):(Rs(n),null);if((n.flags&128)!==0)throw Error(i(558))}return jt(n),null;case 13:if(c=n.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(h=Mr(n),c!==null&&c.dehydrated!==null){if(t===null){if(!h)throw Error(i(318));if(h=n.memoizedState,h=h!==null?h.dehydrated:null,!h)throw Error(i(317));h[ns]=n}else Ha(),(n.flags&128)===0&&(n.memoizedState=null),n.flags|=4;jt(n),h=!1}else h=Iu(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=h),h=!0;if(!h)return n.flags&256?(Rs(n),n):(Rs(n),null)}return Rs(n),(n.flags&128)!==0?(n.lanes=l,n):(l=c!==null,t=t!==null&&t.memoizedState!==null,l&&(c=n.child,h=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(h=c.alternate.memoizedState.cachePool.pool),g=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(g=c.memoizedState.cachePool.pool),g!==h&&(c.flags|=2048)),l!==t&&l&&(n.child.flags|=8192),zo(n,n.updateQueue),jt(n),null);case 4:return Se(),t===null&&Jd(n.stateNode.containerInfo),jt(n),null;case 10:return On(n.type),jt(n),null;case 19:if(D(Ut),c=n.memoizedState,c===null)return jt(n),null;if(h=(n.flags&128)!==0,g=c.rendering,g===null)if(h)Zi(c,!1);else{if(Rt!==0||t!==null&&(t.flags&128)!==0)for(t=n.child;t!==null;){if(g=To(t),g!==null){for(n.flags|=128,Zi(c,!1),t=g.updateQueue,n.updateQueue=t,zo(n,t),n.subtreeFlags=0,t=l,l=n.child;l!==null;)Ep(l,t),l=l.sibling;return M(Ut,Ut.current&1|2),We&&Rn(n,c.treeForkCount),n.child}t=t.sibling}c.tail!==null&&Jt()>Go&&(n.flags|=128,h=!0,Zi(c,!1),n.lanes=4194304)}else{if(!h)if(t=To(g),t!==null){if(n.flags|=128,h=!0,t=t.updateQueue,n.updateQueue=t,zo(n,t),Zi(c,!0),c.tail===null&&c.tailMode==="hidden"&&!g.alternate&&!We)return jt(n),null}else 2*Jt()-c.renderingStartTime>Go&&l!==536870912&&(n.flags|=128,h=!0,Zi(c,!1),n.lanes=4194304);c.isBackwards?(g.sibling=n.child,n.child=g):(t=c.last,t!==null?t.sibling=g:n.child=g,c.last=g)}return c.tail!==null?(t=c.tail,c.rendering=t,c.tail=t.sibling,c.renderingStartTime=Jt(),t.sibling=null,l=Ut.current,M(Ut,h?l&1|2:l&1),We&&Rn(n,c.treeForkCount),t):(jt(n),null);case 22:case 23:return Rs(n),Qu(),c=n.memoizedState!==null,t!==null?t.memoizedState!==null!==c&&(n.flags|=8192):c&&(n.flags|=8192),c?(l&536870912)!==0&&(n.flags&128)===0&&(jt(n),n.subtreeFlags&6&&(n.flags|=8192)):jt(n),l=n.updateQueue,l!==null&&zo(n,l.retryQueue),l=null,t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(l=t.memoizedState.cachePool.pool),c=null,n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(c=n.memoizedState.cachePool.pool),c!==l&&(n.flags|=2048),t!==null&&D(Ka),null;case 24:return l=null,t!==null&&(l=t.memoizedState.cache),n.memoizedState.cache!==l&&(n.flags|=2048),On(It),jt(n),null;case 25:return null;case 30:return null}throw Error(i(156,n.tag))}function Q1(t,n){switch(Lu(n),n.tag){case 1:return t=n.flags,t&65536?(n.flags=t&-65537|128,n):null;case 3:return On(It),Se(),t=n.flags,(t&65536)!==0&&(t&128)===0?(n.flags=t&-65537|128,n):null;case 26:case 27:case 5:return qe(n),null;case 31:if(n.memoizedState!==null){if(Rs(n),n.alternate===null)throw Error(i(340));Ha()}return t=n.flags,t&65536?(n.flags=t&-65537|128,n):null;case 13:if(Rs(n),t=n.memoizedState,t!==null&&t.dehydrated!==null){if(n.alternate===null)throw Error(i(340));Ha()}return t=n.flags,t&65536?(n.flags=t&-65537|128,n):null;case 19:return D(Ut),null;case 4:return Se(),null;case 10:return On(n.type),null;case 22:case 23:return Rs(n),Qu(),t!==null&&D(Ka),t=n.flags,t&65536?(n.flags=t&-65537|128,n):null;case 24:return On(It),null;case 25:return null;default:return null}}function t0(t,n){switch(Lu(n),n.tag){case 3:On(It),Se();break;case 26:case 27:case 5:qe(n);break;case 4:Se();break;case 31:n.memoizedState!==null&&Rs(n);break;case 13:Rs(n);break;case 19:D(Ut);break;case 10:On(n.type);break;case 22:case 23:Rs(n),Qu(),t!==null&&D(Ka);break;case 24:On(It)}}function Wi(t,n){try{var l=n.updateQueue,c=l!==null?l.lastEffect:null;if(c!==null){var h=c.next;l=h;do{if((l.tag&t)===t){c=void 0;var g=l.create,w=l.inst;c=g(),w.destroy=c}l=l.next}while(l!==h)}}catch(E){ut(n,n.return,E)}}function da(t,n,l){try{var c=n.updateQueue,h=c!==null?c.lastEffect:null;if(h!==null){var g=h.next;c=g;do{if((c.tag&t)===t){var w=c.inst,E=w.destroy;if(E!==void 0){w.destroy=void 0,h=n;var P=l,X=E;try{X()}catch(ne){ut(h,P,ne)}}}c=c.next}while(c!==g)}}catch(ne){ut(n,n.return,ne)}}function s0(t){var n=t.updateQueue;if(n!==null){var l=t.stateNode;try{Fp(n,l)}catch(c){ut(t,t.return,c)}}}function n0(t,n,l){l.props=Za(t.type,t.memoizedProps),l.state=t.memoizedState;try{l.componentWillUnmount()}catch(c){ut(t,n,c)}}function el(t,n){try{var l=t.ref;if(l!==null){switch(t.tag){case 26:case 27:case 5:var c=t.stateNode;break;case 30:c=t.stateNode;break;default:c=t.stateNode}typeof l=="function"?t.refCleanup=l(c):l.current=c}}catch(h){ut(t,n,h)}}function yn(t,n){var l=t.ref,c=t.refCleanup;if(l!==null)if(typeof c=="function")try{c()}catch(h){ut(t,n,h)}finally{t.refCleanup=null,t=t.alternate,t!=null&&(t.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(h){ut(t,n,h)}else l.current=null}function a0(t){var n=t.type,l=t.memoizedProps,c=t.stateNode;try{e:switch(n){case"button":case"input":case"select":case"textarea":l.autoFocus&&c.focus();break e;case"img":l.src?c.src=l.src:l.srcSet&&(c.srcset=l.srcSet)}}catch(h){ut(t,t.return,h)}}function Cd(t,n,l){try{var c=t.stateNode;yN(c,t.type,l,n),c[ys]=n}catch(h){ut(t,t.return,h)}}function r0(t){return t.tag===5||t.tag===3||t.tag===26||t.tag===27&&ba(t.type)||t.tag===4}function Ad(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||r0(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.tag===27&&ba(t.type)||t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Rd(t,n,l){var c=t.tag;if(c===5||c===6)t=t.stateNode,n?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(t,n):(n=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,n.appendChild(t),l=l._reactRootContainer,l!=null||n.onclick!==null||(n.onclick=En));else if(c!==4&&(c===27&&ba(t.type)&&(l=t.stateNode,n=null),t=t.child,t!==null))for(Rd(t,n,l),t=t.sibling;t!==null;)Rd(t,n,l),t=t.sibling}function Vo(t,n,l){var c=t.tag;if(c===5||c===6)t=t.stateNode,n?l.insertBefore(t,n):l.appendChild(t);else if(c!==4&&(c===27&&ba(t.type)&&(l=t.stateNode),t=t.child,t!==null))for(Vo(t,n,l),t=t.sibling;t!==null;)Vo(t,n,l),t=t.sibling}function i0(t){var n=t.stateNode,l=t.memoizedProps;try{for(var c=t.type,h=n.attributes;h.length;)n.removeAttributeNode(h[0]);ls(n,c,l),n[ns]=t,n[ys]=l}catch(g){ut(t,t.return,g)}}var In=!1,Vt=!1,Dd=!1,l0=typeof WeakSet=="function"?WeakSet:Set,Wt=null;function Z1(t,n){if(t=t.containerInfo,Wd=oc,t=yp(t),_u(t)){if("selectionStart"in t)var l={start:t.selectionStart,end:t.selectionEnd};else e:{l=(l=t.ownerDocument)&&l.defaultView||window;var c=l.getSelection&&l.getSelection();if(c&&c.rangeCount!==0){l=c.anchorNode;var h=c.anchorOffset,g=c.focusNode;c=c.focusOffset;try{l.nodeType,g.nodeType}catch{l=null;break e}var w=0,E=-1,P=-1,X=0,ne=0,oe=t,Q=null;t:for(;;){for(var ee;oe!==l||h!==0&&oe.nodeType!==3||(E=w+h),oe!==g||c!==0&&oe.nodeType!==3||(P=w+c),oe.nodeType===3&&(w+=oe.nodeValue.length),(ee=oe.firstChild)!==null;)Q=oe,oe=ee;for(;;){if(oe===t)break t;if(Q===l&&++X===h&&(E=w),Q===g&&++ne===c&&(P=w),(ee=oe.nextSibling)!==null)break;oe=Q,Q=oe.parentNode}oe=ee}l=E===-1||P===-1?null:{start:E,end:P}}else l=null}l=l||{start:0,end:0}}else l=null;for(eh={focusedElem:t,selectionRange:l},oc=!1,Wt=n;Wt!==null;)if(n=Wt,t=n.child,(n.subtreeFlags&1028)!==0&&t!==null)t.return=n,Wt=t;else for(;Wt!==null;){switch(n=Wt,g=n.alternate,t=n.flags,n.tag){case 0:if((t&4)!==0&&(t=n.updateQueue,t=t!==null?t.events:null,t!==null))for(l=0;l<t.length;l++)h=t[l],h.ref.impl=h.nextImpl;break;case 11:case 15:break;case 1:if((t&1024)!==0&&g!==null){t=void 0,l=n,h=g.memoizedProps,g=g.memoizedState,c=l.stateNode;try{var _e=Za(l.type,h);t=c.getSnapshotBeforeUpdate(_e,g),c.__reactInternalSnapshotBeforeUpdate=t}catch(Ue){ut(l,l.return,Ue)}}break;case 3:if((t&1024)!==0){if(t=n.stateNode.containerInfo,l=t.nodeType,l===9)nh(t);else if(l===1)switch(t.nodeName){case"HEAD":case"HTML":case"BODY":nh(t);break;default:t.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((t&1024)!==0)throw Error(i(163))}if(t=n.sibling,t!==null){t.return=n.return,Wt=t;break}Wt=n.return}}function o0(t,n,l){var c=l.flags;switch(l.tag){case 0:case 11:case 15:zn(t,l),c&4&&Wi(5,l);break;case 1:if(zn(t,l),c&4)if(t=l.stateNode,n===null)try{t.componentDidMount()}catch(w){ut(l,l.return,w)}else{var h=Za(l.type,n.memoizedProps);n=n.memoizedState;try{t.componentDidUpdate(h,n,t.__reactInternalSnapshotBeforeUpdate)}catch(w){ut(l,l.return,w)}}c&64&&s0(l),c&512&&el(l,l.return);break;case 3:if(zn(t,l),c&64&&(t=l.updateQueue,t!==null)){if(n=null,l.child!==null)switch(l.child.tag){case 27:case 5:n=l.child.stateNode;break;case 1:n=l.child.stateNode}try{Fp(t,n)}catch(w){ut(l,l.return,w)}}break;case 27:n===null&&c&4&&i0(l);case 26:case 5:zn(t,l),n===null&&c&4&&a0(l),c&512&&el(l,l.return);break;case 12:zn(t,l);break;case 31:zn(t,l),c&4&&d0(t,l);break;case 13:zn(t,l),c&4&&h0(t,l),c&64&&(t=l.memoizedState,t!==null&&(t=t.dehydrated,t!==null&&(l=lN.bind(null,l),TN(t,l))));break;case 22:if(c=l.memoizedState!==null||In,!c){n=n!==null&&n.memoizedState!==null||Vt,h=In;var g=Vt;In=c,(Vt=n)&&!g?Vn(t,l,(l.subtreeFlags&8772)!==0):zn(t,l),In=h,Vt=g}break;case 30:break;default:zn(t,l)}}function c0(t){var n=t.alternate;n!==null&&(t.alternate=null,c0(n)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(n=t.stateNode,n!==null&&ou(n)),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}var _t=null,ws=!1;function Bn(t,n,l){for(l=l.child;l!==null;)u0(t,n,l),l=l.sibling}function u0(t,n,l){if(Qt&&typeof Qt.onCommitFiberUnmount=="function")try{Qt.onCommitFiberUnmount(pn,l)}catch{}switch(l.tag){case 26:Vt||yn(l,n),Bn(t,n,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:Vt||yn(l,n);var c=_t,h=ws;ba(l.type)&&(_t=l.stateNode,ws=!1),Bn(t,n,l),cl(l.stateNode),_t=c,ws=h;break;case 5:Vt||yn(l,n);case 6:if(c=_t,h=ws,_t=null,Bn(t,n,l),_t=c,ws=h,_t!==null)if(ws)try{(_t.nodeType===9?_t.body:_t.nodeName==="HTML"?_t.ownerDocument.body:_t).removeChild(l.stateNode)}catch(g){ut(l,n,g)}else try{_t.removeChild(l.stateNode)}catch(g){ut(l,n,g)}break;case 18:_t!==null&&(ws?(t=_t,sx(t.nodeType===9?t.body:t.nodeName==="HTML"?t.ownerDocument.body:t,l.stateNode),ti(t)):sx(_t,l.stateNode));break;case 4:c=_t,h=ws,_t=l.stateNode.containerInfo,ws=!0,Bn(t,n,l),_t=c,ws=h;break;case 0:case 11:case 14:case 15:da(2,l,n),Vt||da(4,l,n),Bn(t,n,l);break;case 1:Vt||(yn(l,n),c=l.stateNode,typeof c.componentWillUnmount=="function"&&n0(l,n,c)),Bn(t,n,l);break;case 21:Bn(t,n,l);break;case 22:Vt=(c=Vt)||l.memoizedState!==null,Bn(t,n,l),Vt=c;break;default:Bn(t,n,l)}}function d0(t,n){if(n.memoizedState===null&&(t=n.alternate,t!==null&&(t=t.memoizedState,t!==null))){t=t.dehydrated;try{ti(t)}catch(l){ut(n,n.return,l)}}}function h0(t,n){if(n.memoizedState===null&&(t=n.alternate,t!==null&&(t=t.memoizedState,t!==null&&(t=t.dehydrated,t!==null))))try{ti(t)}catch(l){ut(n,n.return,l)}}function W1(t){switch(t.tag){case 31:case 13:case 19:var n=t.stateNode;return n===null&&(n=t.stateNode=new l0),n;case 22:return t=t.stateNode,n=t._retryCache,n===null&&(n=t._retryCache=new l0),n;default:throw Error(i(435,t.tag))}}function $o(t,n){var l=W1(t);n.forEach(function(c){if(!l.has(c)){l.add(c);var h=oN.bind(null,t,c);c.then(h,h)}})}function js(t,n){var l=n.deletions;if(l!==null)for(var c=0;c<l.length;c++){var h=l[c],g=t,w=n,E=w;e:for(;E!==null;){switch(E.tag){case 27:if(ba(E.type)){_t=E.stateNode,ws=!1;break e}break;case 5:_t=E.stateNode,ws=!1;break e;case 3:case 4:_t=E.stateNode.containerInfo,ws=!0;break e}E=E.return}if(_t===null)throw Error(i(160));u0(g,w,h),_t=null,ws=!1,g=h.alternate,g!==null&&(g.return=null),h.return=null}if(n.subtreeFlags&13886)for(n=n.child;n!==null;)f0(n,t),n=n.sibling}var Ws=null;function f0(t,n){var l=t.alternate,c=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:js(n,t),Ns(t),c&4&&(da(3,t,t.return),Wi(3,t),da(5,t,t.return));break;case 1:js(n,t),Ns(t),c&512&&(Vt||l===null||yn(l,l.return)),c&64&&In&&(t=t.updateQueue,t!==null&&(c=t.callbacks,c!==null&&(l=t.shared.hiddenCallbacks,t.shared.hiddenCallbacks=l===null?c:l.concat(c))));break;case 26:var h=Ws;if(js(n,t),Ns(t),c&512&&(Vt||l===null||yn(l,l.return)),c&4){var g=l!==null?l.memoizedState:null;if(c=t.memoizedState,l===null)if(c===null)if(t.stateNode===null){e:{c=t.type,l=t.memoizedProps,h=h.ownerDocument||h;t:switch(c){case"title":g=h.getElementsByTagName("title")[0],(!g||g[Ti]||g[ns]||g.namespaceURI==="http://www.w3.org/2000/svg"||g.hasAttribute("itemprop"))&&(g=h.createElement(c),h.head.insertBefore(g,h.querySelector("head > title"))),ls(g,c,l),g[ns]=t,Zt(g),c=g;break e;case"link":var w=fx("link","href",h).get(c+(l.href||""));if(w){for(var E=0;E<w.length;E++)if(g=w[E],g.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&g.getAttribute("rel")===(l.rel==null?null:l.rel)&&g.getAttribute("title")===(l.title==null?null:l.title)&&g.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){w.splice(E,1);break t}}g=h.createElement(c),ls(g,c,l),h.head.appendChild(g);break;case"meta":if(w=fx("meta","content",h).get(c+(l.content||""))){for(E=0;E<w.length;E++)if(g=w[E],g.getAttribute("content")===(l.content==null?null:""+l.content)&&g.getAttribute("name")===(l.name==null?null:l.name)&&g.getAttribute("property")===(l.property==null?null:l.property)&&g.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&g.getAttribute("charset")===(l.charSet==null?null:l.charSet)){w.splice(E,1);break t}}g=h.createElement(c),ls(g,c,l),h.head.appendChild(g);break;default:throw Error(i(468,c))}g[ns]=t,Zt(g),c=g}t.stateNode=c}else mx(h,t.type,t.stateNode);else t.stateNode=hx(h,c,t.memoizedProps);else g!==c?(g===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):g.count--,c===null?mx(h,t.type,t.stateNode):hx(h,c,t.memoizedProps)):c===null&&t.stateNode!==null&&Cd(t,t.memoizedProps,l.memoizedProps)}break;case 27:js(n,t),Ns(t),c&512&&(Vt||l===null||yn(l,l.return)),l!==null&&c&4&&Cd(t,t.memoizedProps,l.memoizedProps);break;case 5:if(js(n,t),Ns(t),c&512&&(Vt||l===null||yn(l,l.return)),t.flags&32){h=t.stateNode;try{Sr(h,"")}catch(_e){ut(t,t.return,_e)}}c&4&&t.stateNode!=null&&(h=t.memoizedProps,Cd(t,h,l!==null?l.memoizedProps:h)),c&1024&&(Dd=!0);break;case 6:if(js(n,t),Ns(t),c&4){if(t.stateNode===null)throw Error(i(162));c=t.memoizedProps,l=t.stateNode;try{l.nodeValue=c}catch(_e){ut(t,t.return,_e)}}break;case 3:if(ac=null,h=Ws,Ws=sc(n.containerInfo),js(n,t),Ws=h,Ns(t),c&4&&l!==null&&l.memoizedState.isDehydrated)try{ti(n.containerInfo)}catch(_e){ut(t,t.return,_e)}Dd&&(Dd=!1,m0(t));break;case 4:c=Ws,Ws=sc(t.stateNode.containerInfo),js(n,t),Ns(t),Ws=c;break;case 12:js(n,t),Ns(t);break;case 31:js(n,t),Ns(t),c&4&&(c=t.updateQueue,c!==null&&(t.updateQueue=null,$o(t,c)));break;case 13:js(n,t),Ns(t),t.child.flags&8192&&t.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(Ho=Jt()),c&4&&(c=t.updateQueue,c!==null&&(t.updateQueue=null,$o(t,c)));break;case 22:h=t.memoizedState!==null;var P=l!==null&&l.memoizedState!==null,X=In,ne=Vt;if(In=X||h,Vt=ne||P,js(n,t),Vt=ne,In=X,Ns(t),c&8192)e:for(n=t.stateNode,n._visibility=h?n._visibility&-2:n._visibility|1,h&&(l===null||P||In||Vt||Wa(t)),l=null,n=t;;){if(n.tag===5||n.tag===26){if(l===null){P=l=n;try{if(g=P.stateNode,h)w=g.style,typeof w.setProperty=="function"?w.setProperty("display","none","important"):w.display="none";else{E=P.stateNode;var oe=P.memoizedProps.style,Q=oe!=null&&oe.hasOwnProperty("display")?oe.display:null;E.style.display=Q==null||typeof Q=="boolean"?"":(""+Q).trim()}}catch(_e){ut(P,P.return,_e)}}}else if(n.tag===6){if(l===null){P=n;try{P.stateNode.nodeValue=h?"":P.memoizedProps}catch(_e){ut(P,P.return,_e)}}}else if(n.tag===18){if(l===null){P=n;try{var ee=P.stateNode;h?nx(ee,!0):nx(P.stateNode,!1)}catch(_e){ut(P,P.return,_e)}}}else if((n.tag!==22&&n.tag!==23||n.memoizedState===null||n===t)&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break e;for(;n.sibling===null;){if(n.return===null||n.return===t)break e;l===n&&(l=null),n=n.return}l===n&&(l=null),n.sibling.return=n.return,n=n.sibling}c&4&&(c=t.updateQueue,c!==null&&(l=c.retryQueue,l!==null&&(c.retryQueue=null,$o(t,l))));break;case 19:js(n,t),Ns(t),c&4&&(c=t.updateQueue,c!==null&&(t.updateQueue=null,$o(t,c)));break;case 30:break;case 21:break;default:js(n,t),Ns(t)}}function Ns(t){var n=t.flags;if(n&2){try{for(var l,c=t.return;c!==null;){if(r0(c)){l=c;break}c=c.return}if(l==null)throw Error(i(160));switch(l.tag){case 27:var h=l.stateNode,g=Ad(t);Vo(t,g,h);break;case 5:var w=l.stateNode;l.flags&32&&(Sr(w,""),l.flags&=-33);var E=Ad(t);Vo(t,E,w);break;case 3:case 4:var P=l.stateNode.containerInfo,X=Ad(t);Rd(t,X,P);break;default:throw Error(i(161))}}catch(ne){ut(t,t.return,ne)}t.flags&=-3}n&4096&&(t.flags&=-4097)}function m0(t){if(t.subtreeFlags&1024)for(t=t.child;t!==null;){var n=t;m0(n),n.tag===5&&n.flags&1024&&n.stateNode.reset(),t=t.sibling}}function zn(t,n){if(n.subtreeFlags&8772)for(n=n.child;n!==null;)o0(t,n.alternate,n),n=n.sibling}function Wa(t){for(t=t.child;t!==null;){var n=t;switch(n.tag){case 0:case 11:case 14:case 15:da(4,n,n.return),Wa(n);break;case 1:yn(n,n.return);var l=n.stateNode;typeof l.componentWillUnmount=="function"&&n0(n,n.return,l),Wa(n);break;case 27:cl(n.stateNode);case 26:case 5:yn(n,n.return),Wa(n);break;case 22:n.memoizedState===null&&Wa(n);break;case 30:Wa(n);break;default:Wa(n)}t=t.sibling}}function Vn(t,n,l){for(l=l&&(n.subtreeFlags&8772)!==0,n=n.child;n!==null;){var c=n.alternate,h=t,g=n,w=g.flags;switch(g.tag){case 0:case 11:case 15:Vn(h,g,l),Wi(4,g);break;case 1:if(Vn(h,g,l),c=g,h=c.stateNode,typeof h.componentDidMount=="function")try{h.componentDidMount()}catch(X){ut(c,c.return,X)}if(c=g,h=c.updateQueue,h!==null){var E=c.stateNode;try{var P=h.shared.hiddenCallbacks;if(P!==null)for(h.shared.hiddenCallbacks=null,h=0;h<P.length;h++)Gp(P[h],E)}catch(X){ut(c,c.return,X)}}l&&w&64&&s0(g),el(g,g.return);break;case 27:i0(g);case 26:case 5:Vn(h,g,l),l&&c===null&&w&4&&a0(g),el(g,g.return);break;case 12:Vn(h,g,l);break;case 31:Vn(h,g,l),l&&w&4&&d0(h,g);break;case 13:Vn(h,g,l),l&&w&4&&h0(h,g);break;case 22:g.memoizedState===null&&Vn(h,g,l),el(g,g.return);break;case 30:break;default:Vn(h,g,l)}n=n.sibling}}function Od(t,n){var l=null;t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(l=t.memoizedState.cachePool.pool),t=null,n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(t=n.memoizedState.cachePool.pool),t!==l&&(t!=null&&t.refCount++,l!=null&&zi(l))}function Md(t,n){t=null,n.alternate!==null&&(t=n.alternate.memoizedState.cache),n=n.memoizedState.cache,n!==t&&(n.refCount++,t!=null&&zi(t))}function en(t,n,l,c){if(n.subtreeFlags&10256)for(n=n.child;n!==null;)p0(t,n,l,c),n=n.sibling}function p0(t,n,l,c){var h=n.flags;switch(n.tag){case 0:case 11:case 15:en(t,n,l,c),h&2048&&Wi(9,n);break;case 1:en(t,n,l,c);break;case 3:en(t,n,l,c),h&2048&&(t=null,n.alternate!==null&&(t=n.alternate.memoizedState.cache),n=n.memoizedState.cache,n!==t&&(n.refCount++,t!=null&&zi(t)));break;case 12:if(h&2048){en(t,n,l,c),t=n.stateNode;try{var g=n.memoizedProps,w=g.id,E=g.onPostCommit;typeof E=="function"&&E(w,n.alternate===null?"mount":"update",t.passiveEffectDuration,-0)}catch(P){ut(n,n.return,P)}}else en(t,n,l,c);break;case 31:en(t,n,l,c);break;case 13:en(t,n,l,c);break;case 23:break;case 22:g=n.stateNode,w=n.alternate,n.memoizedState!==null?g._visibility&2?en(t,n,l,c):tl(t,n):g._visibility&2?en(t,n,l,c):(g._visibility|=2,Hr(t,n,l,c,(n.subtreeFlags&10256)!==0||!1)),h&2048&&Od(w,n);break;case 24:en(t,n,l,c),h&2048&&Md(n.alternate,n);break;default:en(t,n,l,c)}}function Hr(t,n,l,c,h){for(h=h&&((n.subtreeFlags&10256)!==0||!1),n=n.child;n!==null;){var g=t,w=n,E=l,P=c,X=w.flags;switch(w.tag){case 0:case 11:case 15:Hr(g,w,E,P,h),Wi(8,w);break;case 23:break;case 22:var ne=w.stateNode;w.memoizedState!==null?ne._visibility&2?Hr(g,w,E,P,h):tl(g,w):(ne._visibility|=2,Hr(g,w,E,P,h)),h&&X&2048&&Od(w.alternate,w);break;case 24:Hr(g,w,E,P,h),h&&X&2048&&Md(w.alternate,w);break;default:Hr(g,w,E,P,h)}n=n.sibling}}function tl(t,n){if(n.subtreeFlags&10256)for(n=n.child;n!==null;){var l=t,c=n,h=c.flags;switch(c.tag){case 22:tl(l,c),h&2048&&Od(c.alternate,c);break;case 24:tl(l,c),h&2048&&Md(c.alternate,c);break;default:tl(l,c)}n=n.sibling}}var sl=8192;function Gr(t,n,l){if(t.subtreeFlags&sl)for(t=t.child;t!==null;)g0(t,n,l),t=t.sibling}function g0(t,n,l){switch(t.tag){case 26:Gr(t,n,l),t.flags&sl&&t.memoizedState!==null&&BN(l,Ws,t.memoizedState,t.memoizedProps);break;case 5:Gr(t,n,l);break;case 3:case 4:var c=Ws;Ws=sc(t.stateNode.containerInfo),Gr(t,n,l),Ws=c;break;case 22:t.memoizedState===null&&(c=t.alternate,c!==null&&c.memoizedState!==null?(c=sl,sl=16777216,Gr(t,n,l),sl=c):Gr(t,n,l));break;default:Gr(t,n,l)}}function x0(t){var n=t.alternate;if(n!==null&&(t=n.child,t!==null)){n.child=null;do n=t.sibling,t.sibling=null,t=n;while(t!==null)}}function nl(t){var n=t.deletions;if((t.flags&16)!==0){if(n!==null)for(var l=0;l<n.length;l++){var c=n[l];Wt=c,y0(c,t)}x0(t)}if(t.subtreeFlags&10256)for(t=t.child;t!==null;)b0(t),t=t.sibling}function b0(t){switch(t.tag){case 0:case 11:case 15:nl(t),t.flags&2048&&da(9,t,t.return);break;case 3:nl(t);break;case 12:nl(t);break;case 22:var n=t.stateNode;t.memoizedState!==null&&n._visibility&2&&(t.return===null||t.return.tag!==13)?(n._visibility&=-3,qo(t)):nl(t);break;default:nl(t)}}function qo(t){var n=t.deletions;if((t.flags&16)!==0){if(n!==null)for(var l=0;l<n.length;l++){var c=n[l];Wt=c,y0(c,t)}x0(t)}for(t=t.child;t!==null;){switch(n=t,n.tag){case 0:case 11:case 15:da(8,n,n.return),qo(n);break;case 22:l=n.stateNode,l._visibility&2&&(l._visibility&=-3,qo(n));break;default:qo(n)}t=t.sibling}}function y0(t,n){for(;Wt!==null;){var l=Wt;switch(l.tag){case 0:case 11:case 15:da(8,l,n);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var c=l.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:zi(l.memoizedState.cache)}if(c=l.child,c!==null)c.return=l,Wt=c;else e:for(l=t;Wt!==null;){c=Wt;var h=c.sibling,g=c.return;if(c0(c),c===l){Wt=null;break e}if(h!==null){h.return=g,Wt=h;break e}Wt=g}}}var eN={getCacheForType:function(t){var n=rs(It),l=n.data.get(t);return l===void 0&&(l=t(),n.data.set(t,l)),l},cacheSignal:function(){return rs(It).controller.signal}},tN=typeof WeakMap=="function"?WeakMap:Map,lt=0,pt=null,Fe=null,Je=0,ct=0,Ds=null,ha=!1,Fr=!1,Ud=!1,$n=0,Rt=0,fa=0,er=0,Ld=0,Os=0,Kr=0,al=null,Ss=null,Pd=!1,Ho=0,v0=0,Go=1/0,Fo=null,ma=null,Ft=0,pa=null,Yr=null,qn=0,Id=0,Bd=null,w0=null,rl=0,zd=null;function Ms(){return(lt&2)!==0&&Je!==0?Je&-Je:J.T!==null?Fd():gn()}function j0(){if(Os===0)if((Je&536870912)===0||We){var t=z;z<<=1,(z&3932160)===0&&(z=262144),Os=t}else Os=536870912;return t=As.current,t!==null&&(t.flags|=32),Os}function _s(t,n,l){(t===pt&&(ct===2||ct===9)||t.cancelPendingCommit!==null)&&(Xr(t,0),ga(t,Je,Os,!1)),Ve(t,l),((lt&2)===0||t!==pt)&&(t===pt&&((lt&2)===0&&(er|=l),Rt===4&&ga(t,Je,Os,!1)),vn(t))}function N0(t,n,l){if((lt&6)!==0)throw Error(i(327));var c=!l&&(n&127)===0&&(n&t.expiredLanes)===0||ge(t,n),h=c?aN(t,n):$d(t,n,!0),g=c;do{if(h===0){Fr&&!c&&ga(t,n,0,!1);break}else{if(l=t.current.alternate,g&&!sN(l)){h=$d(t,n,!1),g=!1;continue}if(h===2){if(g=n,t.errorRecoveryDisabledLanes&g)var w=0;else w=t.pendingLanes&-536870913,w=w!==0?w:w&536870912?536870912:0;if(w!==0){n=w;e:{var E=t;h=al;var P=E.current.memoizedState.isDehydrated;if(P&&(Xr(E,w).flags|=256),w=$d(E,w,!1),w!==2){if(Ud&&!P){E.errorRecoveryDisabledLanes|=g,er|=g,h=4;break e}g=Ss,Ss=h,g!==null&&(Ss===null?Ss=g:Ss.push.apply(Ss,g))}h=w}if(g=!1,h!==2)continue}}if(h===1){Xr(t,0),ga(t,n,0,!0);break}e:{switch(c=t,g=h,g){case 0:case 1:throw Error(i(345));case 4:if((n&4194048)!==n)break;case 6:ga(c,n,Os,!ha);break e;case 2:Ss=null;break;case 3:case 5:break;default:throw Error(i(329))}if((n&62914560)===n&&(h=Ho+300-Jt(),10<h)){if(ga(c,n,Os,!ha),ue(c,0,!0)!==0)break e;qn=n,c.timeoutHandle=ex(S0.bind(null,c,l,Ss,Fo,Pd,n,Os,er,Kr,ha,g,"Throttled",-0,0),h);break e}S0(c,l,Ss,Fo,Pd,n,Os,er,Kr,ha,g,null,-0,0)}}break}while(!0);vn(t)}function S0(t,n,l,c,h,g,w,E,P,X,ne,oe,Q,ee){if(t.timeoutHandle=-1,oe=n.subtreeFlags,oe&8192||(oe&16785408)===16785408){oe={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:En},g0(n,g,oe);var _e=(g&62914560)===g?Ho-Jt():(g&4194048)===g?v0-Jt():0;if(_e=zN(oe,_e),_e!==null){qn=g,t.cancelPendingCommit=_e(D0.bind(null,t,n,g,l,c,h,w,E,P,ne,oe,null,Q,ee)),ga(t,g,w,!X);return}}D0(t,n,g,l,c,h,w,E,P)}function sN(t){for(var n=t;;){var l=n.tag;if((l===0||l===11||l===15)&&n.flags&16384&&(l=n.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var c=0;c<l.length;c++){var h=l[c],g=h.getSnapshot;h=h.value;try{if(!Es(g(),h))return!1}catch{return!1}}if(l=n.child,n.subtreeFlags&16384&&l!==null)l.return=n,n=l;else{if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return!0;n=n.return}n.sibling.return=n.return,n=n.sibling}}return!0}function ga(t,n,l,c){n&=~Ld,n&=~er,t.suspendedLanes|=n,t.pingedLanes&=~n,c&&(t.warmLanes|=n),c=t.expirationTimes;for(var h=n;0<h;){var g=31-Ht(h),w=1<<g;c[g]=-1,h&=~w}l!==0&&st(t,l,n)}function Ko(){return(lt&6)===0?(il(0),!1):!0}function Vd(){if(Fe!==null){if(ct===0)var t=Fe.return;else t=Fe,Dn=Ga=null,nd(t),Br=null,$i=0,t=Fe;for(;t!==null;)t0(t.alternate,t),t=t.return;Fe=null}}function Xr(t,n){var l=t.timeoutHandle;l!==-1&&(t.timeoutHandle=-1,jN(l)),l=t.cancelPendingCommit,l!==null&&(t.cancelPendingCommit=null,l()),qn=0,Vd(),pt=t,Fe=l=An(t.current,null),Je=n,ct=0,Ds=null,ha=!1,Fr=ge(t,n),Ud=!1,Kr=Os=Ld=er=fa=Rt=0,Ss=al=null,Pd=!1,(n&8)!==0&&(n|=n&32);var c=t.entangledLanes;if(c!==0)for(t=t.entanglements,c&=n;0<c;){var h=31-Ht(c),g=1<<h;n|=t[h],c&=~g}return $n=n,mo(),l}function _0(t,n){He=null,J.H=Ji,n===Ir||n===jo?(n=Vp(),ct=3):n===Gu?(n=Vp(),ct=4):ct=n===yd?8:n!==null&&typeof n=="object"&&typeof n.then=="function"?6:1,Ds=n,Fe===null&&(Rt=1,Lo(t,$s(n,t.current)))}function k0(){var t=As.current;return t===null?!0:(Je&4194048)===Je?Fs===null:(Je&62914560)===Je||(Je&536870912)!==0?t===Fs:!1}function T0(){var t=J.H;return J.H=Ji,t===null?Ji:t}function E0(){var t=J.A;return J.A=eN,t}function Yo(){Rt=4,ha||(Je&4194048)!==Je&&As.current!==null||(Fr=!0),(fa&134217727)===0&&(er&134217727)===0||pt===null||ga(pt,Je,Os,!1)}function $d(t,n,l){var c=lt;lt|=2;var h=T0(),g=E0();(pt!==t||Je!==n)&&(Fo=null,Xr(t,n)),n=!1;var w=Rt;e:do try{if(ct!==0&&Fe!==null){var E=Fe,P=Ds;switch(ct){case 8:Vd(),w=6;break e;case 3:case 2:case 9:case 6:As.current===null&&(n=!0);var X=ct;if(ct=0,Ds=null,Jr(t,E,P,X),l&&Fr){w=0;break e}break;default:X=ct,ct=0,Ds=null,Jr(t,E,P,X)}}nN(),w=Rt;break}catch(ne){_0(t,ne)}while(!0);return n&&t.shellSuspendCounter++,Dn=Ga=null,lt=c,J.H=h,J.A=g,Fe===null&&(pt=null,Je=0,mo()),w}function nN(){for(;Fe!==null;)C0(Fe)}function aN(t,n){var l=lt;lt|=2;var c=T0(),h=E0();pt!==t||Je!==n?(Fo=null,Go=Jt()+500,Xr(t,n)):Fr=ge(t,n);e:do try{if(ct!==0&&Fe!==null){n=Fe;var g=Ds;t:switch(ct){case 1:ct=0,Ds=null,Jr(t,n,g,1);break;case 2:case 9:if(Bp(g)){ct=0,Ds=null,A0(n);break}n=function(){ct!==2&&ct!==9||pt!==t||(ct=7),vn(t)},g.then(n,n);break e;case 3:ct=7;break e;case 4:ct=5;break e;case 7:Bp(g)?(ct=0,Ds=null,A0(n)):(ct=0,Ds=null,Jr(t,n,g,7));break;case 5:var w=null;switch(Fe.tag){case 26:w=Fe.memoizedState;case 5:case 27:var E=Fe;if(w?px(w):E.stateNode.complete){ct=0,Ds=null;var P=E.sibling;if(P!==null)Fe=P;else{var X=E.return;X!==null?(Fe=X,Xo(X)):Fe=null}break t}}ct=0,Ds=null,Jr(t,n,g,5);break;case 6:ct=0,Ds=null,Jr(t,n,g,6);break;case 8:Vd(),Rt=6;break e;default:throw Error(i(462))}}rN();break}catch(ne){_0(t,ne)}while(!0);return Dn=Ga=null,J.H=c,J.A=h,lt=l,Fe!==null?0:(pt=null,Je=0,mo(),Rt)}function rN(){for(;Fe!==null&&!ks();)C0(Fe)}function C0(t){var n=Wg(t.alternate,t,$n);t.memoizedProps=t.pendingProps,n===null?Xo(t):Fe=n}function A0(t){var n=t,l=n.alternate;switch(n.tag){case 15:case 0:n=Kg(l,n,n.pendingProps,n.type,void 0,Je);break;case 11:n=Kg(l,n,n.pendingProps,n.type.render,n.ref,Je);break;case 5:nd(n);default:t0(l,n),n=Fe=Ep(n,$n),n=Wg(l,n,$n)}t.memoizedProps=t.pendingProps,n===null?Xo(t):Fe=n}function Jr(t,n,l,c){Dn=Ga=null,nd(n),Br=null,$i=0;var h=n.return;try{if(K1(t,h,n,l,Je)){Rt=1,Lo(t,$s(l,t.current)),Fe=null;return}}catch(g){if(h!==null)throw Fe=h,g;Rt=1,Lo(t,$s(l,t.current)),Fe=null;return}n.flags&32768?(We||c===1?t=!0:Fr||(Je&536870912)!==0?t=!1:(ha=t=!0,(c===2||c===9||c===3||c===6)&&(c=As.current,c!==null&&c.tag===13&&(c.flags|=16384))),R0(n,t)):Xo(n)}function Xo(t){var n=t;do{if((n.flags&32768)!==0){R0(n,ha);return}t=n.return;var l=J1(n.alternate,n,$n);if(l!==null){Fe=l;return}if(n=n.sibling,n!==null){Fe=n;return}Fe=n=t}while(n!==null);Rt===0&&(Rt=5)}function R0(t,n){do{var l=Q1(t.alternate,t);if(l!==null){l.flags&=32767,Fe=l;return}if(l=t.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!n&&(t=t.sibling,t!==null)){Fe=t;return}Fe=t=l}while(t!==null);Rt=6,Fe=null}function D0(t,n,l,c,h,g,w,E,P){t.cancelPendingCommit=null;do Jo();while(Ft!==0);if((lt&6)!==0)throw Error(i(327));if(n!==null){if(n===t.current)throw Error(i(177));if(g=n.lanes|n.childLanes,g|=Au,nt(t,l,g,w,E,P),t===pt&&(Fe=pt=null,Je=0),Yr=n,pa=t,qn=l,Id=g,Bd=h,w0=c,(n.subtreeFlags&10256)!==0||(n.flags&10256)!==0?(t.callbackNode=null,t.callbackPriority=0,cN(kn,function(){return P0(),null})):(t.callbackNode=null,t.callbackPriority=0),c=(n.flags&13878)!==0,(n.subtreeFlags&13878)!==0||c){c=J.T,J.T=null,h=se.p,se.p=2,w=lt,lt|=4;try{Z1(t,n,l)}finally{lt=w,se.p=h,J.T=c}}Ft=1,O0(),M0(),U0()}}function O0(){if(Ft===1){Ft=0;var t=pa,n=Yr,l=(n.flags&13878)!==0;if((n.subtreeFlags&13878)!==0||l){l=J.T,J.T=null;var c=se.p;se.p=2;var h=lt;lt|=4;try{f0(n,t);var g=eh,w=yp(t.containerInfo),E=g.focusedElem,P=g.selectionRange;if(w!==E&&E&&E.ownerDocument&&bp(E.ownerDocument.documentElement,E)){if(P!==null&&_u(E)){var X=P.start,ne=P.end;if(ne===void 0&&(ne=X),"selectionStart"in E)E.selectionStart=X,E.selectionEnd=Math.min(ne,E.value.length);else{var oe=E.ownerDocument||document,Q=oe&&oe.defaultView||window;if(Q.getSelection){var ee=Q.getSelection(),_e=E.textContent.length,Ue=Math.min(P.start,_e),ft=P.end===void 0?Ue:Math.min(P.end,_e);!ee.extend&&Ue>ft&&(w=ft,ft=Ue,Ue=w);var q=xp(E,Ue),$=xp(E,ft);if(q&&$&&(ee.rangeCount!==1||ee.anchorNode!==q.node||ee.anchorOffset!==q.offset||ee.focusNode!==$.node||ee.focusOffset!==$.offset)){var Y=oe.createRange();Y.setStart(q.node,q.offset),ee.removeAllRanges(),Ue>ft?(ee.addRange(Y),ee.extend($.node,$.offset)):(Y.setEnd($.node,$.offset),ee.addRange(Y))}}}}for(oe=[],ee=E;ee=ee.parentNode;)ee.nodeType===1&&oe.push({element:ee,left:ee.scrollLeft,top:ee.scrollTop});for(typeof E.focus=="function"&&E.focus(),E=0;E<oe.length;E++){var ie=oe[E];ie.element.scrollLeft=ie.left,ie.element.scrollTop=ie.top}}oc=!!Wd,eh=Wd=null}finally{lt=h,se.p=c,J.T=l}}t.current=n,Ft=2}}function M0(){if(Ft===2){Ft=0;var t=pa,n=Yr,l=(n.flags&8772)!==0;if((n.subtreeFlags&8772)!==0||l){l=J.T,J.T=null;var c=se.p;se.p=2;var h=lt;lt|=4;try{o0(t,n.alternate,n)}finally{lt=h,se.p=c,J.T=l}}Ft=3}}function U0(){if(Ft===4||Ft===3){Ft=0,pr();var t=pa,n=Yr,l=qn,c=w0;(n.subtreeFlags&10256)!==0||(n.flags&10256)!==0?Ft=5:(Ft=0,Yr=pa=null,L0(t,t.pendingLanes));var h=t.pendingLanes;if(h===0&&(ma=null),St(l),n=n.stateNode,Qt&&typeof Qt.onCommitFiberRoot=="function")try{Qt.onCommitFiberRoot(pn,n,void 0,(n.current.flags&128)===128)}catch{}if(c!==null){n=J.T,h=se.p,se.p=2,J.T=null;try{for(var g=t.onRecoverableError,w=0;w<c.length;w++){var E=c[w];g(E.value,{componentStack:E.stack})}}finally{J.T=n,se.p=h}}(qn&3)!==0&&Jo(),vn(t),h=t.pendingLanes,(l&261930)!==0&&(h&42)!==0?t===zd?rl++:(rl=0,zd=t):rl=0,il(0)}}function L0(t,n){(t.pooledCacheLanes&=n)===0&&(n=t.pooledCache,n!=null&&(t.pooledCache=null,zi(n)))}function Jo(){return O0(),M0(),U0(),P0()}function P0(){if(Ft!==5)return!1;var t=pa,n=Id;Id=0;var l=St(qn),c=J.T,h=se.p;try{se.p=32>l?32:l,J.T=null,l=Bd,Bd=null;var g=pa,w=qn;if(Ft=0,Yr=pa=null,qn=0,(lt&6)!==0)throw Error(i(331));var E=lt;if(lt|=4,b0(g.current),p0(g,g.current,w,l),lt=E,il(0,!1),Qt&&typeof Qt.onPostCommitFiberRoot=="function")try{Qt.onPostCommitFiberRoot(pn,g)}catch{}return!0}finally{se.p=h,J.T=c,L0(t,n)}}function I0(t,n,l){n=$s(l,n),n=bd(t.stateNode,n,2),t=oa(t,n,2),t!==null&&(Ve(t,2),vn(t))}function ut(t,n,l){if(t.tag===3)I0(t,t,l);else for(;n!==null;){if(n.tag===3){I0(n,t,l);break}else if(n.tag===1){var c=n.stateNode;if(typeof n.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(ma===null||!ma.has(c))){t=$s(l,t),l=Bg(2),c=oa(n,l,2),c!==null&&(zg(l,c,n,t),Ve(c,2),vn(c));break}}n=n.return}}function qd(t,n,l){var c=t.pingCache;if(c===null){c=t.pingCache=new tN;var h=new Set;c.set(n,h)}else h=c.get(n),h===void 0&&(h=new Set,c.set(n,h));h.has(l)||(Ud=!0,h.add(l),t=iN.bind(null,t,n,l),n.then(t,t))}function iN(t,n,l){var c=t.pingCache;c!==null&&c.delete(n),t.pingedLanes|=t.suspendedLanes&l,t.warmLanes&=~l,pt===t&&(Je&l)===l&&(Rt===4||Rt===3&&(Je&62914560)===Je&&300>Jt()-Ho?(lt&2)===0&&Xr(t,0):Ld|=l,Kr===Je&&(Kr=0)),vn(t)}function B0(t,n){n===0&&(n=Me()),t=$a(t,n),t!==null&&(Ve(t,n),vn(t))}function lN(t){var n=t.memoizedState,l=0;n!==null&&(l=n.retryLane),B0(t,l)}function oN(t,n){var l=0;switch(t.tag){case 31:case 13:var c=t.stateNode,h=t.memoizedState;h!==null&&(l=h.retryLane);break;case 19:c=t.stateNode;break;case 22:c=t.stateNode._retryCache;break;default:throw Error(i(314))}c!==null&&c.delete(n),B0(t,l)}function cN(t,n){return ot(t,n)}var Qo=null,Qr=null,Hd=!1,Zo=!1,Gd=!1,xa=0;function vn(t){t!==Qr&&t.next===null&&(Qr===null?Qo=Qr=t:Qr=Qr.next=t),Zo=!0,Hd||(Hd=!0,dN())}function il(t,n){if(!Gd&&Zo){Gd=!0;do for(var l=!1,c=Qo;c!==null;){if(t!==0){var h=c.pendingLanes;if(h===0)var g=0;else{var w=c.suspendedLanes,E=c.pingedLanes;g=(1<<31-Ht(42|t)+1)-1,g&=h&~(w&~E),g=g&201326741?g&201326741|1:g?g|2:0}g!==0&&(l=!0,q0(c,g))}else g=Je,g=ue(c,c===pt?g:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(g&3)===0||ge(c,g)||(l=!0,q0(c,g));c=c.next}while(l);Gd=!1}}function uN(){z0()}function z0(){Zo=Hd=!1;var t=0;xa!==0&&wN()&&(t=xa);for(var n=Jt(),l=null,c=Qo;c!==null;){var h=c.next,g=V0(c,n);g===0?(c.next=null,l===null?Qo=h:l.next=h,h===null&&(Qr=l)):(l=c,(t!==0||(g&3)!==0)&&(Zo=!0)),c=h}Ft!==0&&Ft!==5||il(t),xa!==0&&(xa=0)}function V0(t,n){for(var l=t.suspendedLanes,c=t.pingedLanes,h=t.expirationTimes,g=t.pendingLanes&-62914561;0<g;){var w=31-Ht(g),E=1<<w,P=h[w];P===-1?((E&l)===0||(E&c)!==0)&&(h[w]=be(E,n)):P<=n&&(t.expiredLanes|=E),g&=~E}if(n=pt,l=Je,l=ue(t,t===n?l:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),c=t.callbackNode,l===0||t===n&&(ct===2||ct===9)||t.cancelPendingCommit!==null)return c!==null&&c!==null&&ss(c),t.callbackNode=null,t.callbackPriority=0;if((l&3)===0||ge(t,l)){if(n=l&-l,n===t.callbackPriority)return n;switch(c!==null&&ss(c),St(l)){case 2:case 8:l=La;break;case 32:l=kn;break;case 268435456:l=Pa;break;default:l=kn}return c=$0.bind(null,t),l=ot(l,c),t.callbackPriority=n,t.callbackNode=l,n}return c!==null&&c!==null&&ss(c),t.callbackPriority=2,t.callbackNode=null,2}function $0(t,n){if(Ft!==0&&Ft!==5)return t.callbackNode=null,t.callbackPriority=0,null;var l=t.callbackNode;if(Jo()&&t.callbackNode!==l)return null;var c=Je;return c=ue(t,t===pt?c:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),c===0?null:(N0(t,c,n),V0(t,Jt()),t.callbackNode!=null&&t.callbackNode===l?$0.bind(null,t):null)}function q0(t,n){if(Jo())return null;N0(t,n,!0)}function dN(){NN(function(){(lt&6)!==0?ot(Ua,uN):z0()})}function Fd(){if(xa===0){var t=Lr;t===0&&(t=U,U<<=1,(U&261888)===0&&(U=256)),xa=t}return xa}function H0(t){return t==null||typeof t=="symbol"||typeof t=="boolean"?null:typeof t=="function"?t:ro(""+t)}function G0(t,n){var l=n.ownerDocument.createElement("input");return l.name=n.name,l.value=n.value,t.id&&l.setAttribute("form",t.id),n.parentNode.insertBefore(l,n),t=new FormData(t),l.parentNode.removeChild(l),t}function hN(t,n,l,c,h){if(n==="submit"&&l&&l.stateNode===h){var g=H0((h[ys]||null).action),w=c.submitter;w&&(n=(n=w[ys]||null)?H0(n.formAction):w.getAttribute("formAction"),n!==null&&(g=n,w=null));var E=new co("action","action",null,c,h);t.push({event:E,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(xa!==0){var P=w?G0(h,w):new FormData(h);hd(l,{pending:!0,data:P,method:h.method,action:g},null,P)}}else typeof g=="function"&&(E.preventDefault(),P=w?G0(h,w):new FormData(h),hd(l,{pending:!0,data:P,method:h.method,action:g},g,P))},currentTarget:h}]})}}for(var Kd=0;Kd<Cu.length;Kd++){var Yd=Cu[Kd],fN=Yd.toLowerCase(),mN=Yd[0].toUpperCase()+Yd.slice(1);Zs(fN,"on"+mN)}Zs(jp,"onAnimationEnd"),Zs(Np,"onAnimationIteration"),Zs(Sp,"onAnimationStart"),Zs("dblclick","onDoubleClick"),Zs("focusin","onFocus"),Zs("focusout","onBlur"),Zs(A1,"onTransitionRun"),Zs(R1,"onTransitionStart"),Zs(D1,"onTransitionCancel"),Zs(_p,"onTransitionEnd"),jr("onMouseEnter",["mouseout","mouseover"]),jr("onMouseLeave",["mouseout","mouseover"]),jr("onPointerEnter",["pointerout","pointerover"]),jr("onPointerLeave",["pointerout","pointerover"]),Ia("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ia("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ia("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ia("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ia("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ia("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ll="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),pN=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(ll));function F0(t,n){n=(n&4)!==0;for(var l=0;l<t.length;l++){var c=t[l],h=c.event;c=c.listeners;e:{var g=void 0;if(n)for(var w=c.length-1;0<=w;w--){var E=c[w],P=E.instance,X=E.currentTarget;if(E=E.listener,P!==g&&h.isPropagationStopped())break e;g=E,h.currentTarget=X;try{g(h)}catch(ne){fo(ne)}h.currentTarget=null,g=P}else for(w=0;w<c.length;w++){if(E=c[w],P=E.instance,X=E.currentTarget,E=E.listener,P!==g&&h.isPropagationStopped())break e;g=E,h.currentTarget=X;try{g(h)}catch(ne){fo(ne)}h.currentTarget=null,g=P}}}}function Ke(t,n){var l=n[lu];l===void 0&&(l=n[lu]=new Set);var c=t+"__bubble";l.has(c)||(K0(n,t,2,!1),l.add(c))}function Xd(t,n,l){var c=0;n&&(c|=4),K0(l,t,c,n)}var Wo="_reactListening"+Math.random().toString(36).slice(2);function Jd(t){if(!t[Wo]){t[Wo]=!0,zm.forEach(function(l){l!=="selectionchange"&&(pN.has(l)||Xd(l,!1,t),Xd(l,!0,t))});var n=t.nodeType===9?t:t.ownerDocument;n===null||n[Wo]||(n[Wo]=!0,Xd("selectionchange",!1,n))}}function K0(t,n,l,c){switch(jx(n)){case 2:var h=qN;break;case 8:h=HN;break;default:h=dh}l=h.bind(null,n,l,t),h=void 0,!gu||n!=="touchstart"&&n!=="touchmove"&&n!=="wheel"||(h=!0),c?h!==void 0?t.addEventListener(n,l,{capture:!0,passive:h}):t.addEventListener(n,l,!0):h!==void 0?t.addEventListener(n,l,{passive:h}):t.addEventListener(n,l,!1)}function Qd(t,n,l,c,h){var g=c;if((n&1)===0&&(n&2)===0&&c!==null)e:for(;;){if(c===null)return;var w=c.tag;if(w===3||w===4){var E=c.stateNode.containerInfo;if(E===h)break;if(w===4)for(w=c.return;w!==null;){var P=w.tag;if((P===3||P===4)&&w.stateNode.containerInfo===h)return;w=w.return}for(;E!==null;){if(w=yr(E),w===null)return;if(P=w.tag,P===5||P===6||P===26||P===27){c=g=w;continue e}E=E.parentNode}}c=c.return}Zm(function(){var X=g,ne=mu(l),oe=[];e:{var Q=kp.get(t);if(Q!==void 0){var ee=co,_e=t;switch(t){case"keypress":if(lo(l)===0)break e;case"keydown":case"keyup":ee=o1;break;case"focusin":_e="focus",ee=vu;break;case"focusout":_e="blur",ee=vu;break;case"beforeblur":case"afterblur":ee=vu;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ee=tp;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ee=Jj;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ee=d1;break;case jp:case Np:case Sp:ee=Wj;break;case _p:ee=f1;break;case"scroll":case"scrollend":ee=Yj;break;case"wheel":ee=p1;break;case"copy":case"cut":case"paste":ee=t1;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ee=np;break;case"toggle":case"beforetoggle":ee=x1}var Ue=(n&4)!==0,ft=!Ue&&(t==="scroll"||t==="scrollend"),q=Ue?Q!==null?Q+"Capture":null:Q;Ue=[];for(var $=X,Y;$!==null;){var ie=$;if(Y=ie.stateNode,ie=ie.tag,ie!==5&&ie!==26&&ie!==27||Y===null||q===null||(ie=Ci($,q),ie!=null&&Ue.push(ol($,ie,Y))),ft)break;$=$.return}0<Ue.length&&(Q=new ee(Q,_e,null,l,ne),oe.push({event:Q,listeners:Ue}))}}if((n&7)===0){e:{if(Q=t==="mouseover"||t==="pointerover",ee=t==="mouseout"||t==="pointerout",Q&&l!==fu&&(_e=l.relatedTarget||l.fromElement)&&(yr(_e)||_e[br]))break e;if((ee||Q)&&(Q=ne.window===ne?ne:(Q=ne.ownerDocument)?Q.defaultView||Q.parentWindow:window,ee?(_e=l.relatedTarget||l.toElement,ee=X,_e=_e?yr(_e):null,_e!==null&&(ft=u(_e),Ue=_e.tag,_e!==ft||Ue!==5&&Ue!==27&&Ue!==6)&&(_e=null)):(ee=null,_e=X),ee!==_e)){if(Ue=tp,ie="onMouseLeave",q="onMouseEnter",$="mouse",(t==="pointerout"||t==="pointerover")&&(Ue=np,ie="onPointerLeave",q="onPointerEnter",$="pointer"),ft=ee==null?Q:Ei(ee),Y=_e==null?Q:Ei(_e),Q=new Ue(ie,$+"leave",ee,l,ne),Q.target=ft,Q.relatedTarget=Y,ie=null,yr(ne)===X&&(Ue=new Ue(q,$+"enter",_e,l,ne),Ue.target=Y,Ue.relatedTarget=ft,ie=Ue),ft=ie,ee&&_e)t:{for(Ue=gN,q=ee,$=_e,Y=0,ie=q;ie;ie=Ue(ie))Y++;ie=0;for(var De=$;De;De=Ue(De))ie++;for(;0<Y-ie;)q=Ue(q),Y--;for(;0<ie-Y;)$=Ue($),ie--;for(;Y--;){if(q===$||$!==null&&q===$.alternate){Ue=q;break t}q=Ue(q),$=Ue($)}Ue=null}else Ue=null;ee!==null&&Y0(oe,Q,ee,Ue,!1),_e!==null&&ft!==null&&Y0(oe,ft,_e,Ue,!0)}}e:{if(Q=X?Ei(X):window,ee=Q.nodeName&&Q.nodeName.toLowerCase(),ee==="select"||ee==="input"&&Q.type==="file")var at=dp;else if(cp(Q))if(hp)at=T1;else{at=_1;var Te=S1}else ee=Q.nodeName,!ee||ee.toLowerCase()!=="input"||Q.type!=="checkbox"&&Q.type!=="radio"?X&&hu(X.elementType)&&(at=dp):at=k1;if(at&&(at=at(t,X))){up(oe,at,l,ne);break e}Te&&Te(t,Q,X),t==="focusout"&&X&&Q.type==="number"&&X.memoizedProps.value!=null&&du(Q,"number",Q.value)}switch(Te=X?Ei(X):window,t){case"focusin":(cp(Te)||Te.contentEditable==="true")&&(Er=Te,ku=X,Pi=null);break;case"focusout":Pi=ku=Er=null;break;case"mousedown":Tu=!0;break;case"contextmenu":case"mouseup":case"dragend":Tu=!1,vp(oe,l,ne);break;case"selectionchange":if(C1)break;case"keydown":case"keyup":vp(oe,l,ne)}var Ge;if(ju)e:{switch(t){case"compositionstart":var Qe="onCompositionStart";break e;case"compositionend":Qe="onCompositionEnd";break e;case"compositionupdate":Qe="onCompositionUpdate";break e}Qe=void 0}else Tr?lp(t,l)&&(Qe="onCompositionEnd"):t==="keydown"&&l.keyCode===229&&(Qe="onCompositionStart");Qe&&(ap&&l.locale!=="ko"&&(Tr||Qe!=="onCompositionStart"?Qe==="onCompositionEnd"&&Tr&&(Ge=Wm()):(ta=ne,xu="value"in ta?ta.value:ta.textContent,Tr=!0)),Te=ec(X,Qe),0<Te.length&&(Qe=new sp(Qe,t,null,l,ne),oe.push({event:Qe,listeners:Te}),Ge?Qe.data=Ge:(Ge=op(l),Ge!==null&&(Qe.data=Ge)))),(Ge=y1?v1(t,l):w1(t,l))&&(Qe=ec(X,"onBeforeInput"),0<Qe.length&&(Te=new sp("onBeforeInput","beforeinput",null,l,ne),oe.push({event:Te,listeners:Qe}),Te.data=Ge)),hN(oe,t,X,l,ne)}F0(oe,n)})}function ol(t,n,l){return{instance:t,listener:n,currentTarget:l}}function ec(t,n){for(var l=n+"Capture",c=[];t!==null;){var h=t,g=h.stateNode;if(h=h.tag,h!==5&&h!==26&&h!==27||g===null||(h=Ci(t,l),h!=null&&c.unshift(ol(t,h,g)),h=Ci(t,n),h!=null&&c.push(ol(t,h,g))),t.tag===3)return c;t=t.return}return[]}function gN(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5&&t.tag!==27);return t||null}function Y0(t,n,l,c,h){for(var g=n._reactName,w=[];l!==null&&l!==c;){var E=l,P=E.alternate,X=E.stateNode;if(E=E.tag,P!==null&&P===c)break;E!==5&&E!==26&&E!==27||X===null||(P=X,h?(X=Ci(l,g),X!=null&&w.unshift(ol(l,X,P))):h||(X=Ci(l,g),X!=null&&w.push(ol(l,X,P)))),l=l.return}w.length!==0&&t.push({event:n,listeners:w})}var xN=/\r\n?/g,bN=/\u0000|\uFFFD/g;function X0(t){return(typeof t=="string"?t:""+t).replace(xN,`
`).replace(bN,"")}function J0(t,n){return n=X0(n),X0(t)===n}function ht(t,n,l,c,h,g){switch(l){case"children":typeof c=="string"?n==="body"||n==="textarea"&&c===""||Sr(t,c):(typeof c=="number"||typeof c=="bigint")&&n!=="body"&&Sr(t,""+c);break;case"className":no(t,"class",c);break;case"tabIndex":no(t,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":no(t,l,c);break;case"style":Jm(t,c,g);break;case"data":if(n!=="object"){no(t,"data",c);break}case"src":case"href":if(c===""&&(n!=="a"||l!=="href")){t.removeAttribute(l);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){t.removeAttribute(l);break}c=ro(""+c),t.setAttribute(l,c);break;case"action":case"formAction":if(typeof c=="function"){t.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof g=="function"&&(l==="formAction"?(n!=="input"&&ht(t,n,"name",h.name,h,null),ht(t,n,"formEncType",h.formEncType,h,null),ht(t,n,"formMethod",h.formMethod,h,null),ht(t,n,"formTarget",h.formTarget,h,null)):(ht(t,n,"encType",h.encType,h,null),ht(t,n,"method",h.method,h,null),ht(t,n,"target",h.target,h,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){t.removeAttribute(l);break}c=ro(""+c),t.setAttribute(l,c);break;case"onClick":c!=null&&(t.onclick=En);break;case"onScroll":c!=null&&Ke("scroll",t);break;case"onScrollEnd":c!=null&&Ke("scrollend",t);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(l=c.__html,l!=null){if(h.children!=null)throw Error(i(60));t.innerHTML=l}}break;case"multiple":t.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":t.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){t.removeAttribute("xlink:href");break}l=ro(""+c),t.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?t.setAttribute(l,""+c):t.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?t.setAttribute(l,""):t.removeAttribute(l);break;case"capture":case"download":c===!0?t.setAttribute(l,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?t.setAttribute(l,c):t.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?t.setAttribute(l,c):t.removeAttribute(l);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?t.removeAttribute(l):t.setAttribute(l,c);break;case"popover":Ke("beforetoggle",t),Ke("toggle",t),so(t,"popover",c);break;case"xlinkActuate":Tn(t,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":Tn(t,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":Tn(t,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":Tn(t,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":Tn(t,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":Tn(t,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":Tn(t,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":Tn(t,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":Tn(t,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":so(t,"is",c);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=Fj.get(l)||l,so(t,l,c))}}function Zd(t,n,l,c,h,g){switch(l){case"style":Jm(t,c,g);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(l=c.__html,l!=null){if(h.children!=null)throw Error(i(60));t.innerHTML=l}}break;case"children":typeof c=="string"?Sr(t,c):(typeof c=="number"||typeof c=="bigint")&&Sr(t,""+c);break;case"onScroll":c!=null&&Ke("scroll",t);break;case"onScrollEnd":c!=null&&Ke("scrollend",t);break;case"onClick":c!=null&&(t.onclick=En);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Vm.hasOwnProperty(l))e:{if(l[0]==="o"&&l[1]==="n"&&(h=l.endsWith("Capture"),n=l.slice(2,h?l.length-7:void 0),g=t[ys]||null,g=g!=null?g[l]:null,typeof g=="function"&&t.removeEventListener(n,g,h),typeof c=="function")){typeof g!="function"&&g!==null&&(l in t?t[l]=null:t.hasAttribute(l)&&t.removeAttribute(l)),t.addEventListener(n,c,h);break e}l in t?t[l]=c:c===!0?t.setAttribute(l,""):so(t,l,c)}}}function ls(t,n,l){switch(n){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ke("error",t),Ke("load",t);var c=!1,h=!1,g;for(g in l)if(l.hasOwnProperty(g)){var w=l[g];if(w!=null)switch(g){case"src":c=!0;break;case"srcSet":h=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,n));default:ht(t,n,g,w,l,null)}}h&&ht(t,n,"srcSet",l.srcSet,l,null),c&&ht(t,n,"src",l.src,l,null);return;case"input":Ke("invalid",t);var E=g=w=h=null,P=null,X=null;for(c in l)if(l.hasOwnProperty(c)){var ne=l[c];if(ne!=null)switch(c){case"name":h=ne;break;case"type":w=ne;break;case"checked":P=ne;break;case"defaultChecked":X=ne;break;case"value":g=ne;break;case"defaultValue":E=ne;break;case"children":case"dangerouslySetInnerHTML":if(ne!=null)throw Error(i(137,n));break;default:ht(t,n,c,ne,l,null)}}Fm(t,g,E,P,X,w,h,!1);return;case"select":Ke("invalid",t),c=w=g=null;for(h in l)if(l.hasOwnProperty(h)&&(E=l[h],E!=null))switch(h){case"value":g=E;break;case"defaultValue":w=E;break;case"multiple":c=E;default:ht(t,n,h,E,l,null)}n=g,l=w,t.multiple=!!c,n!=null?Nr(t,!!c,n,!1):l!=null&&Nr(t,!!c,l,!0);return;case"textarea":Ke("invalid",t),g=h=c=null;for(w in l)if(l.hasOwnProperty(w)&&(E=l[w],E!=null))switch(w){case"value":c=E;break;case"defaultValue":h=E;break;case"children":g=E;break;case"dangerouslySetInnerHTML":if(E!=null)throw Error(i(91));break;default:ht(t,n,w,E,l,null)}Ym(t,c,h,g);return;case"option":for(P in l)l.hasOwnProperty(P)&&(c=l[P],c!=null)&&(P==="selected"?t.selected=c&&typeof c!="function"&&typeof c!="symbol":ht(t,n,P,c,l,null));return;case"dialog":Ke("beforetoggle",t),Ke("toggle",t),Ke("cancel",t),Ke("close",t);break;case"iframe":case"object":Ke("load",t);break;case"video":case"audio":for(c=0;c<ll.length;c++)Ke(ll[c],t);break;case"image":Ke("error",t),Ke("load",t);break;case"details":Ke("toggle",t);break;case"embed":case"source":case"link":Ke("error",t),Ke("load",t);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(X in l)if(l.hasOwnProperty(X)&&(c=l[X],c!=null))switch(X){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,n));default:ht(t,n,X,c,l,null)}return;default:if(hu(n)){for(ne in l)l.hasOwnProperty(ne)&&(c=l[ne],c!==void 0&&Zd(t,n,ne,c,l,void 0));return}}for(E in l)l.hasOwnProperty(E)&&(c=l[E],c!=null&&ht(t,n,E,c,l,null))}function yN(t,n,l,c){switch(n){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var h=null,g=null,w=null,E=null,P=null,X=null,ne=null;for(ee in l){var oe=l[ee];if(l.hasOwnProperty(ee)&&oe!=null)switch(ee){case"checked":break;case"value":break;case"defaultValue":P=oe;default:c.hasOwnProperty(ee)||ht(t,n,ee,null,c,oe)}}for(var Q in c){var ee=c[Q];if(oe=l[Q],c.hasOwnProperty(Q)&&(ee!=null||oe!=null))switch(Q){case"type":g=ee;break;case"name":h=ee;break;case"checked":X=ee;break;case"defaultChecked":ne=ee;break;case"value":w=ee;break;case"defaultValue":E=ee;break;case"children":case"dangerouslySetInnerHTML":if(ee!=null)throw Error(i(137,n));break;default:ee!==oe&&ht(t,n,Q,ee,c,oe)}}uu(t,w,E,P,X,ne,g,h);return;case"select":ee=w=E=Q=null;for(g in l)if(P=l[g],l.hasOwnProperty(g)&&P!=null)switch(g){case"value":break;case"multiple":ee=P;default:c.hasOwnProperty(g)||ht(t,n,g,null,c,P)}for(h in c)if(g=c[h],P=l[h],c.hasOwnProperty(h)&&(g!=null||P!=null))switch(h){case"value":Q=g;break;case"defaultValue":E=g;break;case"multiple":w=g;default:g!==P&&ht(t,n,h,g,c,P)}n=E,l=w,c=ee,Q!=null?Nr(t,!!l,Q,!1):!!c!=!!l&&(n!=null?Nr(t,!!l,n,!0):Nr(t,!!l,l?[]:"",!1));return;case"textarea":ee=Q=null;for(E in l)if(h=l[E],l.hasOwnProperty(E)&&h!=null&&!c.hasOwnProperty(E))switch(E){case"value":break;case"children":break;default:ht(t,n,E,null,c,h)}for(w in c)if(h=c[w],g=l[w],c.hasOwnProperty(w)&&(h!=null||g!=null))switch(w){case"value":Q=h;break;case"defaultValue":ee=h;break;case"children":break;case"dangerouslySetInnerHTML":if(h!=null)throw Error(i(91));break;default:h!==g&&ht(t,n,w,h,c,g)}Km(t,Q,ee);return;case"option":for(var _e in l)Q=l[_e],l.hasOwnProperty(_e)&&Q!=null&&!c.hasOwnProperty(_e)&&(_e==="selected"?t.selected=!1:ht(t,n,_e,null,c,Q));for(P in c)Q=c[P],ee=l[P],c.hasOwnProperty(P)&&Q!==ee&&(Q!=null||ee!=null)&&(P==="selected"?t.selected=Q&&typeof Q!="function"&&typeof Q!="symbol":ht(t,n,P,Q,c,ee));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ue in l)Q=l[Ue],l.hasOwnProperty(Ue)&&Q!=null&&!c.hasOwnProperty(Ue)&&ht(t,n,Ue,null,c,Q);for(X in c)if(Q=c[X],ee=l[X],c.hasOwnProperty(X)&&Q!==ee&&(Q!=null||ee!=null))switch(X){case"children":case"dangerouslySetInnerHTML":if(Q!=null)throw Error(i(137,n));break;default:ht(t,n,X,Q,c,ee)}return;default:if(hu(n)){for(var ft in l)Q=l[ft],l.hasOwnProperty(ft)&&Q!==void 0&&!c.hasOwnProperty(ft)&&Zd(t,n,ft,void 0,c,Q);for(ne in c)Q=c[ne],ee=l[ne],!c.hasOwnProperty(ne)||Q===ee||Q===void 0&&ee===void 0||Zd(t,n,ne,Q,c,ee);return}}for(var q in l)Q=l[q],l.hasOwnProperty(q)&&Q!=null&&!c.hasOwnProperty(q)&&ht(t,n,q,null,c,Q);for(oe in c)Q=c[oe],ee=l[oe],!c.hasOwnProperty(oe)||Q===ee||Q==null&&ee==null||ht(t,n,oe,Q,c,ee)}function Q0(t){switch(t){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function vN(){if(typeof performance.getEntriesByType=="function"){for(var t=0,n=0,l=performance.getEntriesByType("resource"),c=0;c<l.length;c++){var h=l[c],g=h.transferSize,w=h.initiatorType,E=h.duration;if(g&&E&&Q0(w)){for(w=0,E=h.responseEnd,c+=1;c<l.length;c++){var P=l[c],X=P.startTime;if(X>E)break;var ne=P.transferSize,oe=P.initiatorType;ne&&Q0(oe)&&(P=P.responseEnd,w+=ne*(P<E?1:(E-X)/(P-X)))}if(--c,n+=8*(g+w)/(h.duration/1e3),t++,10<t)break}}if(0<t)return n/t/1e6}return navigator.connection&&(t=navigator.connection.downlink,typeof t=="number")?t:5}var Wd=null,eh=null;function tc(t){return t.nodeType===9?t:t.ownerDocument}function Z0(t){switch(t){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function W0(t,n){if(t===0)switch(n){case"svg":return 1;case"math":return 2;default:return 0}return t===1&&n==="foreignObject"?0:t}function th(t,n){return t==="textarea"||t==="noscript"||typeof n.children=="string"||typeof n.children=="number"||typeof n.children=="bigint"||typeof n.dangerouslySetInnerHTML=="object"&&n.dangerouslySetInnerHTML!==null&&n.dangerouslySetInnerHTML.__html!=null}var sh=null;function wN(){var t=window.event;return t&&t.type==="popstate"?t===sh?!1:(sh=t,!0):(sh=null,!1)}var ex=typeof setTimeout=="function"?setTimeout:void 0,jN=typeof clearTimeout=="function"?clearTimeout:void 0,tx=typeof Promise=="function"?Promise:void 0,NN=typeof queueMicrotask=="function"?queueMicrotask:typeof tx<"u"?function(t){return tx.resolve(null).then(t).catch(SN)}:ex;function SN(t){setTimeout(function(){throw t})}function ba(t){return t==="head"}function sx(t,n){var l=n,c=0;do{var h=l.nextSibling;if(t.removeChild(l),h&&h.nodeType===8)if(l=h.data,l==="/$"||l==="/&"){if(c===0){t.removeChild(h),ti(n);return}c--}else if(l==="$"||l==="$?"||l==="$~"||l==="$!"||l==="&")c++;else if(l==="html")cl(t.ownerDocument.documentElement);else if(l==="head"){l=t.ownerDocument.head,cl(l);for(var g=l.firstChild;g;){var w=g.nextSibling,E=g.nodeName;g[Ti]||E==="SCRIPT"||E==="STYLE"||E==="LINK"&&g.rel.toLowerCase()==="stylesheet"||l.removeChild(g),g=w}}else l==="body"&&cl(t.ownerDocument.body);l=h}while(l);ti(n)}function nx(t,n){var l=t;t=0;do{var c=l.nextSibling;if(l.nodeType===1?n?(l._stashedDisplay=l.style.display,l.style.display="none"):(l.style.display=l._stashedDisplay||"",l.getAttribute("style")===""&&l.removeAttribute("style")):l.nodeType===3&&(n?(l._stashedText=l.nodeValue,l.nodeValue=""):l.nodeValue=l._stashedText||""),c&&c.nodeType===8)if(l=c.data,l==="/$"){if(t===0)break;t--}else l!=="$"&&l!=="$?"&&l!=="$~"&&l!=="$!"||t++;l=c}while(l)}function nh(t){var n=t.firstChild;for(n&&n.nodeType===10&&(n=n.nextSibling);n;){var l=n;switch(n=n.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":nh(l),ou(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}t.removeChild(l)}}function _N(t,n,l,c){for(;t.nodeType===1;){var h=l;if(t.nodeName.toLowerCase()!==n.toLowerCase()){if(!c&&(t.nodeName!=="INPUT"||t.type!=="hidden"))break}else if(c){if(!t[Ti])switch(n){case"meta":if(!t.hasAttribute("itemprop"))break;return t;case"link":if(g=t.getAttribute("rel"),g==="stylesheet"&&t.hasAttribute("data-precedence"))break;if(g!==h.rel||t.getAttribute("href")!==(h.href==null||h.href===""?null:h.href)||t.getAttribute("crossorigin")!==(h.crossOrigin==null?null:h.crossOrigin)||t.getAttribute("title")!==(h.title==null?null:h.title))break;return t;case"style":if(t.hasAttribute("data-precedence"))break;return t;case"script":if(g=t.getAttribute("src"),(g!==(h.src==null?null:h.src)||t.getAttribute("type")!==(h.type==null?null:h.type)||t.getAttribute("crossorigin")!==(h.crossOrigin==null?null:h.crossOrigin))&&g&&t.hasAttribute("async")&&!t.hasAttribute("itemprop"))break;return t;default:return t}}else if(n==="input"&&t.type==="hidden"){var g=h.name==null?null:""+h.name;if(h.type==="hidden"&&t.getAttribute("name")===g)return t}else return t;if(t=Ks(t.nextSibling),t===null)break}return null}function kN(t,n,l){if(n==="")return null;for(;t.nodeType!==3;)if((t.nodeType!==1||t.nodeName!=="INPUT"||t.type!=="hidden")&&!l||(t=Ks(t.nextSibling),t===null))return null;return t}function ax(t,n){for(;t.nodeType!==8;)if((t.nodeType!==1||t.nodeName!=="INPUT"||t.type!=="hidden")&&!n||(t=Ks(t.nextSibling),t===null))return null;return t}function ah(t){return t.data==="$?"||t.data==="$~"}function rh(t){return t.data==="$!"||t.data==="$?"&&t.ownerDocument.readyState!=="loading"}function TN(t,n){var l=t.ownerDocument;if(t.data==="$~")t._reactRetry=n;else if(t.data!=="$?"||l.readyState!=="loading")n();else{var c=function(){n(),l.removeEventListener("DOMContentLoaded",c)};l.addEventListener("DOMContentLoaded",c),t._reactRetry=c}}function Ks(t){for(;t!=null;t=t.nextSibling){var n=t.nodeType;if(n===1||n===3)break;if(n===8){if(n=t.data,n==="$"||n==="$!"||n==="$?"||n==="$~"||n==="&"||n==="F!"||n==="F")break;if(n==="/$"||n==="/&")return null}}return t}var ih=null;function rx(t){t=t.nextSibling;for(var n=0;t;){if(t.nodeType===8){var l=t.data;if(l==="/$"||l==="/&"){if(n===0)return Ks(t.nextSibling);n--}else l!=="$"&&l!=="$!"&&l!=="$?"&&l!=="$~"&&l!=="&"||n++}t=t.nextSibling}return null}function ix(t){t=t.previousSibling;for(var n=0;t;){if(t.nodeType===8){var l=t.data;if(l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"){if(n===0)return t;n--}else l!=="/$"&&l!=="/&"||n++}t=t.previousSibling}return null}function lx(t,n,l){switch(n=tc(l),t){case"html":if(t=n.documentElement,!t)throw Error(i(452));return t;case"head":if(t=n.head,!t)throw Error(i(453));return t;case"body":if(t=n.body,!t)throw Error(i(454));return t;default:throw Error(i(451))}}function cl(t){for(var n=t.attributes;n.length;)t.removeAttributeNode(n[0]);ou(t)}var Ys=new Map,ox=new Set;function sc(t){return typeof t.getRootNode=="function"?t.getRootNode():t.nodeType===9?t:t.ownerDocument}var Hn=se.d;se.d={f:EN,r:CN,D:AN,C:RN,L:DN,m:ON,X:UN,S:MN,M:LN};function EN(){var t=Hn.f(),n=Ko();return t||n}function CN(t){var n=vr(t);n!==null&&n.tag===5&&n.type==="form"?_g(n):Hn.r(t)}var Zr=typeof document>"u"?null:document;function cx(t,n,l){var c=Zr;if(c&&typeof n=="string"&&n){var h=zs(n);h='link[rel="'+t+'"][href="'+h+'"]',typeof l=="string"&&(h+='[crossorigin="'+l+'"]'),ox.has(h)||(ox.add(h),t={rel:t,crossOrigin:l,href:n},c.querySelector(h)===null&&(n=c.createElement("link"),ls(n,"link",t),Zt(n),c.head.appendChild(n)))}}function AN(t){Hn.D(t),cx("dns-prefetch",t,null)}function RN(t,n){Hn.C(t,n),cx("preconnect",t,n)}function DN(t,n,l){Hn.L(t,n,l);var c=Zr;if(c&&t&&n){var h='link[rel="preload"][as="'+zs(n)+'"]';n==="image"&&l&&l.imageSrcSet?(h+='[imagesrcset="'+zs(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(h+='[imagesizes="'+zs(l.imageSizes)+'"]')):h+='[href="'+zs(t)+'"]';var g=h;switch(n){case"style":g=Wr(t);break;case"script":g=ei(t)}Ys.has(g)||(t=b({rel:"preload",href:n==="image"&&l&&l.imageSrcSet?void 0:t,as:n},l),Ys.set(g,t),c.querySelector(h)!==null||n==="style"&&c.querySelector(ul(g))||n==="script"&&c.querySelector(dl(g))||(n=c.createElement("link"),ls(n,"link",t),Zt(n),c.head.appendChild(n)))}}function ON(t,n){Hn.m(t,n);var l=Zr;if(l&&t){var c=n&&typeof n.as=="string"?n.as:"script",h='link[rel="modulepreload"][as="'+zs(c)+'"][href="'+zs(t)+'"]',g=h;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":g=ei(t)}if(!Ys.has(g)&&(t=b({rel:"modulepreload",href:t},n),Ys.set(g,t),l.querySelector(h)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(dl(g)))return}c=l.createElement("link"),ls(c,"link",t),Zt(c),l.head.appendChild(c)}}}function MN(t,n,l){Hn.S(t,n,l);var c=Zr;if(c&&t){var h=wr(c).hoistableStyles,g=Wr(t);n=n||"default";var w=h.get(g);if(!w){var E={loading:0,preload:null};if(w=c.querySelector(ul(g)))E.loading=5;else{t=b({rel:"stylesheet",href:t,"data-precedence":n},l),(l=Ys.get(g))&&lh(t,l);var P=w=c.createElement("link");Zt(P),ls(P,"link",t),P._p=new Promise(function(X,ne){P.onload=X,P.onerror=ne}),P.addEventListener("load",function(){E.loading|=1}),P.addEventListener("error",function(){E.loading|=2}),E.loading|=4,nc(w,n,c)}w={type:"stylesheet",instance:w,count:1,state:E},h.set(g,w)}}}function UN(t,n){Hn.X(t,n);var l=Zr;if(l&&t){var c=wr(l).hoistableScripts,h=ei(t),g=c.get(h);g||(g=l.querySelector(dl(h)),g||(t=b({src:t,async:!0},n),(n=Ys.get(h))&&oh(t,n),g=l.createElement("script"),Zt(g),ls(g,"link",t),l.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},c.set(h,g))}}function LN(t,n){Hn.M(t,n);var l=Zr;if(l&&t){var c=wr(l).hoistableScripts,h=ei(t),g=c.get(h);g||(g=l.querySelector(dl(h)),g||(t=b({src:t,async:!0,type:"module"},n),(n=Ys.get(h))&&oh(t,n),g=l.createElement("script"),Zt(g),ls(g,"link",t),l.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},c.set(h,g))}}function ux(t,n,l,c){var h=(h=ae.current)?sc(h):null;if(!h)throw Error(i(446));switch(t){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(n=Wr(l.href),l=wr(h).hoistableStyles,c=l.get(n),c||(c={type:"style",instance:null,count:0,state:null},l.set(n,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){t=Wr(l.href);var g=wr(h).hoistableStyles,w=g.get(t);if(w||(h=h.ownerDocument||h,w={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},g.set(t,w),(g=h.querySelector(ul(t)))&&!g._p&&(w.instance=g,w.state.loading=5),Ys.has(t)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},Ys.set(t,l),g||PN(h,t,l,w.state))),n&&c===null)throw Error(i(528,""));return w}if(n&&c!==null)throw Error(i(529,""));return null;case"script":return n=l.async,l=l.src,typeof l=="string"&&n&&typeof n!="function"&&typeof n!="symbol"?(n=ei(l),l=wr(h).hoistableScripts,c=l.get(n),c||(c={type:"script",instance:null,count:0,state:null},l.set(n,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,t))}}function Wr(t){return'href="'+zs(t)+'"'}function ul(t){return'link[rel="stylesheet"]['+t+"]"}function dx(t){return b({},t,{"data-precedence":t.precedence,precedence:null})}function PN(t,n,l,c){t.querySelector('link[rel="preload"][as="style"]['+n+"]")?c.loading=1:(n=t.createElement("link"),c.preload=n,n.addEventListener("load",function(){return c.loading|=1}),n.addEventListener("error",function(){return c.loading|=2}),ls(n,"link",l),Zt(n),t.head.appendChild(n))}function ei(t){return'[src="'+zs(t)+'"]'}function dl(t){return"script[async]"+t}function hx(t,n,l){if(n.count++,n.instance===null)switch(n.type){case"style":var c=t.querySelector('style[data-href~="'+zs(l.href)+'"]');if(c)return n.instance=c,Zt(c),c;var h=b({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return c=(t.ownerDocument||t).createElement("style"),Zt(c),ls(c,"style",h),nc(c,l.precedence,t),n.instance=c;case"stylesheet":h=Wr(l.href);var g=t.querySelector(ul(h));if(g)return n.state.loading|=4,n.instance=g,Zt(g),g;c=dx(l),(h=Ys.get(h))&&lh(c,h),g=(t.ownerDocument||t).createElement("link"),Zt(g);var w=g;return w._p=new Promise(function(E,P){w.onload=E,w.onerror=P}),ls(g,"link",c),n.state.loading|=4,nc(g,l.precedence,t),n.instance=g;case"script":return g=ei(l.src),(h=t.querySelector(dl(g)))?(n.instance=h,Zt(h),h):(c=l,(h=Ys.get(g))&&(c=b({},l),oh(c,h)),t=t.ownerDocument||t,h=t.createElement("script"),Zt(h),ls(h,"link",c),t.head.appendChild(h),n.instance=h);case"void":return null;default:throw Error(i(443,n.type))}else n.type==="stylesheet"&&(n.state.loading&4)===0&&(c=n.instance,n.state.loading|=4,nc(c,l.precedence,t));return n.instance}function nc(t,n,l){for(var c=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),h=c.length?c[c.length-1]:null,g=h,w=0;w<c.length;w++){var E=c[w];if(E.dataset.precedence===n)g=E;else if(g!==h)break}g?g.parentNode.insertBefore(t,g.nextSibling):(n=l.nodeType===9?l.head:l,n.insertBefore(t,n.firstChild))}function lh(t,n){t.crossOrigin==null&&(t.crossOrigin=n.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=n.referrerPolicy),t.title==null&&(t.title=n.title)}function oh(t,n){t.crossOrigin==null&&(t.crossOrigin=n.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=n.referrerPolicy),t.integrity==null&&(t.integrity=n.integrity)}var ac=null;function fx(t,n,l){if(ac===null){var c=new Map,h=ac=new Map;h.set(l,c)}else h=ac,c=h.get(l),c||(c=new Map,h.set(l,c));if(c.has(t))return c;for(c.set(t,null),l=l.getElementsByTagName(t),h=0;h<l.length;h++){var g=l[h];if(!(g[Ti]||g[ns]||t==="link"&&g.getAttribute("rel")==="stylesheet")&&g.namespaceURI!=="http://www.w3.org/2000/svg"){var w=g.getAttribute(n)||"";w=t+w;var E=c.get(w);E?E.push(g):c.set(w,[g])}}return c}function mx(t,n,l){t=t.ownerDocument||t,t.head.insertBefore(l,n==="title"?t.querySelector("head > title"):null)}function IN(t,n,l){if(l===1||n.itemProp!=null)return!1;switch(t){case"meta":case"title":return!0;case"style":if(typeof n.precedence!="string"||typeof n.href!="string"||n.href==="")break;return!0;case"link":if(typeof n.rel!="string"||typeof n.href!="string"||n.href===""||n.onLoad||n.onError)break;return n.rel==="stylesheet"?(t=n.disabled,typeof n.precedence=="string"&&t==null):!0;case"script":if(n.async&&typeof n.async!="function"&&typeof n.async!="symbol"&&!n.onLoad&&!n.onError&&n.src&&typeof n.src=="string")return!0}return!1}function px(t){return!(t.type==="stylesheet"&&(t.state.loading&3)===0)}function BN(t,n,l,c){if(l.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(l.state.loading&4)===0){if(l.instance===null){var h=Wr(c.href),g=n.querySelector(ul(h));if(g){n=g._p,n!==null&&typeof n=="object"&&typeof n.then=="function"&&(t.count++,t=rc.bind(t),n.then(t,t)),l.state.loading|=4,l.instance=g,Zt(g);return}g=n.ownerDocument||n,c=dx(c),(h=Ys.get(h))&&lh(c,h),g=g.createElement("link"),Zt(g);var w=g;w._p=new Promise(function(E,P){w.onload=E,w.onerror=P}),ls(g,"link",c),l.instance=g}t.stylesheets===null&&(t.stylesheets=new Map),t.stylesheets.set(l,n),(n=l.state.preload)&&(l.state.loading&3)===0&&(t.count++,l=rc.bind(t),n.addEventListener("load",l),n.addEventListener("error",l))}}var ch=0;function zN(t,n){return t.stylesheets&&t.count===0&&lc(t,t.stylesheets),0<t.count||0<t.imgCount?function(l){var c=setTimeout(function(){if(t.stylesheets&&lc(t,t.stylesheets),t.unsuspend){var g=t.unsuspend;t.unsuspend=null,g()}},6e4+n);0<t.imgBytes&&ch===0&&(ch=62500*vN());var h=setTimeout(function(){if(t.waitingForImages=!1,t.count===0&&(t.stylesheets&&lc(t,t.stylesheets),t.unsuspend)){var g=t.unsuspend;t.unsuspend=null,g()}},(t.imgBytes>ch?50:800)+n);return t.unsuspend=l,function(){t.unsuspend=null,clearTimeout(c),clearTimeout(h)}}:null}function rc(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)lc(this,this.stylesheets);else if(this.unsuspend){var t=this.unsuspend;this.unsuspend=null,t()}}}var ic=null;function lc(t,n){t.stylesheets=null,t.unsuspend!==null&&(t.count++,ic=new Map,n.forEach(VN,t),ic=null,rc.call(t))}function VN(t,n){if(!(n.state.loading&4)){var l=ic.get(t);if(l)var c=l.get(null);else{l=new Map,ic.set(t,l);for(var h=t.querySelectorAll("link[data-precedence],style[data-precedence]"),g=0;g<h.length;g++){var w=h[g];(w.nodeName==="LINK"||w.getAttribute("media")!=="not all")&&(l.set(w.dataset.precedence,w),c=w)}c&&l.set(null,c)}h=n.instance,w=h.getAttribute("data-precedence"),g=l.get(w)||c,g===c&&l.set(null,h),l.set(w,h),this.count++,c=rc.bind(this),h.addEventListener("load",c),h.addEventListener("error",c),g?g.parentNode.insertBefore(h,g.nextSibling):(t=t.nodeType===9?t.head:t,t.insertBefore(h,t.firstChild)),n.state.loading|=4}}var hl={$$typeof:C,Provider:null,Consumer:null,_currentValue:he,_currentValue2:he,_threadCount:0};function $N(t,n,l,c,h,g,w,E,P){this.tag=1,this.containerInfo=t,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Be(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Be(0),this.hiddenUpdates=Be(null),this.identifierPrefix=c,this.onUncaughtError=h,this.onCaughtError=g,this.onRecoverableError=w,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=P,this.incompleteTransitions=new Map}function gx(t,n,l,c,h,g,w,E,P,X,ne,oe){return t=new $N(t,n,l,w,P,X,ne,oe,E),n=1,g===!0&&(n|=24),g=Cs(3,null,null,n),t.current=g,g.stateNode=t,n=$u(),n.refCount++,t.pooledCache=n,n.refCount++,g.memoizedState={element:c,isDehydrated:l,cache:n},Fu(g),t}function xx(t){return t?(t=Rr,t):Rr}function bx(t,n,l,c,h,g){h=xx(h),c.context===null?c.context=h:c.pendingContext=h,c=la(n),c.payload={element:l},g=g===void 0?null:g,g!==null&&(c.callback=g),l=oa(t,c,n),l!==null&&(_s(l,t,n),Hi(l,t,n))}function yx(t,n){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var l=t.retryLane;t.retryLane=l!==0&&l<n?l:n}}function uh(t,n){yx(t,n),(t=t.alternate)&&yx(t,n)}function vx(t){if(t.tag===13||t.tag===31){var n=$a(t,67108864);n!==null&&_s(n,t,67108864),uh(t,67108864)}}function wx(t){if(t.tag===13||t.tag===31){var n=Ms();n=mt(n);var l=$a(t,n);l!==null&&_s(l,t,n),uh(t,n)}}var oc=!0;function qN(t,n,l,c){var h=J.T;J.T=null;var g=se.p;try{se.p=2,dh(t,n,l,c)}finally{se.p=g,J.T=h}}function HN(t,n,l,c){var h=J.T;J.T=null;var g=se.p;try{se.p=8,dh(t,n,l,c)}finally{se.p=g,J.T=h}}function dh(t,n,l,c){if(oc){var h=hh(c);if(h===null)Qd(t,n,c,cc,l),Nx(t,c);else if(FN(h,t,n,l,c))c.stopPropagation();else if(Nx(t,c),n&4&&-1<GN.indexOf(t)){for(;h!==null;){var g=vr(h);if(g!==null)switch(g.tag){case 3:if(g=g.stateNode,g.current.memoizedState.isDehydrated){var w=re(g.pendingLanes);if(w!==0){var E=g;for(E.pendingLanes|=2,E.entangledLanes|=2;w;){var P=1<<31-Ht(w);E.entanglements[1]|=P,w&=~P}vn(g),(lt&6)===0&&(Go=Jt()+500,il(0))}}break;case 31:case 13:E=$a(g,2),E!==null&&_s(E,g,2),Ko(),uh(g,2)}if(g=hh(c),g===null&&Qd(t,n,c,cc,l),g===h)break;h=g}h!==null&&c.stopPropagation()}else Qd(t,n,c,null,l)}}function hh(t){return t=mu(t),fh(t)}var cc=null;function fh(t){if(cc=null,t=yr(t),t!==null){var n=u(t);if(n===null)t=null;else{var l=n.tag;if(l===13){if(t=d(n),t!==null)return t;t=null}else if(l===31){if(t=f(n),t!==null)return t;t=null}else if(l===3){if(n.stateNode.current.memoizedState.isDehydrated)return n.tag===3?n.stateNode.containerInfo:null;t=null}else n!==t&&(t=null)}}return cc=t,null}function jx(t){switch(t){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(gr()){case Ua:return 2;case La:return 8;case kn:case xr:return 32;case Pa:return 268435456;default:return 32}default:return 32}}var mh=!1,ya=null,va=null,wa=null,fl=new Map,ml=new Map,ja=[],GN="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Nx(t,n){switch(t){case"focusin":case"focusout":ya=null;break;case"dragenter":case"dragleave":va=null;break;case"mouseover":case"mouseout":wa=null;break;case"pointerover":case"pointerout":fl.delete(n.pointerId);break;case"gotpointercapture":case"lostpointercapture":ml.delete(n.pointerId)}}function pl(t,n,l,c,h,g){return t===null||t.nativeEvent!==g?(t={blockedOn:n,domEventName:l,eventSystemFlags:c,nativeEvent:g,targetContainers:[h]},n!==null&&(n=vr(n),n!==null&&vx(n)),t):(t.eventSystemFlags|=c,n=t.targetContainers,h!==null&&n.indexOf(h)===-1&&n.push(h),t)}function FN(t,n,l,c,h){switch(n){case"focusin":return ya=pl(ya,t,n,l,c,h),!0;case"dragenter":return va=pl(va,t,n,l,c,h),!0;case"mouseover":return wa=pl(wa,t,n,l,c,h),!0;case"pointerover":var g=h.pointerId;return fl.set(g,pl(fl.get(g)||null,t,n,l,c,h)),!0;case"gotpointercapture":return g=h.pointerId,ml.set(g,pl(ml.get(g)||null,t,n,l,c,h)),!0}return!1}function Sx(t){var n=yr(t.target);if(n!==null){var l=u(n);if(l!==null){if(n=l.tag,n===13){if(n=d(l),n!==null){t.blockedOn=n,to(t.priority,function(){wx(l)});return}}else if(n===31){if(n=f(l),n!==null){t.blockedOn=n,to(t.priority,function(){wx(l)});return}}else if(n===3&&l.stateNode.current.memoizedState.isDehydrated){t.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}t.blockedOn=null}function uc(t){if(t.blockedOn!==null)return!1;for(var n=t.targetContainers;0<n.length;){var l=hh(t.nativeEvent);if(l===null){l=t.nativeEvent;var c=new l.constructor(l.type,l);fu=c,l.target.dispatchEvent(c),fu=null}else return n=vr(l),n!==null&&vx(n),t.blockedOn=l,!1;n.shift()}return!0}function _x(t,n,l){uc(t)&&l.delete(n)}function KN(){mh=!1,ya!==null&&uc(ya)&&(ya=null),va!==null&&uc(va)&&(va=null),wa!==null&&uc(wa)&&(wa=null),fl.forEach(_x),ml.forEach(_x)}function dc(t,n){t.blockedOn===n&&(t.blockedOn=null,mh||(mh=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,KN)))}var hc=null;function kx(t){hc!==t&&(hc=t,s.unstable_scheduleCallback(s.unstable_NormalPriority,function(){hc===t&&(hc=null);for(var n=0;n<t.length;n+=3){var l=t[n],c=t[n+1],h=t[n+2];if(typeof c!="function"){if(fh(c||l)===null)continue;break}var g=vr(l);g!==null&&(t.splice(n,3),n-=3,hd(g,{pending:!0,data:h,method:l.method,action:c},c,h))}}))}function ti(t){function n(P){return dc(P,t)}ya!==null&&dc(ya,t),va!==null&&dc(va,t),wa!==null&&dc(wa,t),fl.forEach(n),ml.forEach(n);for(var l=0;l<ja.length;l++){var c=ja[l];c.blockedOn===t&&(c.blockedOn=null)}for(;0<ja.length&&(l=ja[0],l.blockedOn===null);)Sx(l),l.blockedOn===null&&ja.shift();if(l=(t.ownerDocument||t).$$reactFormReplay,l!=null)for(c=0;c<l.length;c+=3){var h=l[c],g=l[c+1],w=h[ys]||null;if(typeof g=="function")w||kx(l);else if(w){var E=null;if(g&&g.hasAttribute("formAction")){if(h=g,w=g[ys]||null)E=w.formAction;else if(fh(h)!==null)continue}else E=w.action;typeof E=="function"?l[c+1]=E:(l.splice(c,3),c-=3),kx(l)}}}function Tx(){function t(g){g.canIntercept&&g.info==="react-transition"&&g.intercept({handler:function(){return new Promise(function(w){return h=w})},focusReset:"manual",scroll:"manual"})}function n(){h!==null&&(h(),h=null),c||setTimeout(l,20)}function l(){if(!c&&!navigation.transition){var g=navigation.currentEntry;g&&g.url!=null&&navigation.navigate(g.url,{state:g.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var c=!1,h=null;return navigation.addEventListener("navigate",t),navigation.addEventListener("navigatesuccess",n),navigation.addEventListener("navigateerror",n),setTimeout(l,100),function(){c=!0,navigation.removeEventListener("navigate",t),navigation.removeEventListener("navigatesuccess",n),navigation.removeEventListener("navigateerror",n),h!==null&&(h(),h=null)}}}function ph(t){this._internalRoot=t}fc.prototype.render=ph.prototype.render=function(t){var n=this._internalRoot;if(n===null)throw Error(i(409));var l=n.current,c=Ms();bx(l,c,t,n,null,null)},fc.prototype.unmount=ph.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var n=t.containerInfo;bx(t.current,2,null,t,null,null),Ko(),n[br]=null}};function fc(t){this._internalRoot=t}fc.prototype.unstable_scheduleHydration=function(t){if(t){var n=gn();t={blockedOn:null,target:t,priority:n};for(var l=0;l<ja.length&&n!==0&&n<ja[l].priority;l++);ja.splice(l,0,t),l===0&&Sx(t)}};var Ex=e.version;if(Ex!=="19.2.3")throw Error(i(527,Ex,"19.2.3"));se.findDOMNode=function(t){var n=t._reactInternals;if(n===void 0)throw typeof t.render=="function"?Error(i(188)):(t=Object.keys(t).join(","),Error(i(268,t)));return t=p(n),t=t!==null?x(t):null,t=t===null?null:t.stateNode,t};var YN={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:J,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var mc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!mc.isDisabled&&mc.supportsFiber)try{pn=mc.inject(YN),Qt=mc}catch{}}return xl.createRoot=function(t,n){if(!o(t))throw Error(i(299));var l=!1,c="",h=Ug,g=Lg,w=Pg;return n!=null&&(n.unstable_strictMode===!0&&(l=!0),n.identifierPrefix!==void 0&&(c=n.identifierPrefix),n.onUncaughtError!==void 0&&(h=n.onUncaughtError),n.onCaughtError!==void 0&&(g=n.onCaughtError),n.onRecoverableError!==void 0&&(w=n.onRecoverableError)),n=gx(t,1,!1,null,null,l,c,null,h,g,w,Tx),t[br]=n.current,Jd(t),new ph(n)},xl.hydrateRoot=function(t,n,l){if(!o(t))throw Error(i(299));var c=!1,h="",g=Ug,w=Lg,E=Pg,P=null;return l!=null&&(l.unstable_strictMode===!0&&(c=!0),l.identifierPrefix!==void 0&&(h=l.identifierPrefix),l.onUncaughtError!==void 0&&(g=l.onUncaughtError),l.onCaughtError!==void 0&&(w=l.onCaughtError),l.onRecoverableError!==void 0&&(E=l.onRecoverableError),l.formState!==void 0&&(P=l.formState)),n=gx(t,1,!0,n,l??null,c,h,P,g,w,E,Tx),n.context=xx(null),l=n.current,c=Ms(),c=mt(c),h=la(c),h.callback=null,oa(l,h,c),l=c,n.current.lanes=l,Ve(n,l),vn(n),t[br]=n.current,Jd(t),new fc(n)},xl.version="19.2.3",xl}var Ix;function nS(){if(Ix)return bh.exports;Ix=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),bh.exports=sS(),bh.exports}var aS=nS();var Bx="popstate";function rS(s={}){function e(i,o){let{pathname:u,search:d,hash:f}=i.location;return ef("",{pathname:u,search:d,hash:f},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function a(i,o){return typeof o=="string"?o:Cl(o)}return lS(e,a,null,s)}function kt(s,e){if(s===!1||s===null||typeof s>"u")throw new Error(e)}function hn(s,e){if(!s){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function iS(){return Math.random().toString(36).substring(2,10)}function zx(s,e){return{usr:s.state,key:s.key,idx:e}}function ef(s,e,a=null,i){return{pathname:typeof s=="string"?s:s.pathname,search:"",hash:"",...typeof e=="string"?wi(e):e,state:a,key:e&&e.key||i||iS()}}function Cl({pathname:s="/",search:e="",hash:a=""}){return e&&e!=="?"&&(s+=e.charAt(0)==="?"?e:"?"+e),a&&a!=="#"&&(s+=a.charAt(0)==="#"?a:"#"+a),s}function wi(s){let e={};if(s){let a=s.indexOf("#");a>=0&&(e.hash=s.substring(a),s=s.substring(0,a));let i=s.indexOf("?");i>=0&&(e.search=s.substring(i),s=s.substring(0,i)),s&&(e.pathname=s)}return e}function lS(s,e,a,i={}){let{window:o=document.defaultView,v5Compat:u=!1}=i,d=o.history,f="POP",m=null,p=x();p==null&&(p=0,d.replaceState({...d.state,idx:p},""));function x(){return(d.state||{idx:null}).idx}function b(){f="POP";let T=x(),R=T==null?null:T-p;p=T,m&&m({action:f,location:k.location,delta:R})}function y(T,R){f="PUSH";let A=ef(k.location,T,R);p=x()+1;let C=zx(A,p),B=k.createHref(A);try{d.pushState(C,"",B)}catch(F){if(F instanceof DOMException&&F.name==="DataCloneError")throw F;o.location.assign(B)}u&&m&&m({action:f,location:k.location,delta:1})}function j(T,R){f="REPLACE";let A=ef(k.location,T,R);p=x();let C=zx(A,p),B=k.createHref(A);d.replaceState(C,"",B),u&&m&&m({action:f,location:k.location,delta:0})}function N(T){return oS(T)}let k={get action(){return f},get location(){return s(o,d)},listen(T){if(m)throw new Error("A history only accepts one active listener");return o.addEventListener(Bx,b),m=T,()=>{o.removeEventListener(Bx,b),m=null}},createHref(T){return e(o,T)},createURL:N,encodeLocation(T){let R=N(T);return{pathname:R.pathname,search:R.search,hash:R.hash}},push:y,replace:j,go(T){return d.go(T)}};return k}function oS(s,e=!1){let a="http://localhost";typeof window<"u"&&(a=window.location.origin!=="null"?window.location.origin:window.location.href),kt(a,"No window.location.(origin|href) available to create URL");let i=typeof s=="string"?s:Cl(s);return i=i.replace(/ $/,"%20"),!e&&i.startsWith("//")&&(i=a+i),new URL(i,a)}function Yy(s,e,a="/"){return cS(s,e,a,!1)}function cS(s,e,a,i){let o=typeof e=="string"?wi(e):e,u=Jn(o.pathname||"/",a);if(u==null)return null;let d=Xy(s);uS(d);let f=null;for(let m=0;f==null&&m<d.length;++m){let p=wS(u);f=yS(d[m],p,i)}return f}function Xy(s,e=[],a=[],i="",o=!1){let u=(d,f,m=o,p)=>{let x={relativePath:p===void 0?d.path||"":p,caseSensitive:d.caseSensitive===!0,childrenIndex:f,route:d};if(x.relativePath.startsWith("/")){if(!x.relativePath.startsWith(i)&&m)return;kt(x.relativePath.startsWith(i),`Absolute route path "${x.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),x.relativePath=x.relativePath.slice(i.length)}let b=Fn([i,x.relativePath]),y=a.concat(x);d.children&&d.children.length>0&&(kt(d.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${b}".`),Xy(d.children,e,y,b,m)),!(d.path==null&&!d.index)&&e.push({path:b,score:xS(b,d.index),routesMeta:y})};return s.forEach((d,f)=>{if(d.path===""||!d.path?.includes("?"))u(d,f);else for(let m of Jy(d.path))u(d,f,!0,m)}),e}function Jy(s){let e=s.split("/");if(e.length===0)return[];let[a,...i]=e,o=a.endsWith("?"),u=a.replace(/\?$/,"");if(i.length===0)return o?[u,""]:[u];let d=Jy(i.join("/")),f=[];return f.push(...d.map(m=>m===""?u:[u,m].join("/"))),o&&f.push(...d),f.map(m=>s.startsWith("/")&&m===""?"/":m)}function uS(s){s.sort((e,a)=>e.score!==a.score?a.score-e.score:bS(e.routesMeta.map(i=>i.childrenIndex),a.routesMeta.map(i=>i.childrenIndex)))}var dS=/^:[\w-]+$/,hS=3,fS=2,mS=1,pS=10,gS=-2,Vx=s=>s==="*";function xS(s,e){let a=s.split("/"),i=a.length;return a.some(Vx)&&(i+=gS),e&&(i+=fS),a.filter(o=>!Vx(o)).reduce((o,u)=>o+(dS.test(u)?hS:u===""?mS:pS),i)}function bS(s,e){return s.length===e.length&&s.slice(0,-1).every((i,o)=>i===e[o])?s[s.length-1]-e[e.length-1]:0}function yS(s,e,a=!1){let{routesMeta:i}=s,o={},u="/",d=[];for(let f=0;f<i.length;++f){let m=i[f],p=f===i.length-1,x=u==="/"?e:e.slice(u.length)||"/",b=Uc({path:m.relativePath,caseSensitive:m.caseSensitive,end:p},x),y=m.route;if(!b&&p&&a&&!i[i.length-1].route.index&&(b=Uc({path:m.relativePath,caseSensitive:m.caseSensitive,end:!1},x)),!b)return null;Object.assign(o,b.params),d.push({params:o,pathname:Fn([u,b.pathname]),pathnameBase:_S(Fn([u,b.pathnameBase])),route:y}),b.pathnameBase!=="/"&&(u=Fn([u,b.pathnameBase]))}return d}function Uc(s,e){typeof s=="string"&&(s={path:s,caseSensitive:!1,end:!0});let[a,i]=vS(s.path,s.caseSensitive,s.end),o=e.match(a);if(!o)return null;let u=o[0],d=u.replace(/(.)\/+$/,"$1"),f=o.slice(1);return{params:i.reduce((p,{paramName:x,isOptional:b},y)=>{if(x==="*"){let N=f[y]||"";d=u.slice(0,u.length-N.length).replace(/(.)\/+$/,"$1")}const j=f[y];return b&&!j?p[x]=void 0:p[x]=(j||"").replace(/%2F/g,"/"),p},{}),pathname:u,pathnameBase:d,pattern:s}}function vS(s,e=!1,a=!0){hn(s==="*"||!s.endsWith("*")||s.endsWith("/*"),`Route path "${s}" will be treated as if it were "${s.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${s.replace(/\*$/,"/*")}".`);let i=[],o="^"+s.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(d,f,m)=>(i.push({paramName:f,isOptional:m!=null}),m?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return s.endsWith("*")?(i.push({paramName:"*"}),o+=s==="*"||s==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):a?o+="\\/*$":s!==""&&s!=="/"&&(o+="(?:(?=\\/|$))"),[new RegExp(o,e?void 0:"i"),i]}function wS(s){try{return s.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return hn(!1,`The URL path "${s}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),s}}function Jn(s,e){if(e==="/")return s;if(!s.toLowerCase().startsWith(e.toLowerCase()))return null;let a=e.endsWith("/")?e.length-1:e.length,i=s.charAt(a);return i&&i!=="/"?null:s.slice(a)||"/"}var jS=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function NS(s,e="/"){let{pathname:a,search:i="",hash:o=""}=typeof s=="string"?wi(s):s,u;return a?(a=a.replace(/\/\/+/g,"/"),a.startsWith("/")?u=$x(a.substring(1),"/"):u=$x(a,e)):u=e,{pathname:u,search:kS(i),hash:TS(o)}}function $x(s,e){let a=e.replace(/\/+$/,"").split("/");return s.split("/").forEach(o=>{o===".."?a.length>1&&a.pop():o!=="."&&a.push(o)}),a.length>1?a.join("/"):"/"}function jh(s,e,a,i){return`Cannot include a '${s}' character in a manually specified \`to.${e}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${a}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function SS(s){return s.filter((e,a)=>a===0||e.route.path&&e.route.path.length>0)}function qf(s){let e=SS(s);return e.map((a,i)=>i===e.length-1?a.pathname:a.pathnameBase)}function Hf(s,e,a,i=!1){let o;typeof s=="string"?o=wi(s):(o={...s},kt(!o.pathname||!o.pathname.includes("?"),jh("?","pathname","search",o)),kt(!o.pathname||!o.pathname.includes("#"),jh("#","pathname","hash",o)),kt(!o.search||!o.search.includes("#"),jh("#","search","hash",o)));let u=s===""||o.pathname==="",d=u?"/":o.pathname,f;if(d==null)f=a;else{let b=e.length-1;if(!i&&d.startsWith("..")){let y=d.split("/");for(;y[0]==="..";)y.shift(),b-=1;o.pathname=y.join("/")}f=b>=0?e[b]:"/"}let m=NS(o,f),p=d&&d!=="/"&&d.endsWith("/"),x=(u||d===".")&&a.endsWith("/");return!m.pathname.endsWith("/")&&(p||x)&&(m.pathname+="/"),m}var Fn=s=>s.join("/").replace(/\/\/+/g,"/"),_S=s=>s.replace(/\/+$/,"").replace(/^\/*/,"/"),kS=s=>!s||s==="?"?"":s.startsWith("?")?s:"?"+s,TS=s=>!s||s==="#"?"":s.startsWith("#")?s:"#"+s,ES=class{constructor(s,e,a,i=!1){this.status=s,this.statusText=e||"",this.internal=i,a instanceof Error?(this.data=a.toString(),this.error=a):this.data=a}};function CS(s){return s!=null&&typeof s.status=="number"&&typeof s.statusText=="string"&&typeof s.internal=="boolean"&&"data"in s}function AS(s){return s.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var Qy=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Zy(s,e){let a=s;if(typeof a!="string"||!jS.test(a))return{absoluteURL:void 0,isExternal:!1,to:a};let i=a,o=!1;if(Qy)try{let u=new URL(window.location.href),d=a.startsWith("//")?new URL(u.protocol+a):new URL(a),f=Jn(d.pathname,e);d.origin===u.origin&&f!=null?a=f+d.search+d.hash:o=!0}catch{hn(!1,`<Link to="${a}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:i,isExternal:o,to:a}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var Wy=["POST","PUT","PATCH","DELETE"];new Set(Wy);var RS=["GET",...Wy];new Set(RS);var ji=v.createContext(null);ji.displayName="DataRouter";var Jc=v.createContext(null);Jc.displayName="DataRouterState";var DS=v.createContext(!1),ev=v.createContext({isTransitioning:!1});ev.displayName="ViewTransition";var OS=v.createContext(new Map);OS.displayName="Fetchers";var MS=v.createContext(null);MS.displayName="Await";var Is=v.createContext(null);Is.displayName="Navigation";var Gl=v.createContext(null);Gl.displayName="Location";var fn=v.createContext({outlet:null,matches:[],isDataRoute:!1});fn.displayName="Route";var Gf=v.createContext(null);Gf.displayName="RouteError";var tv="REACT_ROUTER_ERROR",US="REDIRECT",LS="ROUTE_ERROR_RESPONSE";function PS(s){if(s.startsWith(`${tv}:${US}:{`))try{let e=JSON.parse(s.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function IS(s){if(s.startsWith(`${tv}:${LS}:{`))try{let e=JSON.parse(s.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new ES(e.status,e.statusText,e.data)}catch{}}function BS(s,{relative:e}={}){kt(Ni(),"useHref() may be used only in the context of a <Router> component.");let{basename:a,navigator:i}=v.useContext(Is),{hash:o,pathname:u,search:d}=Fl(s,{relative:e}),f=u;return a!=="/"&&(f=u==="/"?a:Fn([a,u])),i.createHref({pathname:f,search:d,hash:o})}function Ni(){return v.useContext(Gl)!=null}function Oa(){return kt(Ni(),"useLocation() may be used only in the context of a <Router> component."),v.useContext(Gl).location}var sv="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function nv(s){v.useContext(Is).static||v.useLayoutEffect(s)}function _n(){let{isDataRoute:s}=v.useContext(fn);return s?e2():zS()}function zS(){kt(Ni(),"useNavigate() may be used only in the context of a <Router> component.");let s=v.useContext(ji),{basename:e,navigator:a}=v.useContext(Is),{matches:i}=v.useContext(fn),{pathname:o}=Oa(),u=JSON.stringify(qf(i)),d=v.useRef(!1);return nv(()=>{d.current=!0}),v.useCallback((m,p={})=>{if(hn(d.current,sv),!d.current)return;if(typeof m=="number"){a.go(m);return}let x=Hf(m,JSON.parse(u),o,p.relative==="path");s==null&&e!=="/"&&(x.pathname=x.pathname==="/"?e:Fn([e,x.pathname])),(p.replace?a.replace:a.push)(x,p.state,p)},[e,a,u,o,s])}var VS=v.createContext(null);function $S(s){let e=v.useContext(fn).outlet;return v.useMemo(()=>e&&v.createElement(VS.Provider,{value:s},e),[e,s])}function Fl(s,{relative:e}={}){let{matches:a}=v.useContext(fn),{pathname:i}=Oa(),o=JSON.stringify(qf(a));return v.useMemo(()=>Hf(s,JSON.parse(o),i,e==="path"),[s,o,i,e])}function qS(s,e){return av(s,e)}function av(s,e,a,i,o){kt(Ni(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:u}=v.useContext(Is),{matches:d}=v.useContext(fn),f=d[d.length-1],m=f?f.params:{},p=f?f.pathname:"/",x=f?f.pathnameBase:"/",b=f&&f.route;{let A=b&&b.path||"";iv(p,!b||A.endsWith("*")||A.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${p}" (under <Route path="${A}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${A}"> to <Route path="${A==="/"?"*":`${A}/*`}">.`)}let y=Oa(),j;if(e){let A=typeof e=="string"?wi(e):e;kt(x==="/"||A.pathname?.startsWith(x),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${x}" but pathname "${A.pathname}" was given in the \`location\` prop.`),j=A}else j=y;let N=j.pathname||"/",k=N;if(x!=="/"){let A=x.replace(/^\//,"").split("/");k="/"+N.replace(/^\//,"").split("/").slice(A.length).join("/")}let T=Yy(s,{pathname:k});hn(b||T!=null,`No routes matched location "${j.pathname}${j.search}${j.hash}" `),hn(T==null||T[T.length-1].route.element!==void 0||T[T.length-1].route.Component!==void 0||T[T.length-1].route.lazy!==void 0,`Matched leaf route at location "${j.pathname}${j.search}${j.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let R=YS(T&&T.map(A=>Object.assign({},A,{params:Object.assign({},m,A.params),pathname:Fn([x,u.encodeLocation?u.encodeLocation(A.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:A.pathname]),pathnameBase:A.pathnameBase==="/"?x:Fn([x,u.encodeLocation?u.encodeLocation(A.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:A.pathnameBase])})),d,a,i,o);return e&&R?v.createElement(Gl.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...j},navigationType:"POP"}},R):R}function HS(){let s=WS(),e=CS(s)?`${s.status} ${s.statusText}`:s instanceof Error?s.message:JSON.stringify(s),a=s instanceof Error?s.stack:null,i="rgba(200,200,200, 0.5)",o={padding:"0.5rem",backgroundColor:i},u={padding:"2px 4px",backgroundColor:i},d=null;return console.error("Error handled by React Router default ErrorBoundary:",s),d=v.createElement(v.Fragment,null,v.createElement("p",null," Hey developer "),v.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",v.createElement("code",{style:u},"ErrorBoundary")," or"," ",v.createElement("code",{style:u},"errorElement")," prop on your route.")),v.createElement(v.Fragment,null,v.createElement("h2",null,"Unexpected Application Error!"),v.createElement("h3",{style:{fontStyle:"italic"}},e),a?v.createElement("pre",{style:o},a):null,d)}var GS=v.createElement(HS,null),rv=class extends v.Component{constructor(s){super(s),this.state={location:s.location,revalidation:s.revalidation,error:s.error}}static getDerivedStateFromError(s){return{error:s}}static getDerivedStateFromProps(s,e){return e.location!==s.location||e.revalidation!=="idle"&&s.revalidation==="idle"?{error:s.error,location:s.location,revalidation:s.revalidation}:{error:s.error!==void 0?s.error:e.error,location:e.location,revalidation:s.revalidation||e.revalidation}}componentDidCatch(s,e){this.props.onError?this.props.onError(s,e):console.error("React Router caught the following error during render",s)}render(){let s=this.state.error;if(this.context&&typeof s=="object"&&s&&"digest"in s&&typeof s.digest=="string"){const a=IS(s.digest);a&&(s=a)}let e=s!==void 0?v.createElement(fn.Provider,{value:this.props.routeContext},v.createElement(Gf.Provider,{value:s,children:this.props.component})):this.props.children;return this.context?v.createElement(FS,{error:s},e):e}};rv.contextType=DS;var Nh=new WeakMap;function FS({children:s,error:e}){let{basename:a}=v.useContext(Is);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let i=PS(e.digest);if(i){let o=Nh.get(e);if(o)throw o;let u=Zy(i.location,a);if(Qy&&!Nh.get(e))if(u.isExternal||i.reloadDocument)window.location.href=u.absoluteURL||u.to;else{const d=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(u.to,{replace:i.replace}));throw Nh.set(e,d),d}return v.createElement("meta",{httpEquiv:"refresh",content:`0;url=${u.absoluteURL||u.to}`})}}return s}function KS({routeContext:s,match:e,children:a}){let i=v.useContext(ji);return i&&i.static&&i.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=e.route.id),v.createElement(fn.Provider,{value:s},a)}function YS(s,e=[],a=null,i=null,o=null){if(s==null){if(!a)return null;if(a.errors)s=a.matches;else if(e.length===0&&!a.initialized&&a.matches.length>0)s=a.matches;else return null}let u=s,d=a?.errors;if(d!=null){let x=u.findIndex(b=>b.route.id&&d?.[b.route.id]!==void 0);kt(x>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(d).join(",")}`),u=u.slice(0,Math.min(u.length,x+1))}let f=!1,m=-1;if(a)for(let x=0;x<u.length;x++){let b=u[x];if((b.route.HydrateFallback||b.route.hydrateFallbackElement)&&(m=x),b.route.id){let{loaderData:y,errors:j}=a,N=b.route.loader&&!y.hasOwnProperty(b.route.id)&&(!j||j[b.route.id]===void 0);if(b.route.lazy||N){f=!0,m>=0?u=u.slice(0,m+1):u=[u[0]];break}}}let p=a&&i?(x,b)=>{i(x,{location:a.location,params:a.matches?.[0]?.params??{},unstable_pattern:AS(a.matches),errorInfo:b})}:void 0;return u.reduceRight((x,b,y)=>{let j,N=!1,k=null,T=null;a&&(j=d&&b.route.id?d[b.route.id]:void 0,k=b.route.errorElement||GS,f&&(m<0&&y===0?(iv("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),N=!0,T=null):m===y&&(N=!0,T=b.route.hydrateFallbackElement||null)));let R=e.concat(u.slice(0,y+1)),A=()=>{let C;return j?C=k:N?C=T:b.route.Component?C=v.createElement(b.route.Component,null):b.route.element?C=b.route.element:C=x,v.createElement(KS,{match:b,routeContext:{outlet:x,matches:R,isDataRoute:a!=null},children:C})};return a&&(b.route.ErrorBoundary||b.route.errorElement||y===0)?v.createElement(rv,{location:a.location,revalidation:a.revalidation,component:k,error:j,children:A(),routeContext:{outlet:null,matches:R,isDataRoute:!0},onError:p}):A()},null)}function Ff(s){return`${s} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function XS(s){let e=v.useContext(ji);return kt(e,Ff(s)),e}function JS(s){let e=v.useContext(Jc);return kt(e,Ff(s)),e}function QS(s){let e=v.useContext(fn);return kt(e,Ff(s)),e}function Kf(s){let e=QS(s),a=e.matches[e.matches.length-1];return kt(a.route.id,`${s} can only be used on routes that contain a unique "id"`),a.route.id}function ZS(){return Kf("useRouteId")}function WS(){let s=v.useContext(Gf),e=JS("useRouteError"),a=Kf("useRouteError");return s!==void 0?s:e.errors?.[a]}function e2(){let{router:s}=XS("useNavigate"),e=Kf("useNavigate"),a=v.useRef(!1);return nv(()=>{a.current=!0}),v.useCallback(async(o,u={})=>{hn(a.current,sv),a.current&&(typeof o=="number"?await s.navigate(o):await s.navigate(o,{fromRouteId:e,...u}))},[s,e])}var qx={};function iv(s,e,a){!e&&!qx[s]&&(qx[s]=!0,hn(!1,a))}v.memo(t2);function t2({routes:s,future:e,state:a,onError:i}){return av(s,void 0,a,i,e)}function di({to:s,replace:e,state:a,relative:i}){kt(Ni(),"<Navigate> may be used only in the context of a <Router> component.");let{static:o}=v.useContext(Is);hn(!o,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:u}=v.useContext(fn),{pathname:d}=Oa(),f=_n(),m=Hf(s,qf(u),d,i==="path"),p=JSON.stringify(m);return v.useEffect(()=>{f(JSON.parse(p),{replace:e,state:a,relative:i})},[f,p,i,e,a]),null}function Yf(s){return $S(s.context)}function et(s){kt(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function s2({basename:s="/",children:e=null,location:a,navigationType:i="POP",navigator:o,static:u=!1,unstable_useTransitions:d}){kt(!Ni(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let f=s.replace(/^\/*/,"/"),m=v.useMemo(()=>({basename:f,navigator:o,static:u,unstable_useTransitions:d,future:{}}),[f,o,u,d]);typeof a=="string"&&(a=wi(a));let{pathname:p="/",search:x="",hash:b="",state:y=null,key:j="default"}=a,N=v.useMemo(()=>{let k=Jn(p,f);return k==null?null:{location:{pathname:k,search:x,hash:b,state:y,key:j},navigationType:i}},[f,p,x,b,y,j,i]);return hn(N!=null,`<Router basename="${f}"> is not able to match the URL "${p}${x}${b}" because it does not start with the basename, so the <Router> won't render anything.`),N==null?null:v.createElement(Is.Provider,{value:m},v.createElement(Gl.Provider,{children:e,value:N}))}function n2({children:s,location:e}){return qS(tf(s),e)}function tf(s,e=[]){let a=[];return v.Children.forEach(s,(i,o)=>{if(!v.isValidElement(i))return;let u=[...e,o];if(i.type===v.Fragment){a.push.apply(a,tf(i.props.children,u));return}kt(i.type===et,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),kt(!i.props.index||!i.props.children,"An index route cannot have child routes.");let d={id:i.props.id||u.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,middleware:i.props.middleware,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(d.children=tf(i.props.children,u)),a.push(d)}),a}var Ec="get",Cc="application/x-www-form-urlencoded";function Qc(s){return typeof HTMLElement<"u"&&s instanceof HTMLElement}function a2(s){return Qc(s)&&s.tagName.toLowerCase()==="button"}function r2(s){return Qc(s)&&s.tagName.toLowerCase()==="form"}function i2(s){return Qc(s)&&s.tagName.toLowerCase()==="input"}function l2(s){return!!(s.metaKey||s.altKey||s.ctrlKey||s.shiftKey)}function o2(s,e){return s.button===0&&(!e||e==="_self")&&!l2(s)}var pc=null;function c2(){if(pc===null)try{new FormData(document.createElement("form"),0),pc=!1}catch{pc=!0}return pc}var u2=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Sh(s){return s!=null&&!u2.has(s)?(hn(!1,`"${s}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Cc}"`),null):s}function d2(s,e){let a,i,o,u,d;if(r2(s)){let f=s.getAttribute("action");i=f?Jn(f,e):null,a=s.getAttribute("method")||Ec,o=Sh(s.getAttribute("enctype"))||Cc,u=new FormData(s)}else if(a2(s)||i2(s)&&(s.type==="submit"||s.type==="image")){let f=s.form;if(f==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let m=s.getAttribute("formaction")||f.getAttribute("action");if(i=m?Jn(m,e):null,a=s.getAttribute("formmethod")||f.getAttribute("method")||Ec,o=Sh(s.getAttribute("formenctype"))||Sh(f.getAttribute("enctype"))||Cc,u=new FormData(f,s),!c2()){let{name:p,type:x,value:b}=s;if(x==="image"){let y=p?`${p}.`:"";u.append(`${y}x`,"0"),u.append(`${y}y`,"0")}else p&&u.append(p,b)}}else{if(Qc(s))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');a=Ec,i=null,o=Cc,d=s}return u&&o==="text/plain"&&(d=u,u=void 0),{action:i,method:a.toLowerCase(),encType:o,formData:u,body:d}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Xf(s,e){if(s===!1||s===null||typeof s>"u")throw new Error(e)}function h2(s,e,a,i){let o=typeof s=="string"?new URL(s,typeof window>"u"?"server://singlefetch/":window.location.origin):s;return a?o.pathname.endsWith("/")?o.pathname=`${o.pathname}_.${i}`:o.pathname=`${o.pathname}.${i}`:o.pathname==="/"?o.pathname=`_root.${i}`:e&&Jn(o.pathname,e)==="/"?o.pathname=`${e.replace(/\/$/,"")}/_root.${i}`:o.pathname=`${o.pathname.replace(/\/$/,"")}.${i}`,o}async function f2(s,e){if(s.id in e)return e[s.id];try{let a=await import(s.module);return e[s.id]=a,a}catch(a){return console.error(`Error loading route module \`${s.module}\`, reloading page...`),console.error(a),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function m2(s){return s==null?!1:s.href==null?s.rel==="preload"&&typeof s.imageSrcSet=="string"&&typeof s.imageSizes=="string":typeof s.rel=="string"&&typeof s.href=="string"}async function p2(s,e,a){let i=await Promise.all(s.map(async o=>{let u=e.routes[o.route.id];if(u){let d=await f2(u,a);return d.links?d.links():[]}return[]}));return y2(i.flat(1).filter(m2).filter(o=>o.rel==="stylesheet"||o.rel==="preload").map(o=>o.rel==="stylesheet"?{...o,rel:"prefetch",as:"style"}:{...o,rel:"prefetch"}))}function Hx(s,e,a,i,o,u){let d=(m,p)=>a[p]?m.route.id!==a[p].route.id:!0,f=(m,p)=>a[p].pathname!==m.pathname||a[p].route.path?.endsWith("*")&&a[p].params["*"]!==m.params["*"];return u==="assets"?e.filter((m,p)=>d(m,p)||f(m,p)):u==="data"?e.filter((m,p)=>{let x=i.routes[m.route.id];if(!x||!x.hasLoader)return!1;if(d(m,p)||f(m,p))return!0;if(m.route.shouldRevalidate){let b=m.route.shouldRevalidate({currentUrl:new URL(o.pathname+o.search+o.hash,window.origin),currentParams:a[0]?.params||{},nextUrl:new URL(s,window.origin),nextParams:m.params,defaultShouldRevalidate:!0});if(typeof b=="boolean")return b}return!0}):[]}function g2(s,e,{includeHydrateFallback:a}={}){return x2(s.map(i=>{let o=e.routes[i.route.id];if(!o)return[];let u=[o.module];return o.clientActionModule&&(u=u.concat(o.clientActionModule)),o.clientLoaderModule&&(u=u.concat(o.clientLoaderModule)),a&&o.hydrateFallbackModule&&(u=u.concat(o.hydrateFallbackModule)),o.imports&&(u=u.concat(o.imports)),u}).flat(1))}function x2(s){return[...new Set(s)]}function b2(s){let e={},a=Object.keys(s).sort();for(let i of a)e[i]=s[i];return e}function y2(s,e){let a=new Set;return new Set(e),s.reduce((i,o)=>{let u=JSON.stringify(b2(o));return a.has(u)||(a.add(u),i.push({key:u,link:o})),i},[])}function lv(){let s=v.useContext(ji);return Xf(s,"You must render this element inside a <DataRouterContext.Provider> element"),s}function v2(){let s=v.useContext(Jc);return Xf(s,"You must render this element inside a <DataRouterStateContext.Provider> element"),s}var Jf=v.createContext(void 0);Jf.displayName="FrameworkContext";function ov(){let s=v.useContext(Jf);return Xf(s,"You must render this element inside a <HydratedRouter> element"),s}function w2(s,e){let a=v.useContext(Jf),[i,o]=v.useState(!1),[u,d]=v.useState(!1),{onFocus:f,onBlur:m,onMouseEnter:p,onMouseLeave:x,onTouchStart:b}=e,y=v.useRef(null);v.useEffect(()=>{if(s==="render"&&d(!0),s==="viewport"){let k=R=>{R.forEach(A=>{d(A.isIntersecting)})},T=new IntersectionObserver(k,{threshold:.5});return y.current&&T.observe(y.current),()=>{T.disconnect()}}},[s]),v.useEffect(()=>{if(i){let k=setTimeout(()=>{d(!0)},100);return()=>{clearTimeout(k)}}},[i]);let j=()=>{o(!0)},N=()=>{o(!1),d(!1)};return a?s!=="intent"?[u,y,{}]:[u,y,{onFocus:bl(f,j),onBlur:bl(m,N),onMouseEnter:bl(p,j),onMouseLeave:bl(x,N),onTouchStart:bl(b,j)}]:[!1,y,{}]}function bl(s,e){return a=>{s&&s(a),a.defaultPrevented||e(a)}}function j2({page:s,...e}){let{router:a}=lv(),i=v.useMemo(()=>Yy(a.routes,s,a.basename),[a.routes,s,a.basename]);return i?v.createElement(S2,{page:s,matches:i,...e}):null}function N2(s){let{manifest:e,routeModules:a}=ov(),[i,o]=v.useState([]);return v.useEffect(()=>{let u=!1;return p2(s,e,a).then(d=>{u||o(d)}),()=>{u=!0}},[s,e,a]),i}function S2({page:s,matches:e,...a}){let i=Oa(),{future:o,manifest:u,routeModules:d}=ov(),{basename:f}=lv(),{loaderData:m,matches:p}=v2(),x=v.useMemo(()=>Hx(s,e,p,u,i,"data"),[s,e,p,u,i]),b=v.useMemo(()=>Hx(s,e,p,u,i,"assets"),[s,e,p,u,i]),y=v.useMemo(()=>{if(s===i.pathname+i.search+i.hash)return[];let k=new Set,T=!1;if(e.forEach(A=>{let C=u.routes[A.route.id];!C||!C.hasLoader||(!x.some(B=>B.route.id===A.route.id)&&A.route.id in m&&d[A.route.id]?.shouldRevalidate||C.hasClientLoader?T=!0:k.add(A.route.id))}),k.size===0)return[];let R=h2(s,f,o.unstable_trailingSlashAwareDataRequests,"data");return T&&k.size>0&&R.searchParams.set("_routes",e.filter(A=>k.has(A.route.id)).map(A=>A.route.id).join(",")),[R.pathname+R.search]},[f,o.unstable_trailingSlashAwareDataRequests,m,i,u,x,e,s,d]),j=v.useMemo(()=>g2(b,u),[b,u]),N=N2(b);return v.createElement(v.Fragment,null,y.map(k=>v.createElement("link",{key:k,rel:"prefetch",as:"fetch",href:k,...a})),j.map(k=>v.createElement("link",{key:k,rel:"modulepreload",href:k,...a})),N.map(({key:k,link:T})=>v.createElement("link",{key:k,nonce:a.nonce,...T,crossOrigin:T.crossOrigin??a.crossOrigin})))}function _2(...s){return e=>{s.forEach(a=>{typeof a=="function"?a(e):a!=null&&(a.current=e)})}}var k2=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{k2&&(window.__reactRouterVersion="7.13.0")}catch{}function T2({basename:s,children:e,unstable_useTransitions:a,window:i}){let o=v.useRef();o.current==null&&(o.current=rS({window:i,v5Compat:!0}));let u=o.current,[d,f]=v.useState({action:u.action,location:u.location}),m=v.useCallback(p=>{a===!1?f(p):v.startTransition(()=>f(p))},[a]);return v.useLayoutEffect(()=>u.listen(m),[u,m]),v.createElement(s2,{basename:s,children:e,location:d.location,navigationType:d.action,navigator:u,unstable_useTransitions:a})}var cv=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Zc=v.forwardRef(function({onClick:e,discover:a="render",prefetch:i="none",relative:o,reloadDocument:u,replace:d,state:f,target:m,to:p,preventScrollReset:x,viewTransition:b,unstable_defaultShouldRevalidate:y,...j},N){let{basename:k,unstable_useTransitions:T}=v.useContext(Is),R=typeof p=="string"&&cv.test(p),A=Zy(p,k);p=A.to;let C=BS(p,{relative:o}),[B,F,V]=w2(i,j),O=A2(p,{replace:d,state:f,target:m,preventScrollReset:x,relative:o,viewTransition:b,unstable_defaultShouldRevalidate:y,unstable_useTransitions:T});function H(me){e&&e(me),me.defaultPrevented||O(me)}let te=v.createElement("a",{...j,...V,href:A.absoluteURL||C,onClick:A.isExternal||u?e:H,ref:_2(N,F),target:m,"data-discover":!R&&a==="render"?"true":void 0});return B&&!R?v.createElement(v.Fragment,null,te,v.createElement(j2,{page:C})):te});Zc.displayName="Link";var hr=v.forwardRef(function({"aria-current":e="page",caseSensitive:a=!1,className:i="",end:o=!1,style:u,to:d,viewTransition:f,children:m,...p},x){let b=Fl(d,{relative:p.relative}),y=Oa(),j=v.useContext(Jc),{navigator:N,basename:k}=v.useContext(Is),T=j!=null&&U2(b)&&f===!0,R=N.encodeLocation?N.encodeLocation(b).pathname:b.pathname,A=y.pathname,C=j&&j.navigation&&j.navigation.location?j.navigation.location.pathname:null;a||(A=A.toLowerCase(),C=C?C.toLowerCase():null,R=R.toLowerCase()),C&&k&&(C=Jn(C,k)||C);const B=R!=="/"&&R.endsWith("/")?R.length-1:R.length;let F=A===R||!o&&A.startsWith(R)&&A.charAt(B)==="/",V=C!=null&&(C===R||!o&&C.startsWith(R)&&C.charAt(R.length)==="/"),O={isActive:F,isPending:V,isTransitioning:T},H=F?e:void 0,te;typeof i=="function"?te=i(O):te=[i,F?"active":null,V?"pending":null,T?"transitioning":null].filter(Boolean).join(" ");let me=typeof u=="function"?u(O):u;return v.createElement(Zc,{...p,"aria-current":H,className:te,ref:x,style:me,to:d,viewTransition:f},typeof m=="function"?m(O):m)});hr.displayName="NavLink";var E2=v.forwardRef(({discover:s="render",fetcherKey:e,navigate:a,reloadDocument:i,replace:o,state:u,method:d=Ec,action:f,onSubmit:m,relative:p,preventScrollReset:x,viewTransition:b,unstable_defaultShouldRevalidate:y,...j},N)=>{let{unstable_useTransitions:k}=v.useContext(Is),T=O2(),R=M2(f,{relative:p}),A=d.toLowerCase()==="get"?"get":"post",C=typeof f=="string"&&cv.test(f),B=F=>{if(m&&m(F),F.defaultPrevented)return;F.preventDefault();let V=F.nativeEvent.submitter,O=V?.getAttribute("formmethod")||d,H=()=>T(V||F.currentTarget,{fetcherKey:e,method:O,navigate:a,replace:o,state:u,relative:p,preventScrollReset:x,viewTransition:b,unstable_defaultShouldRevalidate:y});k&&a!==!1?v.startTransition(()=>H()):H()};return v.createElement("form",{ref:N,method:A,action:R,onSubmit:i?m:B,...j,"data-discover":!C&&s==="render"?"true":void 0})});E2.displayName="Form";function C2(s){return`${s} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function uv(s){let e=v.useContext(ji);return kt(e,C2(s)),e}function A2(s,{target:e,replace:a,state:i,preventScrollReset:o,relative:u,viewTransition:d,unstable_defaultShouldRevalidate:f,unstable_useTransitions:m}={}){let p=_n(),x=Oa(),b=Fl(s,{relative:u});return v.useCallback(y=>{if(o2(y,e)){y.preventDefault();let j=a!==void 0?a:Cl(x)===Cl(b),N=()=>p(s,{replace:j,state:i,preventScrollReset:o,relative:u,viewTransition:d,unstable_defaultShouldRevalidate:f});m?v.startTransition(()=>N()):N()}},[x,p,b,a,i,e,s,o,u,d,f,m])}var R2=0,D2=()=>`__${String(++R2)}__`;function O2(){let{router:s}=uv("useSubmit"),{basename:e}=v.useContext(Is),a=ZS(),i=s.fetch,o=s.navigate;return v.useCallback(async(u,d={})=>{let{action:f,method:m,encType:p,formData:x,body:b}=d2(u,e);if(d.navigate===!1){let y=d.fetcherKey||D2();await i(y,a,d.action||f,{unstable_defaultShouldRevalidate:d.unstable_defaultShouldRevalidate,preventScrollReset:d.preventScrollReset,formData:x,body:b,formMethod:d.method||m,formEncType:d.encType||p,flushSync:d.flushSync})}else await o(d.action||f,{unstable_defaultShouldRevalidate:d.unstable_defaultShouldRevalidate,preventScrollReset:d.preventScrollReset,formData:x,body:b,formMethod:d.method||m,formEncType:d.encType||p,replace:d.replace,state:d.state,fromRouteId:a,flushSync:d.flushSync,viewTransition:d.viewTransition})},[i,o,e,a])}function M2(s,{relative:e}={}){let{basename:a}=v.useContext(Is),i=v.useContext(fn);kt(i,"useFormAction must be used inside a RouteContext");let[o]=i.matches.slice(-1),u={...Fl(s||".",{relative:e})},d=Oa();if(s==null){u.search=d.search;let f=new URLSearchParams(u.search),m=f.getAll("index");if(m.some(x=>x==="")){f.delete("index"),m.filter(b=>b).forEach(b=>f.append("index",b));let x=f.toString();u.search=x?`?${x}`:""}}return(!s||s===".")&&o.route.index&&(u.search=u.search?u.search.replace(/^\?/,"?index&"):"?index"),a!=="/"&&(u.pathname=u.pathname==="/"?a:Fn([a,u.pathname])),Cl(u)}function U2(s,{relative:e}={}){let a=v.useContext(ev);kt(a!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=uv("useViewTransitionState"),o=Fl(s,{relative:e});if(!a.isTransitioning)return!1;let u=Jn(a.currentLocation.pathname,i)||a.currentLocation.pathname,d=Jn(a.nextLocation.pathname,i)||a.nextLocation.pathname;return Uc(o.pathname,d)!=null||Uc(o.pathname,u)!=null}var L2=Ky();const on={student:"student",coach:"coach",admin:"admin"};const dv=(...s)=>s.filter((e,a,i)=>!!e&&e.trim()!==""&&i.indexOf(e)===a).join(" ").trim();const P2=s=>s.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();const I2=s=>s.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,a,i)=>i?i.toUpperCase():a.toLowerCase());const Gx=s=>{const e=I2(s);return e.charAt(0).toUpperCase()+e.slice(1)};var B2={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const z2=s=>{for(const e in s)if(e.startsWith("aria-")||e==="role"||e==="title")return!0;return!1};const V2=v.forwardRef(({color:s="currentColor",size:e=24,strokeWidth:a=2,absoluteStrokeWidth:i,className:o="",children:u,iconNode:d,...f},m)=>v.createElement("svg",{ref:m,...B2,width:e,height:e,stroke:s,strokeWidth:i?Number(a)*24/Number(e):a,className:dv("lucide",o),...!u&&!z2(f)&&{"aria-hidden":"true"},...f},[...d.map(([p,x])=>v.createElement(p,x)),...Array.isArray(u)?u:[u]]));const Ne=(s,e)=>{const a=v.forwardRef(({className:i,...o},u)=>v.createElement(V2,{ref:u,iconNode:e,className:dv(`lucide-${P2(Gx(s))}`,`lucide-${s}`,i),...o}));return a.displayName=Gx(s),a};const $2=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],q2=Ne("activity",$2);const H2=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],G2=Ne("arrow-right",H2);const F2=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],K2=Ne("bell",F2);const Y2=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],Al=Ne("book-open",Y2);const X2=[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]],J2=Ne("briefcase",X2);const Q2=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],gs=Ne("calendar",Q2);const Z2=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],W2=Ne("chart-column",Z2);const e_=[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]],Lc=Ne("check-check",e_);const t_=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],hv=Ne("check",t_);const s_=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],n_=Ne("chevron-down",s_);const a_=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Fx=Ne("chevron-right",a_);const r_=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],i_=Ne("chevron-up",r_);const l_=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],sf=Ne("circle-alert",l_);const o_=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Kn=Ne("circle-check-big",o_);const c_=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],nf=Ne("circle-check",c_);const u_=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],fv=Ne("circle-x",u_);const d_=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]],h_=Ne("clipboard-check",d_);const f_=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],af=Ne("clipboard-list",f_);const m_=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Ca=Ne("clock",m_);const p_=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],g_=Ne("download",p_);const x_=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]],Rl=Ne("ellipsis-vertical",x_);const b_=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],mv=Ne("eye",b_);const y_=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Kl=Ne("file-text",y_);const v_=[["path",{d:"M4 20h16a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.93a2 2 0 0 1-1.66-.9l-.82-1.2A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13c0 1.1.9 2 2 2Z",key:"1fr9dc"}],["path",{d:"M8 10v4",key:"tgpxqk"}],["path",{d:"M12 10v2",key:"hh53o1"}],["path",{d:"M16 10v6",key:"1d6xys"}]],mr=Ne("folder-kanban",v_);const w_=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]],j_=Ne("folder-open",w_);const N_=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],S_=Ne("funnel",N_);const __=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],k_=Ne("globe",__);const T_=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],E_=Ne("house",T_);const C_=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],A_=Ne("info",C_);const R_=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],Kx=Ne("layers",R_);const D_=[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]],O_=Ne("layout-dashboard",D_);const M_=[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]],U_=Ne("lightbulb",M_);const L_=[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]],pv=Ne("link-2",L_);const P_=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],Dl=Ne("log-out",P_);const I_=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],gv=Ne("mail",I_);const B_=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],xv=Ne("map-pin",B_);const z_=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],Pc=Ne("menu",z_);const V_=[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]],Ol=Ne("message-circle",V_);const $_=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],yi=Ne("message-square",$_);const q_=[["path",{d:"M12 19v3",key:"npa21l"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M16.95 16.95A7 7 0 0 1 5 12v-2",key:"cqa7eg"}],["path",{d:"M18.89 13.23A7 7 0 0 0 19 12v-2",key:"16hl24"}],["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}]],H_=Ne("mic-off",q_);const G_=[["path",{d:"M12 19v3",key:"npa21l"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["rect",{x:"9",y:"2",width:"6",height:"13",rx:"3",key:"s6n7sd"}]],F_=Ne("mic",G_);const K_=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],Y_=Ne("pen",K_);const X_=[["path",{d:"M10.1 13.9a14 14 0 0 0 3.732 2.668 1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2 18 18 0 0 1-12.728-5.272",key:"1wngk7"}],["path",{d:"M22 2 2 22",key:"y4kqgn"}],["path",{d:"M4.76 13.582A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 .244.473",key:"10hv5p"}]],J_=Ne("phone-off",X_);const Q_=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],bv=Ne("phone",Q_);const Z_=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Yn=Ne("plus",Z_);const W_=[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]],ek=Ne("refresh-ccw",W_);const tk=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],sk=Ne("rotate-ccw",tk);const nk=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],ak=Ne("save",nk);const rk=[["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M18 5v16",key:"1ethyx"}],["path",{d:"m4 6 7.106-3.79a2 2 0 0 1 1.788 0L20 6",key:"zywc2d"}],["path",{d:"m6 11-3.52 2.147a1 1 0 0 0-.48.854V19a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-5a1 1 0 0 0-.48-.853L18 11",key:"1d4ql0"}],["path",{d:"M6 5v16",key:"1sn0nx"}],["circle",{cx:"12",cy:"9",r:"2",key:"1092wv"}]],ik=Ne("school",rk);const lk=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],Zn=Ne("search",lk);const ok=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],yv=Ne("send",ok);const ck=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],vv=Ne("settings",ck);const uk=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]],Yx=Ne("shield-alert",uk);const dk=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],rf=Ne("shield",dk);const hk=[["path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344",key:"2acyp4"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Ic=Ne("square-check-big",hk);const fk=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],wv=Ne("square-pen",fk);const mk=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],pk=Ne("star",mk);const gk=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],jn=Ne("target",gk);const xk=[["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}],["path",{d:"M7 10v12",key:"1qc93n"}]],bk=Ne("thumbs-up",xk);const yk=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],jv=Ne("trash-2",yk);const vk=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],Nv=Ne("trending-up",vk);const wk=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Sv=Ne("triangle-alert",wk);const jk=[["path",{d:"M12 4v16",key:"1654pz"}],["path",{d:"M4 7V5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2",key:"e0r10z"}],["path",{d:"M9 20h6",key:"s66wpe"}]],Nk=Ne("type",jk);const Sk=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],fr=Ne("user",Sk);const _k=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],dn=Ne("users",_k);const kk=[["path",{d:"M10.66 6H14a2 2 0 0 1 2 2v2.5l5.248-3.062A.5.5 0 0 1 22 7.87v8.196",key:"w8jjjt"}],["path",{d:"M16 16a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h2",key:"1xawa7"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],Tk=Ne("video-off",kk);const Ek=[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]],Yl=Ne("video",Ek);const Ck=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Qf=Ne("x",Ck),_v=v.createContext(null),gt=()=>{const s=v.useContext(_v);if(!s)throw new Error("useAuth must be used within AuthProvider");return s},kv=v.createContext(null),yt=()=>{const s=v.useContext(kv);if(!s)throw new Error("useData must be used within DataProvider");return s};function Pt({open:s,isOpen:e,title:a,children:i,onClose:o,footer:u}){const d=s??e??!1;return v.useEffect(()=>{if(!d)return;const f=m=>{m.key==="Escape"&&o?.()};return window.addEventListener("keydown",f),()=>window.removeEventListener("keydown",f)},[d,o]),d?L2.createPortal(r.jsxs("div",{className:"fixed inset-0 z-50 flex items-end sm:items-center justify-center p-3 sm:p-4",children:[r.jsx("div",{className:"absolute inset-0 bg-slate-900/40 backdrop-blur-sm transition-opacity",onClick:o}),r.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl relative z-10 w-full max-w-2xl max-h-[90vh] overflow-hidden animate-in fade-in zoom-in-95 duration-200 flex flex-col",role:"dialog","aria-modal":"true","aria-label":a??"Dialog",children:[r.jsxs("div",{className:"flex items-center justify-between px-4 sm:px-6 py-4 border-b border-slate-100 flex-none",children:[r.jsx("div",{children:a?r.jsx("h3",{className:"text-lg font-heading font-semibold text-slate-800",children:a}):null}),r.jsx("button",{type:"button",className:"text-slate-400 hover:text-slate-600 hover:bg-slate-100 p-2 rounded-full transition-colors",onClick:o,"aria-label":"Close",children:r.jsx(Qf,{className:"h-5 w-5"})})]}),r.jsx("div",{className:"p-4 sm:p-6 overflow-y-auto flex-1",children:i}),u?r.jsx("div",{className:"bg-slate-50 px-4 sm:px-6 py-4 flex items-center justify-end gap-3 border-t border-slate-100 flex-none",children:u}):null]})]}),document.body):null}function Xl({open:s,isOpen:e,title:a="Confirm",message:i,description:o,confirmLabel:u="Confirm",cancelLabel:d="Cancel",danger:f=!1,isDanger:m,onConfirm:p,onClose:x,busy:b,isLoading:y}){const j=s??e??!1,N=i??o,k=b??y,T=f??m;return r.jsx(Pt,{open:j,title:a,onClose:k?void 0:x,footer:r.jsxs(r.Fragment,{children:[r.jsx("button",{type:"button",className:"btn-ghost",onClick:x,disabled:k,children:d}),r.jsx("button",{type:"button",className:T?"btn-danger":"btn-primary",onClick:p,disabled:k,children:k?"Working":u})]}),children:r.jsx("div",{className:"text-sm text-slate-700",children:N})})}function Bc({className:s="",buttonClassName:e=""}){const{currentUser:a}=gt(),{listNotifications:i,refreshNotifications:o,markNotificationRead:u,markAllNotificationsRead:d}=yt(),f=_n(),[m,p]=v.useState(!1),x=v.useRef(null),b=v.useMemo(()=>!a?.id||!i?[]:i({userId:a.id,limit:8}),[a?.id,i]),y=v.useMemo(()=>b.filter(N=>!N.readAt).length,[b]);v.useEffect(()=>{const N=k=>{m&&x.current&&(x.current.contains(k.target)||p(!1))};return window.addEventListener("mousedown",N),()=>window.removeEventListener("mousedown",N)},[m]),v.useEffect(()=>{!a?.id||!o||o()},[a?.id,o]);const j=async N=>{try{!N.readAt&&u&&await u({notificationId:N.id})}finally{p(!1),N.linkUrl&&f(N.linkUrl)}};return r.jsxs("div",{ref:x,className:["relative",s].join(" "),children:[r.jsxs("button",{type:"button",onClick:()=>p(N=>!N),className:["relative p-2 rounded-full transition-colors","text-slate-400 hover:text-slate-700 hover:bg-slate-100",e].join(" "),"aria-label":"Notifications",children:[r.jsx(K2,{className:"h-5 w-5"}),y>0?r.jsx("span",{className:"absolute -top-0.5 -right-0.5 min-w-[18px] h-[18px] px-1 rounded-full bg-red-500 text-white text-[10px] font-bold grid place-items-center ring-2 ring-white",children:y>9?"9+":y}):null]}),m?r.jsxs("div",{className:"absolute right-0 mt-2 w-80 max-w-[90vw] rounded-2xl border border-slate-200 bg-white shadow-xl overflow-hidden z-50",children:[r.jsxs("div",{className:"px-4 py-3 border-b border-slate-100 flex items-center justify-between",children:[r.jsx("div",{className:"text-sm font-heading font-bold text-slate-900",children:"Notifications"}),r.jsxs("button",{type:"button",className:"inline-flex items-center gap-2 text-xs font-semibold text-slate-500 hover:text-slate-700",onClick:async()=>{!a?.id||!d||await d({userId:a.id})},disabled:!a?.id||y===0,title:"Mark all as read",children:[r.jsx(Lc,{className:"h-4 w-4"}),"Mark all"]})]}),b.length===0?r.jsx("div",{className:"px-4 py-6 text-sm text-slate-500",children:"No notifications yet."}):r.jsx("div",{className:"max-h-[380px] overflow-auto",children:b.map(N=>r.jsx("button",{type:"button",onClick:()=>j(N),className:["w-full text-left px-4 py-3 border-b border-slate-50 hover:bg-slate-50 transition-colors",N.readAt?"bg-white":"bg-blue-50/40"].join(" "),children:r.jsxs("div",{className:"flex items-start justify-between gap-3",children:[r.jsxs("div",{className:"min-w-0",children:[r.jsx("div",{className:"text-sm font-semibold text-slate-900 truncate",children:N.title??"Notification"}),N.message?r.jsx("div",{className:"mt-0.5 text-xs text-slate-600 line-clamp-2",children:N.message}):null,r.jsx("div",{className:"mt-1 text-[10px] text-slate-400",children:N.createdAt?new Date(N.createdAt).toLocaleString():""})]}),N.readAt?null:r.jsx("span",{className:"mt-1 h-2 w-2 rounded-full bg-blue-600 flex-shrink-0"})]})},N.id))})]}):null]})}function Ak(){const{logout:s,currentUser:e}=gt(),a=_n(),[i,o]=v.useState(!0),{getUserById:u}=yt(),d=e?.id?u(e.id):null,[f,m]=v.useState(!1),[p,x]=v.useState(!1),b=()=>m(!0),y=async()=>{try{x(!0),await s(),a("/login",{replace:!0})}finally{x(!1),m(!1)}},j=[{label:"Overview",to:"/admin",icon:q2,end:!0},{label:"Projects",to:"/admin/projects",icon:mr},{label:"Programs",to:"/admin/programs",icon:Kx},{label:"Applications",to:"/admin/applications",icon:Kx},{label:"Users",to:"/admin/users",icon:dn},{label:"Reports",to:"/admin/reports",icon:W2},{label:"Settings",to:"/admin/settings",icon:vv}];return r.jsxs("div",{className:"min-h-screen bg-slate-50 font-sans text-slate-900 flex flex-col md:flex-row",children:[r.jsxs("aside",{className:`bg-slate-900 text-white flex-shrink-0 transition-all duration-300 ease-in-out flex flex-col shadow-xl z-20 
          ${i?"w-64":"w-20"}
          hidden md:flex sticky top-0 h-screen
        `,children:[r.jsxs("div",{className:"h-16 flex items-center px-4 bg-slate-950/50 border-b border-white/5 justify-between",children:[i&&r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"bg-admin-accent/20 p-1.5 rounded-lg",children:r.jsx(rf,{className:"h-5 w-5 text-admin-accent"})}),r.jsx("span",{className:"font-heading font-bold text-lg tracking-wide text-white",children:"ADMIN"})]}),r.jsx("button",{onClick:()=>o(!i),className:`p-2 hover:bg-white/10 rounded-lg transition-colors text-slate-400 hover:text-white ${!i&&"mx-auto"}`,children:r.jsx(Pc,{className:"h-5 w-5"})})]}),r.jsxs("div",{className:"px-4 py-6",children:[i&&r.jsx("p",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider mb-4 px-2",children:"Main Menu"}),r.jsx("nav",{className:"space-y-1",children:j.map(N=>r.jsxs(hr,{to:N.to,end:N.end,className:({isActive:k})=>`flex items-center gap-3 px-3 py-2.5 rounded-xl text-sm font-medium transition-all duration-200 group
                    ${k?"bg-admin-primary text-white shadow-lg shadow-blue-900/20":"text-slate-400 hover:bg-white/5 hover:text-slate-100"}`,children:[r.jsx(N.icon,{className:`h-5 w-5 flex-shrink-0 transition-colors ${!i&&"mx-auto"}`}),i&&r.jsx("span",{children:N.label})]},N.to))})]}),r.jsxs("div",{className:"mt-auto p-4 border-t border-white/5 bg-black/20",children:[i?r.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[r.jsx("div",{className:"h-10 w-10 rounded-full bg-admin-primary flex items-center justify-center font-bold text-white shadow-md ring-2 ring-white/10",children:d?.name?.charAt(0)||"A"}),r.jsxs("div",{className:"overflow-hidden",children:[r.jsx("div",{className:"font-bold text-sm text-white truncate",children:d?.name||"Administrator"}),r.jsxs("div",{className:"text-[10px] text-emerald-400 font-medium flex items-center gap-1",children:[r.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-emerald-500 animate-pulse"}),"Online"]})]})]}):r.jsx("div",{className:"flex justify-center mb-4",children:r.jsx("div",{className:"h-8 w-8 rounded-full bg-admin-primary flex items-center justify-center font-bold text-xs text-white",children:d?.name?.charAt(0)||"A"})}),r.jsxs("button",{onClick:b,className:`flex items-center gap-2 text-slate-400 hover:text-red-400 transition-colors w-full p-2 rounded-lg hover:bg-white/5 ${!i&&"justify-center"}`,children:[r.jsx(Dl,{className:"h-5 w-5"}),i&&r.jsx("span",{className:"text-sm font-medium",children:"Sign Out"})]})]})]}),r.jsxs("div",{className:"md:hidden flex flex-col",children:[r.jsxs("header",{className:"h-16 bg-slate-900 text-white flex items-center justify-between px-4 shadow-md sticky top-0 z-30",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"bg-admin-accent/20 p-1.5 rounded-lg",children:r.jsx(rf,{className:"h-5 w-5 text-admin-accent"})}),r.jsx("span",{className:"font-heading font-bold text-lg tracking-wide",children:"ADMIN"})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Bc,{buttonClassName:"text-slate-300 hover:text-white hover:bg-white/10"}),r.jsx("button",{onClick:()=>o(!i),className:"p-2 text-slate-400 hover:text-white",children:r.jsx(Pc,{className:"h-6 w-6"})})]})]}),i&&r.jsxs("div",{className:"bg-slate-800 text-white border-b border-white/10 p-4 space-y-2 animate-in slide-in-from-top-2",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-4 pb-4 border-b border-white/10",children:[r.jsx("div",{className:"h-10 w-10 rounded-full bg-admin-primary flex items-center justify-center font-bold text-white shadow-md ring-2 ring-white/10",children:d?.name?.charAt(0)||"A"}),r.jsxs("div",{children:[r.jsx("div",{className:"font-bold text-sm text-white",children:d?.name||"Administrator"}),r.jsx("div",{className:"text-xs text-emerald-400 font-medium",children:"Online"})]})]}),j.map(N=>r.jsxs(hr,{to:N.to,end:N.end,onClick:()=>o(!1),className:({isActive:k})=>`flex items-center gap-3 px-4 py-3 rounded-xl text-sm font-medium transition-colors
                            ${k?"bg-admin-primary text-white":"text-slate-400 hover:bg-white/5"}`,children:[r.jsx(N.icon,{className:"h-5 w-5"}),N.label]},N.to)),r.jsxs("button",{onClick:b,className:"w-full flex items-center gap-3 px-4 py-3 rounded-xl text-sm font-medium text-slate-400 hover:text-red-400 hover:bg-white/5 mt-2",children:[r.jsx(Dl,{className:"h-5 w-5"}),"Sign Out"]})]})]}),r.jsxs("div",{className:"flex-1 flex flex-col min-w-0 overflow-hidden",children:[r.jsxs("header",{className:"h-16 bg-white border-b border-slate-200 flex items-center justify-between px-8 shadow-sm z-10 sticky top-0",children:[r.jsxs("div",{className:"flex items-center gap-4 text-slate-400",children:[r.jsx(Zn,{className:"h-4 w-4"}),r.jsx("input",{type:"text",placeholder:"Type to search...",className:"bg-transparent text-sm focus:outline-none text-slate-700 w-64 placeholder:text-slate-400"})]}),r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx(Bc,{}),r.jsx("div",{className:"h-8 w-px bg-slate-200 mx-2"}),r.jsxs("div",{className:"text-right hidden sm:block",children:[r.jsx("div",{className:"text-xs font-bold text-slate-900 uppercase tracking-wide",children:"SEA Platform"}),r.jsx("div",{className:"text-[10px] text-slate-500",children:"v2.4.0 (Stable)"})]})]})]}),r.jsx("main",{className:"flex-1 overflow-auto bg-slate-50 p-6 md:p-8",children:r.jsx("div",{className:"max-w-7xl mx-auto space-y-8 animate-in fade-in duration-500 slide-in-from-bottom-4",children:r.jsx(Yf,{})})})]}),r.jsx(Xl,{open:f,title:"Sign out",message:"Are you sure you want to sign out?",confirmLabel:"Sign out",cancelLabel:"Cancel",danger:!0,busy:p,onClose:()=>m(!1),onConfirm:y})]})}function Rk(){const{logout:s,currentUser:e}=gt(),{getUserById:a}=yt(),i=e?.id?a(e.id):null,o=_n(),[u,d]=v.useState(!0),[f,m]=v.useState(!1),[p,x]=v.useState(!1),b=()=>m(!0),y=async()=>{try{x(!0),await s(),o("/login",{replace:!0})}finally{x(!1),m(!1)}},j=[{label:"Dashboard",to:"/coach",icon:O_,end:!0},{label:"Projects",to:"/coach/projects",icon:mr},{label:"Tasks",to:"/coach/tasks",icon:jn},{label:"Students",to:"/coach/students",icon:dn},{label:"Programs",to:"/coach/programs",icon:k_},{label:"Sessions",to:"/coach/sessions",icon:Ic},{label:"Deliverables",to:"/coach/deliverables",icon:Ic},{label:"Messages",to:"/coach/messages",icon:yi}];return r.jsxs("div",{className:"min-h-screen bg-coach-bg flex flex-col md:flex-row font-sans text-coach-text",children:[r.jsxs("aside",{className:`bg-coach-secondary text-white flex-shrink-0 transition-all duration-300 ease-in-out hidden md:flex flex-col shadow-xl z-20 sticky top-0 h-screen
          ${u?"w-64":"w-20"}
        `,children:[r.jsxs("div",{className:"h-16 flex items-center px-4 bg-coach-secondary/50 border-b border-white/10 justify-between",children:[u&&r.jsxs("span",{className:"font-heading font-bold text-lg tracking-wide text-white",children:["COACH",r.jsx("span",{className:"text-coach-primary font-normal ml-1 bg-white px-1 rounded text-xs py-0.5",children:"PRO"})]}),r.jsx("button",{onClick:()=>d(!u),className:"p-2 hover:bg-white/10 rounded-lg transition-colors",children:r.jsx(Pc,{className:"h-5 w-5"})})]}),r.jsx("nav",{className:"flex-1 py-6 px-3 space-y-2",children:j.map(N=>r.jsxs(hr,{to:N.to,end:N.end,className:({isActive:k})=>`flex items-center gap-3 px-3 py-3 rounded-md text-sm font-medium transition-colors
                ${k?"bg-coach-primary text-white shadow-lg":"text-slate-300 hover:bg-white/10 hover:text-white"}`,children:[r.jsx(N.icon,{className:`h-5 w-5 flex-shrink-0 ${!u&&"mx-auto"}`}),u&&r.jsx("span",{className:"font-heading",children:N.label})]},N.to))}),r.jsxs("div",{className:"p-4 border-t border-white/10 bg-black/20",children:[r.jsxs("div",{className:`flex items-center gap-3 ${!u&&"justify-center"}`,children:[r.jsx("div",{className:"h-10 w-10 rounded bg-coach-primary flex items-center justify-center font-bold text-white text-sm shadow-md ring-2 ring-white/10",children:i?.name?.charAt(0)||"C"}),u&&r.jsxs("div",{className:"overflow-hidden",children:[r.jsx("p",{className:"text-sm font-bold text-white truncate font-heading",children:i?.name}),r.jsx("p",{className:"text-xs text-slate-400 truncate",children:"Senior Coach"})]})]}),r.jsxs("button",{onClick:b,className:`mt-4 w-full flex items-center gap-3 px-3 py-2 text-sm text-slate-300 hover:text-white hover:bg-white/5 rounded transition-colors
                 ${!u&&"justify-center"}
            `,children:[r.jsx(Dl,{className:"h-5 w-5"}),u&&r.jsx("span",{children:"Sign Out"})]})]})]}),r.jsxs("div",{className:"md:hidden flex flex-col shadow-md z-30 relative",children:[r.jsxs("header",{className:"h-16 bg-coach-secondary text-white flex items-center justify-between px-4",children:[r.jsx("div",{className:"flex items-center gap-2",children:r.jsxs("span",{className:"font-heading font-bold text-lg tracking-wide",children:["COACH",r.jsx("span",{className:"font-normal ml-1 bg-white px-1 rounded text-xs py-0.5 text-black",children:"PRO"})]})}),r.jsx("button",{onClick:()=>d(!u),className:"p-2 text-slate-300 hover:text-white",children:r.jsx(Pc,{className:"h-6 w-6"})})]}),u&&r.jsxs("div",{className:"bg-coach-secondary border-t border-white/10 p-4 space-y-2 absolute top-16 left-0 right-0 shadow-xl animate-in slide-in-from-top-2",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-4 pb-4 border-b border-white/10 px-2",children:[r.jsx("div",{className:"h-9 w-9 rounded bg-coach-primary flex items-center justify-center font-bold text-white text-sm shadow-md ring-1 ring-white/10",children:i?.name?.charAt(0)||"C"}),r.jsxs("div",{children:[r.jsx("div",{className:"font-bold text-sm text-white",children:i?.name}),r.jsx("div",{className:"text-xs text-slate-400",children:"Senior Coach"})]})]}),j.map(N=>r.jsxs(hr,{to:N.to,end:N.end,onClick:()=>d(!1),className:({isActive:k})=>`flex items-center gap-3 px-4 py-3 rounded-lg text-sm font-medium transition-colors
                            ${k?"bg-coach-primary text-white":"text-slate-300 hover:bg-white/10"}`,children:[r.jsx(N.icon,{className:"h-5 w-5"}),N.label]},N.to)),r.jsxs("button",{onClick:b,className:"w-full flex items-center gap-3 px-4 py-3 rounded-lg text-sm font-medium text-slate-400 hover:text-white hover:bg-white/5 mt-2",children:[r.jsx(Dl,{className:"h-5 w-5"}),"Sign Out"]})]})]}),r.jsxs("div",{className:"flex-1 flex flex-col min-w-0",children:[r.jsxs("header",{className:"h-16 bg-white border-b border-slate-200 flex items-center justify-between px-6 shadow-sm z-10 sticky top-0",children:[r.jsx("h1",{className:"font-heading font-semibold text-lg text-slate-800",children:"Workspace"}),r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx(Bc,{}),r.jsx("button",{className:"p-2 text-slate-400 hover:text-slate-600 rounded-full hover:bg-slate-100 transition-colors",children:r.jsx(vv,{className:"h-5 w-5"})})]})]}),r.jsx("main",{className:"flex-1 overflow-auto p-4 md:p-6 bg-slate-50",children:r.jsx("div",{className:"max-w-[1600px] mx-auto",children:r.jsx(Yf,{})})})]}),r.jsx(Xl,{open:f,title:"Sign out",message:"Are you sure you want to sign out?",confirmLabel:"Sign out",cancelLabel:"Cancel",danger:!0,busy:p,onClose:()=>m(!1),onConfirm:y})]})}function Dk(){const{logout:s,currentUser:e}=gt(),{getUserById:a}=yt(),i=e?.id?a(e.id):null,o=_n(),[u,d]=v.useState(!1),[f,m]=v.useState(!1),p=()=>d(!0),x=async()=>{try{m(!0),await s(),o("/login",{replace:!0})}finally{m(!1),d(!1)}},b=[{label:"Home",to:"/student",icon:E_,end:!0},{label:"Projects",to:"/student/projects",icon:mr},{label:"My Tasks",to:"/student/tasks",icon:jn},{label:"My Progress",to:"/student/programs",icon:af},{label:"Messages",to:"/student/messages",icon:Ol},{label:"Profile",to:"/student/profile",icon:fr}];return r.jsxs("div",{className:"min-h-screen bg-student-bg font-sans text-student-text",children:[r.jsxs("div",{className:"flex h-screen overflow-hidden",children:[r.jsxs("aside",{className:"w-64 bg-white m-4 rounded-3xl shadow-sm flex-col border border-blue-100 hidden md:flex",children:[r.jsxs("div",{className:"p-8 flex items-center gap-3",children:[r.jsx("div",{className:"h-12 w-12 rounded-full bg-blue-50 flex items-center justify-center text-student-primary shadow-sm",children:r.jsx(fr,{className:"h-6 w-6"})}),r.jsxs("div",{children:[r.jsxs("h2",{className:"font-heading font-bold text-lg text-slate-800",children:["Hello, ",i?.name?.split(" ")[0]||"Student","!"]}),r.jsx("p",{className:"text-xs text-slate-500 font-medium",children:"Let's keep growing"})]})]}),r.jsx("nav",{className:"flex-1 px-4 space-y-3",children:b.map(y=>r.jsxs(hr,{to:y.to,end:y.end,className:({isActive:j})=>`flex items-center gap-4 px-6 py-4 rounded-2xl transition-all duration-300 group
                  ${j?"bg-student-primary text-white shadow-md translate-x-1":"text-slate-500 hover:bg-blue-50 hover:text-student-primary"}`,children:[r.jsx(y.icon,{className:"h-6 w-6 stroke-[1.5]"}),r.jsx("span",{className:"font-heading font-semibold text-base",children:y.label})]},y.to))}),r.jsx("div",{className:"p-6",children:r.jsxs("button",{onClick:p,className:"w-full flex items-center justify-center gap-2 text-slate-400 hover:text-red-500 transition-colors py-4 rounded-xl hover:bg-slate-50",children:[r.jsx(Dl,{className:"h-5 w-5"}),r.jsx("span",{className:"font-medium",children:"Sign Out"})]})})]}),r.jsx("main",{className:"flex-1 overflow-y-auto p-4 md:p-8",children:r.jsxs("div",{className:"max-w-5xl mx-auto space-y-4",children:[r.jsx("div",{className:"sticky top-0 z-40 flex justify-end bg-student-bg/80 backdrop-blur py-2",children:r.jsx(Bc,{})}),r.jsx("div",{className:"space-y-8",children:r.jsx(Yf,{})})]})})]}),r.jsx("div",{className:"md:hidden fixed bottom-0 left-0 right-0 bg-white border-t border-slate-100 flex justify-around p-3 z-50 shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.05)]",children:b.map(y=>r.jsxs(hr,{to:y.to,end:y.end,className:({isActive:j})=>`flex flex-col items-center gap-1 p-2 rounded-xl transition-colors
                ${j?"text-student-primary bg-blue-50":"text-slate-400"}`,children:[r.jsx(y.icon,{className:"h-6 w-6"}),r.jsx("span",{className:"text-[10px] font-medium font-heading",children:y.label})]},y.to))}),r.jsx(Xl,{open:u,title:"Sign out",message:"Are you sure you want to sign out?",confirmLabel:"Sign out",cancelLabel:"Cancel",danger:!0,busy:f,onClose:()=>d(!1),onConfirm:x})]})}function _h({allowedRoles:s,children:e}){const{isAuthenticated:a,role:i}=gt();return a?s&&!s.includes(i)?r.jsx(di,{to:"/unauthorized",replace:!0}):e:r.jsx(di,{to:"/login",replace:!0})}const Tv=v.createContext(null),mn=()=>{const s=v.useContext(Tv);if(!s)throw new Error("useToast must be used within ToastProvider");return s};function Ok(){const s=_n(),{login:e,signup:a,isAuthenticated:i,role:o}=gt(),{push:u}=mn(),[d,f]=v.useState(!1),[m,p]=v.useState(""),[x,b]=v.useState(""),[y,j]=v.useState(""),[N,k]=v.useState(on.student),[T,R]=v.useState(!1);v.useEffect(()=>{if(i){const C=o===on.admin?"/admin":o===on.coach?"/coach":"/student";s(C,{replace:!0})}},[i,o,s]);const A=async C=>{C.preventDefault(),R(!0);try{if(d){const B=await a({email:m,password:x,name:y,role:N});B.success?B.needsEmailConfirmation?(u({type:"success",title:"Confirm your email",message:"We sent you a confirmation email. After confirming, come back and sign in."}),f(!1)):u({type:"success",title:"Account Created",message:"Signed in successfully!"}):u({type:"danger",title:"Signup Failed",message:B.error})}else{const B=await e({email:m,password:x});B.success?u({type:"success",title:"Welcome",message:"Signed in successfully"}):u({type:"danger",title:"Login Failed",message:B.error||"Invalid credentials"})}}catch(B){console.error(B),u({type:"danger",title:"Error",message:"Something went wrong"})}finally{R(!1)}};return i?r.jsx("div",{className:"flex h-screen w-full items-center justify-center bg-slate-50",children:r.jsx("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-slate-200 border-t-blue-600"})}):r.jsx("div",{className:"app-container app-bg flex min-h-screen items-center justify-center px-4",children:r.jsxs("div",{className:"surface-soft w-full max-w-md p-6",children:[r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"mx-auto grid h-12 w-12 place-items-center rounded-2xl bg-primary text-primary-foreground shadow-sm",children:r.jsx("span",{className:"text-sm font-bold",children:"SEA"})}),r.jsx("div",{className:"mt-3 text-lg font-semibold text-foreground",children:"SEA Platform"}),r.jsx("div",{className:"mt-1 text-sm text-muted-foreground",children:d?"Create a new account":"Sign in to your account"})]}),r.jsxs("form",{className:"mt-6 space-y-4",onSubmit:A,children:[d&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{children:[r.jsx("label",{className:"label",htmlFor:"name",children:"Full Name"}),r.jsx("input",{id:"name",type:"text",className:"input",value:y,onChange:C=>j(C.target.value),required:!0,autoComplete:"name",placeholder:"John Doe"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"label",htmlFor:"role",children:"Role"}),r.jsxs("select",{id:"role",className:"input",value:N,onChange:C=>k(C.target.value),children:[r.jsx("option",{value:on.student,children:"Student"}),r.jsx("option",{value:on.coach,children:"Coach"}),r.jsx("option",{value:on.admin,children:"Admin"})]})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"label",htmlFor:"email",children:"Email Address"}),r.jsx("input",{id:"email",type:"email",className:"input",value:m,onChange:C=>p(C.target.value),required:!0,autoComplete:"email",placeholder:"you@example.com"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"label",htmlFor:"password",children:"Password"}),r.jsx("input",{id:"password",type:"password",className:"input",value:x,onChange:C=>b(C.target.value),required:!0,autoComplete:d?"new-password":"current-password",placeholder:"",minLength:6})]}),r.jsx("button",{type:"submit",className:"btn-primary w-full",disabled:T,children:T?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-white/20 border-t-white"}),d?"Creating Account...":"Signing in..."]}):d?"create Account":"Sign In"})]}),r.jsx("div",{className:"mt-6 text-center",children:r.jsxs("p",{className:"text-sm text-muted-foreground",children:[d?"Already have an account?":"Don't have an account?"," ",r.jsx("button",{type:"button",onClick:()=>{f(!d),p(""),b(""),j("")},className:"font-semibold text-primary hover:text-primary-600 focus:outline-none focus:underline",children:d?"Sign in":"Create one"})]})})]})})}function Ye({title:s,subtitle:e,actions:a,children:i,className:o=""}){return r.jsxs("div",{className:`bg-white rounded-xl shadow-sm border border-slate-200/60 overflow-hidden ${o}`,children:[(s||a)&&r.jsxs("div",{className:"px-6 py-4 flex items-center justify-between border-b border-slate-100",children:[r.jsxs("div",{children:[s&&r.jsx("h3",{className:"font-heading font-semibold text-slate-800 text-base",children:s}),e&&r.jsx("p",{className:"text-sm text-slate-500 mt-0.5",children:e})]}),a&&r.jsx("div",{className:"flex items-center gap-2",children:a})]}),r.jsx("div",{className:"p-6",children:i})]})}const Mk={success:"bg-green-100 text-green-700 border border-green-200",warning:"bg-amber-50 text-amber-700 border border-amber-200",danger:"bg-red-50 text-red-700 border border-red-200",neutral:"bg-slate-100 text-slate-700 border border-slate-200",info:"bg-blue-50 text-blue-700 border border-blue-200"},Uk={active:"success",archived:"neutral",pending:"warning",reviewed:"info",approved:"success",accepted:"success",rejected:"danger",scheduled:"info",cancelled:"danger",completed:"success",submitted:"warning",revision:"warning",graded:"success",admin:"neutral",coach:"neutral",student:"neutral"};function ts({value:s}){const e=String(s??"").toLowerCase(),a=Uk[e]||"neutral",i=Mk[a];return r.jsx("span",{className:`inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-semibold capitalize tracking-wide ${i}`,children:String(s??"")})}const es=s=>{if(!s)return"";try{return new Date(s).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"2-digit"})}catch{return String(s)}},ms=s=>{if(!s)return"";try{return new Date(s).toLocaleString(void 0,{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"})}catch{return String(s)}};function Lk(){const{data:s}=yt(),[e,a]=v.useState("all"),[i,o]=v.useState(null),u=v.useMemo(()=>{if(!s)return null;const m=(s.users??[]).filter(A=>A.role==="student"),p=(s.users??[]).filter(A=>A.role==="coach"),x=s.programs??[],y=(s.coachingSessions??[]).filter(A=>A.status==="completed");let j=0,N=0;y.forEach(A=>{j+=A.attendeeStudentIds.length,N+=(A.attendance??[]).filter(C=>C.status==="present").length});const k=j>0?Math.round(N/j*100):0,T=new Date,R=m.filter(A=>{const C=new Date(A.updatedAt),B=(T-C)/(1e3*60*60*24),F=(s.deliverables??[]).filter(V=>V.assignedStudentIds.includes(A.id)&&new Date(V.dueDate)<T&&!V.submissions?.some(O=>O.studentId===A.id)).length;return B>7||F>=2});return{totalStudents:m.length,totalCoaches:p.length,totalPrograms:x.length,avgAttendance:k,atRiskCount:R.length,students:m,atRiskStudents:R}},[s]),d=v.useMemo(()=>u?u.students.filter(m=>e==="all"?!0:e==="inactive"?u.atRiskStudents.some(p=>p.id===m.id):e!=="blocked"):[],[u,e]),f=v.useMemo(()=>!i||!s?[]:(s.messages??[]).filter(m=>m.senderId===i||m.receiverId===i).sort((m,p)=>new Date(m.sentAt)-new Date(p.sentAt)).map(m=>{const p=s.users.find(x=>x.id===m.senderId);return{...m,senderName:p?.name||"Unknown"}}),[i,s]);return u?r.jsxs("div",{className:"space-y-8 animate-in fade-in duration-500",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-heading font-bold tracking-tight text-slate-900 dark:text-white",children:"System Overview"}),r.jsxs("p",{className:"mt-2 text-lg text-slate-500 font-medium",children:["Monitoring ",r.jsxs("span",{className:"font-bold text-slate-700 dark:text-slate-300",children:[u.totalPrograms," active programs"]})," and ",r.jsxs("span",{className:"font-bold text-slate-700 dark:text-slate-300",children:[u.totalStudents," students"]}),"."]})]}),r.jsxs("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-4",children:[r.jsxs("div",{className:"relative overflow-hidden rounded-2xl bg-white p-6 shadow-sm border border-slate-200 group hover:shadow-md transition-all dark:bg-slate-800 dark:border-slate-700",children:[r.jsx("div",{className:"absolute right-0 top-0 h-24 w-24 translate-x-8 translate-y--8 rounded-full bg-slate-900/5 group-hover:bg-slate-900/10 transition-colors"}),r.jsxs("div",{className:"flex items-center gap-4 relative z-10",children:[r.jsx("div",{className:"rounded-xl bg-slate-900 text-white p-3 shadow-lg shadow-slate-900/20",children:r.jsx(dn,{className:"h-6 w-6"})}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-bold uppercase tracking-wider text-slate-500",children:"Total Students"}),r.jsx("h3",{className:"text-2xl font-heading font-bold text-slate-900 dark:text-white",children:u.totalStudents})]})]})]}),r.jsxs("div",{className:"relative overflow-hidden rounded-2xl bg-white p-6 shadow-sm border border-slate-200 group hover:shadow-md transition-all dark:bg-slate-800 dark:border-slate-700",children:[r.jsx("div",{className:"absolute right-0 top-0 h-24 w-24 translate-x-8 translate-y--8 rounded-full bg-indigo-500/10 group-hover:bg-indigo-500/20 transition-colors"}),r.jsxs("div",{className:"flex items-center gap-4 relative z-10",children:[r.jsx("div",{className:"rounded-xl bg-indigo-600 text-white p-3 shadow-lg shadow-indigo-600/20",children:r.jsx(Al,{className:"h-6 w-6"})}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-bold uppercase tracking-wider text-slate-500",children:"Active Programs"}),r.jsx("h3",{className:"text-2xl font-heading font-bold text-slate-900 dark:text-white",children:u.totalPrograms})]})]})]}),r.jsxs("div",{className:"relative overflow-hidden rounded-2xl bg-white p-6 shadow-sm border border-slate-200 group hover:shadow-md transition-all dark:bg-slate-800 dark:border-slate-700",children:[r.jsx("div",{className:"absolute right-0 top-0 h-24 w-24 translate-x-8 translate-y--8 rounded-full bg-emerald-500/10 group-hover:bg-emerald-500/20 transition-colors"}),r.jsxs("div",{className:"flex items-center gap-4 relative z-10",children:[r.jsx("div",{className:"rounded-xl bg-emerald-600 text-white p-3 shadow-lg shadow-emerald-600/20",children:r.jsx(gs,{className:"h-6 w-6"})}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-bold uppercase tracking-wider text-slate-500",children:"Avg. Attendance"}),r.jsxs("h3",{className:"text-2xl font-heading font-bold text-slate-900 dark:text-white",children:[u.avgAttendance,"%"]})]})]})]}),r.jsxs("div",{className:"relative overflow-hidden rounded-2xl bg-white p-6 shadow-sm border border-slate-200 group hover:shadow-md transition-all dark:bg-slate-800 dark:border-slate-700",children:[r.jsx("div",{className:"absolute right-0 top-0 h-24 w-24 translate-x-8 translate-y--8 rounded-full bg-amber-500/10 group-hover:bg-amber-500/20 transition-colors"}),r.jsxs("div",{className:"flex items-center gap-4 relative z-10",children:[r.jsx("div",{className:"rounded-xl bg-amber-500 text-white p-3 shadow-lg shadow-amber-500/20",children:r.jsx(Yx,{className:"h-6 w-6"})}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-bold uppercase tracking-wider text-slate-500",children:"Students At Risk"}),r.jsx("h3",{className:"text-2xl font-heading font-bold text-slate-900 dark:text-white",children:u.atRiskCount})]})]})]})]}),u.atRiskStudents.length>0&&r.jsxs("div",{className:"rounded-2xl border border-amber-200 bg-amber-50 p-6 flex items-start gap-4 shadow-sm dark:bg-amber-900/20 dark:border-amber-900",children:[r.jsx("div",{className:"rounded-full bg-amber-100 p-2 text-amber-600 shrink-0",children:r.jsx(sf,{className:"h-6 w-6"})}),r.jsxs("div",{className:"flex-1",children:[r.jsx("h3",{className:"font-heading font-bold text-amber-900 text-lg mb-1 dark:text-amber-100",children:"Attention Required"}),r.jsxs("p",{className:"text-sm text-amber-800 leading-relaxed dark:text-amber-200",children:[r.jsxs("span",{className:"font-bold",children:[u.atRiskStudents.length," students"]})," have been inactive for over 7 days or have multiple overdue deliverables. This may impact program completion rates."]})]}),r.jsx("button",{onClick:()=>a("inactive"),className:"shrink-0 rounded-xl bg-white px-4 py-2 text-sm font-bold text-amber-700 shadow-sm border border-amber-200 hover:bg-amber-50 active:scale-95 transition-all",children:"View Reports"})]}),r.jsxs("div",{className:"space-y-5",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[r.jsx("h2",{className:"text-xl font-heading font-bold text-slate-900 dark:text-white",children:"Student Monitoring"}),r.jsxs("div",{className:"flex items-center p-1 bg-slate-100 rounded-xl border border-slate-200 dark:bg-slate-800 dark:border-slate-700",children:[r.jsx("button",{onClick:()=>a("all"),className:`px-4 py-2 text-sm font-bold rounded-lg transition-all ${e==="all"?"bg-white text-slate-900 shadow-sm dark:bg-slate-700 dark:text-white":"text-slate-500 hover:text-slate-700 dark:text-slate-400"}`,children:"All Students"}),r.jsx("button",{onClick:()=>a("inactive"),className:`px-4 py-2 text-sm font-bold rounded-lg transition-all ${e==="inactive"?"bg-amber-100 text-amber-700 shadow-sm":"text-slate-500 hover:text-amber-600"}`,children:"At Risk"}),r.jsx("button",{onClick:()=>a("blocked"),className:`px-4 py-2 text-sm font-bold rounded-lg transition-all ${e==="blocked"?"bg-red-100 text-red-700 shadow-sm":"text-slate-500 hover:text-red-600"}`,children:"Blocked"})]})]}),r.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white shadow-sm overflow-hidden dark:bg-slate-800 dark:border-slate-700",children:r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"w-full text-sm text-left",children:[r.jsx("thead",{className:"bg-slate-50 text-slate-500 font-bold font-heading uppercase tracking-wider text-xs border-b border-slate-200 dark:bg-slate-900/50 dark:border-slate-700 dark:text-slate-400",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-6 py-4",children:"Student"}),r.jsx("th",{className:"px-6 py-4",children:"University"}),r.jsx("th",{className:"px-6 py-4",children:"Health Status"}),r.jsx("th",{className:"px-6 py-4",children:"Last Active"}),r.jsx("th",{className:"px-6 py-4 text-right",children:"Actions"})]})}),r.jsx("tbody",{className:"divide-y divide-slate-100 dark:divide-slate-700",children:d.length===0?r.jsx("tr",{children:r.jsxs("td",{colSpan:5,className:"px-6 py-12 text-center text-slate-400",children:[r.jsx("div",{className:"mx-auto mb-3 h-12 w-12 rounded-full bg-slate-100 flex items-center justify-center dark:bg-slate-800",children:r.jsx(Zn,{className:"h-6 w-6 text-slate-300"})}),"No students found matching this filter."]})}):d.map(m=>{const p=u.atRiskStudents.some(x=>x.id===m.id);return r.jsxs("tr",{className:"group hover:bg-slate-50/80 transition-colors dark:hover:bg-slate-700/50",children:[r.jsx("td",{className:"px-6 py-4",children:r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"h-10 w-10 rounded-full bg-slate-900 text-white flex items-center justify-center font-bold text-sm shadow-sm ring-2 ring-slate-50 group-hover:ring-white transition-all",children:m.name.charAt(0)}),r.jsxs("div",{children:[r.jsx("div",{className:"font-bold text-slate-900 dark:text-white",children:m.name}),r.jsx("div",{className:"text-xs text-slate-500 font-medium",children:m.email})]})]})}),r.jsx("td",{className:"px-6 py-4 text-slate-600 font-medium dark:text-slate-300",children:m.university}),r.jsx("td",{className:"px-6 py-4",children:p?r.jsxs("span",{className:"inline-flex items-center gap-1.5 rounded-full bg-amber-50 px-2.5 py-1 text-xs font-bold text-amber-700 border border-amber-200 shadow-sm",children:[r.jsx(sf,{className:"h-3.5 w-3.5"})," At Risk"]}):r.jsxs("span",{className:"inline-flex items-center gap-1.5 rounded-full bg-emerald-50 px-2.5 py-1 text-xs font-bold text-emerald-700 border border-emerald-200 shadow-sm",children:[r.jsx(Kn,{className:"h-3.5 w-3.5"})," Healthy"]})}),r.jsx("td",{className:"px-6 py-4 text-slate-500 font-medium",children:ms(m.updatedAt)}),r.jsx("td",{className:"px-6 py-4 text-right",children:r.jsxs("button",{onClick:()=>o(m.id),className:"inline-flex items-center gap-2 rounded-lg bg-white px-3 py-1.5 text-xs font-bold text-slate-700 shadow-sm ring-1 ring-slate-200 hover:bg-slate-50 hover:text-slate-900 transition-all dark:bg-slate-800 dark:ring-slate-700 dark:text-slate-300",children:[r.jsx(mv,{className:"h-3.5 w-3.5"})," Monitor"]})})]},m.id)})})]})})})]}),r.jsxs(Pt,{isOpen:!!i,onClose:()=>o(null),title:"Communication Log (Read-Only)",children:[r.jsx("div",{className:"h-[400px] overflow-y-auto rounded-xl border border-slate-200 bg-slate-50/50 p-6 scrollbar-thin scrollbar-thumb-slate-200 dark:bg-slate-900/50 dark:border-slate-700",children:f.length===0?r.jsxs("div",{className:"flex h-full flex-col items-center justify-center text-slate-400",children:[r.jsx(yi,{className:"mb-3 h-10 w-10 opacity-20"}),r.jsx("p",{className:"text-sm font-medium",children:"No messages recorded for this student."})]}):r.jsx("div",{className:"space-y-4",children:f.map(m=>r.jsxs("div",{className:"flex flex-col gap-1.5 animate-in slide-in-from-bottom-2",children:[r.jsxs("div",{className:"flex items-center justify-between px-1",children:[r.jsx("span",{className:"text-xs font-bold text-slate-700 dark:text-slate-300",children:m.senderName}),r.jsx("span",{className:"text-[10px] uppercase font-bold text-slate-400 tracking-wide",children:ms(m.sentAt)})]}),r.jsx("div",{className:"rounded-2xl rounded-tl-none border border-slate-200 bg-white p-4 text-sm text-slate-600 shadow-sm dark:bg-slate-800 dark:border-slate-700 dark:text-slate-300",children:m.content})]},m.id))})}),r.jsxs("div",{className:"mt-4 flex items-center justify-center gap-2 rounded-xl bg-amber-50 p-4 text-xs font-bold text-amber-800 border border-amber-100 dark:bg-amber-900/20 dark:text-amber-200 dark:border-amber-900/50",children:[r.jsx(Yx,{className:"h-4 w-4"}),"This view is for monitoring purposes only. You cannot reply from here."]})]})]}):r.jsx("div",{className:"p-8",children:"Loading analytics..."})}function Aa({title:s="No results found",message:e,action:a,icon:i=j_}){const o=i;return r.jsxs("div",{className:"flex flex-col items-center justify-center p-12 text-center bg-slate-50 border-2 border-dashed border-slate-200 rounded-xl",children:[r.jsx("div",{className:"h-12 w-12 rounded-full bg-slate-100 flex items-center justify-center mb-4 text-slate-400",children:r.jsx(o,{className:"h-6 w-6"})}),r.jsx("h3",{className:"font-heading font-semibold text-slate-900 text-base",children:s}),e&&r.jsx("p",{className:"mt-1 max-w-sm text-sm text-slate-500",children:e}),a&&r.jsx("div",{className:"mt-6",children:a})]})}const Xx=s=>`"${(s==null?"":String(s)).replaceAll('"','""')}"`,Pk=({columns:s,rows:e})=>{const a=s.map(o=>Xx(o.header)).join(","),i=e.map(o=>s.map(u=>Xx(u.accessor(o))).join(","));return[a,...i].join(`
`)},Ik=({filename:s,text:e,mime:a="text/plain"})=>{const i=new Blob([e],{type:a}),o=URL.createObjectURL(i),u=document.createElement("a");u.href=o,u.download=s,document.body.appendChild(u),u.click(),u.remove(),URL.revokeObjectURL(o)},gc=s=>String(s??"").toLowerCase();function Wc({title:s,rows:e,columns:a,getRowId:i,initialSort:o,searchPlaceholder:u="Search",actions:d,exportFilename:f}){const[m,p]=v.useState(""),[x,b]=v.useState(1),[y,j]=v.useState(10),[N,k]=v.useState(o??null),T=v.useMemo(()=>{const O=gc(m);return O?e.filter(H=>a.some(te=>{if(te.searchable===!1)return!1;const me=te.accessor(H);return gc(me).includes(O)})):e},[e,a,m]),R=v.useMemo(()=>{if(!N)return T;const O=a.find(me=>me.key===N.key);if(!O)return T;const H=N.dir,te=[...T];return te.sort((me,de)=>{const ye=O.sortValue?O.sortValue(me):O.accessor(me),Ae=O.sortValue?O.sortValue(de):O.accessor(de),Re=gc(ye),ze=gc(Ae);return Re<ze?H==="asc"?-1:1:Re>ze?H==="asc"?1:-1:0}),te},[T,a,N]),A=Math.max(1,Math.ceil(R.length/y)),C=Math.min(x,A),B=v.useMemo(()=>{const O=(C-1)*y;return R.slice(O,O+y)},[R,C,y]),F=O=>{b(1),k(H=>!H||H.key!==O?{key:O,dir:"asc"}:H.dir==="asc"?{key:O,dir:"desc"}:null)},V=()=>{const O=f??`${s??"export"}.csv`,H=Pk({columns:a.map(te=>({header:te.header,accessor:te.accessor})),rows:R});Ik({filename:O,text:H,mime:"text/csv"})};return r.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden",children:[r.jsxs("div",{className:"px-6 py-4 border-b border-slate-100 flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[r.jsxs("div",{children:[s&&r.jsx("h3",{className:"font-heading font-semibold text-slate-800",children:s}),r.jsxs("p",{className:"text-sm text-slate-500 mt-1",children:[R.length," result",R.length!==1&&"s"]})]}),r.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[r.jsxs("div",{className:"relative",children:[r.jsx(Zn,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400"}),r.jsx("input",{type:"text",placeholder:u,value:m,onChange:O=>{p(O.target.value),b(1)},className:"pl-9 pr-4 py-2 text-sm border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 w-full md:w-64"})]}),d,r.jsxs("button",{onClick:V,className:"flex items-center justify-center gap-2 px-3 py-2 text-sm font-medium text-slate-600 bg-slate-50 hover:bg-slate-100 border border-slate-200 rounded-lg transition-colors",children:[r.jsx(g_,{className:"h-4 w-4"}),"Export"]})]})]}),r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"w-full text-left text-sm",children:[r.jsx("thead",{className:"bg-slate-50 border-b border-slate-200 text-xs font-semibold uppercase text-slate-500 tracking-wider",children:r.jsx("tr",{children:a.map(O=>r.jsx("th",{className:`px-6 py-3 transition-colors ${O.sortable===!1?"":"cursor-pointer hover:bg-slate-100"} ${O.align==="right"?"text-right":"text-left"}`,onClick:()=>{O.sortable!==!1&&F(O.key)},children:r.jsxs("div",{className:`flex items-center gap-1 ${O.align==="right"?"justify-end":""}`,children:[O.header,r.jsx("div",{className:"flex flex-col",children:O.sortable===!1?null:r.jsxs(r.Fragment,{children:[N?.key===O.key&&N.dir==="asc"&&r.jsx(i_,{className:"h-3 w-3"}),N?.key===O.key&&N.dir==="desc"&&r.jsx(n_,{className:"h-3 w-3"})]})})]})},O.key))})}),r.jsx("tbody",{className:"divide-y divide-slate-100",children:B.length===0?r.jsx("tr",{children:r.jsx("td",{colSpan:a.length,className:"p-8 text-center text-slate-500",children:r.jsx(Aa,{message:"No results found"})})}):B.map((O,H)=>r.jsx("tr",{className:"hover:bg-slate-50/50 transition-colors",children:a.map(te=>r.jsx("td",{className:`px-6 py-4 whitespace-nowrap text-slate-600 ${te.align==="right"?"text-right":""}`,children:te.cell?te.cell(O):te.accessor(O)},te.key))},i?i(O):O.id||H))})]})}),A>1&&r.jsxs("div",{className:"px-6 py-4 border-t border-slate-100 flex items-center justify-between",children:[r.jsxs("span",{className:"text-sm text-slate-500",children:["Page ",x," of ",A]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("select",{className:"text-sm border border-slate-200 rounded px-2 py-1 focus:outline-none focus:ring-1 focus:ring-slate-300",value:y,onChange:O=>{j(Number(O.target.value)),b(1)},children:[5,10,20,50].map(O=>r.jsxs("option",{value:O,children:[O," / page"]},O))}),r.jsxs("div",{className:"flex gap-1 ml-2",children:[r.jsx("button",{disabled:x<=1,onClick:()=>b(O=>Math.max(1,O-1)),className:"px-3 py-1 text-sm border border-slate-200 rounded hover:bg-slate-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),r.jsx("button",{disabled:x>=A,onClick:()=>b(O=>Math.min(A,O+1)),className:"px-3 py-1 text-sm border border-slate-200 rounded hover:bg-slate-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})]})]})}const Ev=v.createContext(null),Zf=()=>{const s=v.useContext(Ev);if(!s)throw new Error("useProgramManagement must be used within ProgramManagementProvider");return s},Bk=s=>s?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(String(s).trim()):!1,zk=s=>String(s??"").trim().length>0,Cv=(s,e)=>{const a={};for(const i of Object.keys(s)){const o=s[i];for(const u of o){const d=u(e[i],e);if(d!==!0){a[i]=d;break}}}return a},rn={required:s=>e=>zk(e)?!0:`${s} is required`,email:s=>e=>Bk(e)?!0:`${s} must be a valid email`,min:(s,e)=>a=>String(a??"").trim().length>=e?!0:`${s} must be at least ${e} characters`},Vk={name:[rn.required("Name")],description:[rn.required("Description")],durationWeeks:[rn.required("Duration")],startDate:[rn.required("Start date")],endDate:[rn.required("End date")],capacity:[rn.required("Capacity")],status:[rn.required("Status")]},xc=s=>{if(!s)return"";try{return new Date(s).toISOString().slice(0,10)}catch{return""}},Jx=s=>s?new Date(`${s}T00:00:00.000Z`).toISOString():"";function $k(){const{data:s,upsertProgram:e,deleteProgram:a,reset:i}=yt(),{push:o}=mn(),{templates:u,templateDetailsById:d,fetchTemplateDetails:f,upsertTemplate:m,deleteTemplate:p,addStage:x,addContentItem:b,addTaskTemplate:y,deleteStage:j,deleteContentItem:N,deleteTaskTemplate:k}=Zf(),[T,R]=v.useState(!1),[A,C]=v.useState(null),[B,F]=v.useState({}),[V,O]=v.useState(!1),[H,te]=v.useState(""),[me,de]=v.useState({open:!1,programId:null}),[ye,Ae]=v.useState(!1),[Re,ze]=v.useState(null),[J,se]=v.useState("edit"),[he,we]=v.useState(!1),[K,S]=v.useState({name:"",description:"",isActive:!0}),[D,M]=v.useState({}),[I,G]=v.useState(null),[ae,xe]=v.useState({name:"",description:""}),[je,Se]=v.useState({contentType:"video",title:"",url:"",provider:"",durationMinutes:"",description:""}),[pe,qe]=v.useState({title:"",description:"",dueOffsetDays:"",requiresApproval:!0}),Oe=v.useMemo(()=>s?.programs??[],[s?.programs]),Xe=v.useMemo(()=>(s?.users??[]).filter(W=>W.role==="coach"),[s?.users]),vt=v.useMemo(()=>(s?.users??[]).filter(W=>W.role==="student"),[s?.users]),fe=v.useMemo(()=>u.find(W=>W.id===Re)??null,[Re,u]),ve=v.useMemo(()=>Re?d[Re]??null:null,[Re,d]),le=()=>{se("create"),ze(null),G(null),S({name:"",description:"",isActive:!0}),M({}),xe({name:"",description:""}),Se({contentType:"video",title:"",url:"",provider:"",durationMinutes:"",description:""}),qe({title:"",description:"",dueOffsetDays:"",requiresApproval:!0}),Ae(!0)},Ee=async W=>{se("edit"),ze(W),Ae(!0);try{const _=u.find(z=>z.id===W)??null;_&&S({name:_.name??"",description:_.description??"",isActive:!!_.isActive});const U=(await f(W))?.stages?.[0]?.id??null;G(U)}catch(_){o({type:"danger",title:"Error",message:_?.message??"Failed to load template details"})}},Ie=()=>{he||(Ae(!1),M({}))},ot=async()=>{const W={};if(String(K.name??"").trim()||(W.name="Name is required"),M(W),!Object.keys(W).length){we(!0);try{const _=await m({id:J==="edit"?Re:void 0,name:String(K.name??"").trim(),description:String(K.description??"").trim(),isActive:!!K.isActive});se("edit"),ze(_.id),o({type:"success",title:J==="create"?"Template created":"Template updated",message:"Now build stages, then add videos/courses and tasks."});const U=(await f(_.id))?.stages?.[0]?.id??null;G(z=>z??U)}catch(_){o({type:"danger",title:"Error",message:_?.message??"Failed to save template"})}finally{we(!1)}}};v.useEffect(()=>{ye&&J==="edit"&&fe&&S({name:fe.name??"",description:fe.description??"",isActive:!!fe.isActive})},[fe,ye,J]),v.useEffect(()=>{if(!Re||!ve)return;const W=new Set((ve.stages??[]).map(_=>_.id));I&&W.has(I)||G(ve.stages?.[0]?.id??null)},[ve,Re,I]);const ss=async W=>{if(window.confirm("Delete this template? This will delete its stages/content/task templates."))try{await p(W),o({type:"success",title:"Deleted",message:"Template removed."}),Re===W&&(Ae(!1),ze(null))}catch(_){o({type:"danger",title:"Error",message:_?.message??"Failed to delete template"})}},ks=W=>{const _=String(W??"").trim();return _?/^https?:\/\//i.test(_)?null:"URL must start with http:// or https://":"URL is required"},pr=async()=>{if(!Re){o({type:"warning",title:"Save template first",message:"Create the template before adding stages."});return}const W=String(ae.name??"").trim();if(!W){o({type:"warning",title:"Stage name required",message:"Give the stage a name (e.g. IDEA)."});return}we(!0);try{const _=ve?.stages?.length??0,L=await x({templateId:Re,name:W,description:String(ae.description??"").trim(),orderIndex:_});xe({name:"",description:""}),G(L?.id??null),o({type:"success",title:"Stage added",message:"Now add videos/courses and tasks for this stage."})}catch(_){o({type:"danger",title:"Error",message:_?.message??"Failed to add stage"})}finally{we(!1)}},Jt=async()=>{if(!I){o({type:"warning",title:"Pick a stage",message:"Select a stage before adding content."});return}const W=String(je.title??"").trim();if(!W){o({type:"warning",title:"Title required",message:"Give your content a title."});return}const _=ks(je.url);if(_){o({type:"warning",title:"Invalid URL",message:_});return}const L=String(je.durationMinutes??"").trim(),U=L?Number(L):null,z=Number.isFinite(U)&&U>0?U:null,Z=(ve?.contents??[]).filter(re=>re.stageId===I).length;we(!0);try{await b({stageId:I,contentType:je.contentType,title:W,description:String(je.description??"").trim(),url:String(je.url??"").trim(),provider:String(je.provider??"").trim(),durationMinutes:z,orderIndex:Z}),Se(re=>({...re,title:"",url:"",provider:"",durationMinutes:"",description:""})),o({type:"success",title:"Added",message:"Content item added."})}catch(re){o({type:"danger",title:"Error",message:re?.message??"Failed to add content"})}finally{we(!1)}},gr=async()=>{if(!I){o({type:"warning",title:"Pick a stage",message:"Select a stage before adding tasks."});return}const W=String(pe.title??"").trim();if(!W){o({type:"warning",title:"Title required",message:"Give your task a title."});return}const _=String(pe.dueOffsetDays??"").trim(),L=_?Number(_):null,U=Number.isFinite(L)?L:null,z=(ve?.taskTemplates??[]).filter(Z=>Z.stageId===I).length;we(!0);try{await y({stageId:I,title:W,description:String(pe.description??"").trim(),dueOffsetDays:U,orderIndex:z,requiresApproval:!!pe.requiresApproval}),qe(Z=>({...Z,title:"",description:"",dueOffsetDays:""})),o({type:"success",title:"Added",message:"Task template added."})}catch(Z){o({type:"danger",title:"Error",message:Z?.message??"Failed to add task template"})}finally{we(!1)}},Ua=async W=>{if(Re&&window.confirm("Delete this stage? This will remove its content and task templates.")){we(!0);try{if(await j({templateId:Re,stageId:W}),I===W){const _=(ve?.stages??[]).filter(L=>L.id!==W);G(_?.[0]?.id??null)}o({type:"success",title:"Deleted",message:"Stage removed."})}catch(_){o({type:"danger",title:"Error",message:_?.message??"Failed to delete stage"})}finally{we(!1)}}},La=async W=>{if(window.confirm("Delete this content item?")){we(!0);try{await N({contentId:W}),o({type:"success",title:"Deleted",message:"Content removed."})}catch(_){o({type:"danger",title:"Error",message:_?.message??"Failed to delete content"})}finally{we(!1)}}},kn=async W=>{if(window.confirm("Delete this task template?")){we(!0);try{await k({taskTemplateId:W}),o({type:"success",title:"Deleted",message:"Task template removed."})}catch(_){o({type:"danger",title:"Error",message:_?.message??"Failed to delete task template"})}finally{we(!1)}}},xr=v.useMemo(()=>{if(!H)return Oe;const W=H.toLowerCase();return Oe.filter(_=>_.name.toLowerCase().includes(W)||_.description.toLowerCase().includes(W))},[Oe,H]),Pa=v.useMemo(()=>({id:A?.id??null,name:A?.name??"",description:A?.description??"",durationWeeks:A?.durationWeeks??6,startDate:xc(A?.startDate)??"",endDate:xc(A?.endDate)??"",capacity:A?.capacity??20,status:A?.status??"active",coachIds:A?.coachIds??[],participantStudentIds:A?.participantStudentIds??[]}),[A]),[Mt,ds]=v.useState(Pa),pn=()=>{C(null),ds({id:null,name:"",description:"",durationWeeks:6,startDate:"",endDate:"",capacity:20,status:"active",coachIds:[],participantStudentIds:[]}),F({}),R(!0)},Qt=W=>{C(W),ds({id:W.id,name:W.name,description:W.description,durationWeeks:W.durationWeeks,startDate:xc(W.startDate),endDate:xc(W.endDate),capacity:W.capacity,status:W.status,coachIds:W.coachIds??[],participantStudentIds:W.participantStudentIds??[]}),F({}),R(!0)},Ts=async()=>{const W={...Mt,durationWeeks:Number(Mt.durationWeeks),capacity:Number(Mt.capacity)},_=Cv(Vk,W);if(F(_),!Object.keys(_).length){O(!0);try{await e({id:W.id,name:W.name,description:W.description,durationWeeks:W.durationWeeks,startDate:Jx(W.startDate),endDate:Jx(W.endDate),capacity:W.capacity,status:W.status,coachIds:W.coachIds??[],participantStudentIds:W.participantStudentIds??[]}),o({type:"success",title:"Saved",message:"Program updated."}),R(!1)}catch(L){o({type:"danger",title:"Error",message:L?.message??"Failed to save program"})}finally{O(!1)}}},Ht=W=>{const _=new Date,L=new Date(W.startDate),U=new Date(W.endDate);return _<L?"upcoming":_>U?"completed":"ongoing"};return r.jsxs("div",{className:"space-y-8 animate-in fade-in duration-500",children:[r.jsxs("div",{className:"flex flex-col md:flex-row md:items-end justify-between gap-4",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-heading font-bold text-slate-900 dark:text-white",children:"Programs"}),r.jsx("p",{className:"mt-2 text-lg text-slate-500 font-medium",children:"Create, edit, archive, and manage cohorts."})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("button",{onClick:()=>i(),className:"px-4 py-2.5 rounded-xl border border-slate-200 text-slate-600 font-bold text-sm hover:bg-slate-50 transition-colors",title:"Reset Data",children:r.jsx(ek,{className:"h-4 w-4"})}),r.jsxs("button",{onClick:pn,className:"flex items-center gap-2 px-5 py-2.5 rounded-xl bg-slate-900 text-white font-bold text-sm hover:bg-slate-800 shadow-md shadow-slate-900/10 transition-colors dark:bg-white dark:text-slate-900",children:[r.jsx(Yn,{className:"h-4 w-4"})," New Program"]})]})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[r.jsxs("div",{className:"bg-white p-4 rounded-2xl border border-slate-200 shadow-sm dark:bg-slate-800 dark:border-slate-700",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[r.jsx("div",{className:"p-2 bg-indigo-50 text-indigo-600 rounded-lg",children:r.jsx(J2,{className:"h-5 w-5"})}),r.jsx("span",{className:"text-xs font-bold uppercase tracking-wider text-slate-400",children:"Total Programs"})]}),r.jsx("div",{className:"text-2xl font-heading font-bold text-slate-900 dark:text-white",children:Oe.length})]}),r.jsxs("div",{className:"bg-white p-4 rounded-2xl border border-slate-200 shadow-sm dark:bg-slate-800 dark:border-slate-700",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[r.jsx("div",{className:"p-2 bg-emerald-50 text-emerald-600 rounded-lg",children:r.jsx(dn,{className:"h-5 w-5"})}),r.jsx("span",{className:"text-xs font-bold uppercase tracking-wider text-slate-400",children:"Total Students"})]}),r.jsx("div",{className:"text-2xl font-heading font-bold text-slate-900 dark:text-white",children:Oe.reduce((W,_)=>W+(_.participantStudentIds?.length||0),0)})]}),r.jsxs("div",{className:"bg-white p-4 rounded-2xl border border-slate-200 shadow-sm dark:bg-slate-800 dark:border-slate-700",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[r.jsx("div",{className:"p-2 bg-amber-50 text-amber-600 rounded-lg",children:r.jsx(gs,{className:"h-5 w-5"})}),r.jsx("span",{className:"text-xs font-bold uppercase tracking-wider text-slate-400",children:"Ongoing"})]}),r.jsx("div",{className:"text-2xl font-heading font-bold text-slate-900 dark:text-white",children:Oe.filter(W=>Ht(W)==="ongoing").length})]})]}),r.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white shadow-sm p-6 dark:bg-slate-800 dark:border-slate-700",children:[r.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-xl font-heading font-bold text-slate-900 dark:text-white",children:"Program Templates"}),r.jsx("p",{className:"mt-1 text-sm text-slate-500 dark:text-slate-400",children:"Templates define stages + courses/videos + task templates. Students start a template to generate a real, editable Program Instance."})]}),r.jsx("button",{type:"button",onClick:le,className:"px-5 py-2.5 rounded-xl bg-slate-900 text-white font-bold text-sm hover:bg-slate-800 transition-colors dark:bg-white dark:text-slate-900",children:"New Template"})]}),u.length===0?r.jsx("div",{className:"mt-6 text-sm text-slate-500 dark:text-slate-400",children:"No templates yet."}):r.jsx("div",{className:"mt-6 grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:u.map(W=>r.jsxs("div",{className:"rounded-2xl border border-slate-200 p-4 hover:shadow-md transition-shadow dark:border-slate-700",children:[r.jsxs("div",{className:"flex items-start justify-between gap-3",children:[r.jsxs("div",{className:"min-w-0",children:[r.jsx("div",{className:"font-bold text-slate-900 dark:text-white truncate",children:W.name}),r.jsx("div",{className:"mt-1 text-xs text-slate-500 dark:text-slate-400 line-clamp-2",children:W.description})]}),r.jsx(ts,{value:W.isActive?"active":"archived"})]}),r.jsxs("div",{className:"mt-4 flex items-center justify-between gap-2",children:[r.jsx("button",{type:"button",onClick:()=>Ee(W.id),className:"px-4 py-2 rounded-xl border border-slate-200 text-slate-700 font-bold text-xs hover:bg-slate-50 transition-colors dark:border-slate-700 dark:text-slate-200",children:"Edit Structure"}),r.jsx("button",{type:"button",onClick:()=>ss(W.id),className:"px-4 py-2 rounded-xl text-red-600 font-bold text-xs hover:bg-red-50 transition-colors",children:"Delete"})]})]},W.id))})]}),r.jsxs("div",{className:"relative",children:[r.jsx(Zn,{className:"absolute left-4 top-1/2 -translate-y-1/2 h-5 w-5 text-slate-400"}),r.jsx("input",{type:"text",placeholder:"Search programs...",value:H,onChange:W=>te(W.target.value),className:"w-full pl-12 pr-4 py-3 rounded-2xl border border-slate-200 bg-white text-sm outline-none focus:ring-2 focus:ring-slate-100 focus:border-slate-300 transition-all dark:bg-slate-800 dark:border-slate-700"})]}),r.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white shadow-sm overflow-hidden dark:bg-slate-800 dark:border-slate-700",children:r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"w-full text-sm text-left",children:[r.jsx("thead",{className:"bg-slate-50 text-slate-500 font-bold font-heading uppercase tracking-wider text-xs border-b border-slate-200 dark:bg-slate-900/50 dark:border-slate-700 dark:text-slate-400",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-6 py-4",children:"Program Details"}),r.jsx("th",{className:"px-6 py-4",children:"Duration"}),r.jsx("th",{className:"px-6 py-4",children:"Capacity"}),r.jsx("th",{className:"px-6 py-4",children:"Status"}),r.jsx("th",{className:"px-6 py-4 text-right",children:"Actions"})]})}),r.jsx("tbody",{className:"divide-y divide-slate-100 dark:divide-slate-700",children:xr.map(W=>{const _=Ht(W);return r.jsxs("tr",{className:"group hover:bg-slate-50/80 transition-colors dark:hover:bg-slate-700/50",children:[r.jsx("td",{className:"px-6 py-4",children:r.jsxs("div",{children:[r.jsx("div",{className:"font-bold text-slate-900 text-base dark:text-white",children:W.name}),r.jsx("div",{className:"text-xs text-slate-500 mt-1 max-w-md truncate",children:W.description})]})}),r.jsx("td",{className:"px-6 py-4",children:r.jsxs("div",{className:"flex flex-col gap-1",children:[r.jsxs("span",{className:"text-slate-900 font-bold text-sm dark:text-white",children:[W.durationWeeks," Weeks"]}),r.jsxs("span",{className:"text-xs text-slate-500",children:[es(W.startDate)," - ",es(W.endDate)]})]})}),r.jsx("td",{className:"px-6 py-4",children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-24 h-1.5 bg-slate-100 rounded-full overflow-hidden",children:r.jsx("div",{className:"h-full bg-slate-900 rounded-full",style:{width:`${Math.min((W.participantStudentIds?.length||0)/W.capacity*100,100)}%`}})}),r.jsxs("span",{className:"text-xs font-bold text-slate-600",children:[W.participantStudentIds?.length||0," / ",W.capacity]})]})}),r.jsx("td",{className:"px-6 py-4",children:r.jsx(ts,{value:_})}),r.jsx("td",{className:"px-6 py-4 text-right",children:r.jsxs("div",{className:"flex items-center justify-end gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[r.jsx("button",{onClick:()=>Qt(W),className:"p-2 rounded-lg text-slate-400 hover:bg-slate-100 hover:text-slate-700 transition-colors",children:r.jsx(wv,{className:"h-4 w-4"})}),r.jsx("button",{onClick:()=>de({open:!0,programId:W.id}),className:"p-2 rounded-lg text-slate-400 hover:bg-red-50 hover:text-red-600 transition-colors",children:r.jsx(jv,{className:"h-4 w-4"})})]})})]},W.id)})})]})})}),r.jsx(Pt,{isOpen:T,onClose:V?void 0:()=>R(!1),title:A?"Edit Program":"New Program",footer:r.jsxs("div",{className:"flex gap-3 w-full",children:[r.jsx("button",{onClick:()=>R(!1),disabled:V,className:"flex-1 rounded-xl px-4 py-2.5 text-sm font-bold text-slate-600 hover:bg-slate-50 transition-colors border border-transparent hover:border-slate-200 dark:text-slate-300 dark:hover:bg-slate-700",children:"Cancel"}),r.jsx("button",{onClick:Ts,disabled:V,className:"flex-1 rounded-xl bg-slate-900 px-4 py-2.5 text-sm font-bold text-white shadow-lg shadow-slate-900/20 hover:bg-slate-800 transition-all active:scale-95 disabled:opacity-50 disabled:active:scale-100 dark:bg-white dark:text-slate-900",children:V?"Saving...":"Save Program"})]}),children:r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-bold text-slate-700 mb-1.5 dark:text-slate-300",children:"Name"}),r.jsx("input",{className:`w-full rounded-xl border px-4 py-2.5 text-sm outline-none focus:ring-2 transition-all ${B.name?"border-red-300 focus:ring-red-100":"border-slate-200 focus:border-slate-400 focus:ring-slate-100 dark:border-slate-700 dark:bg-slate-800"}`,value:Mt.name,onChange:W=>ds(_=>({..._,name:W.target.value})),placeholder:"e.g. Summer Cohort 2024"}),B.name&&r.jsx("p",{className:"mt-1 text-xs font-bold text-red-500",children:B.name})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-bold text-slate-700 mb-1.5 dark:text-slate-300",children:"Description"}),r.jsx("textarea",{className:`w-full rounded-xl border px-4 py-2.5 text-sm outline-none focus:ring-2 transition-all min-h-[100px] ${B.description?"border-red-300 focus:ring-red-100":"border-slate-200 focus:border-slate-400 focus:ring-slate-100 dark:border-slate-700 dark:bg-slate-800"}`,value:Mt.description,onChange:W=>ds(_=>({..._,description:W.target.value})),placeholder:"Program goals, requirements..."}),B.description&&r.jsx("p",{className:"mt-1 text-xs font-bold text-red-500",children:B.description})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-bold text-slate-700 mb-1.5 dark:text-slate-300",children:"Start Date"}),r.jsx("input",{type:"date",className:`w-full rounded-xl border px-4 py-2.5 text-sm outline-none focus:ring-2 transition-all ${B.startDate?"border-red-300 focus:ring-red-100":"border-slate-200 focus:border-slate-400 focus:ring-slate-100 dark:border-slate-700 dark:bg-slate-800"}`,value:Mt.startDate,onChange:W=>ds(_=>({..._,startDate:W.target.value}))}),B.startDate&&r.jsx("p",{className:"mt-1 text-xs font-bold text-red-500",children:B.startDate})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-bold text-slate-700 mb-1.5 dark:text-slate-300",children:"End Date"}),r.jsx("input",{type:"date",className:`w-full rounded-xl border px-4 py-2.5 text-sm outline-none focus:ring-2 transition-all ${B.endDate?"border-red-300 focus:ring-red-100":"border-slate-200 focus:border-slate-400 focus:ring-slate-100 dark:border-slate-700 dark:bg-slate-800"}`,value:Mt.endDate,onChange:W=>ds(_=>({..._,endDate:W.target.value}))}),B.endDate&&r.jsx("p",{className:"mt-1 text-xs font-bold text-red-500",children:B.endDate})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-bold text-slate-700 mb-1.5 dark:text-slate-300",children:"Duration (Weeks)"}),r.jsx("input",{type:"number",className:`w-full rounded-xl border px-4 py-2.5 text-sm outline-none focus:ring-2 transition-all ${B.durationWeeks?"border-red-300 focus:ring-red-100":"border-slate-200 focus:border-slate-400 focus:ring-slate-100 dark:border-slate-700 dark:bg-slate-800"}`,value:Mt.durationWeeks,onChange:W=>ds(_=>({..._,durationWeeks:W.target.value})),min:1}),B.durationWeeks&&r.jsx("p",{className:"mt-1 text-xs font-bold text-red-500",children:B.durationWeeks})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-bold text-slate-700 mb-1.5 dark:text-slate-300",children:"Capacity"}),r.jsx("input",{type:"number",className:`w-full rounded-xl border px-4 py-2.5 text-sm outline-none focus:ring-2 transition-all ${B.capacity?"border-red-300 focus:ring-red-100":"border-slate-200 focus:border-slate-400 focus:ring-slate-100 dark:border-slate-700 dark:bg-slate-800"}`,value:Mt.capacity,onChange:W=>ds(_=>({..._,capacity:W.target.value})),min:1}),B.capacity&&r.jsx("p",{className:"mt-1 text-xs font-bold text-red-500",children:B.capacity})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-bold text-slate-700 mb-1.5 dark:text-slate-300",children:"Status"}),r.jsxs("div",{className:"relative",children:[r.jsxs("select",{className:"w-full appearance-none rounded-xl border-slate-200 border px-4 py-2.5 text-sm outline-none focus:ring-2 focus:ring-slate-100 focus:border-slate-400 bg-white dark:bg-slate-800 dark:border-slate-700",value:Mt.status,onChange:W=>ds(_=>({..._,status:W.target.value})),children:[r.jsx("option",{value:"active",children:"Active"}),r.jsx("option",{value:"archived",children:"Archived"})]}),r.jsx("div",{className:"pointer-events-none absolute right-4 top-1/2 -translate-y-1/2 text-slate-400",children:r.jsx("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]}),r.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[r.jsxs("div",{className:"rounded-xl border border-slate-200 p-4 dark:border-slate-700",children:[r.jsx("div",{className:"text-sm font-bold text-slate-800 dark:text-slate-200",children:"Assign coaches"}),r.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Coaches can manage sessions and review submissions for this cohort."}),r.jsx("div",{className:"mt-3 space-y-2 max-h-48 overflow-auto pr-1",children:Xe.length===0?r.jsx("div",{className:"text-sm text-slate-500",children:"No coaches found."}):Xe.map(W=>{const _=(Mt.coachIds??[]).includes(W.id);return r.jsxs("label",{className:"flex items-center gap-2 text-sm text-slate-700 dark:text-slate-300",children:[r.jsx("input",{type:"checkbox",checked:_,onChange:L=>{const U=new Set(Mt.coachIds??[]);L.target.checked?U.add(W.id):U.delete(W.id),ds(z=>({...z,coachIds:Array.from(U)}))}}),r.jsx("span",{className:"font-medium",children:W.name}),r.jsx("span",{className:"text-xs text-slate-400 truncate",children:W.email})]},W.id)})})]}),r.jsxs("div",{className:"rounded-xl border border-slate-200 p-4 dark:border-slate-700",children:[r.jsx("div",{className:"text-sm font-bold text-slate-800 dark:text-slate-200",children:"Enroll students"}),r.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Students enrolled here will see the program in their dashboard."}),r.jsx("div",{className:"mt-3 space-y-2 max-h-48 overflow-auto pr-1",children:vt.length===0?r.jsx("div",{className:"text-sm text-slate-500",children:"No students found."}):vt.map(W=>{const _=(Mt.participantStudentIds??[]).includes(W.id);return r.jsxs("label",{className:"flex items-center gap-2 text-sm text-slate-700 dark:text-slate-300",children:[r.jsx("input",{type:"checkbox",checked:_,onChange:L=>{const U=new Set(Mt.participantStudentIds??[]);L.target.checked?U.add(W.id):U.delete(W.id),ds(z=>({...z,participantStudentIds:Array.from(U)}))}}),r.jsx("span",{className:"font-medium",children:W.name}),r.jsx("span",{className:"text-xs text-slate-400 truncate",children:W.email})]},W.id)})})]})]})]})}),r.jsx(Pt,{isOpen:ye,onClose:Ie,title:J==="create"?"Create Template":fe?`Edit Template: ${fe.name}`:"Edit Template",footer:r.jsxs("div",{className:"flex gap-3 w-full",children:[r.jsx("button",{type:"button",onClick:Ie,disabled:he,className:"flex-1 rounded-xl px-4 py-2.5 text-sm font-bold text-slate-600 hover:bg-slate-50 transition-colors border border-transparent hover:border-slate-200 dark:text-slate-300 dark:hover:bg-slate-700",children:"Close"}),r.jsx("button",{type:"button",onClick:ot,disabled:he,className:"flex-1 rounded-xl bg-slate-900 px-4 py-2.5 text-sm font-bold text-white hover:bg-slate-800 transition-colors disabled:opacity-50 dark:bg-white dark:text-slate-900",children:he?"Saving":J==="create"?"Create Template":"Save Template"})]}),children:r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"rounded-2xl border border-slate-200 p-4 dark:border-slate-700",children:[r.jsx("div",{className:"text-xs font-bold uppercase tracking-wider text-slate-400",children:"Step 1  Template info"}),r.jsxs("div",{className:"mt-3 grid gap-4 md:grid-cols-2",children:[r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("label",{className:"block text-sm font-bold text-slate-700 mb-1.5 dark:text-slate-300",children:"Name"}),r.jsx("input",{value:K.name,onChange:W=>{S(_=>({..._,name:W.target.value})),D.name&&M(_=>({..._,name:null}))},placeholder:"e.g. Startup Incubation: IDEA  MVP",className:`w-full rounded-xl border px-4 py-2.5 text-sm outline-none focus:ring-2 transition-all ${D.name?"border-red-300 focus:ring-red-100":"border-slate-200 focus:border-slate-400 focus:ring-slate-100 dark:border-slate-700 dark:bg-slate-800"}`,disabled:he}),D.name?r.jsx("p",{className:"mt-1 text-xs font-bold text-red-500",children:D.name}):null]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("label",{className:"block text-sm font-bold text-slate-700 mb-1.5 dark:text-slate-300",children:"Description"}),r.jsx("textarea",{value:K.description,onChange:W=>S(_=>({..._,description:W.target.value})),placeholder:"What is this program template about?",className:"w-full rounded-xl border border-slate-200 px-4 py-2.5 text-sm outline-none focus:ring-2 focus:ring-slate-100 focus:border-slate-400 min-h-[90px] dark:border-slate-700 dark:bg-slate-800",disabled:he})]}),r.jsxs("div",{className:"flex items-center justify-between rounded-xl border border-slate-200 px-4 py-3 dark:border-slate-700",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-sm font-bold text-slate-800 dark:text-slate-200",children:"Active"}),r.jsx("div",{className:"text-xs text-slate-500 dark:text-slate-400",children:"Only active templates can be started by students."})]}),r.jsxs("label",{className:"flex items-center gap-2 text-sm font-bold text-slate-700 dark:text-slate-200",children:[r.jsx("input",{type:"checkbox",checked:!!K.isActive,onChange:W=>S(_=>({..._,isActive:W.target.checked})),disabled:he}),K.isActive?"Active":"Archived"]})]}),J==="edit"&&Re?r.jsx("button",{type:"button",onClick:()=>ss(Re),className:"rounded-xl border border-red-200 px-4 py-3 text-sm font-bold text-red-600 hover:bg-red-50 transition-colors",disabled:he,children:"Delete template"}):r.jsx("div",{className:"rounded-xl border border-slate-200 px-4 py-3 text-sm text-slate-500 dark:border-slate-700 dark:text-slate-400",children:"Create the template first, then you can add stages."})]})]}),Re?ve?r.jsxs("div",{className:"space-y-4",children:[r.jsx("div",{className:"text-xs font-bold uppercase tracking-wider text-slate-400",children:"Step 2  Build stages"}),r.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[r.jsxs("div",{className:"rounded-2xl border border-slate-200 p-4 dark:border-slate-700",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("div",{className:"text-sm font-bold text-slate-900 dark:text-white",children:"Stages"}),r.jsx("div",{className:"text-xs text-slate-400",children:(ve.stages??[]).length})]}),(ve.stages??[]).length===0?r.jsx("div",{className:"mt-3 text-sm text-slate-500 dark:text-slate-400",children:"Add your first stage (IDEA, PROTOTYPE, MVP)."}):r.jsx("div",{className:"mt-3 space-y-2",children:(ve.stages??[]).map(W=>{const _=W.id===I,L=(ve.contents??[]).filter(z=>z.stageId===W.id).length,U=(ve.taskTemplates??[]).filter(z=>z.stageId===W.id).length;return r.jsxs("div",{className:`rounded-xl border p-3 transition-colors ${_?"border-slate-300 bg-slate-50 dark:border-slate-600 dark:bg-slate-900/30":"border-slate-200 hover:bg-slate-50 dark:border-slate-700 dark:hover:bg-slate-900/20"}`,children:[r.jsxs("button",{type:"button",onClick:()=>G(W.id),className:"w-full text-left",disabled:he,children:[r.jsx("div",{className:"font-bold text-slate-900 dark:text-white truncate",children:W.name}),r.jsxs("div",{className:"mt-1 text-xs text-slate-500 dark:text-slate-400",children:[L," content  ",U," tasks"]})]}),r.jsx("div",{className:"mt-2 flex justify-end",children:r.jsx("button",{type:"button",onClick:()=>Ua(W.id),className:"px-2 py-1 rounded-lg text-xs font-bold text-red-600 hover:bg-red-50",disabled:he,children:"Delete"})})]},W.id)})}),r.jsxs("div",{className:"mt-4 pt-4 border-t border-slate-200 dark:border-slate-700",children:[r.jsx("div",{className:"text-sm font-bold text-slate-900 dark:text-white",children:"Add stage"}),r.jsxs("div",{className:"mt-2 space-y-2",children:[r.jsx("input",{value:ae.name,onChange:W=>xe(_=>({..._,name:W.target.value})),placeholder:"Stage name (e.g. IDEA)",className:"w-full rounded-xl border border-slate-200 px-4 py-2 text-sm outline-none focus:ring-2 focus:ring-slate-100 focus:border-slate-400 dark:border-slate-700 dark:bg-slate-800",disabled:he}),r.jsx("input",{value:ae.description,onChange:W=>xe(_=>({..._,description:W.target.value})),placeholder:"Short description (optional)",className:"w-full rounded-xl border border-slate-200 px-4 py-2 text-sm outline-none focus:ring-2 focus:ring-slate-100 focus:border-slate-400 dark:border-slate-700 dark:bg-slate-800",disabled:he}),r.jsx("button",{type:"button",onClick:pr,disabled:he,className:"w-full rounded-xl bg-slate-900 px-4 py-2 text-sm font-bold text-white hover:bg-slate-800 transition-colors disabled:opacity-50 dark:bg-white dark:text-slate-900",children:"Add stage"})]})]})]}),r.jsx("div",{className:"md:col-span-2 rounded-2xl border border-slate-200 p-4 dark:border-slate-700",children:I?(()=>{const W=(ve.stages??[]).find(U=>U.id===I),_=(ve.contents??[]).filter(U=>U.stageId===I),L=(ve.taskTemplates??[]).filter(U=>U.stageId===I);return W?r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-sm font-bold text-slate-900 dark:text-white",children:"Selected stage"}),r.jsx("div",{className:"mt-1 text-lg font-heading font-bold text-slate-900 dark:text-white",children:W.name}),W.description?r.jsx("div",{className:"mt-1 text-sm text-slate-500 dark:text-slate-400",children:W.description}):null]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("div",{className:"text-sm font-bold text-slate-900 dark:text-white",children:"Content (videos/courses)"}),r.jsx("div",{className:"text-xs text-slate-400",children:_.length})]}),_.length===0?r.jsx("div",{className:"text-sm text-slate-500 dark:text-slate-400",children:"No content yet."}):r.jsx("div",{className:"space-y-2",children:_.map(U=>r.jsxs("div",{className:"flex items-start justify-between gap-3 rounded-xl border border-slate-200 p-3 dark:border-slate-700",children:[r.jsxs("div",{className:"min-w-0",children:[r.jsx("div",{className:"font-bold text-slate-900 dark:text-white truncate",children:U.title}),r.jsxs("div",{className:"text-xs text-slate-500 dark:text-slate-400 truncate",children:[String(U.contentType??"").toUpperCase(),"  ",U.url]}),U.provider||U.durationMinutes?r.jsxs("div",{className:"mt-1 text-xs text-slate-400",children:[U.provider?U.provider:null,U.provider&&U.durationMinutes?"  ":null,U.durationMinutes?`${U.durationMinutes} min`:null]}):null]}),r.jsx("button",{type:"button",onClick:()=>La(U.id),className:"px-2 py-1 rounded-lg text-xs font-bold text-red-600 hover:bg-red-50",disabled:he,children:"Delete"})]},U.id))}),r.jsxs("div",{className:"rounded-xl border border-slate-200 p-3 dark:border-slate-700",children:[r.jsx("div",{className:"text-sm font-bold text-slate-900 dark:text-white",children:"Add content"}),r.jsxs("div",{className:"mt-3 grid gap-3 md:grid-cols-2",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-bold text-slate-500 mb-1",children:"Type"}),r.jsxs("select",{value:je.contentType,onChange:U=>Se(z=>({...z,contentType:U.target.value})),className:"w-full rounded-xl border border-slate-200 px-4 py-2 text-sm outline-none focus:ring-2 focus:ring-slate-100 focus:border-slate-400 bg-white dark:bg-slate-800 dark:border-slate-700",disabled:he,children:[r.jsx("option",{value:"video",children:"Video"}),r.jsx("option",{value:"course",children:"Course"}),r.jsx("option",{value:"article",children:"Article"}),r.jsx("option",{value:"link",children:"Link"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-bold text-slate-500 mb-1",children:"Duration (min)"}),r.jsx("input",{value:je.durationMinutes,onChange:U=>Se(z=>({...z,durationMinutes:U.target.value})),placeholder:"optional",type:"number",className:"w-full rounded-xl border border-slate-200 px-4 py-2 text-sm outline-none focus:ring-2 focus:ring-slate-100 focus:border-slate-400 dark:border-slate-700 dark:bg-slate-800",disabled:he,min:0})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("label",{className:"block text-xs font-bold text-slate-500 mb-1",children:"Title"}),r.jsx("input",{value:je.title,onChange:U=>Se(z=>({...z,title:U.target.value})),placeholder:"e.g. Customer discovery basics",className:"w-full rounded-xl border border-slate-200 px-4 py-2 text-sm outline-none focus:ring-2 focus:ring-slate-100 focus:border-slate-400 dark:border-slate-700 dark:bg-slate-800",disabled:he})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("label",{className:"block text-xs font-bold text-slate-500 mb-1",children:"URL"}),r.jsx("input",{value:je.url,onChange:U=>Se(z=>({...z,url:U.target.value})),placeholder:"https://...",className:"w-full rounded-xl border border-slate-200 px-4 py-2 text-sm outline-none focus:ring-2 focus:ring-slate-100 focus:border-slate-400 dark:border-slate-700 dark:bg-slate-800",disabled:he})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-bold text-slate-500 mb-1",children:"Provider"}),r.jsx("input",{value:je.provider,onChange:U=>Se(z=>({...z,provider:U.target.value})),placeholder:"YouTube, Coursera (optional)",className:"w-full rounded-xl border border-slate-200 px-4 py-2 text-sm outline-none focus:ring-2 focus:ring-slate-100 focus:border-slate-400 dark:border-slate-700 dark:bg-slate-800",disabled:he})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-bold text-slate-500 mb-1",children:"Description"}),r.jsx("input",{value:je.description,onChange:U=>Se(z=>({...z,description:U.target.value})),placeholder:"optional",className:"w-full rounded-xl border border-slate-200 px-4 py-2 text-sm outline-none focus:ring-2 focus:ring-slate-100 focus:border-slate-400 dark:border-slate-700 dark:bg-slate-800",disabled:he})]}),r.jsx("div",{className:"md:col-span-2",children:r.jsx("button",{type:"button",onClick:Jt,disabled:he,className:"w-full rounded-xl bg-slate-900 px-4 py-2 text-sm font-bold text-white hover:bg-slate-800 transition-colors disabled:opacity-50 dark:bg-white dark:text-slate-900",children:"Add content"})})]})]})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("div",{className:"text-sm font-bold text-slate-900 dark:text-white",children:"Tasks"}),r.jsx("div",{className:"text-xs text-slate-400",children:L.length})]}),L.length===0?r.jsx("div",{className:"text-sm text-slate-500 dark:text-slate-400",children:"No tasks yet."}):r.jsx("div",{className:"space-y-2",children:L.map(U=>r.jsxs("div",{className:"flex items-start justify-between gap-3 rounded-xl border border-slate-200 p-3 dark:border-slate-700",children:[r.jsxs("div",{className:"min-w-0",children:[r.jsx("div",{className:"font-bold text-slate-900 dark:text-white truncate",children:U.title}),r.jsxs("div",{className:"text-xs text-slate-500 dark:text-slate-400",children:[U.dueOffsetDays!==null?`Due +${U.dueOffsetDays}d`:"No default deadline",U.requiresApproval?"  Approval required":"  No approval"]})]}),r.jsx("button",{type:"button",onClick:()=>kn(U.id),className:"px-2 py-1 rounded-lg text-xs font-bold text-red-600 hover:bg-red-50",disabled:he,children:"Delete"})]},U.id))}),r.jsxs("div",{className:"rounded-xl border border-slate-200 p-3 dark:border-slate-700",children:[r.jsx("div",{className:"text-sm font-bold text-slate-900 dark:text-white",children:"Add task"}),r.jsxs("div",{className:"mt-3 grid gap-3 md:grid-cols-2",children:[r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("label",{className:"block text-xs font-bold text-slate-500 mb-1",children:"Title"}),r.jsx("input",{value:pe.title,onChange:U=>qe(z=>({...z,title:U.target.value})),placeholder:"e.g. Submit problem statement",className:"w-full rounded-xl border border-slate-200 px-4 py-2 text-sm outline-none focus:ring-2 focus:ring-slate-100 focus:border-slate-400 dark:border-slate-700 dark:bg-slate-800",disabled:he})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("label",{className:"block text-xs font-bold text-slate-500 mb-1",children:"Description"}),r.jsx("input",{value:pe.description,onChange:U=>qe(z=>({...z,description:U.target.value})),placeholder:"optional",className:"w-full rounded-xl border border-slate-200 px-4 py-2 text-sm outline-none focus:ring-2 focus:ring-slate-100 focus:border-slate-400 dark:border-slate-700 dark:bg-slate-800",disabled:he})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-bold text-slate-500 mb-1",children:"Due offset (days)"}),r.jsx("input",{value:pe.dueOffsetDays,onChange:U=>qe(z=>({...z,dueOffsetDays:U.target.value})),placeholder:"optional",type:"number",className:"w-full rounded-xl border border-slate-200 px-4 py-2 text-sm outline-none focus:ring-2 focus:ring-slate-100 focus:border-slate-400 dark:border-slate-700 dark:bg-slate-800",disabled:he})]}),r.jsx("div",{className:"flex items-end",children:r.jsxs("label",{className:"flex items-center gap-2 text-sm font-bold text-slate-700 dark:text-slate-200",children:[r.jsx("input",{type:"checkbox",checked:!!pe.requiresApproval,onChange:U=>qe(z=>({...z,requiresApproval:U.target.checked})),disabled:he}),"Requires approval"]})}),r.jsx("div",{className:"md:col-span-2",children:r.jsx("button",{type:"button",onClick:gr,disabled:he,className:"w-full rounded-xl bg-slate-900 px-4 py-2 text-sm font-bold text-white hover:bg-slate-800 transition-colors disabled:opacity-50 dark:bg-white dark:text-slate-900",children:"Add task"})})]})]})]})]}):r.jsx("div",{className:"text-sm text-slate-500",children:"Stage not found."})})():r.jsx("div",{className:"text-sm text-slate-500",children:"Select a stage to add content and tasks."})})]})]}):r.jsx("div",{className:"text-sm text-slate-500",children:"Loading template structure"}):null]})}),r.jsx(Xl,{isOpen:me.open,title:"Delete Program?",description:"This will permanently remove the program and its associated data.",confirmLabel:"Delete Program",isDanger:!0,onClose:()=>de({open:!1,programId:null}),onConfirm:async()=>{if(me.programId){O(!0);try{await a(me.programId),o({type:"success",title:"Deleted",message:"Program removed."}),de({open:!1,programId:null})}finally{O(!1)}}},isLoading:V})]})}const qk={name:[rn.required("Name")],email:[rn.required("Email"),rn.email("Email")],role:[rn.required("Role")]};function Hk(){const{data:s,upsertUser:e,deleteUser:a}=yt(),{push:i}=mn(),[o,u]=v.useState(!1),[d,f]=v.useState(null),[m,p]=v.useState({name:"",email:"",role:"student"}),[x,b]=v.useState({}),[y,j]=v.useState(!1),[N,k]=v.useState({open:!1,userId:null}),[T,R]=v.useState(""),A=v.useMemo(()=>s?.users??[],[s?.users]),C=v.useMemo(()=>{if(!T)return A;const O=T.toLowerCase();return A.filter(H=>H.name.toLowerCase().includes(O)||H.email.toLowerCase().includes(O)||H.role.toLowerCase().includes(O))},[A,T]),B=()=>{f(null),p({name:"",email:"",role:"student"}),b({}),u(!0)},F=O=>{f(O),p({id:O.id,name:O.name??"",email:O.email??"",role:O.role??"student"}),b({}),u(!0)},V=async()=>{const O=Cv(qk,m);if(b(O),!Object.keys(O).length){j(!0);try{await e(m),i({type:"success",title:"Saved",message:"User updated."}),u(!1)}catch(H){i({type:"danger",title:"Error",message:H?.message??"Failed to save user"})}finally{j(!1)}}};return r.jsxs("div",{className:"space-y-8 animate-in fade-in duration-500",children:[r.jsxs("div",{className:"flex flex-col md:flex-row md:items-end justify-between gap-4",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-heading font-bold text-slate-900 dark:text-white",children:"Users"}),r.jsx("p",{className:"mt-2 text-lg text-slate-500 font-medium",children:"Manage students, alumni, coaches, and administrators."})]}),r.jsxs("button",{onClick:B,className:"flex items-center gap-2 px-5 py-2.5 rounded-xl bg-slate-900 text-white font-bold text-sm hover:bg-slate-800 shadow-md shadow-slate-900/10 transition-colors dark:bg-white dark:text-slate-900",children:[r.jsx(Yn,{className:"h-4 w-4"})," Add User"]})]}),r.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:["student","coach","admin","alumni"].map(O=>r.jsxs("div",{className:"bg-white p-4 rounded-2xl border border-slate-200 shadow-sm dark:bg-slate-800 dark:border-slate-700",children:[r.jsxs("div",{className:"text-xs font-bold uppercase tracking-wider text-slate-400 mb-1",children:[O,"s"]}),r.jsx("div",{className:"text-2xl font-heading font-bold text-slate-900 capitalize dark:text-white",children:A.filter(H=>H.role===O).length})]},O))}),r.jsxs("div",{className:"relative",children:[r.jsx(Zn,{className:"absolute left-4 top-1/2 -translate-y-1/2 h-5 w-5 text-slate-400"}),r.jsx("input",{type:"text",placeholder:"Search users by name, email, or role...",value:T,onChange:O=>R(O.target.value),className:"w-full pl-12 pr-4 py-3 rounded-2xl border border-slate-200 bg-white text-sm outline-none focus:ring-2 focus:ring-slate-100 focus:border-slate-300 transition-all dark:bg-slate-800 dark:border-slate-700"})]}),r.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white shadow-sm overflow-hidden dark:bg-slate-800 dark:border-slate-700",children:r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"w-full text-sm text-left",children:[r.jsx("thead",{className:"bg-slate-50 text-slate-500 font-bold font-heading uppercase tracking-wider text-xs border-b border-slate-200 dark:bg-slate-900/50 dark:border-slate-700 dark:text-slate-400",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-6 py-4",children:"User Details"}),r.jsx("th",{className:"px-6 py-4",children:"Role"}),r.jsx("th",{className:"px-6 py-4 text-right",children:"Actions"})]})}),r.jsxs("tbody",{className:"divide-y divide-slate-100 dark:divide-slate-700",children:[C.map(O=>r.jsxs("tr",{className:"group hover:bg-slate-50/80 transition-colors dark:hover:bg-slate-700/50",children:[r.jsx("td",{className:"px-6 py-4",children:r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"h-10 w-10 rounded-full bg-slate-100 flex items-center justify-center font-bold text-slate-500 text-sm ring-2 ring-white shadow-sm dark:bg-slate-700 dark:text-slate-300 dark:ring-slate-800",children:O.name.charAt(0)}),r.jsxs("div",{children:[r.jsx("div",{className:"font-bold text-slate-900 dark:text-white",children:O.name}),r.jsxs("div",{className:"text-xs text-slate-500 font-medium flex items-center gap-1.5",children:[r.jsx(gv,{className:"h-3 w-3"})," ",O.email]})]})]})}),r.jsx("td",{className:"px-6 py-4",children:r.jsxs("span",{className:`inline-flex items-center gap-1.5 rounded-full px-3 py-1 text-xs font-bold border ${O.role==="admin"?"bg-slate-100 text-slate-700 border-slate-200":O.role==="coach"?"bg-indigo-50 text-indigo-700 border-indigo-100":"bg-blue-50 text-blue-700 border-blue-100"}`,children:[O.role==="admin"?r.jsx(rf,{className:"h-3 w-3"}):O.role==="coach"?r.jsx(fr,{className:"h-3 w-3"}):r.jsx(fr,{className:"h-3 w-3"}),r.jsx("span",{className:"capitalize",children:O.role})]})}),r.jsx("td",{className:"px-6 py-4 text-right",children:r.jsxs("div",{className:"flex items-center justify-end gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[r.jsx("button",{onClick:()=>F(O),className:"p-2 rounded-lg text-slate-400 hover:bg-slate-100 hover:text-slate-700 transition-colors dark:hover:bg-slate-700 dark:hover:text-slate-300",children:r.jsx(wv,{className:"h-4 w-4"})}),r.jsx("button",{onClick:()=>k({open:!0,userId:O.id}),className:"p-2 rounded-lg text-slate-400 hover:bg-red-50 hover:text-red-600 transition-colors dark:hover:bg-red-900/20 dark:hover:text-red-400",children:r.jsx(jv,{className:"h-4 w-4"})})]})})]},O.id)),C.length===0&&r.jsx("tr",{children:r.jsxs("td",{colSpan:3,className:"px-6 py-12 text-center text-slate-400",children:['No users found matching "',T,'".']})})]})]})})}),r.jsx(Pt,{isOpen:o,onClose:y?void 0:()=>u(!1),title:d?"Edit User":"New User",footer:r.jsxs("div",{className:"flex gap-3 w-full",children:[r.jsx("button",{onClick:()=>u(!1),disabled:y,className:"flex-1 rounded-xl px-4 py-2.5 text-sm font-bold text-slate-600 hover:bg-slate-50 transition-colors border border-transparent hover:border-slate-200 dark:text-slate-300 dark:hover:bg-slate-700",children:"Cancel"}),r.jsx("button",{onClick:V,disabled:y,className:"flex-1 rounded-xl bg-slate-900 px-4 py-2.5 text-sm font-bold text-white shadow-lg shadow-slate-900/20 hover:bg-slate-800 transition-all active:scale-95 disabled:opacity-50 disabled:active:scale-100 dark:bg-white dark:text-slate-900",children:y?"Saving...":"Save User"})]}),children:r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-bold text-slate-700 mb-1.5 dark:text-slate-300",children:"Full Name"}),r.jsx("input",{className:`w-full rounded-xl border px-4 py-2.5 text-sm outline-none focus:ring-2 transition-all ${x.name?"border-red-300 focus:ring-red-100":"border-slate-200 focus:border-slate-400 focus:ring-slate-100 dark:border-slate-700 dark:bg-slate-800"}`,value:m.name,onChange:O=>p(H=>({...H,name:O.target.value})),placeholder:"e.g. John Doe"}),x.name&&r.jsx("p",{className:"mt-1 text-xs font-bold text-red-500",children:x.name})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-bold text-slate-700 mb-1.5 dark:text-slate-300",children:"Email Address"}),r.jsx("input",{className:`w-full rounded-xl border px-4 py-2.5 text-sm outline-none focus:ring-2 transition-all ${x.email?"border-red-300 focus:ring-red-100":"border-slate-200 focus:border-slate-400 focus:ring-slate-100 dark:border-slate-700 dark:bg-slate-800"}`,value:m.email,onChange:O=>p(H=>({...H,email:O.target.value})),placeholder:"name@example.com"}),x.email&&r.jsx("p",{className:"mt-1 text-xs font-bold text-red-500",children:x.email})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-bold text-slate-700 mb-1.5 dark:text-slate-300",children:"Role"}),r.jsxs("div",{className:"relative",children:[r.jsxs("select",{className:`w-full appearance-none rounded-xl border px-4 py-2.5 text-sm outline-none focus:ring-2 transition-all bg-white dark:bg-slate-800 ${x.role?"border-red-300 focus:ring-red-100":"border-slate-200 focus:border-slate-400 focus:ring-slate-100 dark:border-slate-700"}`,value:m.role,onChange:O=>p(H=>({...H,role:O.target.value})),children:[r.jsx("option",{value:"student",children:"Student"}),r.jsx("option",{value:"coach",children:"Coach"}),r.jsx("option",{value:"admin",children:"Administrator"})]}),r.jsx("div",{className:"pointer-events-none absolute right-4 top-1/2 -translate-y-1/2 text-slate-400",children:r.jsx("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),x.role&&r.jsx("p",{className:"mt-1 text-xs font-bold text-red-500",children:x.role})]})]})}),r.jsx(Xl,{isOpen:N.open,title:"Delete User?",description:"This will permanently remove the user and their associated data from the system.",confirmLabel:"Delete User",isDanger:!0,onClose:()=>k({open:!1,userId:null}),onConfirm:async()=>{if(N.userId){j(!0);try{await a(N.userId),i({type:"success",title:"Deleted",message:"User removed."}),k({open:!1,userId:null})}finally{j(!1)}}},isLoading:y})]})}function Av(s){var e,a,i="";if(typeof s=="string"||typeof s=="number")i+=s;else if(typeof s=="object")if(Array.isArray(s)){var o=s.length;for(e=0;e<o;e++)s[e]&&(a=Av(s[e]))&&(i&&(i+=" "),i+=a)}else for(a in s)s[a]&&(i&&(i+=" "),i+=a);return i}function Gk(){for(var s,e,a=0,i="",o=arguments.length;a<o;a++)(s=arguments[a])&&(e=Av(s))&&(i&&(i+=" "),i+=e);return i}function it(...s){return Gk(s)}function Fk(){const{data:s,setApplicationStatus:e,getUserById:a,getProgramById:i}=yt(),{currentUser:o}=gt(),{push:u}=mn(),[d,f]=v.useState(null),[m,p]=v.useState(""),[x,b]=v.useState(!1),y=v.useMemo(()=>(s?.applications??[]).map(R=>{const A=a(R.studentId),C=i(R.programId),B=R.status==="pending"?null:R.status==="rejected"?(40+R.id.length*5)%60:(70+R.id.length*3)%30+70;return{...R,studentName:A?.name??R.studentId,studentEmail:A?.email??"",programName:C?.name??R.programId,score:B}}),[s,a,i]),j=T=>{f(T),p(T.decisionNote??"")},N=async T=>{if(d){b(!0);try{await e({applicationId:d.id,status:T,decisionNote:m,actorId:o?.id??null}),u({type:"success",title:"Updated",message:`Application marked ${T}.`}),f(null)}catch(R){u({type:"danger",title:"Error",message:R?.message??"Failed to update"})}finally{b(!1)}}},k=[{key:"student",header:"Student",accessor:T=>T.studentName,cell:T=>r.jsxs("div",{children:[r.jsx("div",{className:"font-medium text-foreground",children:T.studentName}),r.jsx("div",{className:"mt-1 text-xs text-muted-foreground",children:T.studentEmail})]})},{key:"idea",header:"Project Idea",accessor:T=>T.motivation,cell:T=>r.jsx("div",{className:"max-w-xs truncate text-sm",title:T.motivation,children:T.motivation})},{key:"createdAt",header:"Submitted",accessor:T=>ms(T.createdAt),sortValue:T=>T.createdAt},{key:"score",header:"Score",accessor:T=>T.score,cell:T=>T.score?r.jsxs("span",{className:it("font-semibold",T.score>=70?"text-success-700":"text-danger-700"),children:[T.score,"/100"]}):r.jsx("span",{className:"text-muted-foreground",children:"-"})},{key:"status",header:"Status",accessor:T=>T.status,cell:T=>r.jsx(ts,{value:T.status})},{key:"actions",header:"",accessor:()=>"",searchable:!1,sortable:!1,cell:T=>r.jsx("div",{className:"flex justify-end",children:r.jsxs("button",{type:"button",className:"btn-ghost flex items-center gap-1 text-xs",onClick:()=>j(T),children:[r.jsx(mv,{className:"h-4 w-4"})," Review"]})})}];return r.jsxs("div",{className:"space-y-4",children:[r.jsx(Ye,{title:"Applications",subtitle:"Review and decide student applications"}),r.jsx(Wc,{title:"All applications",rows:y,columns:k,exportFilename:"applications.csv",initialSort:{key:"createdAt",dir:"desc"}}),r.jsx(Pt,{open:!!d,title:d?`Application  ${d.studentName}`:"Application",onClose:x?void 0:()=>f(null),footer:d?r.jsxs(r.Fragment,{children:[r.jsx("button",{type:"button",className:"btn-ghost",onClick:()=>f(null),disabled:x,children:"Close"}),r.jsx("button",{type:"button",className:"btn-danger",onClick:()=>N("rejected"),disabled:x,children:"Reject"}),r.jsx("button",{type:"button",className:"btn-primary",onClick:()=>N("accepted"),disabled:x,children:"Accept"})]}):null,children:d?r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"grid gap-2 md:grid-cols-2",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-xs uppercase tracking-wide text-muted-foreground",children:"Program"}),r.jsx("div",{className:"text-sm font-medium text-foreground",children:d.programName})]}),r.jsxs("div",{children:[r.jsx("div",{className:"text-xs uppercase tracking-wide text-muted-foreground",children:"Status"}),r.jsx("div",{className:"mt-1",children:r.jsx(ts,{value:d.status})})]})]}),r.jsxs("div",{children:[r.jsx("div",{className:"text-xs uppercase tracking-wide text-muted-foreground",children:"Motivation"}),r.jsx("div",{className:"mt-1 text-sm text-foreground",children:d.motivation})]}),(d.status==="accepted"||d.status==="rejected")&&d.score&&r.jsxs("div",{children:[r.jsx("div",{className:"text-xs uppercase tracking-wide text-muted-foreground",children:"Evaluation Score"}),r.jsxs("div",{className:it("mt-1 text-lg font-bold",d.score>=70?"text-success-700":"text-danger-700"),children:[d.score,"/100"]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"label",children:"Decision note (optional)"}),r.jsx("textarea",{className:"input min-h-24",value:m,onChange:T=>p(T.target.value),placeholder:"Add a short note"})]})]}):null})]})}function bc({title:s,message:e}){return r.jsxs("div",{className:"surface p-6",children:[r.jsx("div",{className:"text-sm font-semibold text-foreground",children:s}),r.jsx("div",{className:"mt-2 text-sm text-muted-foreground",children:e})]})}const cn={idea:"Idea",prototype:"Prototype",mvp:"MVP"},tt={idea:"IDEA",document:"DOCUMENT",demoLink:"DEMO_LINK",video:"VIDEO"},un={pending:"Pending",reviewed:"Reviewed",approved:"Approved"},Ac=s=>{switch(s){case tt.idea:return"Idea";case tt.document:return"Document";case tt.demoLink:return"Demo link";case tt.video:return"Video";default:return String(s??"Submission")}},Qx=s=>{if(!s)return cn.idea;if(Object.values(cn).includes(s))return s;const e=String(s).toLowerCase();return e==="idea"?cn.idea:e==="prototype"?cn.prototype:e==="mvp"?cn.mvp:cn.idea},Rv=s=>(s??[]).some(e=>e.type===tt.idea),lf=s=>{const e={},a=(o,u)=>{const d=s?.[o];String(d??"").trim()||(e[o]=`${u} is required`)};a("title","Project title"),a("problemStatement","Problem statement"),a("targetUsers","Target users"),a("proposedSolution","Proposed solution");const i=s?.stage;return Object.values(cn).includes(i)||(e.stage="Project stage is required"),{ok:Object.keys(e).length===0,errors:e}},Ze={text:"TEXT",file:"FILE",link:"LINK",checklist:"CHECKLIST"},Xt={pending:"PENDING",submitted:"SUBMITTED",reviewed:"REVIEWED",approved:"APPROVED",revision:"REVISION"},Wf=s=>{const e=String(s??"").toUpperCase();return e===Ze.text?"Text":e===Ze.file?"File":e===Ze.link?"Link":e===Ze.checklist?"Checklist":"Task"},em=s=>{const e=String(s??"").toUpperCase();return e===Xt.pending?"Pending":e===Xt.submitted?"Submitted":e===Xt.reviewed?"Reviewed":e===Xt.approved?"Approved":e===Xt.revision?"Revision":"Pending"},Kk=s=>{const e=String(s??"").toUpperCase();return e===Xt.pending||e===Xt.revision},Yk=s=>String(s??"").toUpperCase()===Xt.submitted,Zx=s=>{const e=String(s??Xt.pending).toUpperCase();return Object.values(Xt).includes(e)?e:Xt.pending},Wx=s=>{const e=String(s??Ze.text).toUpperCase();return Object.values(Ze).includes(e)?e:Ze.text};function Dv({status:s}){const e=String(s??Xt.pending).toUpperCase();return r.jsx(ts,{value:e.toLowerCase()})}const Xk={[tt.idea]:U_,[tt.document]:Kl,[tt.demoLink]:pv,[tt.video]:Yl};function Sa({label:s,children:e}){return r.jsxs("div",{children:[r.jsx("div",{className:"text-xs font-bold uppercase tracking-wider text-slate-400",children:s}),r.jsx("div",{className:"mt-1 text-sm text-slate-700 leading-relaxed",children:e})]})}function tm({submissions:s,tasks:e,getUserById:a,allowComment:i,allowReview:o,currentUserId:u,onComment:d,onSetStatus:f}){const m=v.useMemo(()=>{const p=[];for(const x of s??[])p.push({kind:"submission",id:x.id,at:x.createdAt,submission:x});for(const x of e??[])p.push({kind:"task",id:x.id,at:x.createdAt,task:x});return p.sort((x,b)=>new Date(x.at)-new Date(b.at))},[s,e]);return m.length===0?r.jsx("div",{className:"rounded-xl border border-slate-200 bg-white p-6 text-sm text-slate-500",children:"No activity yet."}):r.jsx("div",{className:"space-y-4",children:m.map(p=>p.kind==="submission"?r.jsx(Qk,{submission:p.submission,getUserById:a,allowComment:i,allowReview:o,currentUserId:u,onComment:d,onSetStatus:f},`sub:${p.id}`):r.jsx(Jk,{task:p.task,getUserById:a},`tsk:${p.id}`))})}function Jk({task:s,getUserById:e}){const a=s?.createdBy?e?.(s.createdBy):null;return r.jsx(Ye,{title:r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"h-9 w-9 rounded-xl bg-slate-100 flex items-center justify-center text-slate-700",children:r.jsx(jn,{className:"h-5 w-5"})}),r.jsxs("div",{children:[r.jsxs("div",{className:"font-heading font-bold text-slate-900",children:["Task: ",s?.title]}),r.jsxs("div",{className:"text-xs text-slate-500",children:[Wf(s?.taskType),"  ",em(s?.status),"  ",ms(s?.createdAt)]})]})]}),actions:r.jsx("div",{className:"flex items-center gap-2",children:r.jsx(Dv,{status:s?.status})}),children:r.jsxs("div",{className:"space-y-4",children:[s?.description?r.jsx("div",{className:"text-sm text-slate-700 whitespace-pre-wrap",children:s.description}):r.jsx("div",{className:"text-sm text-slate-500",children:"No description."}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"rounded-xl border border-slate-200 bg-slate-50 p-4",children:[r.jsx("div",{className:"text-xs font-bold uppercase tracking-wider text-slate-400",children:"Created by"}),r.jsx("div",{className:"mt-1 text-sm font-semibold text-slate-800",children:a?.name??s?.createdBy??"Coach"})]}),r.jsxs("div",{className:"rounded-xl border border-slate-200 bg-slate-50 p-4",children:[r.jsx("div",{className:"text-xs font-bold uppercase tracking-wider text-slate-400",children:"Student submission"}),r.jsx("div",{className:"mt-1 text-sm text-slate-700",children:s?.studentSubmission?"Submitted":"Not submitted yet."})]})]}),s?.coachFeedback?r.jsxs("div",{className:"rounded-xl border border-blue-200 bg-blue-50 p-4",children:[r.jsx("div",{className:"text-xs font-bold uppercase tracking-wider text-blue-700",children:"Coach feedback"}),r.jsx("div",{className:"mt-2 text-sm text-blue-900 whitespace-pre-wrap",children:s.coachFeedback})]}):null]})})}function Qk({submission:s,getUserById:e,allowComment:a,allowReview:i,currentUserId:o,onComment:u,onSetStatus:d}){const f=Xk[s.type]??Kl,[m,p]=v.useState(""),x=String(s.status??un.pending).toLowerCase(),b=x==="approved"?"approved":x==="reviewed"?"reviewed":"pending",y=s.comments??[],j=s.payload??{},N=(()=>{if(s.type===tt.idea)return r.jsxs("div",{className:"space-y-4",children:[r.jsx(Sa,{label:"Problem statement",children:j.problemStatement}),r.jsx(Sa,{label:"Target users",children:j.targetUsers}),r.jsx(Sa,{label:"Proposed solution",children:j.proposedSolution}),r.jsx(Sa,{label:"Stage",children:j.stage})]});if(s.type===tt.document){const k=j.file;return r.jsxs("div",{className:"space-y-2",children:[r.jsx(Sa,{label:"PDF",children:k?.fileName??"Document"}),k?.localUrl?r.jsx("a",{className:"text-sm font-semibold text-blue-600 hover:underline",href:k.localUrl,target:"_blank",rel:"noreferrer",children:"Open document"}):null,j.note?r.jsx("div",{className:"text-xs text-slate-500",children:j.note}):null]})}if(s.type===tt.demoLink)return r.jsx("div",{className:"space-y-2",children:r.jsx(Sa,{label:"Demo link",children:r.jsx("a",{className:"text-blue-600 hover:underline",href:j.url,target:"_blank",rel:"noreferrer",children:j.url})})});if(s.type===tt.video){const k=j.file;return r.jsxs("div",{className:"space-y-2",children:[j.url?r.jsx(Sa,{label:"Video link",children:r.jsx("a",{className:"text-blue-600 hover:underline",href:j.url,target:"_blank",rel:"noreferrer",children:j.url})}):null,k?.fileName?r.jsx(Sa,{label:"Video file",children:k.fileName}):null,k?.localUrl?r.jsx("a",{className:"text-sm font-semibold text-blue-600 hover:underline",href:k.localUrl,target:"_blank",rel:"noreferrer",children:"Open video"}):null,j.note?r.jsx("div",{className:"text-xs text-slate-500",children:j.note}):null]})}return r.jsx("div",{className:"text-sm text-slate-600",children:"Submission details unavailable."})})();return r.jsx(Ye,{title:r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"h-9 w-9 rounded-xl bg-slate-100 flex items-center justify-center text-slate-700",children:r.jsx(f,{className:"h-5 w-5"})}),r.jsxs("div",{children:[r.jsx("div",{className:"font-heading font-bold text-slate-900",children:Ac(s.type)}),r.jsx("div",{className:"text-xs text-slate-500",children:ms(s.createdAt)})]})]}),actions:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(ts,{value:b}),i?r.jsxs(r.Fragment,{children:[b==="pending"?r.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>d?.({submissionId:s.id,status:un.reviewed,reviewerId:o}),children:"Mark reviewed"}):null,b!=="approved"?r.jsx("button",{type:"button",className:"btn-primary",onClick:()=>d?.({submissionId:s.id,status:un.approved,reviewerId:o}),children:"Approve"}):null]}):null]}),children:r.jsxs("div",{className:"space-y-6",children:[N,r.jsxs("div",{children:[r.jsx("div",{className:"text-xs font-bold uppercase tracking-wider text-slate-400 mb-2",children:"Feedback"}),y.length===0?r.jsx("div",{className:"text-sm text-slate-500",children:"No feedback yet."}):r.jsx("div",{className:"space-y-2",children:y.map(k=>{const T=e?.(k.authorId);return r.jsxs("div",{className:"rounded-xl border border-slate-200 bg-slate-50 p-3",children:[r.jsxs("div",{className:"flex items-center justify-between gap-3",children:[r.jsx("div",{className:"text-sm font-bold text-slate-800 truncate",children:T?.name??"Coach"}),r.jsx("div",{className:"text-xs text-slate-500",children:ms(k.createdAt)})]}),r.jsx("div",{className:"mt-1 text-sm text-slate-700 whitespace-pre-wrap",children:k.text})]},k.id)})}),a?r.jsxs("div",{className:"mt-3 flex items-end gap-2",children:[r.jsx("textarea",{className:"input min-h-[44px]",value:m,onChange:k=>p(k.target.value),placeholder:"Write feedback"}),r.jsx("button",{type:"button",className:"btn-primary",disabled:!String(m).trim(),onClick:async()=>{const k=String(m).trim();k&&(await u?.({submissionId:s.id,text:k}),p(""))},children:"Send"})]}):null]})]})})}function Zk(){const{currentUser:s}=gt(),{listProjects:e,listProjectSubmissions:a,listTasks:i,getUserById:o,addProjectSubmissionComment:u,setProjectSubmissionStatus:d}=yt(),[f,m]=v.useState(null),p=v.useMemo(()=>e().map(N=>{const k=a({projectId:N.id}),T=k.filter(A=>String(A.status).toLowerCase()==="pending").length,R=o?.(N.studentId);return{...N,studentName:R?.name??"Student",submissionsCount:k.length,pendingCount:T}}),[o,a,e]),x=v.useMemo(()=>f?e().find(j=>j.id===f)??null:null,[e,f]),b=v.useMemo(()=>x?.id?a({projectId:x.id}):[],[a,x]),y=v.useMemo(()=>x?.id?i?.({projectId:x.id})??[]:[],[i,x]);return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-2xl font-heading font-bold text-slate-900",children:"Projects"}),r.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Monitor progress and stages across all students."})]}),r.jsx(Wc,{title:"All projects",rows:p,exportFilename:"projects.csv",getRowId:j=>j.id,initialSort:{key:"updatedAt",dir:"desc"},columns:[{key:"title",header:"Title",accessor:j=>j.title},{key:"student",header:"Student",accessor:j=>j.studentName},{key:"stage",header:"Stage",accessor:j=>j.stage},{key:"submissions",header:"Submissions",accessor:j=>j.submissionsCount,align:"right"},{key:"pending",header:"Pending",accessor:j=>j.pendingCount,align:"right",cell:j=>r.jsxs("div",{className:"flex items-center justify-end gap-2",children:[r.jsx(ts,{value:j.pendingCount>0?"pending":"active"}),r.jsx("span",{className:"tabular-nums",children:j.pendingCount})]})},{key:"updatedAt",header:"Last updated",accessor:j=>new Date(j.updatedAt).toLocaleString(),sortValue:j=>j.updatedAt},{key:"actions",header:"",accessor:()=>"",searchable:!1,sortable:!1,align:"right",cell:j=>r.jsx("div",{className:"flex justify-end",children:r.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>m(j.id),children:"Review"})})}]}),r.jsx(Pt,{open:!!x,title:x?`Project  ${x.title}`:"Project",onClose:()=>m(null),footer:r.jsx("button",{type:"button",className:"btn-ghost",onClick:()=>m(null),children:"Close"}),children:x?r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"rounded-xl border border-slate-200 bg-slate-50 p-4",children:[r.jsx("div",{className:"text-xs font-bold uppercase tracking-wider text-slate-400",children:"Student"}),r.jsx("div",{className:"mt-1 text-sm font-semibold text-slate-800",children:o?.(x.studentId)?.name??x.studentId}),r.jsx("div",{className:"mt-2 text-xs text-slate-500",children:"Use this view to approve IDEA submissions and review progress."})]}),r.jsx(tm,{submissions:b,tasks:y,getUserById:o,allowComment:!0,allowReview:!0,currentUserId:s?.id??"admin",onComment:async({submissionId:j,text:N})=>{await u?.({submissionId:j,authorId:s?.id??"admin",text:N})},onSetStatus:async({submissionId:j,status:N})=>{await d?.({submissionId:j,status:N,reviewerId:s?.id??"admin"})}})]}):null})]})}function Wk(){const{currentUser:s}=gt(),{data:e,markAsRead:a}=yt(),i=_n(),[o,u]=v.useState(null),d=v.useRef(null),f=v.useMemo(()=>{if(!s?.id||!e)return null;const p=(e.programs??[]).filter(j=>j.coachIds.includes(s.id)),x=p.map(j=>j.id),b=new Set;return p.forEach(j=>{j.participantStudentIds.forEach(N=>b.add(N))}),{students:(e.users??[]).filter(j=>b.has(j.id)).map(j=>{const N=(e.deliverables??[]).filter(T=>x.includes(T.programId)&&T.assignedStudentIds.includes(j.id)&&new Date(T.dueDate)<new Date&&!T.submissions?.some(R=>R.studentId===j.id)).length,k=(e.messages??[]).filter(T=>T.senderId===j.id&&T.receiverId===s.id&&!T.readAt).length;return{...j,overdueCount:N,unreadCount:k,attentionLevel:N>0?"high":k>0?"medium":"low"}}).sort((j,N)=>{const k={high:3,medium:2,low:1};return k[N.attentionLevel]-k[j.attentionLevel]}),myPrograms:p}},[s,e]),m=v.useMemo(()=>{if(!o||!f)return null;const p=f.students.find(y=>y.id===o),x=(e?.messages??[]).filter(y=>y.senderId===s.id&&y.receiverId===o||y.senderId===o&&y.receiverId===s.id).sort((y,j)=>new Date(y.sentAt)-new Date(j.sentAt)),b=(e?.deliverables??[]).filter(y=>y.assignedStudentIds.includes(o)).map(y=>{const j=y.submissions?.find(k=>k.studentId===o);let N="pending";return j?N=j.status:new Date(y.dueDate)<new Date&&(N="overdue"),{...y,submission:j,status:N}}).sort((y,j)=>new Date(y.dueDate)-new Date(j.dueDate));return{student:p,messages:x,deliverables:b}},[o,f,e,s]);return v.useEffect(()=>{m?.messages&&d.current&&d.current.scrollIntoView({behavior:"smooth"})},[m?.messages]),v.useEffect(()=>{if(o&&f){const p=f.students.find(x=>x.id===o);if(p&&p.unreadCount>0){const x=(e?.messages??[]).filter(b=>b.senderId===o&&b.receiverId===s.id&&!b.readAt).map(b=>b.id);x.length>0&&a({messageIds:x})}}},[o,f,e,s,a]),!s||!f?r.jsx("div",{className:"p-8",children:"Loading..."}):r.jsxs("div",{className:"h-[calc(100vh-8rem)] min-h-[600px] overflow-hidden rounded-2xl border border-border bg-card shadow-sm grid grid-cols-12",children:[r.jsxs("div",{className:"col-span-12 md:col-span-4 border-r border-border flex flex-col bg-muted/10",children:[r.jsxs("div",{className:"p-4 border-b border-border",children:[r.jsxs("h2",{className:"font-semibold text-lg flex items-center gap-2",children:[r.jsx(dn,{className:"h-5 w-5"})," My Students"]}),r.jsxs("div",{className:"mt-3 relative",children:[r.jsx(Zn,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),r.jsx("input",{type:"text",placeholder:"Search students...",className:"w-full rounded-full border border-input bg-background pl-9 pr-4 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-primary/20"})]})]}),r.jsx("div",{className:"flex-1 overflow-y-auto p-2 space-y-1",children:f.students.map(p=>r.jsxs("button",{onClick:()=>u(p.id),className:it("w-full text-left p-3 rounded-xl transition-all flex items-center gap-3",o===p.id?"bg-white shadow-sm ring-1 ring-border dark:bg-slate-800":"hover:bg-white/50 hover:dark:bg-white/5"),children:[r.jsxs("div",{className:"relative h-10 w-10",children:[r.jsx("div",{className:"h-full w-full rounded-full bg-indigo-100 text-indigo-700 flex items-center justify-center font-bold",children:p.name.charAt(0)}),p.attentionLevel!=="low"&&r.jsx("span",{className:it("absolute -top-1 -right-1 h-3 w-3 rounded-full border-2 border-white",p.attentionLevel==="high"?"bg-red-500":"bg-blue-500")})]}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"font-medium text-sm text-foreground truncate",children:p.name}),r.jsx("span",{className:"text-xs text-muted-foreground",children:p.level?`Lvl ${p.level}`:""})]}),r.jsx("div",{className:"text-xs text-muted-foreground truncate flex items-center gap-2",children:p.overdueCount>0?r.jsxs("span",{className:"text-red-600 font-medium",children:[p.overdueCount," overdue tasks"]}):p.university})]}),r.jsx(Fx,{className:it("h-4 w-4 text-muted-foreground",o===p.id&&"text-primary")})]},p.id))})]}),r.jsx("div",{className:"col-span-12 md:col-span-8 flex flex-col bg-background",children:m?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"h-16 px-6 border-b border-border flex items-center justify-between bg-white/50 backdrop-blur-sm dark:bg-slate-900/50",children:[r.jsx("div",{className:"flex items-center gap-3",children:r.jsxs("div",{children:[r.jsx("h2",{className:"font-bold text-foreground",children:m.student.name}),r.jsxs("p",{className:"text-xs text-muted-foreground flex items-center gap-2",children:[m.student.email,"  ",m.student.phone]})]})}),r.jsx("div",{className:"flex gap-2",children:r.jsx("button",{className:"btn-ghost btn-sm h-8 w-8 p-0 rounded-full",children:r.jsx(Rl,{className:"h-4 w-4"})})})]}),r.jsxs("div",{className:"flex-1 overflow-hidden grid grid-rows-2 md:grid-rows-1 md:grid-cols-2",children:[r.jsxs("div",{className:"flex flex-col border-r border-border h-full max-h-full p-6 bg-slate-50/30",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsxs("h3",{className:"font-semibold text-sm flex items-center gap-2 text-slate-700",children:[r.jsx(yi,{className:"h-4 w-4"}),"Recent Communications"]}),r.jsxs("button",{onClick:()=>i("/coach/messages"),className:"text-xs font-semibold text-primary hover:underline flex items-center gap-1",children:["Open Messenger ",r.jsx(Fx,{className:"h-3 w-3"})]})]}),r.jsx("div",{className:"flex-1 overflow-y-auto space-y-3 pr-2 custom-scrollbar",children:m.messages.length===0?r.jsxs("div",{className:"h-32 flex flex-col items-center justify-center text-muted-foreground text-sm opacity-60 border border-dashed border-slate-200 rounded-xl",children:[r.jsx(yi,{className:"h-6 w-6 mb-2"}),"No history yet"]}):m.messages.slice(-4).reverse().map(p=>{const x=p.senderId===s.id;return r.jsxs("div",{className:it("p-3 rounded-xl border flex flex-col gap-1 transition-all hover:shadow-sm",x?"bg-white border-slate-100":"bg-blue-50/30 border-blue-100"),children:[r.jsxs("div",{className:"flex justify-between items-start",children:[r.jsx("span",{className:it("text-xs font-bold",x?"text-slate-700":"text-blue-700"),children:x?"You":m.student.name}),r.jsx("span",{className:"text-[10px] text-slate-400",children:ms(p.sentAt)})]}),r.jsx("p",{className:"text-sm text-slate-600 line-clamp-2 leading-relaxed",children:p.content})]},p.id)})}),r.jsxs("div",{className:"mt-6",children:[r.jsxs("h3",{className:"font-semibold text-sm flex items-center gap-2 mb-3 text-slate-700",children:[r.jsx(dn,{className:"h-4 w-4"}),"Student Stats"]}),r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.jsxs("div",{className:"bg-white border border-slate-100 p-3 rounded-lg text-center",children:[r.jsx("div",{className:"text-xs text-slate-500 uppercase tracking-wide font-medium",children:"Attention"}),r.jsx("div",{className:it("mt-1 font-bold",m.student.attentionLevel==="high"?"text-red-600":m.student.attentionLevel==="medium"?"text-amber-600":"text-emerald-600"),children:m.student.attentionLevel.toUpperCase()})]}),r.jsxs("div",{className:"bg-white border border-slate-100 p-3 rounded-lg text-center",children:[r.jsx("div",{className:"text-xs text-slate-500 uppercase tracking-wide font-medium",children:"Late Tasks"}),r.jsx("div",{className:"mt-1 font-bold text-slate-900",children:m.student.overdueCount})]})]})]})]}),r.jsxs("div",{className:"flex flex-col h-full bg-background overflow-hidden",children:[r.jsx("div",{className:"p-4 border-b border-border bg-muted/5",children:r.jsxs("h3",{className:"font-semibold text-sm flex items-center gap-2",children:[r.jsx(h_,{className:"h-4 w-4"}),"Deliverables Status"]})}),r.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:m.deliverables.map(p=>r.jsxs("div",{className:"group rounded-lg border border-border p-3 hover:border-primary/50 transition-colors bg-card",children:[r.jsxs("div",{className:"flex justify-between items-start mb-1",children:[r.jsx("span",{className:"font-medium text-sm text-foreground line-clamp-1",children:p.title}),p.status==="graded"?r.jsxs("span",{className:"text-xs font-bold text-green-600 bg-green-50 px-2 py-0.5 rounded-full",children:[p.submission.grade,"%"]}):p.status==="submitted"?r.jsx("span",{className:"text-xs font-bold text-blue-600 bg-blue-50 px-2 py-0.5 rounded-full",children:"To Grade"}):p.status==="overdue"?r.jsx("span",{className:"text-xs font-bold text-red-600 bg-red-50 px-2 py-0.5 rounded-full",children:"Overdue"}):r.jsx("span",{className:"text-xs text-muted-foreground bg-muted px-2 py-0.5 rounded-full",children:"Pending"})]}),r.jsxs("div",{className:"text-xs text-muted-foreground flex justify-between items-center mt-2",children:[r.jsxs("span",{children:["Due: ",es(p.dueDate)]}),p.status==="submitted"&&r.jsx("button",{className:"text-primary font-medium hover:underline",children:"Grade Now"})]})]},p.id))}),r.jsxs("div",{className:"p-4 border-t border-border bg-indigo-50/50 dark:bg-indigo-900/10",children:[r.jsx("h3",{className:"text-xs font-semibold text-indigo-800 dark:text-indigo-300 mb-2",children:"Quick Actions"}),r.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[r.jsx("button",{onClick:()=>i("/coach/sessions"),className:"rounded-lg bg-white border border-indigo-100 px-3 py-2 text-xs font-medium text-indigo-700 shadow-sm hover:bg-indigo-50 transition-colors",children:"Schedule Session"}),r.jsx("button",{onClick:()=>i("/coach/deliverables"),className:"rounded-lg bg-white border border-indigo-100 px-3 py-2 text-xs font-medium text-indigo-700 shadow-sm hover:bg-indigo-50 transition-colors",children:"Assign Task"})]})]})]})]})]}):r.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-center p-8",children:[r.jsx("div",{className:"h-20 w-20 bg-muted rounded-full flex items-center justify-center mb-4",children:r.jsx(dn,{className:"h-10 w-10 text-muted-foreground/50"})}),r.jsx("h3",{className:"text-xl font-bold text-foreground",children:"Select a Student"}),r.jsx("p",{className:"text-muted-foreground max-w-sm mt-2",children:"Choose a student from the sidebar to view their progress, chat history, and pending deliverables."}),f.students.filter(p=>p.attentionLevel==="high").length>0&&r.jsxs("div",{className:"mt-8 w-full max-w-md",children:[r.jsx("div",{className:"text-xs font-semibold uppercase tracking-wider text-muted-foreground mb-3",children:"Attention Needed"}),r.jsx("div",{className:"bg-red-50 dark:bg-red-900/10 border border-red-100 dark:border-red-900/30 rounded-xl overflow-hidden",children:f.students.filter(p=>p.attentionLevel==="high").map(p=>r.jsxs("button",{onClick:()=>u(p.id),className:"w-full flex items-center justify-between p-3 hover:bg-red-100/50 transition-colors border-b border-red-100 last:border-0",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx(Sv,{className:"h-4 w-4 text-red-500"}),r.jsx("span",{className:"text-sm font-medium text-red-900 dark:text-red-200",children:p.name})]}),r.jsx("span",{className:"text-xs text-red-700 font-medium",children:"View"})]},p.id))})]})]})})]})}function eT(){const{currentUser:s}=gt(),{getUserById:e,listProjects:a,listProjectSubmissions:i,listTasks:o,addProjectSubmissionComment:u,setProjectSubmissionStatus:d}=yt(),[f,m]=v.useState(null),p=s?.id?a({coachId:s.id}):[],x=f?p.find(k=>k.id===f)??null:p[0]??null,b=x?.id?i({projectId:x.id}):[],y=x?.id?o({projectId:x.id})??[]:[],j=async({submissionId:k,text:T})=>{await u({submissionId:k,authorId:s.id,text:T})},N=async({submissionId:k,status:T,reviewerId:R})=>{await d({submissionId:k,status:T,reviewerId:R})};return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-2xl font-heading font-bold text-slate-900",children:"Project Reviews"}),r.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Review IDEA clearly and give feedback per submission."})]}),r.jsxs("div",{className:"grid gap-6 lg:grid-cols-5",children:[r.jsx("div",{className:"lg:col-span-2",children:r.jsx(Ye,{title:"Projects",subtitle:p.length?`${p.length} available`:"No projects yet",children:p.length===0?r.jsx(Aa,{title:"No projects",message:"Students will appear here once they submit an IDEA.",icon:mr}):r.jsx("div",{className:"space-y-2",children:p.map(k=>{const T=e?.(k.studentId),R=x?.id===k.id;return r.jsxs("button",{type:"button",onClick:()=>m(k.id),className:["w-full text-left rounded-xl border p-4 transition-colors",R?"border-coach-primary/30 bg-white":"border-slate-200 bg-white hover:bg-slate-50"].join(" "),children:[r.jsxs("div",{className:"flex items-center justify-between gap-3",children:[r.jsx("div",{className:"font-heading font-bold text-slate-900 truncate",children:k.title}),r.jsx("div",{className:"text-xs font-bold uppercase tracking-wider text-slate-500",children:k.stage})]}),r.jsxs("div",{className:"mt-1 text-xs text-slate-500 truncate",children:["Student: ",T?.name??"Student"]})]},k.id)})})})}),r.jsx("div",{className:"lg:col-span-3",children:x?r.jsxs(Ye,{title:x.title,subtitle:`Student: ${e?.(x.studentId)?.name??"Student"}  Stage: ${x.stage}`,children:[r.jsx(tm,{submissions:b,getUserById:e,allowComment:!0,allowReview:!0,currentUserId:s?.id,onComment:j,onSetStatus:N,tasks:y}),r.jsxs("div",{className:"mt-4 text-xs text-slate-500",children:["Review flow: ",un.pending,"  ",un.reviewed,"  ",un.approved]})]}):r.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white p-6 text-sm text-slate-500",children:"Select a project to review submissions."})})]})]})}function Ov({value:s=0,colorClass:e="bg-blue-600"}){const a=Math.max(0,Math.min(100,Number(s)||0));return r.jsxs("div",{className:"w-full",children:[r.jsx("div",{className:"h-2.5 w-full rounded-full bg-slate-100 overflow-hidden",children:r.jsx("div",{className:`h-full rounded-full transition-all duration-500 ${e}`,style:{width:`${a}%`},"aria-label":`Progress ${a}%`})}),r.jsx("div",{className:"mt-1.5 flex justify-end",children:r.jsxs("span",{className:"text-xs font-semibold text-slate-500",children:[a,"%"]})})]})}function tT(){const{currentUser:s}=gt(),{data:e}=yt(),{templates:a,templateDetailsById:i,instances:o,instanceDetailsById:u,fetchTemplateDetails:d,fetchInstanceDetails:f,subscribeToInstanceTasks:m,approveInstanceTask:p,reorderInstanceTasks:x,advanceInstanceStage:b,injectTask:y,extendTaskDeadline:j}=Zf(),[N,k]=v.useState(null),[T,R]=v.useState(!1),[A,C]=v.useState(null),B=v.useMemo(()=>!s?.id||!e?[]:(e.programs??[]).filter(S=>S.coachIds.includes(s.id)),[s,e]),F=v.useMemo(()=>{if(!e)return{};const S={};return B.forEach(D=>{const M=D.participantStudentIds.length,I=(e.coachingSessions??[]).filter(Se=>Se.programId===D.id).length,G=(e.deliverables??[]).filter(Se=>Se.programId===D.id),ae=G.reduce((Se,pe)=>Se+(pe.submissions?.length??0),0),xe=G.reduce((Se,pe)=>Se+(pe.submissions?.filter(qe=>qe.status==="graded").length??0),0),je=ae>0?Math.round(xe/ae*100):0;S[D.id]={students:M,sessions:I,deliverables:G.length,submissionRate:je}}),S},[B,e]),V=v.useMemo(()=>{if(!N||!e)return null;const S=B.find(G=>G.id===N);if(!S)return null;const D=(e.users??[]).filter(G=>S.participantStudentIds.includes(G.id)),M=(e.deliverables??[]).filter(G=>G.programId===S.id),I=D.map(G=>{const ae=M.flatMap(Oe=>(Oe.submissions??[]).filter(Xe=>Xe.studentId===G.id)),xe=ae.filter(Oe=>Oe.status==="graded").length,je=M.length,Se=je>0?Math.round(xe/je*100):0,pe=ae.filter(Oe=>Oe.grade!==null&&Oe.grade!==void 0).map(Oe=>Oe.grade),qe=pe.length>0?Math.round(pe.reduce((Oe,Xe)=>Oe+Xe,0)/pe.length):null;return{student:G,completed:xe,total:je,progress:Se,avgGrade:qe,xp:G.xp??0,level:G.level??1}});return{program:S,students:D,deliverables:M,studentProgress:I}},[N,B,e]),O=v.useMemo(()=>o??[],[o]),H=v.useMemo(()=>A?u[A]??null:null,[u,A]),te=H?.instance??null,me=H?.tasks??[],de=te?a.find(S=>S.id===te.templateId)??null:null,ye=te?i[te.templateId]??null:null,Ae=v.useMemo(()=>te?.studentId?(e?.users??[]).find(S=>S.id===te.studentId)??null:null,[e?.users,te]);v.useEffect(()=>{if(!T||!A)return;let S=!1;return(async()=>{try{const D=await f(A);if(S)return;D?.instance?.templateId&&await d(D.instance.templateId),await m(A)}catch{}})(),()=>{S=!0}},[f,d,T,A,m]);const Re=S=>{C(S),R(!0)},ze=()=>{R(!1),C(null)},J=async(S,D)=>{const M=me.findIndex(ae=>ae.id===S);if(M<0)return;const I=[...me],G=D==="up"?M-1:M+1;G<0||G>=I.length||([I[M],I[G]]=[I[G],I[M]],await x({instanceId:A,orderedTaskIds:I.map(ae=>ae.id)}))},se=async(S,D)=>{const M=window.prompt("Coach feedback (optional):","");await p({taskId:S,feedback:M??null,approved:D})},he=async()=>{if(!A||!ye?.stages?.length)return;const S=ye.stages.map(I=>I.name).join(", "),D=window.prompt(`Advance stage to: ${S}`,ye.stages[0]?.name??"");if(!D)return;const M=ye.stages.find(I=>I.name.toLowerCase()===D.toLowerCase());M&&await b({instanceId:A,stageId:M.id})},we=async()=>{if(!A)return;const S=window.prompt("New task title:","");if(!S)return;const D=window.prompt("Description (optional):","");let M=te?.currentStageId??null;if(ye?.stages?.length){const I=ye.stages.map(xe=>xe.name).join(", "),G=window.prompt(`Assign to stage: ${I}`,ye.stages[0]?.name??""),ae=ye.stages.find(xe=>xe.name.toLowerCase()===String(G??"").toLowerCase());ae&&(M=ae.id)}M&&await y({instanceId:A,stageId:M,title:S,description:D})},K=async S=>{const D=window.prompt("New deadline date (YYYY-MM-DD):","");if(!D)return;const M=new Date(`${D}T00:00:00.000Z`).toISOString();await j({taskId:S,deadline:M})};return B.length===0?r.jsxs("div",{className:"flex flex-col items-center justify-center py-16",children:[r.jsx(Al,{className:"h-16 w-16 text-muted-foreground"}),r.jsx("h2",{className:"mt-4 text-xl font-semibold text-foreground",children:"No Programs Yet"}),r.jsx("p",{className:"mt-2 text-muted-foreground",children:"You haven't been assigned to any programs yet."})]}):r.jsxs("div",{className:"space-y-6",children:[r.jsx(Ye,{title:"Program Instances",subtitle:"Editable roadmaps generated from templates (videos/courses + tasks)",children:O.length===0?r.jsx("div",{className:"text-sm text-muted-foreground",children:"No program instances yet."}):r.jsx("div",{className:"grid gap-3 md:grid-cols-2",children:O.slice(0,6).map(S=>{const D=a.find(I=>I.id===S.templateId),M=(e?.users??[]).find(I=>I.id===S.studentId);return r.jsx("div",{className:"rounded-lg border border-border/50 bg-muted/20 p-4",children:r.jsxs("div",{className:"flex items-start justify-between gap-3",children:[r.jsxs("div",{className:"min-w-0",children:[r.jsx("div",{className:"font-semibold text-foreground truncate",children:D?.name??"Program"}),r.jsxs("div",{className:"mt-1 text-sm text-muted-foreground truncate",children:["Student: ",M?.name??S.studentId]}),r.jsxs("div",{className:"mt-1 text-xs text-muted-foreground",children:["Started: ",es(S.startedAt)]})]}),r.jsx("button",{type:"button",className:"btn",onClick:()=>Re(S.id),children:"Open"})]})},S.id)})})}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-2xl font-bold text-foreground",children:"My Programs"}),r.jsxs("p",{className:"mt-1 text-muted-foreground",children:["Manage your ",B.length," assigned program",B.length===1?"":"s"]})]}),N?r.jsxs(r.Fragment,{children:[r.jsx("button",{type:"button",className:"btn-ghost",onClick:()=>k(null),children:" Back to all programs"}),V&&r.jsxs("div",{className:"space-y-6",children:[r.jsx(Ye,{children:r.jsxs("div",{className:"flex items-start justify-between gap-4",children:[r.jsxs("div",{className:"min-w-0 flex-1",children:[r.jsx("h2",{className:"text-xl font-bold text-foreground",children:V.program.name}),r.jsx("p",{className:"mt-1 text-muted-foreground",children:V.program.description}),r.jsxs("div",{className:"mt-3 flex items-center gap-4 text-sm text-muted-foreground",children:[r.jsxs("span",{children:[" ",es(V.program.startDate)," -"," ",es(V.program.endDate)]}),r.jsxs("span",{children:[" ",V.students.length," students"]}),r.jsxs("span",{children:[" ",V.deliverables.length," deliverables"]})]})]}),r.jsx(ts,{value:V.program.status})]})}),r.jsx(Ye,{title:"Student Progress",subtitle:`${V.students.length} enrolled students`,children:r.jsx("div",{className:"space-y-3",children:V.studentProgress.map(S=>r.jsxs("div",{className:"flex items-center gap-4 rounded-lg border border-border/50 bg-muted/30 p-4",children:[r.jsx("div",{className:"grid h-12 w-12 place-items-center rounded-full bg-primary/10 text-primary",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-sm font-bold",children:S.level}),r.jsx("div",{className:"text-[10px]",children:"lvl"})]})}),r.jsxs("div",{className:"min-w-0 flex-1",children:[r.jsxs("div",{className:"flex items-center justify-between gap-3",children:[r.jsxs("div",{children:[r.jsx("div",{className:"font-medium text-foreground",children:S.student.name}),r.jsxs("div",{className:"text-sm text-muted-foreground",children:[S.student.university,"  ",S.xp," XP"]})]}),r.jsxs("div",{className:"text-right",children:[r.jsxs("div",{className:"text-sm font-medium text-foreground",children:[S.completed," / ",S.total," completed"]}),S.avgGrade!==null&&r.jsxs("div",{className:"text-sm text-muted-foreground",children:["Avg: ",S.avgGrade,"%"]})]})]}),r.jsx("div",{className:"mt-2",children:r.jsx(Ov,{value:S.progress})})]})]},S.student.id))})}),r.jsx(Ye,{title:"Deliverables",subtitle:"Assignments for this program",children:r.jsx("div",{className:"space-y-2",children:V.deliverables.map(S=>{const D=S.submissions??[],M=D.filter(G=>G.status==="graded").length,I=D.filter(G=>G.status==="submitted").length;return r.jsxs("div",{className:"flex items-center justify-between rounded-lg border border-border/50 bg-muted/30 p-3",children:[r.jsxs("div",{children:[r.jsx("div",{className:"font-medium text-foreground",children:S.title}),r.jsxs("div",{className:"mt-1 text-sm text-muted-foreground",children:["Due: ",es(S.dueDate)]})]}),r.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[r.jsxs("span",{className:"text-success-700",children:[" ",M," graded"]}),I>0&&r.jsxs("span",{className:"text-warning-700",children:[" ",I," pending"]})]})]},S.id)})})})]})]}):r.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:B.map(S=>{const D=F[S.id]??{};return r.jsx(Ye,{className:"cursor-pointer hover:border-primary/50",children:r.jsxs("div",{onClick:()=>k(S.id),className:"space-y-4",children:[r.jsxs("div",{className:"flex items-start justify-between gap-3",children:[r.jsxs("div",{className:"min-w-0 flex-1",children:[r.jsx("h3",{className:"font-semibold text-foreground",children:S.name}),r.jsx("p",{className:"mt-1 text-sm text-muted-foreground line-clamp-2",children:S.description})]}),r.jsx(ts,{value:S.status})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[r.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[r.jsx(dn,{className:"h-4 w-4"}),r.jsxs("span",{children:[D.students," students"]})]}),r.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[r.jsx(gs,{className:"h-4 w-4"}),r.jsxs("span",{children:[D.sessions," sessions"]})]}),r.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[r.jsx(jn,{className:"h-4 w-4"}),r.jsxs("span",{children:[D.deliverables," deliverables"]})]}),r.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[r.jsx(Nv,{className:"h-4 w-4"}),r.jsxs("span",{children:[D.submissionRate,"% graded"]})]})]}),r.jsxs("div",{className:"text-xs text-muted-foreground",children:[es(S.startDate)," - ",es(S.endDate)]})]})},S.id)})}),r.jsx(Pt,{isOpen:T,onClose:ze,title:de?`Instance: ${de.name}`:"Program Instance",children:te?r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"rounded-lg border border-border/50 bg-muted/20 p-4",children:[r.jsx("div",{className:"font-semibold text-foreground",children:"Student"}),r.jsx("div",{className:"text-sm text-muted-foreground",children:Ae?.name??te.studentId}),r.jsxs("div",{className:"mt-2 text-xs text-muted-foreground",children:["Current stage: ",te.currentStageId??""]}),r.jsxs("div",{className:"mt-3 flex flex-wrap gap-2",children:[r.jsx("button",{type:"button",className:"btn-ghost",onClick:he,children:"Advance Stage"}),r.jsx("button",{type:"button",className:"btn-ghost",onClick:we,children:"Inject Task"})]})]}),r.jsx("div",{className:"space-y-2",children:me.length===0?r.jsx("div",{className:"text-sm text-muted-foreground",children:"No tasks in this instance yet."}):me.map(S=>r.jsxs("div",{className:"rounded-lg border border-border/50 bg-muted/10 p-4",children:[r.jsxs("div",{className:"flex items-start justify-between gap-3",children:[r.jsxs("div",{className:"min-w-0",children:[r.jsx("div",{className:"font-medium text-foreground",children:S.title}),S.description?r.jsx("div",{className:"mt-1 text-sm text-muted-foreground",children:S.description}):null,r.jsxs("div",{className:"mt-2 text-xs text-muted-foreground",children:["Status: ",S.status,S.deadline?`  Due: ${es(S.deadline)}`:""]})]}),r.jsx(ts,{value:S.status})]}),r.jsxs("div",{className:"mt-3 flex flex-wrap gap-2",children:[r.jsx("button",{type:"button",className:"btn-ghost",onClick:()=>J(S.id,"up"),children:""}),r.jsx("button",{type:"button",className:"btn-ghost",onClick:()=>J(S.id,"down"),children:""}),r.jsx("button",{type:"button",className:"btn-ghost",onClick:()=>K(S.id),children:"Extend"}),r.jsx("button",{type:"button",className:"btn",onClick:()=>se(S.id,!0),children:"Approve"}),r.jsx("button",{type:"button",className:"btn-ghost",onClick:()=>se(S.id,!1),children:"Reject"})]})]},S.id))})]}):r.jsx("div",{className:"text-sm text-muted-foreground",children:"Loading instance"})})]})}function sT(){const{currentUser:s}=gt(),{data:e}=yt(),[a,i]=v.useState("all"),o=v.useMemo(()=>{if(!s?.id||!e)return[];const p=(e.coachingSessions??[]).filter(j=>j.coachId===s.id),x=new Date,b=new Date(x.getFullYear(),x.getMonth(),x.getDate()),y=new Date(b);return y.setDate(y.getDate()+1),p.filter(j=>{const N=new Date(j.startsAt);return a==="upcoming"?N>=x&&j.status==="scheduled":a==="past"?N<x||j.status==="completed":a==="today"?N>=b&&N<y:!0}).sort((j,N)=>new Date(N.startsAt)-new Date(j.startsAt))},[s,e,a]),u=v.useMemo(()=>{const p={};return o.forEach(x=>{const b=new Date(x.startsAt),y=`${b.getFullYear()}-${String(b.getMonth()+1).padStart(2,"0")}`;p[y]||(p[y]=[]),p[y].push(x)}),p},[o]),d=v.useMemo(()=>{const p=new Date,x=o.filter(k=>new Date(k.startsAt)>=p&&k.status==="scheduled").length,b=o.filter(k=>new Date(k.startsAt)<p||k.status==="completed").length,y=new Date(p.getFullYear(),p.getMonth(),p.getDate()),j=new Date(y);j.setDate(j.getDate()+1);const N=o.filter(k=>{const T=new Date(k.startsAt);return T>=y&&T<j}).length;return{total:o.length,upcoming:x,past:b,today:N}},[o]),f=p=>(e?.programs??[]).find(b=>b.id===p)?.name??"Unknown Program",m=p=>{const[x,b]=p.split("-");return new Date(parseInt(x),parseInt(b)-1).toLocaleDateString("en-US",{month:"long",year:"numeric"})};return o.length===0&&a==="all"?r.jsxs("div",{className:"flex flex-col items-center justify-center py-16",children:[r.jsx(gs,{className:"h-16 w-16 text-muted-foreground"}),r.jsx("h2",{className:"mt-4 text-xl font-semibold text-foreground",children:"No Sessions Yet"}),r.jsx("p",{className:"mt-2 text-muted-foreground",children:"You don't have any coaching sessions scheduled."})]}):r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-2xl font-bold text-foreground",children:"My Sessions"}),r.jsx("p",{className:"mt-1 text-muted-foreground",children:"Manage your coaching sessions and track attendance"})]}),r.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[r.jsx(Ye,{children:r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"grid h-10 w-10 place-items-center rounded-xl bg-primary/10 text-primary",children:r.jsx(gs,{className:"h-5 w-5"})}),r.jsxs("div",{children:[r.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Sessions"}),r.jsx("div",{className:"text-2xl font-bold text-foreground",children:d.total})]})]})}),r.jsx(Ye,{children:r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"grid h-10 w-10 place-items-center rounded-xl bg-secondary/10 text-secondary",children:r.jsx(Ca,{className:"h-5 w-5"})}),r.jsxs("div",{children:[r.jsx("div",{className:"text-sm text-muted-foreground",children:"Today"}),r.jsx("div",{className:"text-2xl font-bold text-foreground",children:d.today})]})]})}),r.jsx(Ye,{children:r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"grid h-10 w-10 place-items-center rounded-xl bg-success-500/10 text-success-700",children:r.jsx(gs,{className:"h-5 w-5"})}),r.jsxs("div",{children:[r.jsx("div",{className:"text-sm text-muted-foreground",children:"Upcoming"}),r.jsx("div",{className:"text-2xl font-bold text-foreground",children:d.upcoming})]})]})}),r.jsx(Ye,{children:r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"grid h-10 w-10 place-items-center rounded-xl bg-muted text-muted-foreground",children:r.jsx(gs,{className:"h-5 w-5"})}),r.jsxs("div",{children:[r.jsx("div",{className:"text-sm text-muted-foreground",children:"Completed"}),r.jsx("div",{className:"text-2xl font-bold text-foreground",children:d.past})]})]})})]}),r.jsxs(Ye,{children:[r.jsxs("div",{className:"flex items-center gap-2 border-b border-border pb-3",children:[r.jsx(S_,{className:"h-4 w-4 text-muted-foreground"}),r.jsx("span",{className:"text-sm font-medium text-foreground",children:"Filter:"}),r.jsx("div",{className:"flex gap-2",children:["all","today","upcoming","past"].map(p=>r.jsx("button",{type:"button",onClick:()=>i(p),className:`rounded-lg px-3 py-1 text-sm font-medium transition-colors ${a===p?"bg-primary text-white":"bg-muted text-muted-foreground hover:bg-muted/70"}`,children:p.charAt(0).toUpperCase()+p.slice(1)},p))})]}),o.length===0?r.jsx("div",{className:"py-8 text-center text-sm text-muted-foreground",children:"No sessions found for this filter"}):r.jsx("div",{className:"space-y-6",children:Object.entries(u).map(([p,x])=>r.jsxs("div",{children:[r.jsx("h3",{className:"mb-3 text-sm font-semibold text-muted-foreground",children:m(p)}),r.jsx("div",{className:"space-y-3",children:x.map(b=>{const y=new Date,j=new Date(b.startsAt)<y;return r.jsxs("div",{className:`flex items-start gap-4 rounded-lg border p-4 ${j?"border-border/30 bg-muted/20":"border-border/50 bg-muted/40"}`,children:[r.jsx("div",{className:"grid h-14 w-14 shrink-0 place-items-center rounded-lg bg-primary/10",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-xl font-bold text-primary",children:new Date(b.startsAt).getDate()}),r.jsx("div",{className:"text-[10px] uppercase text-primary",children:new Date(b.startsAt).toLocaleDateString("en-US",{month:"short"})})]})}),r.jsxs("div",{className:"min-w-0 flex-1",children:[r.jsxs("div",{className:"flex items-start justify-between gap-3",children:[r.jsxs("div",{children:[r.jsx("h4",{className:"font-semibold text-foreground",children:b.title}),r.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:f(b.programId)})]}),r.jsx(ts,{value:b.status})]}),b.description&&r.jsx("p",{className:"mt-2 text-sm text-muted-foreground",children:b.description}),r.jsxs("div",{className:"mt-3 flex flex-wrap gap-4 text-sm text-muted-foreground",children:[r.jsxs("div",{className:"flex items-center gap-1.5",children:[r.jsx(Ca,{className:"h-4 w-4"}),ms(b.startsAt)]}),b.location&&r.jsxs("div",{className:"flex items-center gap-1.5",children:[r.jsx(xv,{className:"h-4 w-4"}),b.location]}),r.jsxs("div",{className:"flex items-center gap-1.5",children:[r.jsx(dn,{className:"h-4 w-4"}),b.attendeeStudentIds.length," student",b.attendeeStudentIds.length===1?"":"s"]})]})]})]},b.id)})})]},p))})]})]})}function nT(){const{currentUser:s}=gt(),{data:e}=yt(),{showToast:a}=mn(),[i,o]=v.useState("pending"),[u,d]=v.useState(null),[f,m]=v.useState(!1),[p,x]=v.useState("approve"),[b,y]=v.useState(""),[j,N]=v.useState(""),k=v.useMemo(()=>{if(!s?.id||!e)return[];const V=(e.programs??[]).filter(O=>O.coachIds.includes(s.id)).map(O=>O.id);return(e.deliverables??[]).filter(O=>V.includes(O.programId)).sort((O,H)=>new Date(H.dueDate)-new Date(O.dueDate))},[s,e]),T=v.useMemo(()=>k.flatMap(O=>(O.submissions??[]).map(H=>({...H,id:`${O.id}-${H.studentId}`,deliverable:O}))).filter(O=>i==="pending"?O.status==="submitted":i==="graded"?O.status==="graded":!0).sort((O,H)=>new Date(H.submittedAt)-new Date(O.submittedAt)),[k,i]),R=v.useMemo(()=>{const V=k.flatMap(de=>de.submissions??[]),O=V.filter(de=>de.status==="submitted").length,H=V.filter(de=>de.status==="graded").length,te=V.filter(de=>de.grade!==null&&de.grade!==void 0).map(de=>de.grade),me=te.length>0?Math.round(te.reduce((de,ye)=>de+ye,0)/te.length):null;return{total:V.length,pending:O,graded:H,avgGrade:me,deliverableCount:k.length}},[k]),A=V=>(e?.users??[]).find(H=>H.id===V)?.name??"Unknown Student",C=(V,O)=>{d(V),x(O),y(V.grade?.toString()??(O==="approve"?"100":"")),N(V.feedback??(O==="revision"?"Please revise...":"")),m(!0)},B=()=>{if(p==="approve"){const V=parseInt(b,10);if(isNaN(V)||V<0||V>100){a("Please enter a valid grade between 0 and 100","error");return}}a(`${p==="approve"?"Approved":"Revision requested"} successfully!`,"success"),m(!1),d(null),y(""),N("")},F=[{key:"student",header:"Student",searchable:!0,accessor:V=>A(V.studentId),render:V=>{const O=A(V.studentId);return r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-full bg-primary/10 text-primary text-xs font-bold",children:O.charAt(0)}),r.jsx("span",{className:"font-medium",children:O})]})}},{key:"deliverable",header:"Deliverable Title",searchable:!0,accessor:V=>V.deliverable.title},{key:"submitted",header:"Submission Date",accessor:V=>V.submittedAt,render:V=>r.jsx("span",{className:"text-sm",children:ms(V.submittedAt)})},{key:"status",header:"Status",accessor:V=>V.status,render:V=>r.jsx(ts,{value:V.status})},{key:"actions",header:"Actions",accessor:()=>"",render:V=>V.status==="graded"?r.jsx("div",{className:"text-sm",children:r.jsxs("span",{className:"font-bold text-success-700",children:[V.grade,"%"]})}):r.jsxs("div",{className:"flex gap-2",children:[r.jsxs("button",{onClick:()=>C(V,"approve"),className:"flex items-center gap-1 rounded bg-success-600 px-2 py-1 text-xs font-medium text-white hover:bg-success-700",children:[r.jsx(bk,{className:"h-3 w-3"})," Approve"]}),r.jsxs("button",{onClick:()=>C(V,"revision"),className:"flex items-center gap-1 rounded bg-warning-500 px-2 py-1 text-xs font-medium text-white hover:bg-warning-600",children:[r.jsx(Sv,{className:"h-3 w-3"})," Request Revision"]})]})}];return k.length===0?r.jsxs("div",{className:"flex flex-col items-center justify-center py-16",children:[r.jsx(jn,{className:"h-16 w-16 text-muted-foreground"}),r.jsx("h2",{className:"mt-4 text-xl font-semibold text-foreground",children:"No Deliverables Yet"}),r.jsx("p",{className:"mt-2 text-muted-foreground",children:"You haven't created any deliverables for your programs yet."})]}):r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-2xl font-bold text-foreground",children:"Deliverables & Reviews"}),r.jsx("p",{className:"mt-1 text-muted-foreground",children:"Review and grade student submissions"})]}),r.jsxs("div",{className:"grid gap-4 md:grid-cols-5",children:[r.jsx(Ye,{children:r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"grid h-10 w-10 place-items-center rounded-xl bg-primary/10 text-primary",children:r.jsx(jn,{className:"h-5 w-5"})}),r.jsxs("div",{children:[r.jsx("div",{className:"text-sm text-muted-foreground",children:"Deliverables"}),r.jsx("div",{className:"text-2xl font-bold text-foreground",children:R.deliverableCount})]})]})}),r.jsx(Ye,{children:r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"grid h-10 w-10 place-items-center rounded-xl bg-secondary/10 text-secondary",children:r.jsx(Kl,{className:"h-5 w-5"})}),r.jsxs("div",{children:[r.jsx("div",{className:"text-sm text-muted-foreground",children:"Total"}),r.jsx("div",{className:"text-2xl font-bold text-foreground",children:R.total})]})]})}),r.jsx(Ye,{children:r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"grid h-10 w-10 place-items-center rounded-xl bg-warning-500/10 text-warning-700",children:r.jsx(Ca,{className:"h-5 w-5"})}),r.jsxs("div",{children:[r.jsx("div",{className:"text-sm text-muted-foreground",children:"Pending"}),r.jsx("div",{className:"text-2xl font-bold text-foreground",children:R.pending})]})]})}),r.jsx(Ye,{children:r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"grid h-10 w-10 place-items-center rounded-xl bg-success-500/10 text-success-700",children:r.jsx(Kn,{className:"h-5 w-5"})}),r.jsxs("div",{children:[r.jsx("div",{className:"text-sm text-muted-foreground",children:"Graded"}),r.jsx("div",{className:"text-2xl font-bold text-foreground",children:R.graded})]})]})}),r.jsx(Ye,{children:r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"grid h-10 w-10 place-items-center rounded-xl bg-accent/10 text-accent",children:r.jsx(pk,{className:"h-5 w-5"})}),r.jsxs("div",{children:[r.jsx("div",{className:"text-sm text-muted-foreground",children:"Avg Grade"}),r.jsx("div",{className:"text-2xl font-bold text-foreground",children:R.avgGrade!==null?`${R.avgGrade}%`:"N/A"})]})]})})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsx("div",{className:"flex gap-2",children:["all","pending","graded"].map(V=>r.jsx("button",{type:"button",onClick:()=>o(V),className:`rounded-lg px-3 py-1 text-sm font-medium transition-colors ${i===V?"bg-primary text-white":"bg-muted text-muted-foreground hover:bg-muted/70"}`,children:V.charAt(0).toUpperCase()+V.slice(1)},V))}),r.jsx(Wc,{columns:F,rows:T,getRowId:V=>V.id,initialSort:{key:"submitted",dir:"desc"},exportFilename:"deliverables-review.csv"})]}),f&&u&&r.jsx(Pt,{title:p==="approve"?"Approve Submission":"Request Revision",onClose:()=>m(!1),footer:r.jsxs(r.Fragment,{children:[r.jsx("button",{type:"button",className:"btn-ghost",onClick:()=>m(!1),children:"Cancel"}),r.jsx("button",{type:"button",className:`btn-${p==="approve"?"primary":"danger"}`,onClick:B,children:p==="approve"?"Approve & Grade":"Send Request"})]}),children:r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"font-semibold text-foreground",children:u.deliverable.title}),r.jsxs("div",{className:"mt-1 text-sm text-muted-foreground",children:["Student: ",A(u.studentId)]})]}),r.jsxs("div",{className:"rounded-lg bg-muted/50 p-3",children:[r.jsx("div",{className:"text-xs font-medium text-muted-foreground",children:"Submission:"}),r.jsx("p",{className:"mt-1 text-sm text-foreground",children:u.content})]}),p==="approve"&&r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-foreground",children:"Grade (0-100)"}),r.jsx("input",{type:"number",min:"0",max:"100",className:"mt-2 w-full rounded-lg border border-border bg-background px-3 py-2 text-sm text-foreground focus:border-primary focus:outline-none focus:ring-1 focus:ring-primary",placeholder:"Enter grade...",value:b,onChange:V=>y(V.target.value)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-foreground",children:p==="approve"?"Feedback (optional)":"Reason for Revision"}),r.jsx("textarea",{className:"mt-2 w-full rounded-lg border border-border bg-background px-3 py-2 text-sm text-foreground focus:border-primary focus:outline-none focus:ring-1 focus:ring-primary",rows:4,placeholder:p==="approve"?"Great job...":"Please clarify...",value:j,onChange:V=>N(V.target.value)})]})]})})]})}function aT(){const{currentUser:s}=gt(),{data:e}=yt(),a=v.useMemo(()=>{if(!s?.id||!e)return[];const o=(e.programs??[]).filter(f=>(f.coachIds??[]).includes(s.id)),u=new Set;return o.forEach(f=>{(f.participantStudentIds??[]).forEach(m=>u.add(m))}),(e.users??[]).filter(f=>u.has(f.id)).map(f=>{const m=o.find(R=>(R.participantStudentIds??[]).includes(f.id)),p=(e.coachingSessions??[]).filter(R=>(R.attendeeStudentIds??[]).includes(f.id)&&R.status==="completed").sort((R,A)=>new Date(A.startsAt)-new Date(R.startsAt)),x=p.length>0?p[0].startsAt:null,b=(e.deliverables??[]).filter(R=>(R.assignedStudentIds??[]).includes(f.id)),y=b.filter(R=>(R.submissions??[]).some(A=>String(A.studentId)===String(f.id))),j=b.length,N=y.length,k=j===0?0:Math.round(N/j*100),T=j>N?"Medium":"Low";return{id:f.id,name:f.name,email:f.email,avatar:f.avatar,programName:m?.name??"Unassigned",progress:k,lastSession:x,riskLevel:T}})},[s,e]),i=[{key:"name",header:"Student",searchable:!0,accessor:o=>o.name,render:o=>r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"flex h-9 w-9 items-center justify-center rounded-full bg-primary/10 text-primary font-medium text-sm",children:o.name.charAt(0)}),r.jsxs("div",{children:[r.jsx("div",{className:"font-medium text-foreground",children:o.name}),r.jsx("div",{className:"text-xs text-muted-foreground",children:o.email})]})]})},{key:"program",header:"Project / Program",accessor:o=>o.programName,render:o=>r.jsx("span",{className:"text-sm text-foreground/80",children:o.programName})},{key:"progress",header:"Progress",accessor:o=>o.progress.toString(),render:o=>r.jsx("div",{className:"w-[120px]",children:r.jsx(Ov,{value:o.progress})})},{key:"lastSession",header:"Last Session",accessor:o=>o.lastSession??"",render:o=>r.jsx("div",{className:"text-sm",children:o.lastSession?r.jsx("span",{className:"text-foreground",children:es(o.lastSession)}):r.jsx("span",{className:"text-muted-foreground italic",children:"No sessions yet"})})},{key:"risk",header:"Risk Level",accessor:o=>o.riskLevel,render:o=>{let u="bg-success-50 text-success-700 border-success-200";return o.riskLevel==="High"&&(u="bg-danger-50 text-danger-700 border-danger-200"),o.riskLevel==="Medium"&&(u="bg-warning-50 text-warning-700 border-warning-200"),r.jsx("span",{className:`inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 ${u}`,children:o.riskLevel})}},{key:"actions",header:"",accessor:()=>"",render:()=>r.jsx("button",{className:"text-sm font-medium text-primary hover:underline",children:"View Details"})}];return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex flex-col gap-1",children:[r.jsx("h1",{className:"text-2xl font-bold text-foreground",children:"My Students"}),r.jsx("p",{className:"text-muted-foreground",children:"Manage and track progress of your assigned students."})]}),r.jsx(Wc,{title:"Students List",rows:a,columns:i,getRowId:o=>o.id,initialSort:{key:"name",dir:"asc"}})]})}function eu(s,e){var a={};for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&e.indexOf(i)<0&&(a[i]=s[i]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,i=Object.getOwnPropertySymbols(s);o<i.length;o++)e.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(s,i[o])&&(a[i[o]]=s[i[o]]);return a}function rT(s,e,a,i){function o(u){return u instanceof a?u:new a(function(d){d(u)})}return new(a||(a=Promise))(function(u,d){function f(x){try{p(i.next(x))}catch(b){d(b)}}function m(x){try{p(i.throw(x))}catch(b){d(b)}}function p(x){x.done?u(x.value):o(x.value).then(f,m)}p((i=i.apply(s,e||[])).next())})}const iT=s=>s?(...e)=>s(...e):(...e)=>fetch(...e);class sm extends Error{constructor(e,a="FunctionsError",i){super(e),this.name=a,this.context=i}}class lT extends sm{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class eb extends sm{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class tb extends sm{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var of;(function(s){s.Any="any",s.ApNortheast1="ap-northeast-1",s.ApNortheast2="ap-northeast-2",s.ApSouth1="ap-south-1",s.ApSoutheast1="ap-southeast-1",s.ApSoutheast2="ap-southeast-2",s.CaCentral1="ca-central-1",s.EuCentral1="eu-central-1",s.EuWest1="eu-west-1",s.EuWest2="eu-west-2",s.EuWest3="eu-west-3",s.SaEast1="sa-east-1",s.UsEast1="us-east-1",s.UsWest1="us-west-1",s.UsWest2="us-west-2"})(of||(of={}));class oT{constructor(e,{headers:a={},customFetch:i,region:o=of.Any}={}){this.url=e,this.headers=a,this.region=o,this.fetch=iT(i)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return rT(this,arguments,void 0,function*(a,i={}){var o;let u,d;try{const{headers:f,method:m,body:p,signal:x,timeout:b}=i;let y={},{region:j}=i;j||(j=this.region);const N=new URL(`${this.url}/${a}`);j&&j!=="any"&&(y["x-region"]=j,N.searchParams.set("forceFunctionRegion",j));let k;p&&(f&&!Object.prototype.hasOwnProperty.call(f,"Content-Type")||!f)?typeof Blob<"u"&&p instanceof Blob||p instanceof ArrayBuffer?(y["Content-Type"]="application/octet-stream",k=p):typeof p=="string"?(y["Content-Type"]="text/plain",k=p):typeof FormData<"u"&&p instanceof FormData?k=p:(y["Content-Type"]="application/json",k=JSON.stringify(p)):p&&typeof p!="string"&&!(typeof Blob<"u"&&p instanceof Blob)&&!(p instanceof ArrayBuffer)&&!(typeof FormData<"u"&&p instanceof FormData)?k=JSON.stringify(p):k=p;let T=x;b&&(d=new AbortController,u=setTimeout(()=>d.abort(),b),x?(T=d.signal,x.addEventListener("abort",()=>d.abort())):T=d.signal);const R=yield this.fetch(N.toString(),{method:m||"POST",headers:Object.assign(Object.assign(Object.assign({},y),this.headers),f),body:k,signal:T}).catch(F=>{throw new lT(F)}),A=R.headers.get("x-relay-error");if(A&&A==="true")throw new eb(R);if(!R.ok)throw new tb(R);let C=((o=R.headers.get("Content-Type"))!==null&&o!==void 0?o:"text/plain").split(";")[0].trim(),B;return C==="application/json"?B=yield R.json():C==="application/octet-stream"||C==="application/pdf"?B=yield R.blob():C==="text/event-stream"?B=R:C==="multipart/form-data"?B=yield R.formData():B=yield R.text(),{data:B,error:null,response:R}}catch(f){return{data:null,error:f,response:f instanceof tb||f instanceof eb?f.context:void 0}}finally{u&&clearTimeout(u)}})}}var cT=class extends Error{constructor(s){super(s.message),this.name="PostgrestError",this.details=s.details,this.hint=s.hint,this.code=s.code}},uT=class{constructor(s){var e,a;this.shouldThrowOnError=!1,this.method=s.method,this.url=s.url,this.headers=new Headers(s.headers),this.schema=s.schema,this.body=s.body,this.shouldThrowOnError=(e=s.shouldThrowOnError)!==null&&e!==void 0?e:!1,this.signal=s.signal,this.isMaybeSingle=(a=s.isMaybeSingle)!==null&&a!==void 0?a:!1,s.fetch?this.fetch=s.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(s,e){return this.headers=new Headers(this.headers),this.headers.set(s,e),this}then(s,e){var a=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const i=this.fetch;let o=i(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async u=>{let d=null,f=null,m=null,p=u.status,x=u.statusText;if(u.ok){var b,y;if(a.method!=="HEAD"){var j;const R=await u.text();R===""||(a.headers.get("Accept")==="text/csv"||a.headers.get("Accept")&&(!((j=a.headers.get("Accept"))===null||j===void 0)&&j.includes("application/vnd.pgrst.plan+text"))?f=R:f=JSON.parse(R))}const k=(b=a.headers.get("Prefer"))===null||b===void 0?void 0:b.match(/count=(exact|planned|estimated)/),T=(y=u.headers.get("content-range"))===null||y===void 0?void 0:y.split("/");k&&T&&T.length>1&&(m=parseInt(T[1])),a.isMaybeSingle&&a.method==="GET"&&Array.isArray(f)&&(f.length>1?(d={code:"PGRST116",details:`Results contain ${f.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},f=null,m=null,p=406,x="Not Acceptable"):f.length===1?f=f[0]:f=null)}else{var N;const k=await u.text();try{d=JSON.parse(k),Array.isArray(d)&&u.status===404&&(f=[],d=null,p=200,x="OK")}catch{u.status===404&&k===""?(p=204,x="No Content"):d={message:k}}if(d&&a.isMaybeSingle&&(!(d==null||(N=d.details)===null||N===void 0)&&N.includes("0 rows"))&&(d=null,p=200,x="OK"),d&&a.shouldThrowOnError)throw new cT(d)}return{error:d,data:f,count:m,status:p,statusText:x}});return this.shouldThrowOnError||(o=o.catch(u=>{var d;let f="";const m=u?.cause;if(m){var p,x,b,y;const N=(p=m?.message)!==null&&p!==void 0?p:"",k=(x=m?.code)!==null&&x!==void 0?x:"";f=`${(b=u?.name)!==null&&b!==void 0?b:"FetchError"}: ${u?.message}`,f+=`

Caused by: ${(y=m?.name)!==null&&y!==void 0?y:"Error"}: ${N}`,k&&(f+=` (${k})`),m?.stack&&(f+=`
${m.stack}`)}else{var j;f=(j=u?.stack)!==null&&j!==void 0?j:""}return{error:{message:`${(d=u?.name)!==null&&d!==void 0?d:"FetchError"}: ${u?.message}`,details:f,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),o.then(s,e)}returns(){return this}overrideTypes(){return this}},dT=class extends uT{select(s){let e=!1;const a=(s??"*").split("").map(i=>/\s/.test(i)&&!e?"":(i==='"'&&(e=!e),i)).join("");return this.url.searchParams.set("select",a),this.headers.append("Prefer","return=representation"),this}order(s,{ascending:e=!0,nullsFirst:a,foreignTable:i,referencedTable:o=i}={}){const u=o?`${o}.order`:"order",d=this.url.searchParams.get(u);return this.url.searchParams.set(u,`${d?`${d},`:""}${s}.${e?"asc":"desc"}${a===void 0?"":a?".nullsfirst":".nullslast"}`),this}limit(s,{foreignTable:e,referencedTable:a=e}={}){const i=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(i,`${s}`),this}range(s,e,{foreignTable:a,referencedTable:i=a}={}){const o=typeof i>"u"?"offset":`${i}.offset`,u=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(o,`${s}`),this.url.searchParams.set(u,`${e-s+1}`),this}abortSignal(s){return this.signal=s,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:s=!1,verbose:e=!1,settings:a=!1,buffers:i=!1,wal:o=!1,format:u="text"}={}){var d;const f=[s?"analyze":null,e?"verbose":null,a?"settings":null,i?"buffers":null,o?"wal":null].filter(Boolean).join("|"),m=(d=this.headers.get("Accept"))!==null&&d!==void 0?d:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${u}; for="${m}"; options=${f};`),u==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(s){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${s}`),this}};const sb=new RegExp("[,()]");var oi=class extends dT{eq(s,e){return this.url.searchParams.append(s,`eq.${e}`),this}neq(s,e){return this.url.searchParams.append(s,`neq.${e}`),this}gt(s,e){return this.url.searchParams.append(s,`gt.${e}`),this}gte(s,e){return this.url.searchParams.append(s,`gte.${e}`),this}lt(s,e){return this.url.searchParams.append(s,`lt.${e}`),this}lte(s,e){return this.url.searchParams.append(s,`lte.${e}`),this}like(s,e){return this.url.searchParams.append(s,`like.${e}`),this}likeAllOf(s,e){return this.url.searchParams.append(s,`like(all).{${e.join(",")}}`),this}likeAnyOf(s,e){return this.url.searchParams.append(s,`like(any).{${e.join(",")}}`),this}ilike(s,e){return this.url.searchParams.append(s,`ilike.${e}`),this}ilikeAllOf(s,e){return this.url.searchParams.append(s,`ilike(all).{${e.join(",")}}`),this}ilikeAnyOf(s,e){return this.url.searchParams.append(s,`ilike(any).{${e.join(",")}}`),this}regexMatch(s,e){return this.url.searchParams.append(s,`match.${e}`),this}regexIMatch(s,e){return this.url.searchParams.append(s,`imatch.${e}`),this}is(s,e){return this.url.searchParams.append(s,`is.${e}`),this}isDistinct(s,e){return this.url.searchParams.append(s,`isdistinct.${e}`),this}in(s,e){const a=Array.from(new Set(e)).map(i=>typeof i=="string"&&sb.test(i)?`"${i}"`:`${i}`).join(",");return this.url.searchParams.append(s,`in.(${a})`),this}notIn(s,e){const a=Array.from(new Set(e)).map(i=>typeof i=="string"&&sb.test(i)?`"${i}"`:`${i}`).join(",");return this.url.searchParams.append(s,`not.in.(${a})`),this}contains(s,e){return typeof e=="string"?this.url.searchParams.append(s,`cs.${e}`):Array.isArray(e)?this.url.searchParams.append(s,`cs.{${e.join(",")}}`):this.url.searchParams.append(s,`cs.${JSON.stringify(e)}`),this}containedBy(s,e){return typeof e=="string"?this.url.searchParams.append(s,`cd.${e}`):Array.isArray(e)?this.url.searchParams.append(s,`cd.{${e.join(",")}}`):this.url.searchParams.append(s,`cd.${JSON.stringify(e)}`),this}rangeGt(s,e){return this.url.searchParams.append(s,`sr.${e}`),this}rangeGte(s,e){return this.url.searchParams.append(s,`nxl.${e}`),this}rangeLt(s,e){return this.url.searchParams.append(s,`sl.${e}`),this}rangeLte(s,e){return this.url.searchParams.append(s,`nxr.${e}`),this}rangeAdjacent(s,e){return this.url.searchParams.append(s,`adj.${e}`),this}overlaps(s,e){return typeof e=="string"?this.url.searchParams.append(s,`ov.${e}`):this.url.searchParams.append(s,`ov.{${e.join(",")}}`),this}textSearch(s,e,{config:a,type:i}={}){let o="";i==="plain"?o="pl":i==="phrase"?o="ph":i==="websearch"&&(o="w");const u=a===void 0?"":`(${a})`;return this.url.searchParams.append(s,`${o}fts${u}.${e}`),this}match(s){return Object.entries(s).forEach(([e,a])=>{this.url.searchParams.append(e,`eq.${a}`)}),this}not(s,e,a){return this.url.searchParams.append(s,`not.${e}.${a}`),this}or(s,{foreignTable:e,referencedTable:a=e}={}){const i=a?`${a}.or`:"or";return this.url.searchParams.append(i,`(${s})`),this}filter(s,e,a){return this.url.searchParams.append(s,`${e}.${a}`),this}},hT=class{constructor(s,{headers:e={},schema:a,fetch:i}){this.url=s,this.headers=new Headers(e),this.schema=a,this.fetch=i}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(s,e){const{head:a=!1,count:i}=e??{},o=a?"HEAD":"GET";let u=!1;const d=(s??"*").split("").map(p=>/\s/.test(p)&&!u?"":(p==='"'&&(u=!u),p)).join(""),{url:f,headers:m}=this.cloneRequestState();return f.searchParams.set("select",d),i&&m.append("Prefer",`count=${i}`),new oi({method:o,url:f,headers:m,schema:this.schema,fetch:this.fetch})}insert(s,{count:e,defaultToNull:a=!0}={}){var i;const o="POST",{url:u,headers:d}=this.cloneRequestState();if(e&&d.append("Prefer",`count=${e}`),a||d.append("Prefer","missing=default"),Array.isArray(s)){const f=s.reduce((m,p)=>m.concat(Object.keys(p)),[]);if(f.length>0){const m=[...new Set(f)].map(p=>`"${p}"`);u.searchParams.set("columns",m.join(","))}}return new oi({method:o,url:u,headers:d,schema:this.schema,body:s,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}upsert(s,{onConflict:e,ignoreDuplicates:a=!1,count:i,defaultToNull:o=!0}={}){var u;const d="POST",{url:f,headers:m}=this.cloneRequestState();if(m.append("Prefer",`resolution=${a?"ignore":"merge"}-duplicates`),e!==void 0&&f.searchParams.set("on_conflict",e),i&&m.append("Prefer",`count=${i}`),o||m.append("Prefer","missing=default"),Array.isArray(s)){const p=s.reduce((x,b)=>x.concat(Object.keys(b)),[]);if(p.length>0){const x=[...new Set(p)].map(b=>`"${b}"`);f.searchParams.set("columns",x.join(","))}}return new oi({method:d,url:f,headers:m,schema:this.schema,body:s,fetch:(u=this.fetch)!==null&&u!==void 0?u:fetch})}update(s,{count:e}={}){var a;const i="PATCH",{url:o,headers:u}=this.cloneRequestState();return e&&u.append("Prefer",`count=${e}`),new oi({method:i,url:o,headers:u,schema:this.schema,body:s,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}delete({count:s}={}){var e;const a="DELETE",{url:i,headers:o}=this.cloneRequestState();return s&&o.append("Prefer",`count=${s}`),new oi({method:a,url:i,headers:o,schema:this.schema,fetch:(e=this.fetch)!==null&&e!==void 0?e:fetch})}},fT=class Mv{constructor(e,{headers:a={},schema:i,fetch:o}={}){this.url=e,this.headers=new Headers(a),this.schemaName=i,this.fetch=o}from(e){if(!e||typeof e!="string"||e.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new hT(new URL(`${this.url}/${e}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new Mv(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,a={},{head:i=!1,get:o=!1,count:u}={}){var d;let f;const m=new URL(`${this.url}/rpc/${e}`);let p;const x=j=>j!==null&&typeof j=="object"&&(!Array.isArray(j)||j.some(x)),b=i&&Object.values(a).some(x);b?(f="POST",p=a):i||o?(f=i?"HEAD":"GET",Object.entries(a).filter(([j,N])=>N!==void 0).map(([j,N])=>[j,Array.isArray(N)?`{${N.join(",")}}`:`${N}`]).forEach(([j,N])=>{m.searchParams.append(j,N)})):(f="POST",p=a);const y=new Headers(this.headers);return b?y.set("Prefer",u?`count=${u},return=minimal`:"return=minimal"):u&&y.set("Prefer",`count=${u}`),new oi({method:f,url:m,headers:y,schema:this.schemaName,body:p,fetch:(d=this.fetch)!==null&&d!==void 0?d:fetch})}};class mT{constructor(){}static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const a=globalThis.process;if(a){const i=a.versions;if(i&&i.node){const o=i.node,u=parseInt(o.replace(/^v/,"").split(".")[0]);return u>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${u} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${u} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let a=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(a+=`

Suggested solution: ${e.workaround}`),new Error(a)}static createWebSocket(e,a){const i=this.getWebSocketConstructor();return new i(e,a)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const pT="2.91.1",gT=`realtime-js/${pT}`,xT="1.0.0",Uv="2.0.0",nb=Uv,cf=1e4,bT=1e3,yT=100;var ka;(function(s){s[s.connecting=0]="connecting",s[s.open=1]="open",s[s.closing=2]="closing",s[s.closed=3]="closed"})(ka||(ka={}));var Kt;(function(s){s.closed="closed",s.errored="errored",s.joined="joined",s.joining="joining",s.leaving="leaving"})(Kt||(Kt={}));var ln;(function(s){s.close="phx_close",s.error="phx_error",s.join="phx_join",s.reply="phx_reply",s.leave="phx_leave",s.access_token="access_token"})(ln||(ln={}));var uf;(function(s){s.websocket="websocket"})(uf||(uf={}));var ir;(function(s){s.Connecting="connecting",s.Open="open",s.Closing="closing",s.Closed="closed"})(ir||(ir={}));class vT{constructor(e){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=e??[]}encode(e,a){if(e.event===this.BROADCAST_EVENT&&!(e.payload instanceof ArrayBuffer)&&typeof e.payload.event=="string")return a(this._binaryEncodeUserBroadcastPush(e));let i=[e.join_ref,e.ref,e.topic,e.event,e.payload];return a(JSON.stringify(i))}_binaryEncodeUserBroadcastPush(e){var a;return this._isArrayBuffer((a=e.payload)===null||a===void 0?void 0:a.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var a,i;const o=(i=(a=e.payload)===null||a===void 0?void 0:a.payload)!==null&&i!==void 0?i:new ArrayBuffer(0);return this._encodeUserBroadcastPush(e,this.BINARY_ENCODING,o)}_encodeJsonUserBroadcastPush(e){var a,i;const o=(i=(a=e.payload)===null||a===void 0?void 0:a.payload)!==null&&i!==void 0?i:{},d=new TextEncoder().encode(JSON.stringify(o)).buffer;return this._encodeUserBroadcastPush(e,this.JSON_ENCODING,d)}_encodeUserBroadcastPush(e,a,i){var o,u;const d=e.topic,f=(o=e.ref)!==null&&o!==void 0?o:"",m=(u=e.join_ref)!==null&&u!==void 0?u:"",p=e.payload.event,x=this.allowedMetadataKeys?this._pick(e.payload,this.allowedMetadataKeys):{},b=Object.keys(x).length===0?"":JSON.stringify(x);if(m.length>255)throw new Error(`joinRef length ${m.length} exceeds maximum of 255`);if(f.length>255)throw new Error(`ref length ${f.length} exceeds maximum of 255`);if(d.length>255)throw new Error(`topic length ${d.length} exceeds maximum of 255`);if(p.length>255)throw new Error(`userEvent length ${p.length} exceeds maximum of 255`);if(b.length>255)throw new Error(`metadata length ${b.length} exceeds maximum of 255`);const y=this.USER_BROADCAST_PUSH_META_LENGTH+m.length+f.length+d.length+p.length+b.length,j=new ArrayBuffer(this.HEADER_LENGTH+y);let N=new DataView(j),k=0;N.setUint8(k++,this.KINDS.userBroadcastPush),N.setUint8(k++,m.length),N.setUint8(k++,f.length),N.setUint8(k++,d.length),N.setUint8(k++,p.length),N.setUint8(k++,b.length),N.setUint8(k++,a),Array.from(m,R=>N.setUint8(k++,R.charCodeAt(0))),Array.from(f,R=>N.setUint8(k++,R.charCodeAt(0))),Array.from(d,R=>N.setUint8(k++,R.charCodeAt(0))),Array.from(p,R=>N.setUint8(k++,R.charCodeAt(0))),Array.from(b,R=>N.setUint8(k++,R.charCodeAt(0)));var T=new Uint8Array(j.byteLength+i.byteLength);return T.set(new Uint8Array(j),0),T.set(new Uint8Array(i),j.byteLength),T.buffer}decode(e,a){if(this._isArrayBuffer(e)){let i=this._binaryDecode(e);return a(i)}if(typeof e=="string"){const i=JSON.parse(e),[o,u,d,f,m]=i;return a({join_ref:o,ref:u,topic:d,event:f,payload:m})}return a({})}_binaryDecode(e){const a=new DataView(e),i=a.getUint8(0),o=new TextDecoder;if(i===this.KINDS.userBroadcast)return this._decodeUserBroadcast(e,a,o)}_decodeUserBroadcast(e,a,i){const o=a.getUint8(1),u=a.getUint8(2),d=a.getUint8(3),f=a.getUint8(4);let m=this.HEADER_LENGTH+4;const p=i.decode(e.slice(m,m+o));m=m+o;const x=i.decode(e.slice(m,m+u));m=m+u;const b=i.decode(e.slice(m,m+d));m=m+d;const y=e.slice(m,e.byteLength),j=f===this.JSON_ENCODING?JSON.parse(i.decode(y)):y,N={type:this.BROADCAST_EVENT,event:x,payload:j};return d>0&&(N.meta=JSON.parse(b)),{join_ref:null,ref:null,topic:p,event:this.BROADCAST_EVENT,payload:N}}_isArrayBuffer(e){var a;return e instanceof ArrayBuffer||((a=e?.constructor)===null||a===void 0?void 0:a.name)==="ArrayBuffer"}_pick(e,a){return!e||typeof e!="object"?{}:Object.fromEntries(Object.entries(e).filter(([i])=>a.includes(i)))}}class Lv{constructor(e,a){this.callback=e,this.timerCalc=a,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=a}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var bt;(function(s){s.abstime="abstime",s.bool="bool",s.date="date",s.daterange="daterange",s.float4="float4",s.float8="float8",s.int2="int2",s.int4="int4",s.int4range="int4range",s.int8="int8",s.int8range="int8range",s.json="json",s.jsonb="jsonb",s.money="money",s.numeric="numeric",s.oid="oid",s.reltime="reltime",s.text="text",s.time="time",s.timestamp="timestamp",s.timestamptz="timestamptz",s.timetz="timetz",s.tsrange="tsrange",s.tstzrange="tstzrange"})(bt||(bt={}));const ab=(s,e,a={})=>{var i;const o=(i=a.skipTypes)!==null&&i!==void 0?i:[];return e?Object.keys(e).reduce((u,d)=>(u[d]=wT(d,s,e,o),u),{}):{}},wT=(s,e,a,i)=>{const o=e.find(f=>f.name===s),u=o?.type,d=a[s];return u&&!i.includes(u)?Pv(u,d):df(d)},Pv=(s,e)=>{if(s.charAt(0)==="_"){const a=s.slice(1,s.length);return _T(e,a)}switch(s){case bt.bool:return jT(e);case bt.float4:case bt.float8:case bt.int2:case bt.int4:case bt.int8:case bt.numeric:case bt.oid:return NT(e);case bt.json:case bt.jsonb:return ST(e);case bt.timestamp:return kT(e);case bt.abstime:case bt.date:case bt.daterange:case bt.int4range:case bt.int8range:case bt.money:case bt.reltime:case bt.text:case bt.time:case bt.timestamptz:case bt.timetz:case bt.tsrange:case bt.tstzrange:return df(e);default:return df(e)}},df=s=>s,jT=s=>{switch(s){case"t":return!0;case"f":return!1;default:return s}},NT=s=>{if(typeof s=="string"){const e=parseFloat(s);if(!Number.isNaN(e))return e}return s},ST=s=>{if(typeof s=="string")try{return JSON.parse(s)}catch{return s}return s},_T=(s,e)=>{if(typeof s!="string")return s;const a=s.length-1,i=s[a];if(s[0]==="{"&&i==="}"){let u;const d=s.slice(1,a);try{u=JSON.parse("["+d+"]")}catch{u=d?d.split(","):[]}return u.map(f=>Pv(e,f))}return s},kT=s=>typeof s=="string"?s.replace(" ","T"):s,Iv=s=>{const e=new URL(s);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class kh{constructor(e,a,i={},o=cf){this.channel=e,this.event=a,this.payload=i,this.timeout=o,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,a){var i;return this._hasReceived(e)&&a((i=this.receivedResp)===null||i===void 0?void 0:i.response),this.recHooks.push({status:e,callback:a}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=a=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=a,this._matchReceive(a)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,a){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:a})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:a}){this.recHooks.filter(i=>i.status===e).forEach(i=>i.callback(a))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var rb;(function(s){s.SYNC="sync",s.JOIN="join",s.LEAVE="leave"})(rb||(rb={}));class Nl{constructor(e,a){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const i=a?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(i.state,{},o=>{const{onJoin:u,onLeave:d,onSync:f}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Nl.syncState(this.state,o,u,d),this.pendingDiffs.forEach(m=>{this.state=Nl.syncDiff(this.state,m,u,d)}),this.pendingDiffs=[],f()}),this.channel._on(i.diff,{},o=>{const{onJoin:u,onLeave:d,onSync:f}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(o):(this.state=Nl.syncDiff(this.state,o,u,d),f())}),this.onJoin((o,u,d)=>{this.channel._trigger("presence",{event:"join",key:o,currentPresences:u,newPresences:d})}),this.onLeave((o,u,d)=>{this.channel._trigger("presence",{event:"leave",key:o,currentPresences:u,leftPresences:d})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,a,i,o){const u=this.cloneDeep(e),d=this.transformState(a),f={},m={};return this.map(u,(p,x)=>{d[p]||(m[p]=x)}),this.map(d,(p,x)=>{const b=u[p];if(b){const y=x.map(T=>T.presence_ref),j=b.map(T=>T.presence_ref),N=x.filter(T=>j.indexOf(T.presence_ref)<0),k=b.filter(T=>y.indexOf(T.presence_ref)<0);N.length>0&&(f[p]=N),k.length>0&&(m[p]=k)}else f[p]=x}),this.syncDiff(u,{joins:f,leaves:m},i,o)}static syncDiff(e,a,i,o){const{joins:u,leaves:d}={joins:this.transformState(a.joins),leaves:this.transformState(a.leaves)};return i||(i=()=>{}),o||(o=()=>{}),this.map(u,(f,m)=>{var p;const x=(p=e[f])!==null&&p!==void 0?p:[];if(e[f]=this.cloneDeep(m),x.length>0){const b=e[f].map(j=>j.presence_ref),y=x.filter(j=>b.indexOf(j.presence_ref)<0);e[f].unshift(...y)}i(f,x,m)}),this.map(d,(f,m)=>{let p=e[f];if(!p)return;const x=m.map(b=>b.presence_ref);p=p.filter(b=>x.indexOf(b.presence_ref)<0),e[f]=p,o(f,p,m),p.length===0&&delete e[f]}),e}static map(e,a){return Object.getOwnPropertyNames(e).map(i=>a(i,e[i]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((a,i)=>{const o=e[i];return"metas"in o?a[i]=o.metas.map(u=>(u.presence_ref=u.phx_ref,delete u.phx_ref,delete u.phx_ref_prev,u)):a[i]=o,a},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var ib;(function(s){s.ALL="*",s.INSERT="INSERT",s.UPDATE="UPDATE",s.DELETE="DELETE"})(ib||(ib={}));var Sl;(function(s){s.BROADCAST="broadcast",s.PRESENCE="presence",s.POSTGRES_CHANGES="postgres_changes",s.SYSTEM="system"})(Sl||(Sl={}));var Gn;(function(s){s.SUBSCRIBED="SUBSCRIBED",s.TIMED_OUT="TIMED_OUT",s.CLOSED="CLOSED",s.CHANNEL_ERROR="CHANNEL_ERROR"})(Gn||(Gn={}));class hi{constructor(e,a={config:{}},i){var o,u;if(this.topic=e,this.params=a,this.socket=i,this.bindings={},this.state=Kt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},a.config),this.timeout=this.socket.timeout,this.joinPush=new kh(this,ln.join,this.params,this.timeout),this.rejoinTimer=new Lv(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Kt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(d=>d.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Kt.closed,this.socket._remove(this)}),this._onError(d=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,d),this.state=Kt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Kt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",d=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,d),this.state=Kt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(ln.reply,{},(d,f)=>{this._trigger(this._replyEventName(f),d)}),this.presence=new Nl(this),this.broadcastEndpointURL=Iv(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((u=(o=this.params.config)===null||o===void 0?void 0:o.broadcast)===null||u===void 0)&&u.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,a=this.timeout){var i,o,u;if(this.socket.isConnected()||this.socket.connect(),this.state==Kt.closed){const{config:{broadcast:d,presence:f,private:m}}=this.params,p=(o=(i=this.bindings.postgres_changes)===null||i===void 0?void 0:i.map(j=>j.filter))!==null&&o!==void 0?o:[],x=!!this.bindings[Sl.PRESENCE]&&this.bindings[Sl.PRESENCE].length>0||((u=this.params.config.presence)===null||u===void 0?void 0:u.enabled)===!0,b={},y={broadcast:d,presence:Object.assign(Object.assign({},f),{enabled:x}),postgres_changes:p,private:m};this.socket.accessTokenValue&&(b.access_token=this.socket.accessTokenValue),this._onError(j=>e?.(Gn.CHANNEL_ERROR,j)),this._onClose(()=>e?.(Gn.CLOSED)),this.updateJoinPayload(Object.assign({config:y},b)),this.joinedOnce=!0,this._rejoin(a),this.joinPush.receive("ok",async({postgres_changes:j})=>{var N;if(this.socket._isManualToken()||this.socket.setAuth(),j===void 0){e?.(Gn.SUBSCRIBED);return}else{const k=this.bindings.postgres_changes,T=(N=k?.length)!==null&&N!==void 0?N:0,R=[];for(let A=0;A<T;A++){const C=k[A],{filter:{event:B,schema:F,table:V,filter:O}}=C,H=j&&j[A];if(H&&H.event===B&&hi.isFilterValueEqual(H.schema,F)&&hi.isFilterValueEqual(H.table,V)&&hi.isFilterValueEqual(H.filter,O))R.push(Object.assign(Object.assign({},C),{id:H.id}));else{this.unsubscribe(),this.state=Kt.errored,e?.(Gn.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=R,e&&e(Gn.SUBSCRIBED);return}}).receive("error",j=>{this.state=Kt.errored,e?.(Gn.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(j).join(", ")||"error")))}).receive("timeout",()=>{e?.(Gn.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,a={}){return await this.send({type:"presence",event:"track",payload:e},a.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,a,i){return this.state===Kt.joined&&e===Sl.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(e,a,i)}async httpSend(e,a,i={}){var o;if(a==null)return Promise.reject("Payload is required for httpSend()");const u={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(u.Authorization=`Bearer ${this.socket.accessTokenValue}`);const d={method:"POST",headers:u,body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:a,private:this.private}]})},f=await this._fetchWithTimeout(this.broadcastEndpointURL,d,(o=i.timeout)!==null&&o!==void 0?o:this.timeout);if(f.status===202)return{success:!0};let m=f.statusText;try{const p=await f.json();m=p.error||p.message||m}catch{}return Promise.reject(new Error(m))}async send(e,a={}){var i,o;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:u,payload:d}=e,f={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(f.Authorization=`Bearer ${this.socket.accessTokenValue}`);const m={method:"POST",headers:f,body:JSON.stringify({messages:[{topic:this.subTopic,event:u,payload:d,private:this.private}]})};try{const p=await this._fetchWithTimeout(this.broadcastEndpointURL,m,(i=a.timeout)!==null&&i!==void 0?i:this.timeout);return await((o=p.body)===null||o===void 0?void 0:o.cancel()),p.ok?"ok":"error"}catch(p){return p.name==="AbortError"?"timed out":"error"}}else return new Promise(u=>{var d,f,m;const p=this._push(e.type,e,a.timeout||this.timeout);e.type==="broadcast"&&!(!((m=(f=(d=this.params)===null||d===void 0?void 0:d.config)===null||f===void 0?void 0:f.broadcast)===null||m===void 0)&&m.ack)&&u("ok"),p.receive("ok",()=>u("ok")),p.receive("error",()=>u("error")),p.receive("timeout",()=>u("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Kt.leaving;const a=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(ln.close,"leave",this._joinRef())};this.joinPush.destroy();let i=null;return new Promise(o=>{i=new kh(this,ln.leave,{},e),i.receive("ok",()=>{a(),o("ok")}).receive("timeout",()=>{a(),o("timed out")}).receive("error",()=>{o("error")}),i.send(),this._canPush()||i.trigger("ok",{})}).finally(()=>{i?.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Kt.closed,this.bindings={}}async _fetchWithTimeout(e,a,i){const o=new AbortController,u=setTimeout(()=>o.abort(),i),d=await this.socket.fetch(e,Object.assign(Object.assign({},a),{signal:o.signal}));return clearTimeout(u),d}_push(e,a,i=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let o=new kh(this,e,a,i);return this._canPush()?o.send():this._addToPushBuffer(o),o}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>yT){const a=this.pushBuffer.shift();a&&(a.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${a.event}`,a.payload))}}_onMessage(e,a,i){return a}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,a,i){var o,u;const d=e.toLocaleLowerCase(),{close:f,error:m,leave:p,join:x}=ln;if(i&&[f,m,p,x].indexOf(d)>=0&&i!==this._joinRef())return;let y=this._onMessage(d,a,i);if(a&&!y)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(d)?(o=this.bindings.postgres_changes)===null||o===void 0||o.filter(j=>{var N,k,T;return((N=j.filter)===null||N===void 0?void 0:N.event)==="*"||((T=(k=j.filter)===null||k===void 0?void 0:k.event)===null||T===void 0?void 0:T.toLocaleLowerCase())===d}).map(j=>j.callback(y,i)):(u=this.bindings[d])===null||u===void 0||u.filter(j=>{var N,k,T,R,A,C,B,F;if(["broadcast","presence","postgres_changes"].includes(d))if("id"in j){const V=j.id,O=(N=j.filter)===null||N===void 0?void 0:N.event;return V&&((k=a.ids)===null||k===void 0?void 0:k.includes(V))&&(O==="*"||O?.toLocaleLowerCase()===((T=a.data)===null||T===void 0?void 0:T.type.toLocaleLowerCase()))&&(!(!((R=j.filter)===null||R===void 0)&&R.table)||j.filter.table===((A=a.data)===null||A===void 0?void 0:A.table))}else{const V=(B=(C=j?.filter)===null||C===void 0?void 0:C.event)===null||B===void 0?void 0:B.toLocaleLowerCase();return V==="*"||V===((F=a?.event)===null||F===void 0?void 0:F.toLocaleLowerCase())}else return j.type.toLocaleLowerCase()===d}).map(j=>{if(typeof y=="object"&&"ids"in y){const N=y.data,{schema:k,table:T,commit_timestamp:R,type:A,errors:C}=N;y=Object.assign(Object.assign({},{schema:k,table:T,commit_timestamp:R,eventType:A,new:{},old:{},errors:C}),this._getPayloadRecords(N))}j.callback(y,i)})}_isClosed(){return this.state===Kt.closed}_isJoined(){return this.state===Kt.joined}_isJoining(){return this.state===Kt.joining}_isLeaving(){return this.state===Kt.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,a,i){const o=e.toLocaleLowerCase(),u={type:o,filter:a,callback:i};return this.bindings[o]?this.bindings[o].push(u):this.bindings[o]=[u],this}_off(e,a){const i=e.toLocaleLowerCase();return this.bindings[i]&&(this.bindings[i]=this.bindings[i].filter(o=>{var u;return!(((u=o.type)===null||u===void 0?void 0:u.toLocaleLowerCase())===i&&hi.isEqual(o.filter,a))})),this}static isEqual(e,a){if(Object.keys(e).length!==Object.keys(a).length)return!1;for(const i in e)if(e[i]!==a[i])return!1;return!0}static isFilterValueEqual(e,a){return(e??void 0)===(a??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(ln.close,{},e)}_onError(e){this._on(ln.error,{},a=>e(a))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Kt.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const a={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(a.new=ab(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(a.old=ab(e.columns,e.old_record)),a}}const Th=()=>{},yc={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},TT=[1e3,2e3,5e3,1e4],ET=1e4,CT=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class AT{constructor(e,a){var i;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=cf,this.transport=null,this.heartbeatIntervalMs=yc.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Th,this.ref=0,this.reconnectTimer=null,this.vsn=nb,this.logger=Th,this.conn=null,this.sendBuffer=[],this.serializer=new vT,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=o=>o?(...u)=>o(...u):(...u)=>fetch(...u),!(!((i=a?.params)===null||i===void 0)&&i.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=a.params.apikey,this.endPoint=`${e}/${uf.websocket}`,this.httpEndpoint=Iv(e),this._initializeOptions(a),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(a?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=mT.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const a=e.message;throw a.includes("Node.js")?new Error(`${a}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${a}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,a){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const i=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(i),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(e?this.conn.close(e,a??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const a=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),a}async removeAllChannels(){const e=await Promise.all(this.channels.map(a=>a.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,a,i){this.logger(e,a,i)}connectionState(){switch(this.conn&&this.conn.readyState){case ka.connecting:return ir.Connecting;case ka.open:return ir.Open;case ka.closing:return ir.Closing;default:return ir.Closed}}isConnected(){return this.connectionState()===ir.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,a={config:{}}){const i=`realtime:${e}`,o=this.getChannels().find(u=>u.topic===i);if(o)return o;{const u=new hi(`realtime:${e}`,a,this);return this.channels.push(u),u}}push(e){const{topic:a,event:i,payload:o,ref:u}=e,d=()=>{this.encode(e,f=>{var m;(m=this.conn)===null||m===void 0||m.send(f)})};this.log("push",`${a} ${i} (${u})`,o),this.isConnected()?d():this.sendBuffer.push(d)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(a){this.log("error","error in heartbeat callback",a)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(a){this.log("error","error in heartbeat callback",a)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(bT,"heartbeat timeout"),setTimeout(()=>{var a;this.isConnected()||(a=this.reconnectTimer)===null||a===void 0||a.scheduleTimeout()},yc.HEARTBEAT_TIMEOUT_FALLBACK);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(a){this.log("error","error in heartbeat callback",a)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let a=this.channels.find(i=>i.topic===e&&(i._isJoined()||i._isJoining()));a&&(this.log("transport",`leaving duplicate topic "${e}"`),a.unsubscribe())}_remove(e){this.channels=this.channels.filter(a=>a.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,a=>{if(a.topic==="phoenix"&&a.event==="phx_reply"&&a.ref&&a.ref===this.pendingHeartbeatRef){const p=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback(a.payload.status==="ok"?"ok":"error",p)}catch(x){this.log("error","error in heartbeat callback",x)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:i,event:o,payload:u,ref:d}=a,f=d?`(${d})`:"",m=u.status||"";this.log("receive",`${m} ${i} ${o} ${f}`.trim(),u),this.channels.filter(p=>p._isMember(i)).forEach(p=>p._trigger(o,u,d)),this._triggerStateCallbacks("message",a)})}_clearTimer(e){var a;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((a=this.reconnectTimer)===null||a===void 0||a.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e),this.conn.readyState===ka.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===ka.open||this.conn.readyState===ka.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(a=>{this.log("error","error waiting for auth on connect",a),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=a=>{this.log("worker","worker error",a.message),this._terminateWorker()},this.workerRef.onmessage=a=>{a.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(e){var a;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(a=this.reconnectTimer)===null||a===void 0||a.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(ln.error))}_appendParams(e,a){if(Object.keys(a).length===0)return e;const i=e.match(/\?/)?"&":"?",o=new URLSearchParams(a);return`${e}${i}${o}`}_workerObjectUrl(e){let a;if(e)a=e;else{const i=new Blob([CT],{type:"application/javascript"});a=URL.createObjectURL(i)}return a}_setConnectionState(e,a=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=a)}async _performAuth(e=null){let a,i=!1;if(e)a=e,i=!0;else if(this.accessToken)try{a=await this.accessToken()}catch(o){this.log("error","Error fetching access token from callback",o),a=this.accessTokenValue}else a=this.accessTokenValue;i?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=a&&(this.accessTokenValue=a,this.channels.forEach(o=>{const u={access_token:a,version:gT};a&&o.updateJoinPayload(u),o.joinedOnce&&o._isJoined()&&o._push(ln.access_token,{access_token:a})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this._isManualToken()||this.setAuth().catch(a=>{this.log("error",`Error setting auth in ${e}`,a)})}_triggerStateCallbacks(e,a){try{this.stateChangeCallbacks[e].forEach(i=>{try{i(a)}catch(o){this.log("error",`error in ${e} callback`,o)}})}catch(i){this.log("error",`error triggering ${e} callbacks`,i)}}_setupReconnectionTimer(){this.reconnectTimer=new Lv(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},yc.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var a,i,o,u,d,f,m,p,x,b,y,j;switch(this.transport=(a=e?.transport)!==null&&a!==void 0?a:null,this.timeout=(i=e?.timeout)!==null&&i!==void 0?i:cf,this.heartbeatIntervalMs=(o=e?.heartbeatIntervalMs)!==null&&o!==void 0?o:yc.HEARTBEAT_INTERVAL,this.worker=(u=e?.worker)!==null&&u!==void 0?u:!1,this.accessToken=(d=e?.accessToken)!==null&&d!==void 0?d:null,this.heartbeatCallback=(f=e?.heartbeatCallback)!==null&&f!==void 0?f:Th,this.vsn=(m=e?.vsn)!==null&&m!==void 0?m:nb,e?.params&&(this.params=e.params),e?.logger&&(this.logger=e.logger),(e?.logLevel||e?.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(p=e?.reconnectAfterMs)!==null&&p!==void 0?p:(N=>TT[N-1]||ET),this.vsn){case xT:this.encode=(x=e?.encode)!==null&&x!==void 0?x:((N,k)=>k(JSON.stringify(N))),this.decode=(b=e?.decode)!==null&&b!==void 0?b:((N,k)=>k(JSON.parse(N)));break;case Uv:this.encode=(y=e?.encode)!==null&&y!==void 0?y:this.serializer.encode.bind(this.serializer),this.decode=(j=e?.decode)!==null&&j!==void 0?j:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e?.workerUrl}}}var Ml=class extends Error{constructor(s,e){super(s),this.name="IcebergError",this.status=e.status,this.icebergType=e.icebergType,this.icebergCode=e.icebergCode,this.details=e.details,this.isCommitStateUnknown=e.icebergType==="CommitStateUnknownException"||[500,502,504].includes(e.status)&&e.icebergType?.includes("CommitState")===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function RT(s,e,a){const i=new URL(e,s);if(a)for(const[o,u]of Object.entries(a))u!==void 0&&i.searchParams.set(o,u);return i.toString()}async function DT(s){return!s||s.type==="none"?{}:s.type==="bearer"?{Authorization:`Bearer ${s.token}`}:s.type==="header"?{[s.name]:s.value}:s.type==="custom"?await s.getHeaders():{}}function OT(s){const e=s.fetchImpl??globalThis.fetch;return{async request({method:a,path:i,query:o,body:u,headers:d}){const f=RT(s.baseUrl,i,o),m=await DT(s.auth),p=await e(f,{method:a,headers:{...u?{"Content-Type":"application/json"}:{},...m,...d},body:u?JSON.stringify(u):void 0}),x=await p.text(),b=(p.headers.get("content-type")||"").includes("application/json"),y=b&&x?JSON.parse(x):x;if(!p.ok){const j=b?y:void 0,N=j?.error;throw new Ml(N?.message??`Request failed with status ${p.status}`,{status:p.status,icebergType:N?.type,icebergCode:N?.code,details:j})}return{status:p.status,headers:p.headers,data:y}}}}function vc(s){return s.join("")}var MT=class{constructor(s,e=""){this.client=s,this.prefix=e}async listNamespaces(s){const e=s?{parent:vc(s.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:e})).data.namespaces.map(i=>({namespace:i}))}async createNamespace(s,e){const a={namespace:s.namespace,properties:e?.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:a})).data}async dropNamespace(s){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${vc(s.namespace)}`})}async loadNamespaceMetadata(s){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${vc(s.namespace)}`})).data.properties}}async namespaceExists(s){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${vc(s.namespace)}`}),!0}catch(e){if(e instanceof Ml&&e.status===404)return!1;throw e}}async createNamespaceIfNotExists(s,e){try{return await this.createNamespace(s,e)}catch(a){if(a instanceof Ml&&a.status===409)return;throw a}}};function si(s){return s.join("")}var UT=class{constructor(s,e="",a){this.client=s,this.prefix=e,this.accessDelegation=a}async listTables(s){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${si(s.namespace)}/tables`})).data.identifiers}async createTable(s,e){const a={};return this.accessDelegation&&(a["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${si(s.namespace)}/tables`,body:e,headers:a})).data.metadata}async updateTable(s,e){const a=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${si(s.namespace)}/tables/${s.name}`,body:e});return{"metadata-location":a.data["metadata-location"],metadata:a.data.metadata}}async dropTable(s,e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${si(s.namespace)}/tables/${s.name}`,query:{purgeRequested:String(e?.purge??!1)}})}async loadTable(s){const e={};return this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${si(s.namespace)}/tables/${s.name}`,headers:e})).data.metadata}async tableExists(s){const e={};this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${si(s.namespace)}/tables/${s.name}`,headers:e}),!0}catch(a){if(a instanceof Ml&&a.status===404)return!1;throw a}}async createTableIfNotExists(s,e){try{return await this.createTable(s,e)}catch(a){if(a instanceof Ml&&a.status===409)return await this.loadTable({namespace:s.namespace,name:e.name});throw a}}},LT=class{constructor(s){let e="v1";s.catalogName&&(e+=`/${s.catalogName}`);const a=s.baseUrl.endsWith("/")?s.baseUrl:`${s.baseUrl}/`;this.client=OT({baseUrl:a,auth:s.auth,fetchImpl:s.fetch}),this.accessDelegation=s.accessDelegation?.join(","),this.namespaceOps=new MT(this.client,e),this.tableOps=new UT(this.client,e,this.accessDelegation)}async listNamespaces(s){return this.namespaceOps.listNamespaces(s)}async createNamespace(s,e){return this.namespaceOps.createNamespace(s,e)}async dropNamespace(s){await this.namespaceOps.dropNamespace(s)}async loadNamespaceMetadata(s){return this.namespaceOps.loadNamespaceMetadata(s)}async listTables(s){return this.tableOps.listTables(s)}async createTable(s,e){return this.tableOps.createTable(s,e)}async updateTable(s,e){return this.tableOps.updateTable(s,e)}async dropTable(s,e){await this.tableOps.dropTable(s,e)}async loadTable(s){return this.tableOps.loadTable(s)}async namespaceExists(s){return this.namespaceOps.namespaceExists(s)}async tableExists(s){return this.tableOps.tableExists(s)}async createNamespaceIfNotExists(s,e){return this.namespaceOps.createNamespaceIfNotExists(s,e)}async createTableIfNotExists(s,e){return this.tableOps.createTableIfNotExists(s,e)}},tu=class extends Error{constructor(s){super(s),this.__isStorageError=!0,this.name="StorageError"}};function Et(s){return typeof s=="object"&&s!==null&&"__isStorageError"in s}var PT=class extends tu{constructor(s,e,a){super(s),this.name="StorageApiError",this.status=e,this.statusCode=a}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},hf=class extends tu{constructor(s,e){super(s),this.name="StorageUnknownError",this.originalError=e}};const nm=s=>s?(...e)=>s(...e):(...e)=>fetch(...e),IT=()=>Response,ff=s=>{if(Array.isArray(s))return s.map(a=>ff(a));if(typeof s=="function"||s!==Object(s))return s;const e={};return Object.entries(s).forEach(([a,i])=>{const o=a.replace(/([-_][a-z])/gi,u=>u.toUpperCase().replace(/[-_]/g,""));e[o]=ff(i)}),e},BT=s=>{if(typeof s!="object"||s===null)return!1;const e=Object.getPrototypeOf(s);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in s)&&!(Symbol.iterator in s)},zT=s=>!s||typeof s!="string"||s.length===0||s.length>100||s.trim()!==s||s.includes("/")||s.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(s);function Ul(s){"@babel/helpers - typeof";return Ul=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ul(s)}function VT(s,e){if(Ul(s)!="object"||!s)return s;var a=s[Symbol.toPrimitive];if(a!==void 0){var i=a.call(s,e);if(Ul(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(s)}function $T(s){var e=VT(s,"string");return Ul(e)=="symbol"?e:e+""}function qT(s,e,a){return(e=$T(e))in s?Object.defineProperty(s,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):s[e]=a,s}function lb(s,e){var a=Object.keys(s);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(s);e&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(s,o).enumerable})),a.push.apply(a,i)}return a}function Pe(s){for(var e=1;e<arguments.length;e++){var a=arguments[e]!=null?arguments[e]:{};e%2?lb(Object(a),!0).forEach(function(i){qT(s,i,a[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(a)):lb(Object(a)).forEach(function(i){Object.defineProperty(s,i,Object.getOwnPropertyDescriptor(a,i))})}return s}const Eh=s=>{var e;return s.msg||s.message||s.error_description||(typeof s.error=="string"?s.error:(e=s.error)===null||e===void 0?void 0:e.message)||JSON.stringify(s)},HT=async(s,e,a)=>{s instanceof await IT()&&!a?.noResolveJson?s.json().then(i=>{const o=s.status||500,u=i?.statusCode||o+"";e(new PT(Eh(i),o,u))}).catch(i=>{e(new hf(Eh(i),i))}):e(new hf(Eh(s),s))},GT=(s,e,a,i)=>{const o={method:s,headers:e?.headers||{}};return s==="GET"||!i?o:(BT(i)?(o.headers=Pe({"Content-Type":"application/json"},e?.headers),o.body=JSON.stringify(i)):o.body=i,e?.duplex&&(o.duplex=e.duplex),Pe(Pe({},o),a))};async function Jl(s,e,a,i,o,u){return new Promise((d,f)=>{s(a,GT(e,i,o,u)).then(m=>{if(!m.ok)throw m;return i?.noResolveJson?m:m.json()}).then(m=>d(m)).catch(m=>HT(m,f,i))})}async function Ll(s,e,a,i){return Jl(s,"GET",e,a,i)}async function an(s,e,a,i,o){return Jl(s,"POST",e,i,o,a)}async function mf(s,e,a,i,o){return Jl(s,"PUT",e,i,o,a)}async function FT(s,e,a,i){return Jl(s,"HEAD",e,Pe(Pe({},a),{},{noResolveJson:!0}),i)}async function am(s,e,a,i,o){return Jl(s,"DELETE",e,i,o,a)}var KT=class{constructor(s,e){this.downloadFn=s,this.shouldThrowOnError=e}then(s,e){return this.execute().then(s,e)}async execute(){var s=this;try{return{data:(await s.downloadFn()).body,error:null}}catch(e){if(s.shouldThrowOnError)throw e;if(Et(e))return{data:null,error:e};throw e}}};let Bv;Bv=Symbol.toStringTag;var YT=class{constructor(s,e){this.downloadFn=s,this.shouldThrowOnError=e,this[Bv]="BlobDownloadBuilder",this.promise=null}asStream(){return new KT(this.downloadFn,this.shouldThrowOnError)}then(s,e){return this.getPromise().then(s,e)}catch(s){return this.getPromise().catch(s)}finally(s){return this.getPromise().finally(s)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var s=this;try{return{data:await(await s.downloadFn()).blob(),error:null}}catch(e){if(s.shouldThrowOnError)throw e;if(Et(e))return{data:null,error:e};throw e}}};const XT={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},ob={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var JT=class{constructor(s,e={},a,i){this.shouldThrowOnError=!1,this.url=s,this.headers=e,this.bucketId=a,this.fetch=nm(i)}throwOnError(){return this.shouldThrowOnError=!0,this}async uploadOrUpdate(s,e,a,i){var o=this;try{let u;const d=Pe(Pe({},ob),i);let f=Pe(Pe({},o.headers),s==="POST"&&{"x-upsert":String(d.upsert)});const m=d.metadata;typeof Blob<"u"&&a instanceof Blob?(u=new FormData,u.append("cacheControl",d.cacheControl),m&&u.append("metadata",o.encodeMetadata(m)),u.append("",a)):typeof FormData<"u"&&a instanceof FormData?(u=a,u.has("cacheControl")||u.append("cacheControl",d.cacheControl),m&&!u.has("metadata")&&u.append("metadata",o.encodeMetadata(m))):(u=a,f["cache-control"]=`max-age=${d.cacheControl}`,f["content-type"]=d.contentType,m&&(f["x-metadata"]=o.toBase64(o.encodeMetadata(m))),(typeof ReadableStream<"u"&&u instanceof ReadableStream||u&&typeof u=="object"&&"pipe"in u&&typeof u.pipe=="function")&&!d.duplex&&(d.duplex="half")),i?.headers&&(f=Pe(Pe({},f),i.headers));const p=o._removeEmptyFolders(e),x=o._getFinalPath(p),b=await(s=="PUT"?mf:an)(o.fetch,`${o.url}/object/${x}`,u,Pe({headers:f},d?.duplex?{duplex:d.duplex}:{}));return{data:{path:p,id:b.Id,fullPath:b.Key},error:null}}catch(u){if(o.shouldThrowOnError)throw u;if(Et(u))return{data:null,error:u};throw u}}async upload(s,e,a){return this.uploadOrUpdate("POST",s,e,a)}async uploadToSignedUrl(s,e,a,i){var o=this;const u=o._removeEmptyFolders(s),d=o._getFinalPath(u),f=new URL(o.url+`/object/upload/sign/${d}`);f.searchParams.set("token",e);try{let m;const p=Pe({upsert:ob.upsert},i),x=Pe(Pe({},o.headers),{"x-upsert":String(p.upsert)});return typeof Blob<"u"&&a instanceof Blob?(m=new FormData,m.append("cacheControl",p.cacheControl),m.append("",a)):typeof FormData<"u"&&a instanceof FormData?(m=a,m.append("cacheControl",p.cacheControl)):(m=a,x["cache-control"]=`max-age=${p.cacheControl}`,x["content-type"]=p.contentType),{data:{path:u,fullPath:(await mf(o.fetch,f.toString(),m,{headers:x})).Key},error:null}}catch(m){if(o.shouldThrowOnError)throw m;if(Et(m))return{data:null,error:m};throw m}}async createSignedUploadUrl(s,e){var a=this;try{let i=a._getFinalPath(s);const o=Pe({},a.headers);e?.upsert&&(o["x-upsert"]="true");const u=await an(a.fetch,`${a.url}/object/upload/sign/${i}`,{},{headers:o}),d=new URL(a.url+u.url),f=d.searchParams.get("token");if(!f)throw new tu("No token returned by API");return{data:{signedUrl:d.toString(),path:s,token:f},error:null}}catch(i){if(a.shouldThrowOnError)throw i;if(Et(i))return{data:null,error:i};throw i}}async update(s,e,a){return this.uploadOrUpdate("PUT",s,e,a)}async move(s,e,a){var i=this;try{return{data:await an(i.fetch,`${i.url}/object/move`,{bucketId:i.bucketId,sourceKey:s,destinationKey:e,destinationBucket:a?.destinationBucket},{headers:i.headers}),error:null}}catch(o){if(i.shouldThrowOnError)throw o;if(Et(o))return{data:null,error:o};throw o}}async copy(s,e,a){var i=this;try{return{data:{path:(await an(i.fetch,`${i.url}/object/copy`,{bucketId:i.bucketId,sourceKey:s,destinationKey:e,destinationBucket:a?.destinationBucket},{headers:i.headers})).Key},error:null}}catch(o){if(i.shouldThrowOnError)throw o;if(Et(o))return{data:null,error:o};throw o}}async createSignedUrl(s,e,a){var i=this;try{let o=i._getFinalPath(s),u=await an(i.fetch,`${i.url}/object/sign/${o}`,Pe({expiresIn:e},a?.transform?{transform:a.transform}:{}),{headers:i.headers});const d=a?.download?`&download=${a.download===!0?"":a.download}`:"";return u={signedUrl:encodeURI(`${i.url}${u.signedURL}${d}`)},{data:u,error:null}}catch(o){if(i.shouldThrowOnError)throw o;if(Et(o))return{data:null,error:o};throw o}}async createSignedUrls(s,e,a){var i=this;try{const o=await an(i.fetch,`${i.url}/object/sign/${i.bucketId}`,{expiresIn:e,paths:s},{headers:i.headers}),u=a?.download?`&download=${a.download===!0?"":a.download}`:"";return{data:o.map(d=>Pe(Pe({},d),{},{signedUrl:d.signedURL?encodeURI(`${i.url}${d.signedURL}${u}`):null})),error:null}}catch(o){if(i.shouldThrowOnError)throw o;if(Et(o))return{data:null,error:o};throw o}}download(s,e){const a=typeof e?.transform<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString(e?.transform||{}),o=i?`?${i}`:"",u=this._getFinalPath(s),d=()=>Ll(this.fetch,`${this.url}/${a}/${u}${o}`,{headers:this.headers,noResolveJson:!0});return new YT(d,this.shouldThrowOnError)}async info(s){var e=this;const a=e._getFinalPath(s);try{return{data:ff(await Ll(e.fetch,`${e.url}/object/info/${a}`,{headers:e.headers})),error:null}}catch(i){if(e.shouldThrowOnError)throw i;if(Et(i))return{data:null,error:i};throw i}}async exists(s){var e=this;const a=e._getFinalPath(s);try{return await FT(e.fetch,`${e.url}/object/${a}`,{headers:e.headers}),{data:!0,error:null}}catch(i){if(e.shouldThrowOnError)throw i;if(Et(i)&&i instanceof hf){const o=i.originalError;if([400,404].includes(o?.status))return{data:!1,error:i}}throw i}}getPublicUrl(s,e){const a=this._getFinalPath(s),i=[],o=e?.download?`download=${e.download===!0?"":e.download}`:"";o!==""&&i.push(o);const u=typeof e?.transform<"u"?"render/image":"object",d=this.transformOptsToQueryString(e?.transform||{});d!==""&&i.push(d);let f=i.join("&");return f!==""&&(f=`?${f}`),{data:{publicUrl:encodeURI(`${this.url}/${u}/public/${a}${f}`)}}}async remove(s){var e=this;try{return{data:await am(e.fetch,`${e.url}/object/${e.bucketId}`,{prefixes:s},{headers:e.headers}),error:null}}catch(a){if(e.shouldThrowOnError)throw a;if(Et(a))return{data:null,error:a};throw a}}async list(s,e,a){var i=this;try{const o=Pe(Pe(Pe({},XT),e),{},{prefix:s||""});return{data:await an(i.fetch,`${i.url}/object/list/${i.bucketId}`,o,{headers:i.headers},a),error:null}}catch(o){if(i.shouldThrowOnError)throw o;if(Et(o))return{data:null,error:o};throw o}}async listV2(s,e){var a=this;try{const i=Pe({},s);return{data:await an(a.fetch,`${a.url}/object/list-v2/${a.bucketId}`,i,{headers:a.headers},e),error:null}}catch(i){if(a.shouldThrowOnError)throw i;if(Et(i))return{data:null,error:i};throw i}}encodeMetadata(s){return JSON.stringify(s)}toBase64(s){return typeof Buffer<"u"?Buffer.from(s).toString("base64"):btoa(s)}_getFinalPath(s){return`${this.bucketId}/${s.replace(/^\/+/,"")}`}_removeEmptyFolders(s){return s.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(s){const e=[];return s.width&&e.push(`width=${s.width}`),s.height&&e.push(`height=${s.height}`),s.resize&&e.push(`resize=${s.resize}`),s.format&&e.push(`format=${s.format}`),s.quality&&e.push(`quality=${s.quality}`),e.join("&")}};const zv="2.91.1",Vv={"X-Client-Info":`storage-js/${zv}`};var QT=class{constructor(s,e={},a,i){this.shouldThrowOnError=!1;const o=new URL(s);i?.useNewHostname&&/supabase\.(co|in|red)$/.test(o.hostname)&&!o.hostname.includes("storage.supabase.")&&(o.hostname=o.hostname.replace("supabase.","storage.supabase.")),this.url=o.href.replace(/\/$/,""),this.headers=Pe(Pe({},Vv),e),this.fetch=nm(a)}throwOnError(){return this.shouldThrowOnError=!0,this}async listBuckets(s){var e=this;try{const a=e.listBucketOptionsToQueryString(s);return{data:await Ll(e.fetch,`${e.url}/bucket${a}`,{headers:e.headers}),error:null}}catch(a){if(e.shouldThrowOnError)throw a;if(Et(a))return{data:null,error:a};throw a}}async getBucket(s){var e=this;try{return{data:await Ll(e.fetch,`${e.url}/bucket/${s}`,{headers:e.headers}),error:null}}catch(a){if(e.shouldThrowOnError)throw a;if(Et(a))return{data:null,error:a};throw a}}async createBucket(s,e={public:!1}){var a=this;try{return{data:await an(a.fetch,`${a.url}/bucket`,{id:s,name:s,type:e.type,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:a.headers}),error:null}}catch(i){if(a.shouldThrowOnError)throw i;if(Et(i))return{data:null,error:i};throw i}}async updateBucket(s,e){var a=this;try{return{data:await mf(a.fetch,`${a.url}/bucket/${s}`,{id:s,name:s,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:a.headers}),error:null}}catch(i){if(a.shouldThrowOnError)throw i;if(Et(i))return{data:null,error:i};throw i}}async emptyBucket(s){var e=this;try{return{data:await an(e.fetch,`${e.url}/bucket/${s}/empty`,{},{headers:e.headers}),error:null}}catch(a){if(e.shouldThrowOnError)throw a;if(Et(a))return{data:null,error:a};throw a}}async deleteBucket(s){var e=this;try{return{data:await am(e.fetch,`${e.url}/bucket/${s}`,{},{headers:e.headers}),error:null}}catch(a){if(e.shouldThrowOnError)throw a;if(Et(a))return{data:null,error:a};throw a}}listBucketOptionsToQueryString(s){const e={};return s&&("limit"in s&&(e.limit=String(s.limit)),"offset"in s&&(e.offset=String(s.offset)),s.search&&(e.search=s.search),s.sortColumn&&(e.sortColumn=s.sortColumn),s.sortOrder&&(e.sortOrder=s.sortOrder)),Object.keys(e).length>0?"?"+new URLSearchParams(e).toString():""}},ZT=class{constructor(s,e={},a){this.shouldThrowOnError=!1,this.url=s.replace(/\/$/,""),this.headers=Pe(Pe({},Vv),e),this.fetch=nm(a)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(s){var e=this;try{return{data:await an(e.fetch,`${e.url}/bucket`,{name:s},{headers:e.headers}),error:null}}catch(a){if(e.shouldThrowOnError)throw a;if(Et(a))return{data:null,error:a};throw a}}async listBuckets(s){var e=this;try{const a=new URLSearchParams;s?.limit!==void 0&&a.set("limit",s.limit.toString()),s?.offset!==void 0&&a.set("offset",s.offset.toString()),s?.sortColumn&&a.set("sortColumn",s.sortColumn),s?.sortOrder&&a.set("sortOrder",s.sortOrder),s?.search&&a.set("search",s.search);const i=a.toString(),o=i?`${e.url}/bucket?${i}`:`${e.url}/bucket`;return{data:await Ll(e.fetch,o,{headers:e.headers}),error:null}}catch(a){if(e.shouldThrowOnError)throw a;if(Et(a))return{data:null,error:a};throw a}}async deleteBucket(s){var e=this;try{return{data:await am(e.fetch,`${e.url}/bucket/${s}`,{},{headers:e.headers}),error:null}}catch(a){if(e.shouldThrowOnError)throw a;if(Et(a))return{data:null,error:a};throw a}}from(s){var e=this;if(!zT(s))throw new tu("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const a=new LT({baseUrl:this.url,catalogName:s,auth:{type:"custom",getHeaders:async()=>e.headers},fetch:this.fetch}),i=this.shouldThrowOnError;return new Proxy(a,{get(o,u){const d=o[u];return typeof d!="function"?d:async(...f)=>{try{return{data:await d.apply(o,f),error:null}}catch(m){if(i)throw m;return{data:null,error:m}}}}})}};const rm={"X-Client-Info":`storage-js/${zv}`,"Content-Type":"application/json"};var $v=class extends Error{constructor(s){super(s),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function Ls(s){return typeof s=="object"&&s!==null&&"__isStorageVectorsError"in s}var Ch=class extends $v{constructor(s,e,a){super(s),this.name="StorageVectorsApiError",this.status=e,this.statusCode=a}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},WT=class extends $v{constructor(s,e){super(s),this.name="StorageVectorsUnknownError",this.originalError=e}};const im=s=>s?(...e)=>s(...e):(...e)=>fetch(...e),eE=s=>{if(typeof s!="object"||s===null)return!1;const e=Object.getPrototypeOf(s);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in s)&&!(Symbol.iterator in s)},cb=s=>s.msg||s.message||s.error_description||s.error||JSON.stringify(s),tE=async(s,e,a)=>{if(s&&typeof s=="object"&&"status"in s&&"ok"in s&&typeof s.status=="number"&&!a?.noResolveJson){const i=s.status||500,o=s;if(typeof o.json=="function")o.json().then(u=>{const d=u?.statusCode||u?.code||i+"";e(new Ch(cb(u),i,d))}).catch(()=>{const u=i+"";e(new Ch(o.statusText||`HTTP ${i} error`,i,u))});else{const u=i+"";e(new Ch(o.statusText||`HTTP ${i} error`,i,u))}}else e(new WT(cb(s),s))},sE=(s,e,a,i)=>{const o={method:s,headers:e?.headers||{}};return i?(eE(i)?(o.headers=Pe({"Content-Type":"application/json"},e?.headers),o.body=JSON.stringify(i)):o.body=i,Pe(Pe({},o),a)):o};async function nE(s,e,a,i,o,u){return new Promise((d,f)=>{s(a,sE(e,i,o,u)).then(m=>{if(!m.ok)throw m;if(i?.noResolveJson)return m;const p=m.headers.get("content-type");return!p||!p.includes("application/json")?{}:m.json()}).then(m=>d(m)).catch(m=>tE(m,f,i))})}async function Ps(s,e,a,i,o){return nE(s,"POST",e,i,o,a)}var aE=class{constructor(s,e={},a){this.shouldThrowOnError=!1,this.url=s.replace(/\/$/,""),this.headers=Pe(Pe({},rm),e),this.fetch=im(a)}throwOnError(){return this.shouldThrowOnError=!0,this}async createIndex(s){var e=this;try{return{data:await Ps(e.fetch,`${e.url}/CreateIndex`,s,{headers:e.headers})||{},error:null}}catch(a){if(e.shouldThrowOnError)throw a;if(Ls(a))return{data:null,error:a};throw a}}async getIndex(s,e){var a=this;try{return{data:await Ps(a.fetch,`${a.url}/GetIndex`,{vectorBucketName:s,indexName:e},{headers:a.headers}),error:null}}catch(i){if(a.shouldThrowOnError)throw i;if(Ls(i))return{data:null,error:i};throw i}}async listIndexes(s){var e=this;try{return{data:await Ps(e.fetch,`${e.url}/ListIndexes`,s,{headers:e.headers}),error:null}}catch(a){if(e.shouldThrowOnError)throw a;if(Ls(a))return{data:null,error:a};throw a}}async deleteIndex(s,e){var a=this;try{return{data:await Ps(a.fetch,`${a.url}/DeleteIndex`,{vectorBucketName:s,indexName:e},{headers:a.headers})||{},error:null}}catch(i){if(a.shouldThrowOnError)throw i;if(Ls(i))return{data:null,error:i};throw i}}},rE=class{constructor(s,e={},a){this.shouldThrowOnError=!1,this.url=s.replace(/\/$/,""),this.headers=Pe(Pe({},rm),e),this.fetch=im(a)}throwOnError(){return this.shouldThrowOnError=!0,this}async putVectors(s){var e=this;try{if(s.vectors.length<1||s.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:await Ps(e.fetch,`${e.url}/PutVectors`,s,{headers:e.headers})||{},error:null}}catch(a){if(e.shouldThrowOnError)throw a;if(Ls(a))return{data:null,error:a};throw a}}async getVectors(s){var e=this;try{return{data:await Ps(e.fetch,`${e.url}/GetVectors`,s,{headers:e.headers}),error:null}}catch(a){if(e.shouldThrowOnError)throw a;if(Ls(a))return{data:null,error:a};throw a}}async listVectors(s){var e=this;try{if(s.segmentCount!==void 0){if(s.segmentCount<1||s.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(s.segmentIndex!==void 0&&(s.segmentIndex<0||s.segmentIndex>=s.segmentCount))throw new Error(`segmentIndex must be between 0 and ${s.segmentCount-1}`)}return{data:await Ps(e.fetch,`${e.url}/ListVectors`,s,{headers:e.headers}),error:null}}catch(a){if(e.shouldThrowOnError)throw a;if(Ls(a))return{data:null,error:a};throw a}}async queryVectors(s){var e=this;try{return{data:await Ps(e.fetch,`${e.url}/QueryVectors`,s,{headers:e.headers}),error:null}}catch(a){if(e.shouldThrowOnError)throw a;if(Ls(a))return{data:null,error:a};throw a}}async deleteVectors(s){var e=this;try{if(s.keys.length<1||s.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:await Ps(e.fetch,`${e.url}/DeleteVectors`,s,{headers:e.headers})||{},error:null}}catch(a){if(e.shouldThrowOnError)throw a;if(Ls(a))return{data:null,error:a};throw a}}},iE=class{constructor(s,e={},a){this.shouldThrowOnError=!1,this.url=s.replace(/\/$/,""),this.headers=Pe(Pe({},rm),e),this.fetch=im(a)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(s){var e=this;try{return{data:await Ps(e.fetch,`${e.url}/CreateVectorBucket`,{vectorBucketName:s},{headers:e.headers})||{},error:null}}catch(a){if(e.shouldThrowOnError)throw a;if(Ls(a))return{data:null,error:a};throw a}}async getBucket(s){var e=this;try{return{data:await Ps(e.fetch,`${e.url}/GetVectorBucket`,{vectorBucketName:s},{headers:e.headers}),error:null}}catch(a){if(e.shouldThrowOnError)throw a;if(Ls(a))return{data:null,error:a};throw a}}async listBuckets(s={}){var e=this;try{return{data:await Ps(e.fetch,`${e.url}/ListVectorBuckets`,s,{headers:e.headers}),error:null}}catch(a){if(e.shouldThrowOnError)throw a;if(Ls(a))return{data:null,error:a};throw a}}async deleteBucket(s){var e=this;try{return{data:await Ps(e.fetch,`${e.url}/DeleteVectorBucket`,{vectorBucketName:s},{headers:e.headers})||{},error:null}}catch(a){if(e.shouldThrowOnError)throw a;if(Ls(a))return{data:null,error:a};throw a}}},lE=class extends iE{constructor(s,e={}){super(s,e.headers||{},e.fetch)}from(s){return new oE(this.url,this.headers,s,this.fetch)}async createBucket(s){var e=()=>super.createBucket,a=this;return e().call(a,s)}async getBucket(s){var e=()=>super.getBucket,a=this;return e().call(a,s)}async listBuckets(s={}){var e=()=>super.listBuckets,a=this;return e().call(a,s)}async deleteBucket(s){var e=()=>super.deleteBucket,a=this;return e().call(a,s)}},oE=class extends aE{constructor(s,e,a,i){super(s,e,i),this.vectorBucketName=a}async createIndex(s){var e=()=>super.createIndex,a=this;return e().call(a,Pe(Pe({},s),{},{vectorBucketName:a.vectorBucketName}))}async listIndexes(s={}){var e=()=>super.listIndexes,a=this;return e().call(a,Pe(Pe({},s),{},{vectorBucketName:a.vectorBucketName}))}async getIndex(s){var e=()=>super.getIndex,a=this;return e().call(a,a.vectorBucketName,s)}async deleteIndex(s){var e=()=>super.deleteIndex,a=this;return e().call(a,a.vectorBucketName,s)}index(s){return new cE(this.url,this.headers,this.vectorBucketName,s,this.fetch)}},cE=class extends rE{constructor(s,e,a,i,o){super(s,e,o),this.vectorBucketName=a,this.indexName=i}async putVectors(s){var e=()=>super.putVectors,a=this;return e().call(a,Pe(Pe({},s),{},{vectorBucketName:a.vectorBucketName,indexName:a.indexName}))}async getVectors(s){var e=()=>super.getVectors,a=this;return e().call(a,Pe(Pe({},s),{},{vectorBucketName:a.vectorBucketName,indexName:a.indexName}))}async listVectors(s={}){var e=()=>super.listVectors,a=this;return e().call(a,Pe(Pe({},s),{},{vectorBucketName:a.vectorBucketName,indexName:a.indexName}))}async queryVectors(s){var e=()=>super.queryVectors,a=this;return e().call(a,Pe(Pe({},s),{},{vectorBucketName:a.vectorBucketName,indexName:a.indexName}))}async deleteVectors(s){var e=()=>super.deleteVectors,a=this;return e().call(a,Pe(Pe({},s),{},{vectorBucketName:a.vectorBucketName,indexName:a.indexName}))}},uE=class extends QT{constructor(s,e={},a,i){super(s,e,a,i)}from(s){return new JT(this.url,this.headers,s,this.fetch)}get vectors(){return new lE(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new ZT(this.url+"/iceberg",this.headers,this.fetch)}};const qv="2.91.1",ci=30*1e3,pf=3,Ah=pf*ci,dE="http://localhost:9999",hE="supabase.auth.token",fE={"X-Client-Info":`gotrue-js/${qv}`},gf="X-Supabase-Api-Version",Hv={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},mE=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,pE=600*1e3;class Pl extends Error{constructor(e,a,i){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=a,this.code=i}}function Ce(s){return typeof s=="object"&&s!==null&&"__isAuthError"in s}class gE extends Pl{constructor(e,a,i){super(e,a,i),this.name="AuthApiError",this.status=a,this.code=i}}function xE(s){return Ce(s)&&s.name==="AuthApiError"}class lr extends Pl{constructor(e,a){super(e),this.name="AuthUnknownError",this.originalError=a}}class Wn extends Pl{constructor(e,a,i,o){super(e,i,o),this.name=a,this.status=i}}class Us extends Wn{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function bE(s){return Ce(s)&&s.name==="AuthSessionMissingError"}class ni extends Wn{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class wc extends Wn{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class jc extends Wn{constructor(e,a=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=a}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function yE(s){return Ce(s)&&s.name==="AuthImplicitGrantRedirectError"}class ub extends Wn{constructor(e,a=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=a}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class vE extends Wn{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class xf extends Wn{constructor(e,a){super(e,"AuthRetryableFetchError",a,void 0)}}function Rh(s){return Ce(s)&&s.name==="AuthRetryableFetchError"}class db extends Wn{constructor(e,a,i){super(e,"AuthWeakPasswordError",a,"weak_password"),this.reasons=i}}class bf extends Wn{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const zc="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),hb=` 	
\r=`.split(""),wE=(()=>{const s=new Array(128);for(let e=0;e<s.length;e+=1)s[e]=-1;for(let e=0;e<hb.length;e+=1)s[hb[e].charCodeAt(0)]=-2;for(let e=0;e<zc.length;e+=1)s[zc[e].charCodeAt(0)]=e;return s})();function fb(s,e,a){if(s!==null)for(e.queue=e.queue<<8|s,e.queuedBits+=8;e.queuedBits>=6;){const i=e.queue>>e.queuedBits-6&63;a(zc[i]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const i=e.queue>>e.queuedBits-6&63;a(zc[i]),e.queuedBits-=6}}function Gv(s,e,a){const i=wE[s];if(i>-1)for(e.queue=e.queue<<6|i,e.queuedBits+=6;e.queuedBits>=8;)a(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(i===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(s)}"`)}}function mb(s){const e=[],a=d=>{e.push(String.fromCodePoint(d))},i={utf8seq:0,codepoint:0},o={queue:0,queuedBits:0},u=d=>{SE(d,i,a)};for(let d=0;d<s.length;d+=1)Gv(s.charCodeAt(d),o,u);return e.join("")}function jE(s,e){if(s<=127){e(s);return}else if(s<=2047){e(192|s>>6),e(128|s&63);return}else if(s<=65535){e(224|s>>12),e(128|s>>6&63),e(128|s&63);return}else if(s<=1114111){e(240|s>>18),e(128|s>>12&63),e(128|s>>6&63),e(128|s&63);return}throw new Error(`Unrecognized Unicode codepoint: ${s.toString(16)}`)}function NE(s,e){for(let a=0;a<s.length;a+=1){let i=s.charCodeAt(a);if(i>55295&&i<=56319){const o=(i-55296)*1024&65535;i=(s.charCodeAt(a+1)-56320&65535|o)+65536,a+=1}jE(i,e)}}function SE(s,e,a){if(e.utf8seq===0){if(s<=127){a(s);return}for(let i=1;i<6;i+=1)if((s>>7-i&1)===0){e.utf8seq=i;break}if(e.utf8seq===2)e.codepoint=s&31;else if(e.utf8seq===3)e.codepoint=s&15;else if(e.utf8seq===4)e.codepoint=s&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(s<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|s&63,e.utf8seq-=1,e.utf8seq===0&&a(e.codepoint)}}function xi(s){const e=[],a={queue:0,queuedBits:0},i=o=>{e.push(o)};for(let o=0;o<s.length;o+=1)Gv(s.charCodeAt(o),a,i);return new Uint8Array(e)}function _E(s){const e=[];return NE(s,a=>e.push(a)),new Uint8Array(e)}function or(s){const e=[],a={queue:0,queuedBits:0},i=o=>{e.push(o)};return s.forEach(o=>fb(o,a,i)),fb(null,a,i),e.join("")}function kE(s){return Math.round(Date.now()/1e3)+s}function TE(){return Symbol("auth-callback")}const cs=()=>typeof window<"u"&&typeof document<"u",tr={tested:!1,writable:!1},Fv=()=>{if(!cs())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(tr.tested)return tr.writable;const s=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(s,s),globalThis.localStorage.removeItem(s),tr.tested=!0,tr.writable=!0}catch{tr.tested=!0,tr.writable=!1}return tr.writable};function EE(s){const e={},a=new URL(s);if(a.hash&&a.hash[0]==="#")try{new URLSearchParams(a.hash.substring(1)).forEach((o,u)=>{e[u]=o})}catch{}return a.searchParams.forEach((i,o)=>{e[o]=i}),e}const Kv=s=>s?(...e)=>s(...e):(...e)=>fetch(...e),CE=s=>typeof s=="object"&&s!==null&&"status"in s&&"ok"in s&&"json"in s&&typeof s.json=="function",ui=async(s,e,a)=>{await s.setItem(e,JSON.stringify(a))},sr=async(s,e)=>{const a=await s.getItem(e);if(!a)return null;try{return JSON.parse(a)}catch{return a}},os=async(s,e)=>{await s.removeItem(e)};class su{constructor(){this.promise=new su.promiseConstructor((e,a)=>{this.resolve=e,this.reject=a})}}su.promiseConstructor=Promise;function Dh(s){const e=s.split(".");if(e.length!==3)throw new bf("Invalid JWT structure");for(let i=0;i<e.length;i++)if(!mE.test(e[i]))throw new bf("JWT not in base64url format");return{header:JSON.parse(mb(e[0])),payload:JSON.parse(mb(e[1])),signature:xi(e[2]),raw:{header:e[0],payload:e[1]}}}async function AE(s){return await new Promise(e=>{setTimeout(()=>e(null),s)})}function RE(s,e){return new Promise((i,o)=>{(async()=>{for(let u=0;u<1/0;u++)try{const d=await s(u);if(!e(u,null,d)){i(d);return}}catch(d){if(!e(u,d)){o(d);return}}})()})}function DE(s){return("0"+s.toString(16)).substr(-2)}function OE(){const e=new Uint32Array(56);if(typeof crypto>"u"){const a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",i=a.length;let o="";for(let u=0;u<56;u++)o+=a.charAt(Math.floor(Math.random()*i));return o}return crypto.getRandomValues(e),Array.from(e,DE).join("")}async function ME(s){const a=new TextEncoder().encode(s),i=await crypto.subtle.digest("SHA-256",a),o=new Uint8Array(i);return Array.from(o).map(u=>String.fromCharCode(u)).join("")}async function UE(s){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),s;const a=await ME(s);return btoa(a).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function ai(s,e,a=!1){const i=OE();let o=i;a&&(o+="/PASSWORD_RECOVERY"),await ui(s,`${e}-code-verifier`,o);const u=await UE(i);return[u,i===u?"plain":"s256"]}const LE=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function PE(s){const e=s.headers.get(gf);if(!e||!e.match(LE))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function IE(s){if(!s)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(s<=e)throw new Error("JWT has expired")}function BE(s){switch(s){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const zE=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function ri(s){if(!zE.test(s))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Oh(){const s={};return new Proxy(s,{get:(e,a)=>{if(a==="__isUserNotAvailableProxy")return!0;if(typeof a=="symbol"){const i=a.toString();if(i==="Symbol(Symbol.toPrimitive)"||i==="Symbol(Symbol.toStringTag)"||i==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${a}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,a)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${a}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,a)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${a}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function VE(s,e){return new Proxy(s,{get:(a,i,o)=>{if(i==="__isInsecureUserWarningProxy")return!0;if(typeof i=="symbol"){const u=i.toString();if(u==="Symbol(Symbol.toPrimitive)"||u==="Symbol(Symbol.toStringTag)"||u==="Symbol(util.inspect.custom)"||u==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(a,i,o)}return!e.value&&typeof i=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(a,i,o)}})}function pb(s){return JSON.parse(JSON.stringify(s))}const ar=s=>s.msg||s.message||s.error_description||s.error||JSON.stringify(s),$E=[502,503,504];async function gb(s){var e;if(!CE(s))throw new xf(ar(s),0);if($E.includes(s.status))throw new xf(ar(s),s.status);let a;try{a=await s.json()}catch(u){throw new lr(ar(u),u)}let i;const o=PE(s);if(o&&o.getTime()>=Hv["2024-01-01"].timestamp&&typeof a=="object"&&a&&typeof a.code=="string"?i=a.code:typeof a=="object"&&a&&typeof a.error_code=="string"&&(i=a.error_code),i){if(i==="weak_password")throw new db(ar(a),s.status,((e=a.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(i==="session_not_found")throw new Us}else if(typeof a=="object"&&a&&typeof a.weak_password=="object"&&a.weak_password&&Array.isArray(a.weak_password.reasons)&&a.weak_password.reasons.length&&a.weak_password.reasons.reduce((u,d)=>u&&typeof d=="string",!0))throw new db(ar(a),s.status,a.weak_password.reasons);throw new gE(ar(a),s.status||500,i)}const qE=(s,e,a,i)=>{const o={method:s,headers:e?.headers||{}};return s==="GET"?o:(o.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),o.body=JSON.stringify(i),Object.assign(Object.assign({},o),a))};async function Le(s,e,a,i){var o;const u=Object.assign({},i?.headers);u[gf]||(u[gf]=Hv["2024-01-01"].name),i?.jwt&&(u.Authorization=`Bearer ${i.jwt}`);const d=(o=i?.query)!==null&&o!==void 0?o:{};i?.redirectTo&&(d.redirect_to=i.redirectTo);const f=Object.keys(d).length?"?"+new URLSearchParams(d).toString():"",m=await HE(s,e,a+f,{headers:u,noResolveJson:i?.noResolveJson},{},i?.body);return i?.xform?i?.xform(m):{data:Object.assign({},m),error:null}}async function HE(s,e,a,i,o,u){const d=qE(e,i,o,u);let f;try{f=await s(a,Object.assign({},d))}catch(m){throw console.error(m),new xf(ar(m),0)}if(f.ok||await gb(f),i?.noResolveJson)return f;try{return await f.json()}catch(m){await gb(m)}}function sn(s){var e;let a=null;KE(s)&&(a=Object.assign({},s),s.expires_at||(a.expires_at=kE(s.expires_in)));const i=(e=s.user)!==null&&e!==void 0?e:s;return{data:{session:a,user:i},error:null}}function xb(s){const e=sn(s);return!e.error&&s.weak_password&&typeof s.weak_password=="object"&&Array.isArray(s.weak_password.reasons)&&s.weak_password.reasons.length&&s.weak_password.message&&typeof s.weak_password.message=="string"&&s.weak_password.reasons.reduce((a,i)=>a&&typeof i=="string",!0)&&(e.data.weak_password=s.weak_password),e}function Ta(s){var e;return{data:{user:(e=s.user)!==null&&e!==void 0?e:s},error:null}}function GE(s){return{data:s,error:null}}function FE(s){const{action_link:e,email_otp:a,hashed_token:i,redirect_to:o,verification_type:u}=s,d=eu(s,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),f={action_link:e,email_otp:a,hashed_token:i,redirect_to:o,verification_type:u},m=Object.assign({},d);return{data:{properties:f,user:m},error:null}}function bb(s){return s}function KE(s){return s.access_token&&s.refresh_token&&s.expires_in}const Mh=["global","local","others"];class YE{constructor({url:e="",headers:a={},fetch:i}){this.url=e,this.headers=a,this.fetch=Kv(i),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,a=Mh[0]){if(Mh.indexOf(a)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Mh.join(", ")}`);try{return await Le(this.fetch,"POST",`${this.url}/logout?scope=${a}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(i){if(Ce(i))return{data:null,error:i};throw i}}async inviteUserByEmail(e,a={}){try{return await Le(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:a.data},headers:this.headers,redirectTo:a.redirectTo,xform:Ta})}catch(i){if(Ce(i))return{data:{user:null},error:i};throw i}}async generateLink(e){try{const{options:a}=e,i=eu(e,["options"]),o=Object.assign(Object.assign({},i),a);return"newEmail"in i&&(o.new_email=i?.newEmail,delete o.newEmail),await Le(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:o,headers:this.headers,xform:FE,redirectTo:a?.redirectTo})}catch(a){if(Ce(a))return{data:{properties:null,user:null},error:a};throw a}}async createUser(e){try{return await Le(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Ta})}catch(a){if(Ce(a))return{data:{user:null},error:a};throw a}}async listUsers(e){var a,i,o,u,d,f,m;try{const p={nextPage:null,lastPage:0,total:0},x=await Le(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(i=(a=e?.page)===null||a===void 0?void 0:a.toString())!==null&&i!==void 0?i:"",per_page:(u=(o=e?.perPage)===null||o===void 0?void 0:o.toString())!==null&&u!==void 0?u:""},xform:bb});if(x.error)throw x.error;const b=await x.json(),y=(d=x.headers.get("x-total-count"))!==null&&d!==void 0?d:0,j=(m=(f=x.headers.get("link"))===null||f===void 0?void 0:f.split(","))!==null&&m!==void 0?m:[];return j.length>0&&(j.forEach(N=>{const k=parseInt(N.split(";")[0].split("=")[1].substring(0,1)),T=JSON.parse(N.split(";")[1].split("=")[1]);p[`${T}Page`]=k}),p.total=parseInt(y)),{data:Object.assign(Object.assign({},b),p),error:null}}catch(p){if(Ce(p))return{data:{users:[]},error:p};throw p}}async getUserById(e){ri(e);try{return await Le(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Ta})}catch(a){if(Ce(a))return{data:{user:null},error:a};throw a}}async updateUserById(e,a){ri(e);try{return await Le(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:a,headers:this.headers,xform:Ta})}catch(i){if(Ce(i))return{data:{user:null},error:i};throw i}}async deleteUser(e,a=!1){ri(e);try{return await Le(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:a},xform:Ta})}catch(i){if(Ce(i))return{data:{user:null},error:i};throw i}}async _listFactors(e){ri(e.userId);try{const{data:a,error:i}=await Le(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:o=>({data:{factors:o},error:null})});return{data:a,error:i}}catch(a){if(Ce(a))return{data:null,error:a};throw a}}async _deleteFactor(e){ri(e.userId),ri(e.id);try{return{data:await Le(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(a){if(Ce(a))return{data:null,error:a};throw a}}async _listOAuthClients(e){var a,i,o,u,d,f,m;try{const p={nextPage:null,lastPage:0,total:0},x=await Le(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(i=(a=e?.page)===null||a===void 0?void 0:a.toString())!==null&&i!==void 0?i:"",per_page:(u=(o=e?.perPage)===null||o===void 0?void 0:o.toString())!==null&&u!==void 0?u:""},xform:bb});if(x.error)throw x.error;const b=await x.json(),y=(d=x.headers.get("x-total-count"))!==null&&d!==void 0?d:0,j=(m=(f=x.headers.get("link"))===null||f===void 0?void 0:f.split(","))!==null&&m!==void 0?m:[];return j.length>0&&(j.forEach(N=>{const k=parseInt(N.split(";")[0].split("=")[1].substring(0,1)),T=JSON.parse(N.split(";")[1].split("=")[1]);p[`${T}Page`]=k}),p.total=parseInt(y)),{data:Object.assign(Object.assign({},b),p),error:null}}catch(p){if(Ce(p))return{data:{clients:[]},error:p};throw p}}async _createOAuthClient(e){try{return await Le(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:a=>({data:a,error:null})})}catch(a){if(Ce(a))return{data:null,error:a};throw a}}async _getOAuthClient(e){try{return await Le(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:a=>({data:a,error:null})})}catch(a){if(Ce(a))return{data:null,error:a};throw a}}async _updateOAuthClient(e,a){try{return await Le(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:a,headers:this.headers,xform:i=>({data:i,error:null})})}catch(i){if(Ce(i))return{data:null,error:i};throw i}}async _deleteOAuthClient(e){try{return await Le(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(a){if(Ce(a))return{data:null,error:a};throw a}}async _regenerateOAuthClientSecret(e){try{return await Le(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:a=>({data:a,error:null})})}catch(a){if(Ce(a))return{data:null,error:a};throw a}}}function yb(s={}){return{getItem:e=>s[e]||null,setItem:(e,a)=>{s[e]=a},removeItem:e=>{delete s[e]}}}const ii={debug:!!(globalThis&&Fv()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Yv extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class XE extends Yv{}async function JE(s,e,a){ii.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",s,e);const i=new globalThis.AbortController;return e>0&&setTimeout(()=>{i.abort(),ii.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",s)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(s,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:i.signal},async o=>{if(o){ii.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",s,o.name);try{return await a()}finally{ii.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",s,o.name)}}else{if(e===0)throw ii.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",s),new XE(`Acquiring an exclusive Navigator LockManager lock "${s}" immediately failed`);if(ii.debug)try{const u=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(u,null,"  "))}catch(u){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",u)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await a()}}))}function QE(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function Xv(s){if(!/^0x[a-fA-F0-9]{40}$/.test(s))throw new Error(`@supabase/auth-js: Address "${s}" is invalid.`);return s.toLowerCase()}function ZE(s){return parseInt(s,16)}function WE(s){const e=new TextEncoder().encode(s);return"0x"+Array.from(e,i=>i.toString(16).padStart(2,"0")).join("")}function eC(s){var e;const{chainId:a,domain:i,expirationTime:o,issuedAt:u=new Date,nonce:d,notBefore:f,requestId:m,resources:p,scheme:x,uri:b,version:y}=s;{if(!Number.isInteger(a))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${a}`);if(!i)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(d&&d.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${d}`);if(!b)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(y!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${y}`);if(!((e=s.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${s.statement}`)}const j=Xv(s.address),N=x?`${x}://${i}`:i,k=s.statement?`${s.statement}
`:"",T=`${N} wants you to sign in with your Ethereum account:
${j}

${k}`;let R=`URI: ${b}
Version: ${y}
Chain ID: ${a}${d?`
Nonce: ${d}`:""}
Issued At: ${u.toISOString()}`;if(o&&(R+=`
Expiration Time: ${o.toISOString()}`),f&&(R+=`
Not Before: ${f.toISOString()}`),m&&(R+=`
Request ID: ${m}`),p){let A=`
Resources:`;for(const C of p){if(!C||typeof C!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${C}`);A+=`
- ${C}`}R+=A}return`${T}
${R}`}class $t extends Error{constructor({message:e,code:a,cause:i,name:o}){var u;super(e,{cause:i}),this.__isWebAuthnError=!0,this.name=(u=o??(i instanceof Error?i.name:void 0))!==null&&u!==void 0?u:"Unknown Error",this.code=a}}class Vc extends $t{constructor(e,a){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:a,message:e}),this.name="WebAuthnUnknownError",this.originalError=a}}function tC({error:s,options:e}){var a,i,o;const{publicKey:u}=e;if(!u)throw Error("options was missing required publicKey property");if(s.name==="AbortError"){if(e.signal instanceof AbortSignal)return new $t({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:s})}else if(s.name==="ConstraintError"){if(((a=u.authenticatorSelection)===null||a===void 0?void 0:a.requireResidentKey)===!0)return new $t({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:s});if(e.mediation==="conditional"&&((i=u.authenticatorSelection)===null||i===void 0?void 0:i.userVerification)==="required")return new $t({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:s});if(((o=u.authenticatorSelection)===null||o===void 0?void 0:o.userVerification)==="required")return new $t({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:s})}else{if(s.name==="InvalidStateError")return new $t({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:s});if(s.name==="NotAllowedError")return new $t({message:s.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:s});if(s.name==="NotSupportedError")return u.pubKeyCredParams.filter(f=>f.type==="public-key").length===0?new $t({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:s}):new $t({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:s});if(s.name==="SecurityError"){const d=window.location.hostname;if(Jv(d)){if(u.rp.id!==d)return new $t({message:`The RP ID "${u.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:s})}else return new $t({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:s})}else if(s.name==="TypeError"){if(u.user.id.byteLength<1||u.user.id.byteLength>64)return new $t({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:s})}else if(s.name==="UnknownError")return new $t({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:s})}return new $t({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:s})}function sC({error:s,options:e}){const{publicKey:a}=e;if(!a)throw Error("options was missing required publicKey property");if(s.name==="AbortError"){if(e.signal instanceof AbortSignal)return new $t({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:s})}else{if(s.name==="NotAllowedError")return new $t({message:s.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:s});if(s.name==="SecurityError"){const i=window.location.hostname;if(Jv(i)){if(a.rpId!==i)return new $t({message:`The RP ID "${a.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:s})}else return new $t({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:s})}else if(s.name==="UnknownError")return new $t({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:s})}return new $t({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:s})}class nC{createNewAbortSignal(){if(this.controller){const a=new Error("Cancelling existing WebAuthn API call for new one");a.name="AbortError",this.controller.abort(a)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const aC=new nC;function rC(s){if(!s)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(s);const{challenge:e,user:a,excludeCredentials:i}=s,o=eu(s,["challenge","user","excludeCredentials"]),u=xi(e).buffer,d=Object.assign(Object.assign({},a),{id:xi(a.id).buffer}),f=Object.assign(Object.assign({},o),{challenge:u,user:d});if(i&&i.length>0){f.excludeCredentials=new Array(i.length);for(let m=0;m<i.length;m++){const p=i[m];f.excludeCredentials[m]=Object.assign(Object.assign({},p),{id:xi(p.id).buffer,type:p.type||"public-key",transports:p.transports})}}return f}function iC(s){if(!s)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(s);const{challenge:e,allowCredentials:a}=s,i=eu(s,["challenge","allowCredentials"]),o=xi(e).buffer,u=Object.assign(Object.assign({},i),{challenge:o});if(a&&a.length>0){u.allowCredentials=new Array(a.length);for(let d=0;d<a.length;d++){const f=a[d];u.allowCredentials[d]=Object.assign(Object.assign({},f),{id:xi(f.id).buffer,type:f.type||"public-key",transports:f.transports})}}return u}function lC(s){var e;if("toJSON"in s&&typeof s.toJSON=="function")return s.toJSON();const a=s;return{id:s.id,rawId:s.id,response:{attestationObject:or(new Uint8Array(s.response.attestationObject)),clientDataJSON:or(new Uint8Array(s.response.clientDataJSON))},type:"public-key",clientExtensionResults:s.getClientExtensionResults(),authenticatorAttachment:(e=a.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function oC(s){var e;if("toJSON"in s&&typeof s.toJSON=="function")return s.toJSON();const a=s,i=s.getClientExtensionResults(),o=s.response;return{id:s.id,rawId:s.id,response:{authenticatorData:or(new Uint8Array(o.authenticatorData)),clientDataJSON:or(new Uint8Array(o.clientDataJSON)),signature:or(new Uint8Array(o.signature)),userHandle:o.userHandle?or(new Uint8Array(o.userHandle)):void 0},type:"public-key",clientExtensionResults:i,authenticatorAttachment:(e=a.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function Jv(s){return s==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(s)}function vb(){var s,e;return!!(cs()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((s=navigator?.credentials)===null||s===void 0?void 0:s.create)=="function"&&typeof((e=navigator?.credentials)===null||e===void 0?void 0:e.get)=="function")}async function cC(s){try{const e=await navigator.credentials.create(s);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new Vc("Browser returned unexpected credential type",e)}:{data:null,error:new Vc("Empty credential response",e)}}catch(e){return{data:null,error:tC({error:e,options:s})}}}async function uC(s){try{const e=await navigator.credentials.get(s);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new Vc("Browser returned unexpected credential type",e)}:{data:null,error:new Vc("Empty credential response",e)}}catch(e){return{data:null,error:sC({error:e,options:s})}}}const dC={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},hC={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function $c(...s){const e=o=>o!==null&&typeof o=="object"&&!Array.isArray(o),a=o=>o instanceof ArrayBuffer||ArrayBuffer.isView(o),i={};for(const o of s)if(o)for(const u in o){const d=o[u];if(d!==void 0)if(Array.isArray(d))i[u]=d;else if(a(d))i[u]=d;else if(e(d)){const f=i[u];e(f)?i[u]=$c(f,d):i[u]=$c(d)}else i[u]=d}return i}function fC(s,e){return $c(dC,s,e||{})}function mC(s,e){return $c(hC,s,e||{})}class pC{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:a,friendlyName:i,signal:o},u){try{const{data:d,error:f}=await this.client.mfa.challenge({factorId:e,webauthn:a});if(!d)return{data:null,error:f};const m=o??aC.createNewAbortSignal();if(d.webauthn.type==="create"){const{user:p}=d.webauthn.credential_options.publicKey;p.name||(p.name=`${p.id}:${i}`),p.displayName||(p.displayName=p.name)}switch(d.webauthn.type){case"create":{const p=fC(d.webauthn.credential_options.publicKey,u?.create),{data:x,error:b}=await cC({publicKey:p,signal:m});return x?{data:{factorId:e,challengeId:d.id,webauthn:{type:d.webauthn.type,credential_response:x}},error:null}:{data:null,error:b}}case"request":{const p=mC(d.webauthn.credential_options.publicKey,u?.request),{data:x,error:b}=await uC(Object.assign(Object.assign({},d.webauthn.credential_options),{publicKey:p,signal:m}));return x?{data:{factorId:e,challengeId:d.id,webauthn:{type:d.webauthn.type,credential_response:x}},error:null}:{data:null,error:b}}}}catch(d){return Ce(d)?{data:null,error:d}:{data:null,error:new lr("Unexpected error in challenge",d)}}}async _verify({challengeId:e,factorId:a,webauthn:i}){return this.client.mfa.verify({factorId:a,challengeId:e,webauthn:i})}async _authenticate({factorId:e,webauthn:{rpId:a=typeof window<"u"?window.location.hostname:void 0,rpOrigins:i=typeof window<"u"?[window.location.origin]:void 0,signal:o}={}},u){if(!a)return{data:null,error:new Pl("rpId is required for WebAuthn authentication")};try{if(!vb())return{data:null,error:new lr("Browser does not support WebAuthn",null)};const{data:d,error:f}=await this.challenge({factorId:e,webauthn:{rpId:a,rpOrigins:i},signal:o},{request:u});if(!d)return{data:null,error:f};const{webauthn:m}=d;return this._verify({factorId:e,challengeId:d.challengeId,webauthn:{type:m.type,rpId:a,rpOrigins:i,credential_response:m.credential_response}})}catch(d){return Ce(d)?{data:null,error:d}:{data:null,error:new lr("Unexpected error in authenticate",d)}}}async _register({friendlyName:e,webauthn:{rpId:a=typeof window<"u"?window.location.hostname:void 0,rpOrigins:i=typeof window<"u"?[window.location.origin]:void 0,signal:o}={}},u){if(!a)return{data:null,error:new Pl("rpId is required for WebAuthn registration")};try{if(!vb())return{data:null,error:new lr("Browser does not support WebAuthn",null)};const{data:d,error:f}=await this._enroll({friendlyName:e});if(!d)return await this.client.mfa.listFactors().then(x=>{var b;return(b=x.data)===null||b===void 0?void 0:b.all.find(y=>y.factor_type==="webauthn"&&y.friendly_name===e&&y.status!=="unverified")}).then(x=>x?this.client.mfa.unenroll({factorId:x?.id}):void 0),{data:null,error:f};const{data:m,error:p}=await this._challenge({factorId:d.id,friendlyName:d.friendly_name,webauthn:{rpId:a,rpOrigins:i},signal:o},{create:u});return m?this._verify({factorId:d.id,challengeId:m.challengeId,webauthn:{rpId:a,rpOrigins:i,type:m.webauthn.type,credential_response:m.webauthn.credential_response}}):{data:null,error:p}}catch(d){return Ce(d)?{data:null,error:d}:{data:null,error:new lr("Unexpected error in register",d)}}}}QE();const gC={url:dE,storageKey:hE,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:fE,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4};async function wb(s,e,a){return await a()}const li={};class Il{get jwks(){var e,a;return(a=(e=li[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&a!==void 0?a:{keys:[]}}set jwks(e){li[this.storageKey]=Object.assign(Object.assign({},li[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,a;return(a=(e=li[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&a!==void 0?a:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){li[this.storageKey]=Object.assign(Object.assign({},li[this.storageKey]),{cachedAt:e})}constructor(e){var a,i,o;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const u=Object.assign(Object.assign({},gC),e);if(this.storageKey=u.storageKey,this.instanceID=(a=Il.nextInstanceID[this.storageKey])!==null&&a!==void 0?a:0,Il.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!u.debug,typeof u.debug=="function"&&(this.logger=u.debug),this.instanceID>0&&cs()){const d=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(d),this.logDebugMessages&&console.trace(d)}if(this.persistSession=u.persistSession,this.autoRefreshToken=u.autoRefreshToken,this.admin=new YE({url:u.url,headers:u.headers,fetch:u.fetch}),this.url=u.url,this.headers=u.headers,this.fetch=Kv(u.fetch),this.lock=u.lock||wb,this.detectSessionInUrl=u.detectSessionInUrl,this.flowType=u.flowType,this.hasCustomAuthorizationHeader=u.hasCustomAuthorizationHeader,this.throwOnError=u.throwOnError,this.lockAcquireTimeout=u.lockAcquireTimeout,u.lock?this.lock=u.lock:this.persistSession&&cs()&&(!((i=globalThis?.navigator)===null||i===void 0)&&i.locks)?this.lock=JE:this.lock=wb,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new pC(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(u.storage?this.storage=u.storage:Fv()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=yb(this.memoryStorage)),u.userStorage&&(this.userStorage=u.userStorage)):(this.memoryStorage={},this.storage=yb(this.memoryStorage)),cs()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(d){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",d)}(o=this.broadcastChannel)===null||o===void 0||o.addEventListener("message",async d=>{this._debug("received broadcast notification from other tab or client",d),await this._notifyAllSubscribers(d.data.event,d.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${qv}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let a={},i="none";if(cs()&&(a=EE(window.location.href),this._isImplicitGrantCallback(a)?i="implicit":await this._isPKCECallback(a)&&(i="pkce")),cs()&&this.detectSessionInUrl&&i!=="none"){const{data:o,error:u}=await this._getSessionFromURL(a,i);if(u){if(this._debug("#_initialize()","error detecting session from URL",u),yE(u)){const m=(e=u.details)===null||e===void 0?void 0:e.code;if(m==="identity_already_exists"||m==="identity_not_found"||m==="single_identity_not_deletable")return{error:u}}return{error:u}}const{session:d,redirectType:f}=o;return this._debug("#_initialize()","detected session in URL",d,"redirect type",f),await this._saveSession(d),setTimeout(async()=>{f==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",d):await this._notifyAllSubscribers("SIGNED_IN",d)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(a){return Ce(a)?this._returnResult({error:a}):this._returnResult({error:new lr("Unexpected error during initialization",a)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var a,i,o;try{const u=await Le(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(i=(a=e?.options)===null||a===void 0?void 0:a.data)!==null&&i!==void 0?i:{},gotrue_meta_security:{captcha_token:(o=e?.options)===null||o===void 0?void 0:o.captchaToken}},xform:sn}),{data:d,error:f}=u;if(f||!d)return this._returnResult({data:{user:null,session:null},error:f});const m=d.session,p=d.user;return d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",m)),this._returnResult({data:{user:p,session:m},error:null})}catch(u){if(Ce(u))return this._returnResult({data:{user:null,session:null},error:u});throw u}}async signUp(e){var a,i,o;try{let u;if("email"in e){const{email:x,password:b,options:y}=e;let j=null,N=null;this.flowType==="pkce"&&([j,N]=await ai(this.storage,this.storageKey)),u=await Le(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:y?.emailRedirectTo,body:{email:x,password:b,data:(a=y?.data)!==null&&a!==void 0?a:{},gotrue_meta_security:{captcha_token:y?.captchaToken},code_challenge:j,code_challenge_method:N},xform:sn})}else if("phone"in e){const{phone:x,password:b,options:y}=e;u=await Le(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:x,password:b,data:(i=y?.data)!==null&&i!==void 0?i:{},channel:(o=y?.channel)!==null&&o!==void 0?o:"sms",gotrue_meta_security:{captcha_token:y?.captchaToken}},xform:sn})}else throw new wc("You must provide either an email or phone number and a password");const{data:d,error:f}=u;if(f||!d)return await os(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:f});const m=d.session,p=d.user;return d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",m)),this._returnResult({data:{user:p,session:m},error:null})}catch(u){if(await os(this.storage,`${this.storageKey}-code-verifier`),Ce(u))return this._returnResult({data:{user:null,session:null},error:u});throw u}}async signInWithPassword(e){try{let a;if("email"in e){const{email:u,password:d,options:f}=e;a=await Le(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:u,password:d,gotrue_meta_security:{captcha_token:f?.captchaToken}},xform:xb})}else if("phone"in e){const{phone:u,password:d,options:f}=e;a=await Le(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:u,password:d,gotrue_meta_security:{captcha_token:f?.captchaToken}},xform:xb})}else throw new wc("You must provide either an email or phone number and a password");const{data:i,error:o}=a;if(o)return this._returnResult({data:{user:null,session:null},error:o});if(!i||!i.session||!i.user){const u=new ni;return this._returnResult({data:{user:null,session:null},error:u})}return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),this._returnResult({data:Object.assign({user:i.user,session:i.session},i.weak_password?{weakPassword:i.weak_password}:null),error:o})}catch(a){if(Ce(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithOAuth(e){var a,i,o,u;return await this._handleProviderSignIn(e.provider,{redirectTo:(a=e.options)===null||a===void 0?void 0:a.redirectTo,scopes:(i=e.options)===null||i===void 0?void 0:i.scopes,queryParams:(o=e.options)===null||o===void 0?void 0:o.queryParams,skipBrowserRedirect:(u=e.options)===null||u===void 0?void 0:u.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:a}=e;switch(a){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${a}"`)}}async signInWithEthereum(e){var a,i,o,u,d,f,m,p,x,b,y;let j,N;if("message"in e)j=e.message,N=e.signature;else{const{chain:k,wallet:T,statement:R,options:A}=e;let C;if(cs())if(typeof T=="object")C=T;else{const te=window;if("ethereum"in te&&typeof te.ethereum=="object"&&"request"in te.ethereum&&typeof te.ethereum.request=="function")C=te.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof T!="object"||!A?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");C=T}const B=new URL((a=A?.url)!==null&&a!==void 0?a:window.location.href),F=await C.request({method:"eth_requestAccounts"}).then(te=>te).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!F||F.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const V=Xv(F[0]);let O=(i=A?.signInWithEthereum)===null||i===void 0?void 0:i.chainId;if(!O){const te=await C.request({method:"eth_chainId"});O=ZE(te)}const H={domain:B.host,address:V,statement:R,uri:B.href,version:"1",chainId:O,nonce:(o=A?.signInWithEthereum)===null||o===void 0?void 0:o.nonce,issuedAt:(d=(u=A?.signInWithEthereum)===null||u===void 0?void 0:u.issuedAt)!==null&&d!==void 0?d:new Date,expirationTime:(f=A?.signInWithEthereum)===null||f===void 0?void 0:f.expirationTime,notBefore:(m=A?.signInWithEthereum)===null||m===void 0?void 0:m.notBefore,requestId:(p=A?.signInWithEthereum)===null||p===void 0?void 0:p.requestId,resources:(x=A?.signInWithEthereum)===null||x===void 0?void 0:x.resources};j=eC(H),N=await C.request({method:"personal_sign",params:[WE(j),V]})}try{const{data:k,error:T}=await Le(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:j,signature:N},!((b=e.options)===null||b===void 0)&&b.captchaToken?{gotrue_meta_security:{captcha_token:(y=e.options)===null||y===void 0?void 0:y.captchaToken}}:null),xform:sn});if(T)throw T;if(!k||!k.session||!k.user){const R=new ni;return this._returnResult({data:{user:null,session:null},error:R})}return k.session&&(await this._saveSession(k.session),await this._notifyAllSubscribers("SIGNED_IN",k.session)),this._returnResult({data:Object.assign({},k),error:T})}catch(k){if(Ce(k))return this._returnResult({data:{user:null,session:null},error:k});throw k}}async signInWithSolana(e){var a,i,o,u,d,f,m,p,x,b,y,j;let N,k;if("message"in e)N=e.message,k=e.signature;else{const{chain:T,wallet:R,statement:A,options:C}=e;let B;if(cs())if(typeof R=="object")B=R;else{const V=window;if("solana"in V&&typeof V.solana=="object"&&("signIn"in V.solana&&typeof V.solana.signIn=="function"||"signMessage"in V.solana&&typeof V.solana.signMessage=="function"))B=V.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof R!="object"||!C?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");B=R}const F=new URL((a=C?.url)!==null&&a!==void 0?a:window.location.href);if("signIn"in B&&B.signIn){const V=await B.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},C?.signInWithSolana),{version:"1",domain:F.host,uri:F.href}),A?{statement:A}:null));let O;if(Array.isArray(V)&&V[0]&&typeof V[0]=="object")O=V[0];else if(V&&typeof V=="object"&&"signedMessage"in V&&"signature"in V)O=V;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in O&&"signature"in O&&(typeof O.signedMessage=="string"||O.signedMessage instanceof Uint8Array)&&O.signature instanceof Uint8Array)N=typeof O.signedMessage=="string"?O.signedMessage:new TextDecoder().decode(O.signedMessage),k=O.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in B)||typeof B.signMessage!="function"||!("publicKey"in B)||typeof B!="object"||!B.publicKey||!("toBase58"in B.publicKey)||typeof B.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");N=[`${F.host} wants you to sign in with your Solana account:`,B.publicKey.toBase58(),...A?["",A,""]:[""],"Version: 1",`URI: ${F.href}`,`Issued At: ${(o=(i=C?.signInWithSolana)===null||i===void 0?void 0:i.issuedAt)!==null&&o!==void 0?o:new Date().toISOString()}`,...!((u=C?.signInWithSolana)===null||u===void 0)&&u.notBefore?[`Not Before: ${C.signInWithSolana.notBefore}`]:[],...!((d=C?.signInWithSolana)===null||d===void 0)&&d.expirationTime?[`Expiration Time: ${C.signInWithSolana.expirationTime}`]:[],...!((f=C?.signInWithSolana)===null||f===void 0)&&f.chainId?[`Chain ID: ${C.signInWithSolana.chainId}`]:[],...!((m=C?.signInWithSolana)===null||m===void 0)&&m.nonce?[`Nonce: ${C.signInWithSolana.nonce}`]:[],...!((p=C?.signInWithSolana)===null||p===void 0)&&p.requestId?[`Request ID: ${C.signInWithSolana.requestId}`]:[],...!((b=(x=C?.signInWithSolana)===null||x===void 0?void 0:x.resources)===null||b===void 0)&&b.length?["Resources",...C.signInWithSolana.resources.map(O=>`- ${O}`)]:[]].join(`
`);const V=await B.signMessage(new TextEncoder().encode(N),"utf8");if(!V||!(V instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");k=V}}try{const{data:T,error:R}=await Le(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:N,signature:or(k)},!((y=e.options)===null||y===void 0)&&y.captchaToken?{gotrue_meta_security:{captcha_token:(j=e.options)===null||j===void 0?void 0:j.captchaToken}}:null),xform:sn});if(R)throw R;if(!T||!T.session||!T.user){const A=new ni;return this._returnResult({data:{user:null,session:null},error:A})}return T.session&&(await this._saveSession(T.session),await this._notifyAllSubscribers("SIGNED_IN",T.session)),this._returnResult({data:Object.assign({},T),error:R})}catch(T){if(Ce(T))return this._returnResult({data:{user:null,session:null},error:T});throw T}}async _exchangeCodeForSession(e){const a=await sr(this.storage,`${this.storageKey}-code-verifier`),[i,o]=(a??"").split("/");try{if(!i&&this.flowType==="pkce")throw new vE;const{data:u,error:d}=await Le(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:i},xform:sn});if(await os(this.storage,`${this.storageKey}-code-verifier`),d)throw d;if(!u||!u.session||!u.user){const f=new ni;return this._returnResult({data:{user:null,session:null,redirectType:null},error:f})}return u.session&&(await this._saveSession(u.session),await this._notifyAllSubscribers("SIGNED_IN",u.session)),this._returnResult({data:Object.assign(Object.assign({},u),{redirectType:o??null}),error:d})}catch(u){if(await os(this.storage,`${this.storageKey}-code-verifier`),Ce(u))return this._returnResult({data:{user:null,session:null,redirectType:null},error:u});throw u}}async signInWithIdToken(e){try{const{options:a,provider:i,token:o,access_token:u,nonce:d}=e,f=await Le(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:i,id_token:o,access_token:u,nonce:d,gotrue_meta_security:{captcha_token:a?.captchaToken}},xform:sn}),{data:m,error:p}=f;if(p)return this._returnResult({data:{user:null,session:null},error:p});if(!m||!m.session||!m.user){const x=new ni;return this._returnResult({data:{user:null,session:null},error:x})}return m.session&&(await this._saveSession(m.session),await this._notifyAllSubscribers("SIGNED_IN",m.session)),this._returnResult({data:m,error:p})}catch(a){if(Ce(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithOtp(e){var a,i,o,u,d;try{if("email"in e){const{email:f,options:m}=e;let p=null,x=null;this.flowType==="pkce"&&([p,x]=await ai(this.storage,this.storageKey));const{error:b}=await Le(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:f,data:(a=m?.data)!==null&&a!==void 0?a:{},create_user:(i=m?.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:m?.captchaToken},code_challenge:p,code_challenge_method:x},redirectTo:m?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:b})}if("phone"in e){const{phone:f,options:m}=e,{data:p,error:x}=await Le(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:f,data:(o=m?.data)!==null&&o!==void 0?o:{},create_user:(u=m?.shouldCreateUser)!==null&&u!==void 0?u:!0,gotrue_meta_security:{captcha_token:m?.captchaToken},channel:(d=m?.channel)!==null&&d!==void 0?d:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:p?.message_id},error:x})}throw new wc("You must provide either an email or phone number.")}catch(f){if(await os(this.storage,`${this.storageKey}-code-verifier`),Ce(f))return this._returnResult({data:{user:null,session:null},error:f});throw f}}async verifyOtp(e){var a,i;try{let o,u;"options"in e&&(o=(a=e.options)===null||a===void 0?void 0:a.redirectTo,u=(i=e.options)===null||i===void 0?void 0:i.captchaToken);const{data:d,error:f}=await Le(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:u}}),redirectTo:o,xform:sn});if(f)throw f;if(!d)throw new Error("An error occurred on token verification.");const m=d.session,p=d.user;return m?.access_token&&(await this._saveSession(m),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",m)),this._returnResult({data:{user:p,session:m},error:null})}catch(o){if(Ce(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}}async signInWithSSO(e){var a,i,o,u,d;try{let f=null,m=null;this.flowType==="pkce"&&([f,m]=await ai(this.storage,this.storageKey));const p=await Le(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(i=(a=e.options)===null||a===void 0?void 0:a.redirectTo)!==null&&i!==void 0?i:void 0}),!((o=e?.options)===null||o===void 0)&&o.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:f,code_challenge_method:m}),headers:this.headers,xform:GE});return!((u=p.data)===null||u===void 0)&&u.url&&cs()&&!(!((d=e.options)===null||d===void 0)&&d.skipBrowserRedirect)&&window.location.assign(p.data.url),this._returnResult(p)}catch(f){if(await os(this.storage,`${this.storageKey}-code-verifier`),Ce(f))return this._returnResult({data:null,error:f});throw f}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:a},error:i}=e;if(i)throw i;if(!a)throw new Us;const{error:o}=await Le(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:a.access_token});return this._returnResult({data:{user:null,session:null},error:o})})}catch(e){if(Ce(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const a=`${this.url}/resend`;if("email"in e){const{email:i,type:o,options:u}=e,{error:d}=await Le(this.fetch,"POST",a,{headers:this.headers,body:{email:i,type:o,gotrue_meta_security:{captcha_token:u?.captchaToken}},redirectTo:u?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:d})}else if("phone"in e){const{phone:i,type:o,options:u}=e,{data:d,error:f}=await Le(this.fetch,"POST",a,{headers:this.headers,body:{phone:i,type:o,gotrue_meta_security:{captcha_token:u?.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:d?.message_id},error:f})}throw new wc("You must provide either an email or phone number and a type")}catch(a){if(Ce(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async a=>a))}async _acquireLock(e,a){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const i=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),o=(async()=>(await i,await a()))();return this.pendingInLock.push((async()=>{try{await o}catch{}})()),o}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const i=a();for(this.pendingInLock.push((async()=>{try{await i}catch{}})()),await i;this.pendingInLock.length;){const o=[...this.pendingInLock];await Promise.all(o),this.pendingInLock.splice(0,o.length)}return await i}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const a=await this.__loadSession();return await e(a)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const a=await sr(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",a),a!==null&&(this._isValidSession(a)?e=a:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const i=e.expires_at?e.expires_at*1e3-Date.now()<Ah:!1;if(this._debug("#__loadSession()",`session has${i?"":" not"} expired`,"expires_at",e.expires_at),!i){if(this.userStorage){const d=await sr(this.userStorage,this.storageKey+"-user");d?.user?e.user=d.user:e.user=Oh()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const d={value:this.suppressGetSessionWarning};e.user=VE(e.user,d),d.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:o,error:u}=await this._callRefreshToken(e.refresh_token);return u?this._returnResult({data:{session:null},error:u}):this._returnResult({data:{session:o},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;const a=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return a.data.user&&(this.suppressGetSessionWarning=!0),a}async _getUser(e){try{return e?await Le(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Ta}):await this._useSession(async a=>{var i,o,u;const{data:d,error:f}=a;if(f)throw f;return!(!((i=d.session)===null||i===void 0)&&i.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Us}:await Le(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(u=(o=d.session)===null||o===void 0?void 0:o.access_token)!==null&&u!==void 0?u:void 0,xform:Ta})})}catch(a){if(Ce(a))return bE(a)&&(await this._removeSession(),await os(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:a});throw a}}async updateUser(e,a={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(e,a))}async _updateUser(e,a={}){try{return await this._useSession(async i=>{const{data:o,error:u}=i;if(u)throw u;if(!o.session)throw new Us;const d=o.session;let f=null,m=null;this.flowType==="pkce"&&e.email!=null&&([f,m]=await ai(this.storage,this.storageKey));const{data:p,error:x}=await Le(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:a?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:f,code_challenge_method:m}),jwt:d.access_token,xform:Ta});if(x)throw x;return d.user=p.user,await this._saveSession(d),await this._notifyAllSubscribers("USER_UPDATED",d),this._returnResult({data:{user:d.user},error:null})})}catch(i){if(await os(this.storage,`${this.storageKey}-code-verifier`),Ce(i))return this._returnResult({data:{user:null},error:i});throw i}}async setSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Us;const a=Date.now()/1e3;let i=a,o=!0,u=null;const{payload:d}=Dh(e.access_token);if(d.exp&&(i=d.exp,o=i<=a),o){const{data:f,error:m}=await this._callRefreshToken(e.refresh_token);if(m)return this._returnResult({data:{user:null,session:null},error:m});if(!f)return{data:{user:null,session:null},error:null};u=f}else{const{data:f,error:m}=await this._getUser(e.access_token);if(m)throw m;u={access_token:e.access_token,refresh_token:e.refresh_token,user:f.user,token_type:"bearer",expires_in:i-a,expires_at:i},await this._saveSession(u),await this._notifyAllSubscribers("SIGNED_IN",u)}return this._returnResult({data:{user:u.user,session:u},error:null})}catch(a){if(Ce(a))return this._returnResult({data:{session:null,user:null},error:a});throw a}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async a=>{var i;if(!e){const{data:d,error:f}=a;if(f)throw f;e=(i=d.session)!==null&&i!==void 0?i:void 0}if(!e?.refresh_token)throw new Us;const{data:o,error:u}=await this._callRefreshToken(e.refresh_token);return u?this._returnResult({data:{user:null,session:null},error:u}):o?this._returnResult({data:{user:o.user,session:o},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(a){if(Ce(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async _getSessionFromURL(e,a){try{if(!cs())throw new jc("No browser detected.");if(e.error||e.error_description||e.error_code)throw new jc(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(a){case"implicit":if(this.flowType==="pkce")throw new ub("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new jc("Not a valid implicit grant flow url.");break;default:}if(a==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new ub("No code detected.");const{data:A,error:C}=await this._exchangeCodeForSession(e.code);if(C)throw C;const B=new URL(window.location.href);return B.searchParams.delete("code"),window.history.replaceState(window.history.state,"",B.toString()),{data:{session:A.session,redirectType:null},error:null}}const{provider_token:i,provider_refresh_token:o,access_token:u,refresh_token:d,expires_in:f,expires_at:m,token_type:p}=e;if(!u||!f||!d||!p)throw new jc("No session defined in URL");const x=Math.round(Date.now()/1e3),b=parseInt(f);let y=x+b;m&&(y=parseInt(m));const j=y-x;j*1e3<=ci&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${j}s, should have been closer to ${b}s`);const N=y-b;x-N>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",N,y,x):x-N<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",N,y,x);const{data:k,error:T}=await this._getUser(u);if(T)throw T;const R={provider_token:i,provider_refresh_token:o,access_token:u,expires_in:b,expires_at:y,refresh_token:d,token_type:p,user:k.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:R,redirectType:e.type},error:null})}catch(i){if(Ce(i))return this._returnResult({data:{session:null,redirectType:null},error:i});throw i}}_isImplicitGrantCallback(e){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),e):!!(e.access_token||e.error_description)}async _isPKCECallback(e){const a=await sr(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&a)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async a=>{var i;const{data:o,error:u}=a;if(u)return this._returnResult({error:u});const d=(i=o.session)===null||i===void 0?void 0:i.access_token;if(d){const{error:f}=await this.admin.signOut(d,e);if(f&&!(xE(f)&&(f.status===404||f.status===401||f.status===403)))return this._returnResult({error:f})}return e!=="others"&&(await this._removeSession(),await os(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const a=TE(),i={id:a,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",a),this.stateChangeEmitters.delete(a)}};return this._debug("#onAuthStateChange()","registered callback with id",a),this.stateChangeEmitters.set(a,i),(async()=>(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(a)})))(),{data:{subscription:i}}}async _emitInitialSession(e){return await this._useSession(async a=>{var i,o;try{const{data:{session:u},error:d}=a;if(d)throw d;await((i=this.stateChangeEmitters.get(e))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",u)),this._debug("INITIAL_SESSION","callback id",e,"session",u)}catch(u){await((o=this.stateChangeEmitters.get(e))===null||o===void 0?void 0:o.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",u),console.error(u)}})}async resetPasswordForEmail(e,a={}){let i=null,o=null;this.flowType==="pkce"&&([i,o]=await ai(this.storage,this.storageKey,!0));try{return await Le(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:i,code_challenge_method:o,gotrue_meta_security:{captcha_token:a.captchaToken}},headers:this.headers,redirectTo:a.redirectTo})}catch(u){if(await os(this.storage,`${this.storageKey}-code-verifier`),Ce(u))return this._returnResult({data:null,error:u});throw u}}async getUserIdentities(){var e;try{const{data:a,error:i}=await this.getUser();if(i)throw i;return this._returnResult({data:{identities:(e=a.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(a){if(Ce(a))return this._returnResult({data:null,error:a});throw a}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var a;try{const{data:i,error:o}=await this._useSession(async u=>{var d,f,m,p,x;const{data:b,error:y}=u;if(y)throw y;const j=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(d=e.options)===null||d===void 0?void 0:d.redirectTo,scopes:(f=e.options)===null||f===void 0?void 0:f.scopes,queryParams:(m=e.options)===null||m===void 0?void 0:m.queryParams,skipBrowserRedirect:!0});return await Le(this.fetch,"GET",j,{headers:this.headers,jwt:(x=(p=b.session)===null||p===void 0?void 0:p.access_token)!==null&&x!==void 0?x:void 0})});if(o)throw o;return cs()&&!(!((a=e.options)===null||a===void 0)&&a.skipBrowserRedirect)&&window.location.assign(i?.url),this._returnResult({data:{provider:e.provider,url:i?.url},error:null})}catch(i){if(Ce(i))return this._returnResult({data:{provider:e.provider,url:null},error:i});throw i}}async linkIdentityIdToken(e){return await this._useSession(async a=>{var i;try{const{error:o,data:{session:u}}=a;if(o)throw o;const{options:d,provider:f,token:m,access_token:p,nonce:x}=e,b=await Le(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(i=u?.access_token)!==null&&i!==void 0?i:void 0,body:{provider:f,id_token:m,access_token:p,nonce:x,link_identity:!0,gotrue_meta_security:{captcha_token:d?.captchaToken}},xform:sn}),{data:y,error:j}=b;return j?this._returnResult({data:{user:null,session:null},error:j}):!y||!y.session||!y.user?this._returnResult({data:{user:null,session:null},error:new ni}):(y.session&&(await this._saveSession(y.session),await this._notifyAllSubscribers("USER_UPDATED",y.session)),this._returnResult({data:y,error:j}))}catch(o){if(await os(this.storage,`${this.storageKey}-code-verifier`),Ce(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}})}async unlinkIdentity(e){try{return await this._useSession(async a=>{var i,o;const{data:u,error:d}=a;if(d)throw d;return await Le(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(o=(i=u.session)===null||i===void 0?void 0:i.access_token)!==null&&o!==void 0?o:void 0})})}catch(a){if(Ce(a))return this._returnResult({data:null,error:a});throw a}}async _refreshAccessToken(e){const a=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(a,"begin");try{const i=Date.now();return await RE(async o=>(o>0&&await AE(200*Math.pow(2,o-1)),this._debug(a,"refreshing attempt",o),await Le(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:sn})),(o,u)=>{const d=200*Math.pow(2,o);return u&&Rh(u)&&Date.now()+d-i<ci})}catch(i){if(this._debug(a,"error",i),Ce(i))return this._returnResult({data:{session:null,user:null},error:i});throw i}finally{this._debug(a,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,a){const i=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:a.redirectTo,scopes:a.scopes,queryParams:a.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",a,"url",i),cs()&&!a.skipBrowserRedirect&&window.location.assign(i),{data:{provider:e,url:i},error:null}}async _recoverAndRefresh(){var e,a;const i="#_recoverAndRefresh()";this._debug(i,"begin");try{const o=await sr(this.storage,this.storageKey);if(o&&this.userStorage){let d=await sr(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!d&&(d={user:o.user},await ui(this.userStorage,this.storageKey+"-user",d)),o.user=(e=d?.user)!==null&&e!==void 0?e:Oh()}else if(o&&!o.user&&!o.user){const d=await sr(this.storage,this.storageKey+"-user");d&&d?.user?(o.user=d.user,await os(this.storage,this.storageKey+"-user"),await ui(this.storage,this.storageKey,o)):o.user=Oh()}if(this._debug(i,"session from storage",o),!this._isValidSession(o)){this._debug(i,"session is not valid"),o!==null&&await this._removeSession();return}const u=((a=o.expires_at)!==null&&a!==void 0?a:1/0)*1e3-Date.now()<Ah;if(this._debug(i,`session has${u?"":" not"} expired with margin of ${Ah}s`),u){if(this.autoRefreshToken&&o.refresh_token){const{error:d}=await this._callRefreshToken(o.refresh_token);d&&(console.error(d),Rh(d)||(this._debug(i,"refresh failed with a non-retryable error, removing the session",d),await this._removeSession()))}}else if(o.user&&o.user.__isUserNotAvailableProxy===!0)try{const{data:d,error:f}=await this._getUser(o.access_token);!f&&d?.user?(o.user=d.user,await this._saveSession(o),await this._notifyAllSubscribers("SIGNED_IN",o)):this._debug(i,"could not get user data, skipping SIGNED_IN notification")}catch(d){console.error("Error getting user data:",d),this._debug(i,"error getting user data, skipping SIGNED_IN notification",d)}else await this._notifyAllSubscribers("SIGNED_IN",o)}catch(o){this._debug(i,"error",o),console.error(o);return}finally{this._debug(i,"end")}}async _callRefreshToken(e){var a,i;if(!e)throw new Us;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const o=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(o,"begin");try{this.refreshingDeferred=new su;const{data:u,error:d}=await this._refreshAccessToken(e);if(d)throw d;if(!u.session)throw new Us;await this._saveSession(u.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",u.session);const f={data:u.session,error:null};return this.refreshingDeferred.resolve(f),f}catch(u){if(this._debug(o,"error",u),Ce(u)){const d={data:null,error:u};return Rh(u)||await this._removeSession(),(a=this.refreshingDeferred)===null||a===void 0||a.resolve(d),d}throw(i=this.refreshingDeferred)===null||i===void 0||i.reject(u),u}finally{this.refreshingDeferred=null,this._debug(o,"end")}}async _notifyAllSubscribers(e,a,i=!0){const o=`#_notifyAllSubscribers(${e})`;this._debug(o,"begin",a,`broadcast = ${i}`);try{this.broadcastChannel&&i&&this.broadcastChannel.postMessage({event:e,session:a});const u=[],d=Array.from(this.stateChangeEmitters.values()).map(async f=>{try{await f.callback(e,a)}catch(m){u.push(m)}});if(await Promise.all(d),u.length>0){for(let f=0;f<u.length;f+=1)console.error(u[f]);throw u[0]}}finally{this._debug(o,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await os(this.storage,`${this.storageKey}-code-verifier`);const a=Object.assign({},e),i=a.user&&a.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!i&&a.user&&await ui(this.userStorage,this.storageKey+"-user",{user:a.user});const o=Object.assign({},a);delete o.user;const u=pb(o);await ui(this.storage,this.storageKey,u)}else{const o=pb(a);await ui(this.storage,this.storageKey,o)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await os(this.storage,this.storageKey),await os(this.storage,this.storageKey+"-code-verifier"),await os(this.storage,this.storageKey+"-user"),this.userStorage&&await os(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&cs()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(a){console.error("removing visibilitychange callback failed",a)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),ci);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e);const a=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=a,a&&typeof a=="object"&&typeof a.unref=="function"?a.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(a)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e);const a=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,a&&clearTimeout(a)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async a=>{const{data:{session:i}}=a;if(!i||!i.refresh_token||!i.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const o=Math.floor((i.expires_at*1e3-e)/ci);this._debug("#_autoRefreshTokenTick()",`access token expires in ${o} ticks, a tick lasts ${ci}ms, refresh threshold is ${pf} ticks`),o<=pf&&await this._callRefreshToken(i.refresh_token)})}catch(a){console.error("Auto refresh tick failed with error. This is likely a transient error.",a)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof Yv)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!cs()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const a=`#_onVisibilityChanged(${e})`;this._debug(a,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{if(document.visibilityState!=="visible"){this._debug(a,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,a,i){const o=[`provider=${encodeURIComponent(a)}`];if(i?.redirectTo&&o.push(`redirect_to=${encodeURIComponent(i.redirectTo)}`),i?.scopes&&o.push(`scopes=${encodeURIComponent(i.scopes)}`),this.flowType==="pkce"){const[u,d]=await ai(this.storage,this.storageKey),f=new URLSearchParams({code_challenge:`${encodeURIComponent(u)}`,code_challenge_method:`${encodeURIComponent(d)}`});o.push(f.toString())}if(i?.queryParams){const u=new URLSearchParams(i.queryParams);o.push(u.toString())}return i?.skipBrowserRedirect&&o.push(`skip_http_redirect=${i.skipBrowserRedirect}`),`${e}?${o.join("&")}`}async _unenroll(e){try{return await this._useSession(async a=>{var i;const{data:o,error:u}=a;return u?this._returnResult({data:null,error:u}):await Le(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(i=o?.session)===null||i===void 0?void 0:i.access_token})})}catch(a){if(Ce(a))return this._returnResult({data:null,error:a});throw a}}async _enroll(e){try{return await this._useSession(async a=>{var i,o;const{data:u,error:d}=a;if(d)return this._returnResult({data:null,error:d});const f=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:m,error:p}=await Le(this.fetch,"POST",`${this.url}/factors`,{body:f,headers:this.headers,jwt:(i=u?.session)===null||i===void 0?void 0:i.access_token});return p?this._returnResult({data:null,error:p}):(e.factorType==="totp"&&m.type==="totp"&&(!((o=m?.totp)===null||o===void 0)&&o.qr_code)&&(m.totp.qr_code=`data:image/svg+xml;utf-8,${m.totp.qr_code}`),this._returnResult({data:m,error:null}))})}catch(a){if(Ce(a))return this._returnResult({data:null,error:a});throw a}}async _verify(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async a=>{var i;const{data:o,error:u}=a;if(u)return this._returnResult({data:null,error:u});const d=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?lC(e.webauthn.credential_response):oC(e.webauthn.credential_response)})}:{code:e.code}),{data:f,error:m}=await Le(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:d,headers:this.headers,jwt:(i=o?.session)===null||i===void 0?void 0:i.access_token});return m?this._returnResult({data:null,error:m}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+f.expires_in},f)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",f),this._returnResult({data:f,error:m}))})}catch(a){if(Ce(a))return this._returnResult({data:null,error:a});throw a}})}async _challenge(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async a=>{var i;const{data:o,error:u}=a;if(u)return this._returnResult({data:null,error:u});const d=await Le(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(i=o?.session)===null||i===void 0?void 0:i.access_token});if(d.error)return d;const{data:f}=d;if(f.type!=="webauthn")return{data:f,error:null};switch(f.webauthn.type){case"create":return{data:Object.assign(Object.assign({},f),{webauthn:Object.assign(Object.assign({},f.webauthn),{credential_options:Object.assign(Object.assign({},f.webauthn.credential_options),{publicKey:rC(f.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},f),{webauthn:Object.assign(Object.assign({},f.webauthn),{credential_options:Object.assign(Object.assign({},f.webauthn.credential_options),{publicKey:iC(f.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(a){if(Ce(a))return this._returnResult({data:null,error:a});throw a}})}async _challengeAndVerify(e){const{data:a,error:i}=await this._challenge({factorId:e.factorId});return i?this._returnResult({data:null,error:i}):await this._verify({factorId:e.factorId,challengeId:a.id,code:e.code})}async _listFactors(){var e;const{data:{user:a},error:i}=await this.getUser();if(i)return{data:null,error:i};const o={all:[],phone:[],totp:[],webauthn:[]};for(const u of(e=a?.factors)!==null&&e!==void 0?e:[])o.all.push(u),u.status==="verified"&&o[u.factor_type].push(u);return{data:o,error:null}}async _getAuthenticatorAssuranceLevel(){var e,a;const{data:{session:i},error:o}=await this.getSession();if(o)return this._returnResult({data:null,error:o});if(!i)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:u}=Dh(i.access_token);let d=null;u.aal&&(d=u.aal);let f=d;((a=(e=i.user.factors)===null||e===void 0?void 0:e.filter(x=>x.status==="verified"))!==null&&a!==void 0?a:[]).length>0&&(f="aal2");const p=u.amr||[];return{data:{currentLevel:d,nextLevel:f,currentAuthenticationMethods:p},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async a=>{const{data:{session:i},error:o}=a;return o?this._returnResult({data:null,error:o}):i?await Le(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:i.access_token,xform:u=>({data:u,error:null})}):this._returnResult({data:null,error:new Us})})}catch(a){if(Ce(a))return this._returnResult({data:null,error:a});throw a}}async _approveAuthorization(e,a){try{return await this._useSession(async i=>{const{data:{session:o},error:u}=i;if(u)return this._returnResult({data:null,error:u});if(!o)return this._returnResult({data:null,error:new Us});const d=await Le(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:o.access_token,body:{action:"approve"},xform:f=>({data:f,error:null})});return d.data&&d.data.redirect_url&&cs()&&!a?.skipBrowserRedirect&&window.location.assign(d.data.redirect_url),d})}catch(i){if(Ce(i))return this._returnResult({data:null,error:i});throw i}}async _denyAuthorization(e,a){try{return await this._useSession(async i=>{const{data:{session:o},error:u}=i;if(u)return this._returnResult({data:null,error:u});if(!o)return this._returnResult({data:null,error:new Us});const d=await Le(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:o.access_token,body:{action:"deny"},xform:f=>({data:f,error:null})});return d.data&&d.data.redirect_url&&cs()&&!a?.skipBrowserRedirect&&window.location.assign(d.data.redirect_url),d})}catch(i){if(Ce(i))return this._returnResult({data:null,error:i});throw i}}async _listOAuthGrants(){try{return await this._useSession(async e=>{const{data:{session:a},error:i}=e;return i?this._returnResult({data:null,error:i}):a?await Le(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:a.access_token,xform:o=>({data:o,error:null})}):this._returnResult({data:null,error:new Us})})}catch(e){if(Ce(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async a=>{const{data:{session:i},error:o}=a;return o?this._returnResult({data:null,error:o}):i?(await Le(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:i.access_token,query:{client_id:e.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new Us})})}catch(a){if(Ce(a))return this._returnResult({data:null,error:a});throw a}}async fetchJwk(e,a={keys:[]}){let i=a.keys.find(f=>f.kid===e);if(i)return i;const o=Date.now();if(i=this.jwks.keys.find(f=>f.kid===e),i&&this.jwks_cached_at+pE>o)return i;const{data:u,error:d}=await Le(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(d)throw d;return!u.keys||u.keys.length===0||(this.jwks=u,this.jwks_cached_at=o,i=u.keys.find(f=>f.kid===e),!i)?null:i}async getClaims(e,a={}){try{let i=e;if(!i){const{data:j,error:N}=await this.getSession();if(N||!j.session)return this._returnResult({data:null,error:N});i=j.session.access_token}const{header:o,payload:u,signature:d,raw:{header:f,payload:m}}=Dh(i);a?.allowExpired||IE(u.exp);const p=!o.alg||o.alg.startsWith("HS")||!o.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(o.kid,a?.keys?{keys:a.keys}:a?.jwks);if(!p){const{error:j}=await this.getUser(i);if(j)throw j;return{data:{claims:u,header:o,signature:d},error:null}}const x=BE(o.alg),b=await crypto.subtle.importKey("jwk",p,x,!0,["verify"]);if(!await crypto.subtle.verify(x,b,d,_E(`${f}.${m}`)))throw new bf("Invalid JWT signature");return{data:{claims:u,header:o,signature:d},error:null}}catch(i){if(Ce(i))return this._returnResult({data:null,error:i});throw i}}}Il.nextInstanceID={};const xC=Il,bC="2.91.1";let vl="";typeof Deno<"u"?vl="deno":typeof document<"u"?vl="web":typeof navigator<"u"&&navigator.product==="ReactNative"?vl="react-native":vl="node";const yC={"X-Client-Info":`supabase-js-${vl}/${bC}`},vC={headers:yC},wC={schema:"public"},jC={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},NC={};function Bl(s){"@babel/helpers - typeof";return Bl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Bl(s)}function SC(s,e){if(Bl(s)!="object"||!s)return s;var a=s[Symbol.toPrimitive];if(a!==void 0){var i=a.call(s,e);if(Bl(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(s)}function _C(s){var e=SC(s,"string");return Bl(e)=="symbol"?e:e+""}function kC(s,e,a){return(e=_C(e))in s?Object.defineProperty(s,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):s[e]=a,s}function jb(s,e){var a=Object.keys(s);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(s);e&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(s,o).enumerable})),a.push.apply(a,i)}return a}function Dt(s){for(var e=1;e<arguments.length;e++){var a=arguments[e]!=null?arguments[e]:{};e%2?jb(Object(a),!0).forEach(function(i){kC(s,i,a[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(a)):jb(Object(a)).forEach(function(i){Object.defineProperty(s,i,Object.getOwnPropertyDescriptor(a,i))})}return s}const TC=s=>s?(...e)=>s(...e):(...e)=>fetch(...e),EC=()=>Headers,CC=(s,e,a)=>{const i=TC(a),o=EC();return async(u,d)=>{var f;const m=(f=await e())!==null&&f!==void 0?f:s;let p=new o(d?.headers);return p.has("apikey")||p.set("apikey",s),p.has("Authorization")||p.set("Authorization",`Bearer ${m}`),i(u,Dt(Dt({},d),{},{headers:p}))}};function AC(s){return s.endsWith("/")?s:s+"/"}function RC(s,e){var a,i;const{db:o,auth:u,realtime:d,global:f}=s,{db:m,auth:p,realtime:x,global:b}=e,y={db:Dt(Dt({},m),o),auth:Dt(Dt({},p),u),realtime:Dt(Dt({},x),d),storage:{},global:Dt(Dt(Dt({},b),f),{},{headers:Dt(Dt({},(a=b?.headers)!==null&&a!==void 0?a:{}),(i=f?.headers)!==null&&i!==void 0?i:{})}),accessToken:async()=>""};return s.accessToken?y.accessToken=s.accessToken:delete y.accessToken,y}function DC(s){const e=s?.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(AC(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var OC=class extends xC{constructor(s){super(s)}},MC=class{constructor(s,e,a){var i,o;this.supabaseUrl=s,this.supabaseKey=e;const u=DC(s);if(!e)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",u),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",u),this.storageUrl=new URL("storage/v1",u),this.functionsUrl=new URL("functions/v1",u);const d=`sb-${u.hostname.split(".")[0]}-auth-token`,f={db:wC,realtime:NC,auth:Dt(Dt({},jC),{},{storageKey:d}),global:vC},m=RC(a??{},f);if(this.storageKey=(i=m.auth.storageKey)!==null&&i!==void 0?i:"",this.headers=(o=m.global.headers)!==null&&o!==void 0?o:{},m.accessToken)this.accessToken=m.accessToken,this.auth=new Proxy({},{get:(x,b)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(b)} is not possible`)}});else{var p;this.auth=this._initSupabaseAuthClient((p=m.auth)!==null&&p!==void 0?p:{},this.headers,m.global.fetch)}this.fetch=CC(e,this._getAccessToken.bind(this),m.global.fetch),this.realtime=this._initRealtimeClient(Dt({headers:this.headers,accessToken:this._getAccessToken.bind(this)},m.realtime)),this.accessToken&&Promise.resolve(this.accessToken()).then(x=>this.realtime.setAuth(x)).catch(x=>console.warn("Failed to set initial Realtime auth token:",x)),this.rest=new fT(new URL("rest/v1",u).href,{headers:this.headers,schema:m.db.schema,fetch:this.fetch}),this.storage=new uE(this.storageUrl.href,this.headers,this.fetch,a?.storage),m.accessToken||this._listenForAuthEvents()}get functions(){return new oT(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(s){return this.rest.from(s)}schema(s){return this.rest.schema(s)}rpc(s,e={},a={head:!1,get:!1,count:void 0}){return this.rest.rpc(s,e,a)}channel(s,e={config:{}}){return this.realtime.channel(s,e)}getChannels(){return this.realtime.getChannels()}removeChannel(s){return this.realtime.removeChannel(s)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var s=this,e,a;if(s.accessToken)return await s.accessToken();const{data:i}=await s.auth.getSession();return(e=(a=i.session)===null||a===void 0?void 0:a.access_token)!==null&&e!==void 0?e:s.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:s,persistSession:e,detectSessionInUrl:a,storage:i,userStorage:o,storageKey:u,flowType:d,lock:f,debug:m,throwOnError:p},x,b){const y={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new OC({url:this.authUrl.href,headers:Dt(Dt({},y),x),storageKey:u,autoRefreshToken:s,persistSession:e,detectSessionInUrl:a,storage:i,userStorage:o,flowType:d,lock:f,debug:m,throwOnError:p,fetch:b,hasCustomAuthorizationHeader:Object.keys(this.headers).some(j=>j.toLowerCase()==="authorization")})}_initRealtimeClient(s){return new AT(this.realtimeUrl.href,Dt(Dt({},s),{},{params:Dt(Dt({},{apikey:this.supabaseKey}),s?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((s,e)=>{this._handleTokenChanged(s,"CLIENT",e?.access_token)})}_handleTokenChanged(s,e,a){(s==="TOKEN_REFRESHED"||s==="SIGNED_IN")&&this.changedAccessToken!==a?(this.changedAccessToken=a,this.realtime.setAuth(a)):s==="SIGNED_OUT"&&(this.realtime.setAuth(),e=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const UC=(s,e,a)=>new MC(s,e,a);function LC(){if(typeof window<"u")return!1;const s=globalThis.process;if(!s)return!1;const e=s.version;if(e==null)return!1;const a=e.match(/^v(\d+)\./);return a?parseInt(a[1],10)<=18:!1}LC()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const PC="https://mdgyxdfbxlnrvvemksck.supabase.co",IC="sb_publishable_ovShhliHWiJQpnpmasb6bCPJg_UV_P9XVo",ce=UC(PC,IC,{auth:{persistSession:!0,autoRefreshToken:!0}});let Uh=null;const Qv=()=>{if(typeof window>"u")return null;const s=window.AudioContext||window.webkitAudioContext;return s?(Uh||(Uh=new s),Uh):null},Zv=()=>{if(typeof window>"u")return;const s=Qv();if(!s)return;const e=async()=>{try{s.state==="suspended"&&await s.resume()}catch{}finally{window.removeEventListener("pointerdown",e),window.removeEventListener("keydown",e)}};window.addEventListener("pointerdown",e,{once:!0}),window.addEventListener("keydown",e,{once:!0})},Wv=async()=>{const s=Qv();if(!s)return!1;try{if(s.state==="suspended")try{await s.resume()}catch(d){console.warn("AudioContext resume failed in playMessageSound:",d)}const e=s.currentTime,a=s.createOscillator(),i=s.createGain();a.type="sine",a.frequency.setValueAtTime(1200,e),i.gain.setValueAtTime(0,e),i.gain.linearRampToValueAtTime(.15,e+.01),i.gain.exponentialRampToValueAtTime(.001,e+.6),a.connect(i),i.connect(s.destination),a.start(e),a.stop(e+.6);const o=s.createOscillator(),u=s.createGain();return o.type="sine",o.frequency.setValueAtTime(2400,e),u.gain.setValueAtTime(0,e),u.gain.linearRampToValueAtTime(.05,e+.01),u.gain.exponentialRampToValueAtTime(.001,e+.3),o.connect(u),u.connect(s.destination),o.start(e),o.stop(e+.3),!0}catch{return!1}};function ew({open:s,status:e,direction:a,callType:i,peerName:o,error:u,muted:d,cameraOff:f,onAccept:m,onReject:p,onEnd:x,onToggleMute:b,onToggleCamera:y,localVideoRef:j,remoteVideoRef:N,remoteAudioRef:k}){if(!s)return null;const T=e==="incoming"?`Incoming ${i==="video"?"video":"audio"} call`:e==="in-call"?`${i==="video"?"Video":"Audio"} call`:"Calling",R=e==="incoming",A=e==="in-call"||e==="connecting"||e==="outgoing",C=i==="video";return r.jsx(Pt,{isOpen:s,onClose:x,title:T,maxWidth:"max-w-lg",children:r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-300",children:[r.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:o??"User"}),r.jsx("div",{className:"mt-1",children:a==="incoming"?"They are calling you.":"Ringing"}),u?r.jsx("div",{className:"mt-2 text-red-600 dark:text-red-400",children:String(u)}):null]}),C?r.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[r.jsx("div",{className:"rounded-lg bg-black/90 aspect-video overflow-hidden",children:r.jsx("video",{ref:N,autoPlay:!0,playsInline:!0,className:"h-full w-full object-cover"})}),r.jsx("div",{className:"rounded-lg bg-black/90 aspect-video overflow-hidden",children:r.jsx("video",{ref:j,autoPlay:!0,muted:!0,playsInline:!0,className:"h-full w-full object-cover"})})]}):r.jsxs("div",{className:"rounded-lg bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-800 p-4 text-sm text-gray-700 dark:text-gray-200",children:["Audio call",r.jsx("audio",{ref:k,autoPlay:!0})]}),r.jsxs("div",{className:"flex items-center justify-center gap-3",children:[R?r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:p,className:"px-4 py-2 rounded-lg bg-gray-100 hover:bg-gray-200 dark:bg-gray-800 dark:hover:bg-gray-700",children:"Decline"}),r.jsx("button",{onClick:m,className:"px-4 py-2 rounded-lg bg-green-600 text-white hover:bg-green-700",children:"Accept"})]}):null,A?r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:b,className:"px-3 py-2 rounded-lg bg-gray-100 hover:bg-gray-200 dark:bg-gray-800 dark:hover:bg-gray-700",title:d?"Unmute":"Mute",children:d?r.jsx(H_,{className:"h-4 w-4"}):r.jsx(F_,{className:"h-4 w-4"})}),C?r.jsx("button",{onClick:y,className:"px-3 py-2 rounded-lg bg-gray-100 hover:bg-gray-200 dark:bg-gray-800 dark:hover:bg-gray-700",title:f?"Turn camera on":"Turn camera off",children:f?r.jsx(Tk,{className:"h-4 w-4"}):r.jsx(Yl,{className:"h-4 w-4"})}):null,r.jsx("button",{onClick:x,className:"px-3 py-2 rounded-lg bg-red-600 text-white hover:bg-red-700",title:"End call",children:r.jsx(J_,{className:"h-4 w-4"})})]}):null]}),r.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Note: Calls require working Supabase Realtime auth; if you still see 401s, signaling will not connect."})]})})}const BC={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:stun1.l.google.com:19302"]}]},xt={idle:"idle",incoming:"incoming",outgoing:"outgoing",connecting:"connecting",inCall:"in-call",ended:"ended"};function tw({currentUserId:s,peerId:e,conversationKey:a,rtcConfig:i}={}){const[o,u]=v.useState(xt.idle),[d,f]=v.useState(null),[m,p]=v.useState(null),[x,b]=v.useState(null),[y,j]=v.useState(null),[N,k]=v.useState(null),[T,R]=v.useState(!1),[A,C]=v.useState(!1),B=v.useRef(xt.idle),F=v.useRef(null),V=v.useRef(null),O=v.useRef(null),H=v.useRef(null),te=v.useRef(null),me=!!(s&&e&&a);v.useEffect(()=>{B.current=o},[o]);const de=v.useMemo(()=>a?`call:${a}`:null,[a]),ye=v.useCallback(()=>{try{const D=V.current;if(D){D.onicecandidate=null,D.ontrack=null,D.onconnectionstatechange=null,D.oniceconnectionstatechange=null;try{D.close()}catch{}}}finally{V.current=null}try{const D=O.current;D&&D.getTracks().forEach(M=>{try{M.stop()}catch{}})}finally{O.current=null,j(null)}try{const D=H.current;D&&D.getTracks().forEach(M=>{try{M.stop()}catch{}})}finally{H.current=null,k(null)}te.current=null,R(!1),C(!1)},[]),Ae=v.useCallback(async(D,M)=>{const I=F.current;if(I)try{await I.send({type:"broadcast",event:D,payload:M})}catch(G){console.warn("Call signal send failed:",D,G)}},[]),Re=v.useCallback(async D=>{if(!navigator?.mediaDevices?.getUserMedia)throw new Error("getUserMedia is not supported in this browser");const M=D==="video"?{audio:!0,video:{width:1280,height:720}}:{audio:!0,video:!1},I=await navigator.mediaDevices.getUserMedia(M);O.current=I,j(I);const G=new MediaStream;return H.current=G,k(G),{stream:I,remote:G}},[]),ze=v.useCallback(async D=>{const M=i??BC,I=new RTCPeerConnection(M);V.current=I,I.onicecandidate=xe=>{xe.candidate&&Ae("ice",{from:s,to:e,candidate:xe.candidate})},I.ontrack=xe=>{const je=H.current;if(!je)return;if(xe.track&&!je.getTracks().some(qe=>qe.id===xe.track.id))try{je.addTrack(xe.track)}catch{}const Se=xe.streams?.[0];Se?.getTracks&&Se.getTracks().forEach(pe=>{if(!je.getTracks().some(Oe=>Oe.id===pe.id))try{je.addTrack(pe)}catch{}}),k(new MediaStream(je.getTracks()))};const G=()=>{const xe=I.connectionState;xe==="connected"&&u(xt.inCall),(xe==="failed"||xe==="disconnected"||xe==="closed")&&(u(xt.ended),ye())};I.onconnectionstatechange=G,I.oniceconnectionstatechange=G;const{stream:ae}=await Re(D);return ae.getTracks().forEach(xe=>{I.addTrack(xe,ae)}),I},[ye,s,Re,e,i,Ae]),J=v.useCallback(async D=>{if(b(null),!me)return b("Call is not ready yet"),{success:!1,error:"Call is not ready yet"};if(o!==xt.idle&&o!==xt.ended)return{success:!1,error:"Already in a call"};try{p("outgoing"),f(D),u(xt.outgoing);const M=await ze(D);u(xt.connecting);const I=await M.createOffer();return await M.setLocalDescription(I),await Ae("offer",{from:s,to:e,callType:D,sdp:I}),{success:!0}}catch(M){return console.error("startCall failed:",M),b(M?.message??String(M)),u(xt.ended),ye(),{success:!1,error:M}}},[ye,s,ze,e,me,Ae,o]),se=v.useCallback(async()=>{if(b(null),!me)return{success:!1,error:"Call is not ready yet"};if(o!==xt.incoming)return{success:!1,error:"No incoming call"};const D=te.current;if(!D?.sdp||!D?.callType)return u(xt.ended),{success:!1,error:"Missing offer payload"};try{p("incoming"),f(D.callType),u(xt.connecting);const M=await ze(D.callType);await M.setRemoteDescription(D.sdp);const I=await M.createAnswer();return await M.setLocalDescription(I),await Ae("answer",{from:s,to:e,sdp:I}),{success:!0}}catch(M){return console.error("acceptCall failed:",M),b(M?.message??String(M)),u(xt.ended),ye(),{success:!1,error:M}}},[ye,s,ze,e,me,Ae,o]),he=v.useCallback(async()=>{me&&o===xt.incoming&&(await Ae("reject",{from:s,to:e}),u(xt.ended),ye())},[ye,s,e,me,Ae,o]),we=v.useCallback(async()=>{me&&o!==xt.idle&&(await Ae("end",{from:s,to:e}),u(xt.ended),ye())},[ye,s,e,me,Ae,o]),K=v.useCallback(()=>{const D=O.current;if(!D)return;const M=!T;D.getAudioTracks().forEach(I=>{I.enabled=!M}),R(M)},[T]),S=v.useCallback(()=>{const D=O.current;if(!D)return;const M=!A;D.getVideoTracks().forEach(I=>{I.enabled=!M}),C(M)},[A]);return v.useEffect(()=>{if(!de||!s)return;const D=ce.channel(de).on("broadcast",{event:"offer"},M=>{const I=M?.payload;if(I&&I.to===s&&I.from===e){if(B.current!==xt.idle&&B.current!==xt.ended){Ae("busy",{from:s,to:e});return}te.current=I,p("incoming"),f(I.callType),u(xt.incoming)}}).on("broadcast",{event:"answer"},async M=>{const I=M?.payload;if(I&&I.to===s&&I.from===e)try{const G=V.current;if(!G)return;await G.setRemoteDescription(I.sdp),u(xt.inCall)}catch(G){console.warn("Failed to apply answer:",G),b(G?.message??String(G)),u(xt.ended),ye()}}).on("broadcast",{event:"ice"},async M=>{const I=M?.payload;if(I&&I.to===s&&I.from===e)try{const G=V.current;if(!G||!I.candidate)return;await G.addIceCandidate(I.candidate)}catch(G){console.warn("Failed to add ICE candidate:",G)}}).on("broadcast",{event:"end"},M=>{const I=M?.payload;I&&I.to===s&&I.from===e&&(u(xt.ended),ye())}).on("broadcast",{event:"reject"},M=>{const I=M?.payload;I&&I.to===s&&I.from===e&&(u(xt.ended),ye())}).on("broadcast",{event:"busy"},M=>{const I=M?.payload;I&&I.to===s&&I.from===e&&(b("User is busy"),u(xt.ended),ye())}).subscribe(M=>{M==="CHANNEL_ERROR"&&console.error("Signaling channel error (check Supabase Realtime auth/401):",de),M==="CLOSED"&&console.warn("Signaling channel closed:",de)});return F.current=D,()=>{try{F.current&&(ce.removeChannel(F.current),F.current=null)}catch{}}},[de,ye,s,e,Ae]),v.useEffect(()=>{u(xt.idle),f(null),p(null),b(null),ye()},[a,e,ye]),{ready:me,status:o,direction:m,callType:d,error:x,localStream:y,remoteStream:N,muted:T,cameraOff:A,startAudioCall:()=>J("audio"),startVideoCall:()=>J("video"),acceptCall:se,rejectCall:he,endCall:we,toggleMute:K,toggleCamera:S}}function zC(){const{currentUser:s,role:e}=gt(),{data:a,sendMessage:i,markAsRead:o,deleteMessageForMe:u,deleteMessageForEveryone:d,getUserById:f,getPresenceForUser:m}=yt(),{showToast:p}=mn(),[x,b]=v.useState(null),[y,j]=v.useState(""),[N,k]=v.useState(""),[T,R]=v.useState(!1),[A,C]=v.useState(!1),[B,F]=v.useState(null),[V,O]=v.useState(!0),H=v.useRef(null),[te,me]=v.useState(!1),de=v.useRef(null),ye=v.useRef(null),Ae=v.useRef(null),Re=v.useRef(0),ze=v.useRef(null),J=v.useRef(null),se=v.useRef(null),he=v.useRef(null);v.useEffect(()=>{Zv()},[]);const we=v.useMemo(()=>!s?.id||!a?[]:(a.messages??[]).filter(le=>le.receiverId===s.id||le.senderId===s.id).sort((le,Ee)=>new Date(le.sentAt)-new Date(Ee.sentAt)),[s,a]),K=v.useMemo(()=>{if(!s)return new Map;const le=new Map;for(const Ee of we){const Ie=Ee.senderId===s.id,ot=Ie?Ee.receiverId:Ee.senderId;if(!le.has(ot)){const ks=f(ot);le.set(ot,{peerId:ot,peer:ks,peerName:ks?.name??"Unknown User",peerRole:ks?.role??"",messages:[],lastMessage:null,unreadCount:0})}const ss=le.get(ot);ss.messages.push(Ee),ss.lastMessage=Ee,!Ie&&!Ee.readAt&&ss.unreadCount++}return le},[we,s,f]),S=v.useMemo(()=>{const le=Array.from(K.values());return(y.trim()?le.filter(Ie=>Ie.peerName.toLowerCase().includes(y.toLowerCase())):le).sort((Ie,ot)=>{const ss=Ie.lastMessage?new Date(Ie.lastMessage.sentAt):new Date(0);return(ot.lastMessage?new Date(ot.lastMessage.sentAt):new Date(0))-ss})},[K,y]),D=v.useMemo(()=>x?K.get(x)||{peerId:x,peer:f(x),peerName:f(x)?.name??"User",peerRole:f(x)?.role??"",messages:[],unreadCount:0}:null,[K,x,f]),M=v.useMemo(()=>{if(!a||!e)return[];if(e==="coach"){const le=(a.programs??[]).filter(Ie=>Ie.coachIds.includes(s?.id)).map(Ie=>Ie.id),Ee=new Set((a.programs??[]).filter(Ie=>le.includes(Ie.id)).flatMap(Ie=>Ie.participantStudentIds));return(a.users??[]).filter(Ie=>Ie.role==="student"&&Ee.has(Ie.id))}return[]},[a,e,s]);v.useEffect(()=>{H.current&&H.current.scrollIntoView({behavior:"smooth"})},[D?.messages,te]),v.useEffect(()=>{if(x&&s&&D){const le=D.messages.filter(Ee=>Ee.receiverId===s.id&&!Ee.readAt).map(Ee=>Ee.id);le.length>0&&o({messageIds:le})}},[x,D,s,o]),v.useEffect(()=>{const le=D?.messages??[];if(le.length===0)return;const Ee=le[le.length-1];if(ze.current===null){ze.current=Ee.id;return}Ee.id!==ze.current&&(ze.current=Ee.id,Ee.senderId===x&&Wv().catch(Ie=>console.warn("Sound play failed",Ie)))},[D,x]);const I=v.useMemo(()=>{if(!s?.id||!x)return null;const le=String(s.id),Ee=String(x);return le<Ee?`${le}:${Ee}`:`${Ee}:${le}`},[s?.id,x]),G=tw({currentUserId:s?.id,peerId:x,conversationKey:I});v.useEffect(()=>{if(J.current)try{J.current.srcObject=G.localStream??null}catch{}},[G.localStream]),v.useEffect(()=>{if(se.current)try{se.current.srcObject=G.remoteStream??null}catch{}if(he.current)try{he.current.srcObject=G.remoteStream??null}catch{}},[G.remoteStream]);const ae=async()=>G.status==="incoming"?G.rejectCall():G.endCall(),xe=async()=>{(await G.startAudioCall())?.success||p("Call failed (check mic permission / Supabase auth)","error")},je=async()=>{(await G.startVideoCall())?.success||p("Call failed (check camera permission / Supabase auth)","error")};v.useEffect(()=>{if(Promise.resolve().then(()=>me(!1)),de.current&&(ce.removeChannel(de.current),de.current=null),!I||!x)return;const le=ce.channel(`typing:${I}`).on("broadcast",{event:"typing"},Ee=>{const Ie=Ee?.payload?.from,ot=!!Ee?.payload?.isTyping;!Ie||Ie!==x||(me(ot),ye.current&&window.clearTimeout(ye.current),ot&&(ye.current=window.setTimeout(()=>me(!1),5e3)))}).subscribe();return de.current=le,()=>{ce.removeChannel(le),ye.current&&window.clearTimeout(ye.current),Ae.current&&window.clearTimeout(Ae.current)}},[I,x]);const Se=async le=>{if(le?.preventDefault(),!N.trim()||!x)return;const Ee=N;k("");try{await i({senderId:s.id,receiverId:x,content:Ee,subject:"Message"}),I&&de.current&&(de.current.send({type:"broadcast",event:"typing",payload:{from:s.id,isTyping:!1}}),Re.current=0)}catch{p("Failed to send message","error"),k(Ee)}},pe=le=>{if(k(le.target.value),!I||!de.current)return;const Ee=Date.now();Ae.current&&clearTimeout(Ae.current),Ee-Re.current>2e3&&(de.current.send({type:"broadcast",event:"typing",payload:{from:s.id,isTyping:!0}}),Re.current=Ee),Ae.current=setTimeout(()=>{de.current?.send({type:"broadcast",event:"typing",payload:{from:s.id,isTyping:!1}}),Re.current=0},1500)},qe={recipientId:"",message:""},[Oe,Xe]=v.useState(qe),vt=async()=>{if(!Oe.recipientId)return p("Select a recipient","error");if(!Oe.message.trim())return p("Enter a message","error");try{await i({senderId:s.id,receiverId:Oe.recipientId,content:Oe.message,subject:"New Conversation"}),R(!1),b(Oe.recipientId),Xe(qe)}catch{p("Failed to start conversation","error")}};if(!s)return null;const fe=x?m(x):null,ve=le=>{le?.id&&(F({id:le.id,isMe:le.senderId===s?.id}),C(!0))};return r.jsxs("div",{className:"h-[calc(100vh-6rem)] w-full bg-slate-50 flex font-sans overflow-hidden",children:[r.jsxs("div",{className:"w-80 border-r border-slate-200 flex flex-col bg-white z-10",children:[r.jsxs("div",{className:"p-4 border-b border-slate-100",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("h2",{className:"text-2xl font-heading font-bold text-slate-900",children:"Inbox"}),r.jsx("button",{onClick:()=>R(!0),className:"p-2 bg-emerald-50 text-emerald-600 rounded-lg hover:bg-emerald-100 transition-colors",children:r.jsx(Yn,{className:"h-5 w-5"})})]}),r.jsxs("div",{className:"relative",children:[r.jsx(Zn,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400"}),r.jsx("input",{type:"text",placeholder:"Search students...",className:"w-full pl-9 pr-4 py-2.5 bg-slate-50 border border-slate-200 rounded-lg text-sm focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 transition-all text-slate-900 placeholder:text-slate-400",value:y,onChange:le=>j(le.target.value)})]})]}),r.jsx("div",{className:"flex-1 overflow-y-auto",children:S.length===0?r.jsxs("div",{className:"p-8 text-center text-slate-400 flex flex-col items-center",children:[r.jsx(fr,{className:"h-12 w-12 mb-2 opacity-10"}),r.jsx("p",{className:"text-sm",children:"No conversations"})]}):S.map(le=>r.jsxs("button",{onClick:()=>b(le.peerId),className:it("w-full p-4 flex items-center gap-3 hover:bg-slate-50 transition-colors border-l-4 text-left",x===le.peerId?"bg-emerald-50/50 border-emerald-500":"border-transparent"),children:[r.jsxs("div",{className:"relative shrink-0",children:[r.jsx("div",{className:it("w-12 h-12 rounded-full flex items-center justify-center text-white font-heading font-bold text-lg shadow-sm border-2 border-white",le.peerRole==="student"?"bg-indigo-500":"bg-slate-500"),children:le.peerName.charAt(0)}),m(le.peerId)?.online&&r.jsx("div",{className:"absolute bottom-0 right-0 w-3 h-3 bg-emerald-500 border-2 border-white rounded-full"})]}),r.jsxs("div",{className:"min-w-0 flex-1",children:[r.jsxs("div",{className:"flex justify-between items-baseline mb-1",children:[r.jsx("span",{className:it("font-semibold truncate",x===le.peerId?"text-emerald-900":"text-slate-900"),children:le.peerName}),le.lastMessage&&r.jsx("span",{className:"text-[10px] text-slate-400 shrink-0 font-medium",children:ms(le.lastMessage.sentAt).split(",")[0]})]}),r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("p",{className:it("text-sm truncate max-w-[140px]",le.unreadCount>0?"font-semibold text-slate-800":"text-slate-500"),children:le.lastMessage?.content??"No messages"}),le.unreadCount>0&&r.jsx("span",{className:"bg-emerald-500 text-white text-[10px] h-5 min-w-[20px] px-1.5 rounded-full flex items-center justify-center font-bold shadow-sm",children:le.unreadCount>9?"9+":le.unreadCount})]})]})]},le.peerId))})]}),r.jsx("div",{className:"flex-1 flex flex-col bg-white relative",children:x?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"h-16 px-6 border-b border-slate-100 flex items-center justify-between shrink-0 bg-white/80 backdrop-blur-sm sticky top-0 z-10",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"relative",children:r.jsx("div",{className:it("w-10 h-10 rounded-full flex items-center justify-center text-white font-heading font-bold shadow-sm",D?.peerRole==="student"?"bg-indigo-500":"bg-slate-500"),children:D?.peerName.charAt(0)})}),r.jsxs("div",{children:[r.jsx("h3",{className:"font-heading font-bold text-slate-900 leading-none",children:D?.peerName}),r.jsx("div",{className:"text-xs text-slate-500 mt-1 flex items-center gap-1.5",children:fe?.online?r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-emerald-500"}),r.jsx("span",{className:"font-medium text-emerald-600",children:"Online"})]}):fe?.lastSeenAt?r.jsxs("span",{children:["Last seen ",new Date(fe.lastSeenAt).toLocaleString()]}):r.jsx("span",{className:"uppercase tracking-wider text-[10px]",children:D?.peerRole})})]})]}),r.jsxs("div",{className:"flex items-center gap-3 text-slate-400",children:[r.jsx("button",{onClick:()=>O(!V),className:it("p-2 rounded-lg transition-colors",V?"bg-slate-100 text-slate-800":"hover:bg-slate-100"),title:"Toggle Info",children:r.jsx(A_,{className:"h-5 w-5"})}),r.jsx("div",{className:"h-4 w-px bg-slate-200 mx-1"}),r.jsx("button",{type:"button",onClick:xe,className:"p-2 hover:bg-slate-100 rounded-lg transition-colors",title:"Audio call",children:r.jsx(bv,{className:"h-5 w-5"})}),r.jsx("button",{type:"button",onClick:je,className:"p-2 hover:bg-slate-100 rounded-lg transition-colors",title:"Video call",children:r.jsx(Yl,{className:"h-5 w-5"})}),r.jsx("button",{className:"p-2 hover:bg-slate-100 rounded-lg transition-colors",children:r.jsx(Rl,{className:"h-5 w-5"})})]})]}),r.jsx("div",{className:"flex-1 overflow-y-auto p-6 bg-slate-50/50",children:r.jsxs("div",{className:"flex flex-col gap-4 max-w-3xl mx-auto",children:[D.messages.map((le,Ee)=>{const Ie=le.senderId===s.id,ot=!Ie&&(Ee===0||D.messages[Ee-1].senderId!==le.senderId),ss=!!le.readAt;return r.jsxs("div",{className:it("flex w-full items-end gap-2 group",Ie?"justify-end":"justify-start"),children:[!Ie&&r.jsx("div",{className:"w-8 h-8 shrink-0 mb-1",children:ot&&r.jsx("div",{className:it("w-8 h-8 rounded-full flex items-center justify-center text-white text-xs font-bold",D?.peerRole==="student"?"bg-indigo-500":"bg-slate-500"),children:D?.peerName.charAt(0)})}),r.jsxs("div",{className:it("max-w-[75%] px-4 py-2.5 rounded-2xl shadow-sm text-sm leading-relaxed relative pr-12 group/bubble transition-all",Ie?"bg-emerald-600 text-white rounded-br-sm":"bg-white text-slate-800 border border-slate-100 rounded-bl-sm"),children:[r.jsx("div",{className:"break-words font-normal whitespace-pre-wrap",children:le.content}),r.jsxs("div",{className:it("text-[10px] mt-1 text-right flex items-center justify-end gap-1 select-none",Ie?"text-emerald-100/90":"text-slate-400"),children:[new Date(le.sentAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),Ie&&(ss?r.jsx("div",{className:"flex items-center gap-0.5",title:`Seen at ${new Date(le.readAt).toLocaleTimeString()}`,children:r.jsx(Lc,{className:"h-3.5 w-3.5 text-emerald-200"})}):r.jsx(hv,{className:"h-3.5 w-3.5 text-emerald-200/70"}))]}),r.jsx("button",{type:"button",onClick:ks=>{ks.stopPropagation(),ve(le)},className:it("absolute top-1 right-1 opacity-0 group-hover/bubble:opacity-100 transition-opacity p-1 rounded-full",Ie?"hover:bg-emerald-700 text-emerald-100":"hover:bg-slate-100 text-slate-400"),title:"Options",children:r.jsx(Rl,{className:"h-3.5 w-3.5"})})]})]},le.id)}),te&&r.jsxs("div",{className:"flex w-full items-end gap-2 justify-start",children:[r.jsx("div",{className:"w-8 h-8 shrink-0 mb-1",children:r.jsx("div",{className:it("w-8 h-8 rounded-full flex items-center justify-center text-white text-xs font-bold",D?.peerRole==="student"?"bg-indigo-500":"bg-slate-500"),children:D?.peerName.charAt(0)})}),r.jsxs("div",{className:"bg-white px-4 py-3 rounded-2xl rounded-bl-none shadow-sm border border-slate-100 flex gap-1 items-center",children:[r.jsx("span",{className:"w-1.5 h-1.5 bg-slate-400 rounded-full animate-bounce"}),r.jsx("span",{className:"w-1.5 h-1.5 bg-slate-400 rounded-full animate-bounce [animation-delay:0.1s]"}),r.jsx("span",{className:"w-1.5 h-1.5 bg-slate-400 rounded-full animate-bounce [animation-delay:0.2s]"})]})]}),r.jsx("div",{ref:H})]})}),r.jsx("div",{className:"p-4 bg-white border-t border-slate-100",children:r.jsxs("div",{className:"max-w-3xl mx-auto flex gap-3 items-end",children:[r.jsx("div",{className:"flex-1 bg-slate-50 rounded-2xl px-4 py-3 focus-within:ring-2 focus-within:ring-emerald-100 focus-within:bg-white transition-all border border-slate-200 focus-within:border-emerald-200",children:r.jsx("form",{onSubmit:Se,children:r.jsx("input",{type:"text",className:"w-full bg-transparent border-none focus:outline-none text-slate-800 placeholder:text-slate-400 text-sm max-h-32",placeholder:`Message ${D?.peerName}...`,value:N,onChange:pe})})}),r.jsx("button",{type:"button",onClick:Se,disabled:!N.trim(),className:"p-3 bg-emerald-600 text-white rounded-xl hover:bg-emerald-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors shadow-sm active:scale-95 flex items-center justify-center",children:r.jsx(yv,{className:"h-5 w-5"})})]})}),r.jsx(ew,{open:G.status!=="idle"&&G.status!=="ended",status:G.status,direction:G.direction,callType:G.callType,peerName:D?.peerName,error:G.error,muted:G.muted,cameraOff:G.cameraOff,onAccept:G.acceptCall,onReject:G.rejectCall,onEnd:ae,onToggleMute:G.toggleMute,onToggleCamera:G.toggleCamera,localVideoRef:J,remoteVideoRef:se,remoteAudioRef:he})]}):r.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center text-slate-300 p-8 bg-slate-50/30",children:[r.jsx("div",{className:"w-24 h-24 bg-white rounded-full flex items-center justify-center mb-4 shadow-sm",children:r.jsx(Ol,{className:"h-10 w-10 text-emerald-200"})}),r.jsx("h3",{className:"text-xl font-heading font-semibold text-slate-900 mb-1",children:"Coach Messenger"}),r.jsx("p",{className:"text-slate-500 text-center max-w-sm text-sm",children:"Select a student communication channel from the sidebar to view history or start a new session."}),r.jsx("button",{onClick:()=>R(!0),className:"mt-8 px-6 py-3 bg-emerald-600 text-white rounded-xl font-semibold hover:bg-emerald-700 transition-colors shadow-lg shadow-emerald-200",children:"New Message"})]})}),x&&V&&r.jsxs("div",{className:"w-72 border-l border-slate-200 bg-white hidden xl:flex flex-col",children:[r.jsxs("div",{className:"p-6 border-b border-slate-100 flex flex-col items-center",children:[r.jsx("div",{className:it("w-20 h-20 rounded-full flex items-center justify-center text-white font-heading font-bold text-3xl mb-3 shadow-md",D?.peerRole==="student"?"bg-indigo-500":"bg-slate-500"),children:D?.peerName.charAt(0)}),r.jsx("h3",{className:"text-lg font-bold text-slate-900",children:D?.peerName}),r.jsx("span",{className:"text-xs font-semibold text-indigo-600 px-2.5 py-0.5 rounded-full bg-indigo-50 mt-1 uppercase tracking-wide",children:D?.peerRole})]}),r.jsx("div",{className:"p-4 flex-1 overflow-y-auto",children:r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{children:[r.jsx("h4",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider mb-3",children:"Quick Actions"}),r.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[r.jsxs("button",{className:"flex flex-col items-center justify-center p-3 rounded-xl bg-slate-50 hover:bg-slate-100 text-slate-600 transition-colors",children:[r.jsx(gs,{className:"h-5 w-5 mb-1 text-slate-400"}),r.jsx("span",{className:"text-xs font-medium",children:"Session"})]}),r.jsxs("button",{className:"flex flex-col items-center justify-center p-3 rounded-xl bg-slate-50 hover:bg-slate-100 text-slate-600 transition-colors",children:[r.jsx(Lc,{className:"h-5 w-5 mb-1 text-slate-400"}),r.jsx("span",{className:"text-xs font-medium",children:"Task"})]})]})]}),r.jsxs("div",{children:[r.jsx("h4",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider mb-2",children:"Student Details"}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"text-sm",children:[r.jsx("p",{className:"text-slate-500 text-xs",children:"Email"}),r.jsx("p",{className:"text-slate-900 font-medium",children:"student@example.com"})]}),r.jsxs("div",{className:"text-sm",children:[r.jsx("p",{className:"text-slate-500 text-xs",children:"Program"}),r.jsx("p",{className:"text-slate-900 font-medium",children:"Full Stack Web Dev"})]}),r.jsxs("div",{className:"text-sm",children:[r.jsx("p",{className:"text-slate-500 text-xs",children:"Progress"}),r.jsx("div",{className:"w-full bg-slate-100 h-2 rounded-full mt-1 overflow-hidden",children:r.jsx("div",{className:"bg-indigo-500 h-full w-[65%]"})}),r.jsx("p",{className:"text-xs text-right mt-0.5 text-slate-400",children:"65%"})]})]})]})]})})]}),T&&r.jsx(Pt,{title:"New Message",onClose:()=>R(!1),footer:r.jsxs(r.Fragment,{children:[r.jsx("button",{className:"btn-ghost",onClick:()=>R(!1),children:"Cancel"}),r.jsx("button",{className:"btn-primary bg-emerald-600 hover:bg-emerald-700 border-emerald-600",onClick:vt,children:"Send Message"})]}),children:r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Recipient"}),r.jsxs("select",{className:"w-full rounded-lg border-slate-200 text-sm focus:ring-emerald-500",value:Oe.recipientId,onChange:le=>Xe({...Oe,recipientId:le.target.value}),children:[r.jsx("option",{value:"",children:"Select a student..."}),M.map(le=>r.jsx("option",{value:le.id,children:le.name},le.id))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Message"}),r.jsx("textarea",{className:"w-full rounded-lg border-slate-200 text-sm focus:ring-emerald-500",rows:4,placeholder:"Type your first message...",value:Oe.message,onChange:le=>Xe({...Oe,message:le.target.value})})]})]})}),r.jsx(Pt,{isOpen:A&&!!B,title:"Delete Message",onClose:()=>{C(!1),F(null)},footer:r.jsxs("div",{className:"flex flex-col gap-2 w-full sm:flex-row sm:justify-end",children:[r.jsx("button",{className:"px-4 py-2 text-slate-600 hover:bg-slate-100 rounded-lg text-sm font-medium transition-colors",onClick:()=>{C(!1),F(null)},children:"Cancel"}),r.jsx("button",{className:"px-4 py-2 text-red-600 bg-red-50 hover:bg-red-100 rounded-lg text-sm font-medium transition-colors",onClick:async()=>{(await u?.({messageId:B.id}))?.success||p("Failed to delete","error"),C(!1),F(null)},children:"Delete for me"}),B?.isMe&&r.jsx("button",{className:"px-4 py-2 bg-red-600 text-white hover:bg-red-700 rounded-lg text-sm font-medium shadow-sm transition-colors",onClick:async()=>{(await d?.({messageId:B.id}))?.success||p("Failed to delete","error"),C(!1),F(null)},children:"Delete for everyone"})]}),children:r.jsxs("div",{className:"text-sm text-slate-600 leading-relaxed",children:["Are you sure you want to delete this message?",B?.isMe&&r.jsx("p",{className:"mt-2 text-xs text-slate-500 bg-slate-50 p-3 rounded-lg border border-slate-100",children:'"Delete for everyone" will remove the message for all participants. "Delete for me" only removes it from your view.'})]})})]})}const VC={[Ze.text]:Nk,[Ze.file]:Kl,[Ze.link]:pv,[Ze.checklist]:Ic};function sw({task:s,primaryAction:e,secondaryAction:a,children:i}){const o=VC[String(s?.taskType??"").toUpperCase()]??Ic;return r.jsx(Ye,{title:r.jsxs("div",{className:"flex items-start gap-3",children:[r.jsx("div",{className:"h-9 w-9 rounded-xl bg-slate-100 flex items-center justify-center text-slate-700 flex-shrink-0",children:r.jsx(o,{className:"h-5 w-5"})}),r.jsxs("div",{className:"min-w-0",children:[r.jsx("div",{className:"font-heading font-bold text-slate-900 truncate",children:s?.title}),r.jsxs("div",{className:"text-xs text-slate-500",children:[Wf(s?.taskType),"  ",em(s?.status)]})]})]}),actions:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Dv,{status:s?.status}),e,a]}),children:r.jsxs("div",{className:"space-y-3",children:[s?.description?r.jsx("div",{className:"text-sm text-slate-700 whitespace-pre-wrap",children:s.description}):r.jsx("div",{className:"text-sm text-slate-500",children:"No description."}),r.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-xs text-slate-500",children:[s?.deadline?r.jsxs("div",{className:"inline-flex items-center gap-1",children:[r.jsx(gs,{className:"h-4 w-4"}),r.jsxs("span",{children:["Deadline: ",ms(s.deadline)]})]}):null,s?.createdAt?r.jsxs("span",{children:["Created: ",ms(s.createdAt)]}):null]}),i]})})}const wn=(s="id")=>{const e=Math.random().toString(16).slice(2),a=Date.now().toString(16);return`${s}_${a}_${e}`},$C=[Ze.text,Ze.file,Ze.link,Ze.checklist];function qC({items:s,onChange:e}){return r.jsxs("div",{className:"space-y-2",children:[r.jsx("div",{className:"text-xs font-bold uppercase tracking-wider text-slate-400",children:"Checklist items"}),(s??[]).map(a=>r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("input",{className:"input flex-1",placeholder:"Checklist item",value:a.text,onChange:i=>{const o=(s??[]).map(u=>u.id===a.id?{...u,text:i.target.value}:u);e(o)}}),r.jsx("button",{type:"button",className:"btn-ghost",onClick:()=>e((s??[]).filter(i=>i.id!==a.id)),title:"Remove item",children:"Remove"})]},a.id)),r.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>e([...s??[],{id:wn("chk"),text:""}]),children:"+ Add item"})]})}function HC({open:s,project:e,submissions:a,onClose:i,onCreate:o}){const[u,d]=v.useState(""),[f,m]=v.useState(""),[p,x]=v.useState(Ze.text),[b,y]=v.useState(""),[j,N]=v.useState(""),[k,T]=v.useState([{id:wn("chk"),text:""}]),[R,A]=v.useState(!1),[C,B]=v.useState(null),F=e?.title??"Project",V=v.useMemo(()=>R||!e?.id?!1:!!String(u).trim(),[R,e?.id,u]),O=()=>{d(""),m(""),x(Ze.text),y(""),N(""),T([{id:wn("chk"),text:""}]),A(!1),B(null)},H=v.useMemo(()=>{if(!b)return null;const de=new Date(b);return Number.isNaN(de.getTime())?null:de.toISOString()},[b]),te=async()=>{if(e?.id){B(null),A(!0);try{await o?.({projectId:e.id,submissionId:j||null,title:u,description:f,taskType:p,deadline:H,checklistItems:p===Ze.checklist?k:null}),O(),i?.()}catch(de){B(de?.message??"Failed to create task")}finally{A(!1)}}},me=Array.isArray(a)?a:[];return r.jsxs(Pt,{open:s,title:`Create Task  ${F}`,onClose:()=>{O(),i?.()},children:[C?r.jsx("div",{className:"mb-4 rounded-xl border border-red-200 bg-red-50 p-4 text-sm text-red-700",children:C}):null,r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-xs font-bold uppercase tracking-wider text-slate-400",children:"Title"}),r.jsx("input",{className:"input mt-1",value:u,onChange:de=>d(de.target.value),placeholder:"Task title"})]}),r.jsxs("div",{children:[r.jsx("div",{className:"text-xs font-bold uppercase tracking-wider text-slate-400",children:"Description"}),r.jsx("textarea",{className:"input mt-1 min-h-[120px]",value:f,onChange:de=>m(de.target.value),placeholder:"Optional details"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-xs font-bold uppercase tracking-wider text-slate-400",children:"Task type"}),r.jsx("select",{className:"input mt-1",value:p,onChange:de=>x(de.target.value),children:$C.map(de=>r.jsx("option",{value:de,children:Wf(de)},de))})]}),r.jsxs("div",{children:[r.jsx("div",{className:"text-xs font-bold uppercase tracking-wider text-slate-400",children:"Deadline"}),r.jsx("input",{className:"input mt-1",type:"datetime-local",value:b,onChange:de=>y(de.target.value)})]})]}),r.jsxs("div",{children:[r.jsx("div",{className:"text-xs font-bold uppercase tracking-wider text-slate-400",children:"Link to submission (optional)"}),r.jsxs("select",{className:"input mt-1",value:j,onChange:de=>N(de.target.value),children:[r.jsx("option",{value:"",children:"None"}),me.map(de=>r.jsxs("option",{value:de.id,children:[de.type,"  ",new Date(de.createdAt).toLocaleString()]},de.id))]})]}),String(p).toUpperCase()===Ze.checklist?r.jsx(qC,{items:k,onChange:T}):null,r.jsxs("div",{className:"flex items-center justify-end gap-2",children:[r.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>i?.(),disabled:R,children:"Cancel"}),r.jsx("button",{type:"button",className:"btn-primary",onClick:te,disabled:!V,children:R?"Creating":"Create Task"})]})]})]})}function GC(){const{currentUser:s}=gt(),{getUserById:e,listProjects:a,listProjectSubmissions:i,listTasks:o,createTask:u,reviewTask:d}=yt(),f=s?.id?a?.({coachId:s.id})??[]:[],[m,p]=v.useState(null),[x,b]=v.useState(!1),y=m&&f.some(C=>C.id===m)?m:f[0]?.id??null,j=y?f.find(C=>C.id===y)??null:null,N=j?.id?o?.({projectId:j.id})??[]:[],k=j?.id?i?.({projectId:j.id})??[]:[],[T,R]=v.useState({}),A=(C,B)=>{R(F=>({...F,[C]:B}))};return r.jsxs("div",{className:"space-y-8 animate-in fade-in duration-500",children:[r.jsxs("div",{className:"flex flex-col md:flex-row md:items-end justify-between gap-4",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-heading font-bold text-slate-900 dark:text-white",children:"Tasks"}),r.jsx("p",{className:"mt-2 text-lg text-slate-500 font-medium",children:"Create tasks per project and review student submissions."})]}),r.jsxs("button",{type:"button",className:"btn-primary",onClick:()=>b(!0),disabled:!j,title:j?"Create a new task":"Select a project first",children:[r.jsx(Yn,{className:"h-4 w-4"}),"Create task"]})]}),f.length===0?r.jsx(Aa,{icon:mr,title:"No projects",message:"Once you have students with projects, you can create tasks here."}):r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[r.jsx("div",{className:"lg:col-span-1",children:r.jsx(Ye,{title:"Projects",children:r.jsx("div",{className:"space-y-2",children:f.map(C=>{const B=j?.id===C.id,F=e?.(C.studentId);return r.jsxs("button",{type:"button",onClick:()=>p(C.id),className:["w-full text-left rounded-xl border p-4 transition-colors",B?"border-coach-primary/30 bg-white":"border-slate-200 bg-white hover:bg-slate-50"].join(" "),children:[r.jsxs("div",{className:"flex items-center justify-between gap-3",children:[r.jsx("div",{className:"font-heading font-bold text-slate-900 truncate",children:C.title}),r.jsx("div",{className:"text-xs font-bold uppercase tracking-wider text-slate-500",children:C.stage})]}),r.jsxs("div",{className:"mt-1 text-xs text-slate-500 truncate",children:["Student: ",F?.name??"Student"]})]},C.id)})})})}),r.jsx("div",{className:"lg:col-span-3",children:j?r.jsx(Ye,{title:j.title,subtitle:`Student: ${e?.(j.studentId)?.name??"Student"}  Stage: ${j.stage}`,children:N.length===0?r.jsx(Aa,{icon:Yn,title:"No tasks for this project",message:"Create the first task to guide the student through the project.",action:r.jsxs("button",{type:"button",className:"btn-primary",onClick:()=>b(!0),children:[r.jsx(Yn,{className:"h-4 w-4"}),"Create task"]})}):r.jsx("div",{className:"space-y-4",children:N.map(C=>{const B=Yk(C.status),F=T[C.id]??C.coachFeedback??"";return r.jsx(sw,{task:C,primaryAction:B?r.jsxs("button",{type:"button",className:"btn-primary",onClick:async()=>{await d?.({taskId:C.id,status:Xt.approved,feedback:F})},children:[r.jsx(nf,{className:"h-4 w-4"}),"Approve"]}):null,secondaryAction:B?r.jsxs("button",{type:"button",className:"btn-secondary",onClick:async()=>{await d?.({taskId:C.id,status:Xt.revision,feedback:F})},children:[r.jsx(sk,{className:"h-4 w-4"}),"Revision"]}):null,children:r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"rounded-xl border border-slate-200 bg-slate-50 p-4",children:[r.jsx("div",{className:"text-xs font-bold uppercase tracking-wider text-slate-400",children:"Student submission"}),r.jsx("div",{className:"mt-2 text-sm text-slate-700",children:C.studentSubmission?"Submitted":"Not submitted yet."})]}),r.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white p-4",children:[r.jsx("div",{className:"text-xs font-bold uppercase tracking-wider text-slate-400",children:"Coach feedback"}),r.jsx("textarea",{className:"input mt-2 min-h-[88px]",placeholder:"Optional feedback",value:F,onChange:V=>A(C.id,V.target.value)}),r.jsx("div",{className:"mt-2 text-xs text-slate-500",children:"Actions enabled when status is SUBMITTED."})]})]})},C.id)})})}):r.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white p-6 text-sm text-slate-500",children:"Select a project to manage tasks."})})]}),r.jsx(HC,{open:x,project:j,submissions:k,onClose:()=>b(!1),onCreate:async C=>{await u?.(C)}})]})}const Lh=["Ideation","Validation","MVP","Growth"],Ph={u_student_1:{name:"EcoEat",phaseIndex:2,nextMilestone:"Prototype Demo"},u_student_2:{name:"FinHacks",phaseIndex:1,nextMilestone:"Customer Interviews"},default:{name:"New Venture",phaseIndex:0,nextMilestone:"Problem Statement"}};function FC(){const{currentUser:s}=gt(),{data:e}=yt(),a=_n(),i=v.useMemo(()=>{if(!s?.id||!e)return null;const x=(e.users??[]).find(N=>N.id===s.id)??null,b=Ph[s.id]||Ph[x?.id]||Ph.default,y=Lh[b.phaseIndex],j=(b.phaseIndex+.5)/Lh.length*100;return{student:x,project:b,phaseName:y,progressPercent:j}},[s,e]),o=v.useMemo(()=>{if(!s?.id||!e)return[];const x=[],b=new Date,y=new Date(b.getTime()+2880*60*1e3);return(e.coachingSessions??[]).filter(k=>(k.attendeeStudentIds??[]).includes(s.id)).filter(k=>{const T=new Date(k.startsAt);return T>=b&&T<=y}).slice(0,1).forEach(k=>{x.push({id:k.id,type:"session",title:`Coaching Session: ${k.title}`,time:k.startsAt,icon:gs,actionLabel:"Join Room",actionUrl:"/student/sessions"})}),(e.deliverables??[]).filter(k=>(k.assignedStudentIds??[]).includes(s.id)).filter(k=>(k.submissions??[]).find(A=>A.studentId===s.id)?!1:new Date(k.dueDate)<=y).slice(0,2).forEach(k=>{x.push({id:k.id,type:"deliverable",title:`Submit: ${k.title}`,time:k.dueDate,icon:nf,actionLabel:"Complete",actionUrl:"/student/deliverables"})}),x.length===0&&x.push({id:"default-1",type:"review",title:"Review your project plan",time:null,icon:Nv,actionLabel:"View Project",actionUrl:"/student/programs"}),x.sort((k,T)=>k.time&&T.time?new Date(k.time)-new Date(T.time):0)},[s,e]),u=v.useMemo(()=>{if(!s?.id||!e)return null;const x=e.users??[],y=(e.messages??[]).filter(N=>N.receiverId===s.id).sort((N,k)=>new Date(k.sentAt)-new Date(N.sentAt)).find(N=>x.find(T=>T.id===N.senderId)?.role==="coach");if(!y)return null;const j=x.find(N=>N.id===y.senderId);return{id:y.id,senderName:j?.name||"Coach",senderAvatar:(j?.name||"C").charAt(0),text:y.content??"",time:y.sentAt,isRead:!!y.readAt}},[s,e]);if(!i)return r.jsx("div",{className:"flex items-center justify-center py-12",children:r.jsx("div",{className:"text-muted-foreground",children:"Loading dashboard"})});const{student:d,project:f,phaseName:m}=i,p=(d?.name||s?.name||"Student").split(" ")[0];return r.jsxs("div",{className:"space-y-8 animate-in fade-in slide-in-from-bottom-5 duration-500",children:[r.jsxs("header",{className:"relative overflow-hidden rounded-3xl bg-gradient-to-br from-student-primary to-blue-600 px-8 py-10 shadow-xl text-white",children:[r.jsxs("div",{className:"relative z-10",children:[r.jsxs("h1",{className:"text-4xl font-heading font-bold tracking-tight mb-3",children:["Hello, ",p,". "]}),r.jsxs("p",{className:"text-lg text-blue-50 font-medium max-w-xl leading-relaxed",children:["You're making solid progress on ",r.jsx("span",{className:"font-bold text-white bg-white/20 px-2 py-0.5 rounded-lg",children:f.name}),". Let's continue pushing the boundaries today."]}),r.jsx("div",{className:"mt-8 flex items-center gap-4",children:r.jsxs("div",{className:"inline-flex items-center gap-2 rounded-xl bg-white/10 border border-white/20 px-4 py-2backdrop-blur-sm",children:[r.jsx("span",{className:"text-xs font-bold uppercase tracking-wider text-blue-100",children:"Current Phase"}),r.jsx("span",{className:"font-heading font-bold",children:m})]})})]}),r.jsx("div",{className:"absolute top-0 right-0 -mr-20 -mt-20 h-96 w-96 rounded-full bg-white/10 blur-3xl pointer-events-none"}),r.jsx("div",{className:"absolute bottom-0 left-0 -ml-20 -mb-20 h-64 w-64 rounded-full bg-white/10 blur-3xl pointer-events-none"})]}),r.jsxs("div",{className:"grid gap-8 md:grid-cols-5",children:[r.jsxs("div",{className:"md:col-span-3 space-y-8",children:[r.jsxs("section",{children:[r.jsxs("div",{className:"mb-5 flex items-center justify-between",children:[r.jsxs("h2",{className:"text-xl font-heading font-bold text-slate-800 flex items-center gap-2",children:[r.jsx(nf,{className:"h-5 w-5 text-student-primary"}),"Priority Tasks"]}),r.jsx("span",{className:"text-xs font-bold uppercase tracking-wider text-slate-400 bg-slate-100 px-3 py-1 rounded-full",children:new Date().toLocaleDateString(void 0,{weekday:"short",day:"numeric"})})]}),r.jsx("div",{className:"space-y-4",children:o.map(x=>{const b=x.icon;return r.jsxs("div",{className:"group relative flex items-center gap-5 rounded-2xl bg-white p-5 shadow-sm border border-slate-100 transition-all hover:shadow-lg hover:border-student-primary/30 hover:-translate-y-0.5 px-6",children:[r.jsx("div",{className:`flex h-14 w-14 shrink-0 items-center justify-center rounded-2xl shadow-inner ${x.type==="session"?"bg-blue-50 text-blue-600":"bg-emerald-50 text-emerald-600"}`,children:r.jsx(b,{className:"h-7 w-7"})}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[r.jsx("span",{className:`text-[10px] uppercase font-bold tracking-wider px-2 py-0.5 rounded-full ${x.type==="session"?"bg-blue-100 text-blue-700":"bg-emerald-100 text-emerald-700"}`,children:x.type}),x.time&&r.jsxs("span",{className:"text-xs text-slate-400 font-medium flex items-center gap-1",children:[" ",ms(x.time)]})]}),r.jsx("h3",{className:"font-semibold font-heading text-slate-800 text-lg truncate",children:x.title})]}),r.jsx("button",{onClick:()=>a(x.actionUrl),className:"shrink-0 rounded-xl bg-slate-50 px-5 py-2.5 text-sm font-bold text-slate-600 transition-all hover:bg-student-primary hover:text-white hover:shadow-md active:scale-95",children:x.actionLabel})]},x.id)})})]}),r.jsxs("section",{children:[r.jsxs("h2",{className:"mb-4 text-xl font-semibold",children:["Current Phase: ",m]}),r.jsxs("div",{className:"rounded-2xl bg-white p-6 shadow-sm border border-slate-100 dark:bg-card dark:border-border",children:[r.jsxs("div",{className:"mb-6 flex justify-between text-sm",children:[r.jsx("span",{className:"text-muted-foreground",children:"Start"}),r.jsxs("span",{className:"font-semibold text-primary",children:[f.nextMilestone," next"]})]}),r.jsxs("div",{className:"relative mb-2 h-4 w-full rounded-full bg-slate-100 dark:bg-slate-800",children:[r.jsx("div",{className:"absolute left-0 top-0 h-full rounded-full bg-primary transition-all duration-1000",style:{width:`${i.progressPercent}%`}}),r.jsx("div",{className:"absolute top-1/2 -ml-1 h-3 w-3 -translate-y-1/2 rounded-full border-2 border-white bg-primary",style:{left:"0%"}}),r.jsx("div",{className:"absolute top-1/2 -ml-1 h-3 w-3 -translate-y-1/2 rounded-full border-2 border-white bg-primary",style:{left:"25%"}}),r.jsx("div",{className:"absolute top-1/2 -ml-1 h-3 w-3 -translate-y-1/2 rounded-full border-2 border-white bg-primary",style:{left:"50%"}}),r.jsx("div",{className:"absolute top-1/2 -ml-1 h-3 w-3 -translate-y-1/2 rounded-full border-2 border-white bg-slate-300",style:{left:"75%"}}),r.jsx("div",{className:"absolute top-1/2 -ml-1 h-3 w-3 -translate-y-1/2 rounded-full border-2 border-white bg-slate-300",style:{left:"100%"}})]}),r.jsx("div",{className:"mt-4 flex justify-between text-xs font-medium text-slate-400",children:Lh.map((x,b)=>r.jsx("div",{className:b<=f.phaseIndex?"text-primary":"",children:x},x))})]})]})]}),r.jsxs("div",{className:"md:col-span-2 space-y-6",children:[r.jsxs("div",{className:"rounded-2xl bg-gradient-to-br from-indigo-500 to-purple-600 p-6 text-white shadow-lg",children:[r.jsxs("div",{className:"mb-4 flex items-center gap-3",children:[r.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-full bg-white/20 text-lg font-bold backdrop-blur-sm",children:u?.senderAvatar??"C"}),r.jsxs("div",{children:[r.jsx("div",{className:"font-semibold",children:"Your Coach"}),r.jsx("div",{className:"text-sm opacity-90",children:"Usually replies in 1h"})]})]}),u?r.jsxs("div",{className:"mb-6 rounded-xl bg-white/10 p-4 backdrop-blur-sm",children:[r.jsx("div",{className:"mb-1 text-xs opacity-75",children:"Latest message received:"}),r.jsxs("p",{className:"line-clamp-2 text-sm italic",children:['"',u.text,'"']})]}):r.jsx("div",{className:"mb-6 h-12"}),r.jsxs("button",{onClick:()=>{},className:"group flex w-full items-center justify-center gap-2 rounded-xl bg-white px-4 py-3 font-semibold text-indigo-600 transition-all hover:bg-indigo-50 active:scale-95",children:[r.jsx(Ol,{className:"h-5 w-5"}),"Message My Coach"]})]}),r.jsxs("div",{className:"rounded-2xl border border-border bg-card p-6",children:[r.jsx("h3",{className:"mb-3 font-semibold text-foreground",children:"Tip of the week"}),r.jsx("p",{className:"text-sm text-muted-foreground",children:`"Don't worry about scalability yet. Do things that don't scale to learn faster from your first customers."`}),r.jsxs("div",{className:"mt-4 flex items-center gap-2 text-xs text-primary font-medium cursor-pointer hover:underline",children:["Read article ",r.jsx(G2,{className:"h-3 w-3"})]})]})]})]})]})}function KC({initialValue:s,onSubmit:e,onCancel:a,submitLabel:i="Create project"}){const[o,u]=v.useState(()=>({title:s?.title??"",problemStatement:s?.problemStatement??"",targetUsers:s?.targetUsers??"",proposedSolution:s?.proposedSolution??"",stage:s?.stage??cn.idea})),d=v.useMemo(()=>lf(o),[o]),f=(p,x)=>u(b=>({...b,[p]:x})),m=p=>{p.preventDefault(),lf(o).ok&&e?.(o)};return r.jsxs("form",{className:"space-y-4",onSubmit:m,children:[r.jsxs("div",{children:[r.jsx("label",{className:"label",htmlFor:"projectTitle",children:"Project title"}),r.jsx("input",{id:"projectTitle",className:"input",value:o.title,onChange:p=>f("title",p.target.value),placeholder:"e.g., EcoEat",autoComplete:"off",required:!0}),d.errors?.title?r.jsx("p",{className:"mt-1 text-xs text-red-600",children:d.errors.title}):null]}),r.jsxs("div",{children:[r.jsx("label",{className:"label",htmlFor:"problemStatement",children:"Problem statement"}),r.jsx("textarea",{id:"problemStatement",className:"input min-h-[96px]",value:o.problemStatement,onChange:p=>f("problemStatement",p.target.value),placeholder:"What problem are you solving?",required:!0}),d.errors?.problemStatement?r.jsx("p",{className:"mt-1 text-xs text-red-600",children:d.errors.problemStatement}):null]}),r.jsxs("div",{children:[r.jsx("label",{className:"label",htmlFor:"targetUsers",children:"Target users"}),r.jsx("textarea",{id:"targetUsers",className:"input min-h-[80px]",value:o.targetUsers,onChange:p=>f("targetUsers",p.target.value),placeholder:"Who will benefit from this project?",required:!0}),d.errors?.targetUsers?r.jsx("p",{className:"mt-1 text-xs text-red-600",children:d.errors.targetUsers}):null]}),r.jsxs("div",{children:[r.jsx("label",{className:"label",htmlFor:"proposedSolution",children:"Proposed solution"}),r.jsx("textarea",{id:"proposedSolution",className:"input min-h-[96px]",value:o.proposedSolution,onChange:p=>f("proposedSolution",p.target.value),placeholder:"Describe your solution at a high level.",required:!0}),d.errors?.proposedSolution?r.jsx("p",{className:"mt-1 text-xs text-red-600",children:d.errors.proposedSolution}):null]}),r.jsxs("div",{children:[r.jsx("label",{className:"label",htmlFor:"stage",children:"Project stage"}),r.jsxs("select",{id:"stage",className:"input",value:o.stage,onChange:p=>f("stage",p.target.value),required:!0,children:[r.jsx("option",{value:cn.idea,children:"Idea"}),r.jsx("option",{value:cn.prototype,children:"Prototype"}),r.jsx("option",{value:cn.mvp,children:"MVP"})]}),d.errors?.stage?r.jsx("p",{className:"mt-1 text-xs text-red-600",children:d.errors.stage}):null]}),r.jsxs("div",{className:"flex items-center justify-end gap-2 pt-2",children:[a?r.jsx("button",{type:"button",className:"btn-secondary",onClick:a,children:"Cancel"}):null,r.jsx("button",{type:"submit",className:"btn-primary",disabled:!d.ok,children:i})]})]})}const Nb=(s,e)=>s?{fileName:s.name,fileType:s.type,fileSize:s.size,lastModified:s.lastModified,localUrl:e}:null;function YC({open:s,onClose:e,onSubmit:a,ideaSubmitted:i}){const[o,u]=v.useState(tt.document),[d,f]=v.useState(!1),[m,p]=v.useState(null),[x,b]=v.useState(""),[y,j]=v.useState(""),[N,k]=v.useState(null),T=v.useMemo(()=>i?o===tt.document?!!m:o===tt.demoLink?String(x).trim().length>0:o===tt.video?String(y).trim().length>0||!!N:!1:!1,[i,o,m,x,y,N]),R=()=>{p(null),b(""),j(""),k(null),u(tt.document)},A=async()=>{if(!(!T||d)){f(!0);try{const C=new Date().toISOString();if(o===tt.document){const B=URL.createObjectURL(m);await a?.({type:o,payload:{uploadedAt:C,file:Nb(m,B),note:"Stored locally in the browser (prototype mode)."}})}if(o===tt.demoLink&&await a?.({type:o,payload:{url:String(x).trim(),addedAt:C}}),o===tt.video)if(String(y).trim())await a?.({type:o,payload:{url:String(y).trim(),addedAt:C}});else{const B=URL.createObjectURL(N);await a?.({type:o,payload:{uploadedAt:C,file:Nb(N,B),note:"Stored locally in the browser (prototype mode)."}})}R(),e?.()}finally{f(!1)}}};return r.jsxs(Pt,{open:s,title:"Add submission",onClose:()=>{R(),e?.()},footer:r.jsxs(r.Fragment,{children:[r.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>{R(),e?.()},children:"Cancel"}),r.jsx("button",{type:"button",className:"btn-primary",disabled:!T||d,onClick:A,children:"Add"})]}),children:[i?null:r.jsx("div",{className:"rounded-xl border border-amber-200 bg-amber-50 p-4 text-sm text-amber-800",children:"Submit your IDEA first before adding other submission types."}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"label",htmlFor:"submissionType",children:"Submission type"}),r.jsxs("select",{id:"submissionType",className:"input",value:o,onChange:C=>u(C.target.value),disabled:!i,children:[r.jsx("option",{value:tt.document,children:Ac(tt.document)}),r.jsx("option",{value:tt.demoLink,children:Ac(tt.demoLink)}),r.jsx("option",{value:tt.video,children:Ac(tt.video)})]})]}),o===tt.document?r.jsxs("div",{children:[r.jsx("label",{className:"label",htmlFor:"docFile",children:"PDF document"}),r.jsx("input",{id:"docFile",className:"input",type:"file",accept:"application/pdf",onChange:C=>p(C.target.files?.[0]??null),disabled:!i}),r.jsx("p",{className:"mt-2 text-xs text-slate-500",children:"PDF is stored locally for now (no database/storage yet)."})]}):null,o===tt.demoLink?r.jsxs("div",{children:[r.jsx("label",{className:"label",htmlFor:"demoUrl",children:"Demo URL"}),r.jsx("input",{id:"demoUrl",className:"input",type:"url",placeholder:"https://your-demo.example",value:x,onChange:C=>b(C.target.value),disabled:!i})]}):null,o===tt.video?r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"label",htmlFor:"videoUrl",children:"Video URL (recommended)"}),r.jsx("input",{id:"videoUrl",className:"input",type:"url",placeholder:"https://youtube.com/... or https://drive.google.com/...",value:y,onChange:C=>j(C.target.value),disabled:!i})]}),r.jsx("div",{className:"text-xs text-slate-500",children:"Or upload a video file (stored locally for now)."}),r.jsxs("div",{children:[r.jsx("label",{className:"label",htmlFor:"videoFile",children:"Video file"}),r.jsx("input",{id:"videoFile",className:"input",type:"file",accept:"video/*",onChange:C=>k(C.target.files?.[0]??null),disabled:!i})]})]}):null]})]})}function XC(){const{currentUser:s}=gt(),{push:e}=mn(),{getUserById:a,listProjects:i,listProjectSubmissions:o,listTasks:u,createProjectWithIdea:d,addProjectSubmission:f}=yt(),[m,p]=v.useState(!1),[x,b]=v.useState(!1),[y,j]=v.useState(null),[N,k]=v.useState(null),T=s?.id?i({studentId:s.id}):[],R=y?T.find(O=>O.id===y)??null:null,A=R?.id?o({projectId:R.id}):[],C=R?.id?u?.({projectId:R.id})??[]:[],B=Rv(A),F=async O=>{k(null);const H=await d({studentId:s.id,idea:O});if(!H.success){k(H.errors??{form:H.error??"Please fix the errors and try again."});return}if(H.localFallback){let te="";try{te=new URL("https://mdgyxdfbxlnrvvemksck.supabase.co").host}catch{te=""}e({type:"warning",title:"Saved locally (Supabase not ready)",message:`This project was saved in your browser only, so admin will not see it until Supabase tables are installed and your app is connected to that Supabase project.${te?` Connected Supabase: ${te}.`:""}`})}p(!1),j(H.project.id)},V=async({type:O,payload:H})=>{R?.id&&await f({projectId:R.id,type:O,payload:H})};return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex items-start justify-between gap-4",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-2xl font-heading font-bold text-slate-900",children:"Projects"}),r.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Submit progressively: Idea  document  demo  video."})]}),r.jsxs("button",{type:"button",className:"btn-primary",onClick:()=>p(!0),children:[r.jsx(Yn,{className:"h-4 w-4"}),"Create Project"]})]}),r.jsxs("div",{className:"grid gap-6 lg:grid-cols-5",children:[r.jsx("div",{className:"lg:col-span-2",children:r.jsx(Ye,{title:"My projects",subtitle:T.length?`${T.length} total`:"Start by submitting your IDEA",children:T.length===0?r.jsx(Aa,{title:"No projects yet",message:"Create your first project by submitting the IDEA form.",icon:mr}):r.jsx("div",{className:"space-y-2",children:T.map(O=>r.jsxs("button",{type:"button",onClick:()=>j(O.id),className:["w-full text-left rounded-xl border p-4 transition-colors",y===O.id?"border-blue-200 bg-blue-50":"border-slate-200 bg-white hover:bg-slate-50"].join(" "),children:[r.jsxs("div",{className:"flex items-center justify-between gap-3",children:[r.jsx("div",{className:"font-heading font-bold text-slate-900 truncate",children:O.title}),r.jsx("div",{className:"text-xs font-bold uppercase tracking-wider text-slate-500",children:O.stage})]}),r.jsxs("div",{className:"mt-1 text-xs text-slate-500",children:["Last updated: ",new Date(O.updatedAt).toLocaleString()]})]},O.id))})})}),r.jsx("div",{className:"lg:col-span-3",children:R?r.jsxs(Ye,{title:R.title,subtitle:`Stage: ${R.stage}`,actions:r.jsxs("button",{type:"button",className:"btn-secondary",onClick:()=>b(!0),disabled:!B,title:B?"Add a submission":"Submit IDEA first",children:[r.jsx(Yn,{className:"h-4 w-4"}),"Add submission"]}),children:[B?null:r.jsx("div",{className:"mb-4 rounded-xl border border-amber-200 bg-amber-50 p-4 text-sm text-amber-800",children:"You must submit the IDEA first before adding documents, demos, or videos."}),r.jsx(tm,{submissions:A,tasks:C,getUserById:a,allowComment:!1,allowReview:!1,currentUserId:s?.id})]}):r.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white p-6 text-sm text-slate-500",children:"Select a project to view its submission timeline."})})]}),r.jsxs(Pt,{open:m,title:"Create Project (IDEA submission)",onClose:()=>{k(null),p(!1)},children:[N?.form?r.jsx("div",{className:"mb-4 rounded-xl border border-red-200 bg-red-50 p-4 text-sm text-red-700",children:N.form}):null,r.jsx(KC,{onSubmit:F,onCancel:()=>{k(null),p(!1)},submitLabel:"Create project"})]}),r.jsx(YC,{open:x,onClose:()=>b(!1),ideaSubmitted:B,onSubmit:V})]})}function JC(){const{currentUser:s}=gt(),{data:e,createApplication:a}=yt(),{showToast:i}=mn(),{templates:o,instances:u,templateDetailsById:d,instanceDetailsById:f,fetchTemplateDetails:m,fetchInstanceDetails:p,createInstanceFromTemplate:x,submitInstanceTask:b,subscribeToInstanceTasks:y}=Zf(),[j,N]=v.useState(null),[k,T]=v.useState(!1),[R,A]=v.useState(!1),[C,B]=v.useState(null),{enrolledPrograms:F,availablePrograms:V}=v.useMemo(()=>{if(!s?.id||!e)return{enrolledPrograms:[],availablePrograms:[]};const S=(e.programs??[]).filter(M=>M.participantStudentIds.includes(s.id)),D=(e.programs??[]).filter(M=>!M.participantStudentIds.includes(s.id)&&M.status==="active");return{enrolledPrograms:S,availablePrograms:D}},[s,e]),O=v.useMemo(()=>{if(!e)return{};const S={};return[...F,...V].forEach(M=>{const I=(e.coachingSessions??[]).filter(xe=>xe.programId===M.id).length,G=(e.deliverables??[]).filter(xe=>xe.programId===M.id).length,ae=(e.users??[]).filter(xe=>M.coachIds.includes(xe.id));S[M.id]={sessions:I,deliverables:G,students:M.participantStudentIds.length,coaches:ae}}),S},[F,V,e]),H=v.useMemo(()=>o.filter(S=>S.isActive),[o]),te=v.useMemo(()=>s?.id?(u??[]).filter(S=>S.studentId===s.id):[],[s?.id,u]),me=v.useMemo(()=>C?f[C]??null:null,[f,C]),de=me?.instance??null,ye=me?.tasks??[],Ae=de?d[de.templateId]??null:null;v.useEffect(()=>{if(!R||!C)return;let S=!1;return(async()=>{try{const D=await p(C);if(S)return;D?.instance?.templateId&&await m(D.instance.templateId),await y(C)}catch(D){i(D?.message??"Failed to load roadmap","error")}})(),()=>{S=!0}},[p,m,R,C,i,y]);const Re=S=>{B(S),A(!0)},ze=()=>{A(!1),B(null)},J=async S=>{try{const D=await x({templateId:S});i("Program started! Your roadmap is ready.","success"),D&&Re(D)}catch(D){i(D?.message??"Failed to start program","error")}},se=async S=>{const D=window.prompt("Paste a submission link or note for your coach:","");if(D!==null)try{await b({taskId:S,submission:{note:D}}),i("Submitted for review.","success")}catch(M){i(M?.message??"Failed to submit task","error")}},he=S=>{N(S),T(!0)},we=async()=>{if(!(!s?.id||!j?.id))try{await a({programId:j.id,studentId:s.id}),i("Application submitted successfully!","success")}catch(S){const D=S?.message||"Failed to submit application.";i(D,"error")}finally{T(!1),N(null)}},K=S=>{if(!s?.id)return 0;const D=(e?.deliverables??[]).filter(I=>I.programId===S&&I.assignedStudentIds.includes(s.id));if(D.length===0)return 0;const M=D.filter(I=>I.submissions?.find(ae=>ae.studentId===s.id)?.status==="graded").length;return Math.round(M/D.length*100)};return r.jsxs("div",{className:"space-y-8 animate-in fade-in duration-500",children:[r.jsxs("div",{className:"space-y-4",children:[r.jsx("h2",{className:"text-xl font-heading font-bold text-slate-800 dark:text-white",children:"My Roadmaps"}),te.length===0?r.jsx(Ye,{className:"bg-slate-50 border-dashed dark:bg-slate-900/30",children:r.jsxs("div",{className:"py-10 text-center",children:[r.jsx("h3",{className:"text-lg font-bold text-slate-900 dark:text-white",children:"No active roadmap yet"}),r.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"Start a template program below to get your personalized tasks and courses."})]})}):r.jsx("div",{className:"grid gap-4 md:grid-cols-2",children:te.map(S=>{const D=o.find(M=>M.id===S.templateId);return r.jsx(Ye,{children:r.jsxs("div",{className:"flex items-start justify-between gap-4",children:[r.jsxs("div",{className:"min-w-0",children:[r.jsx("div",{className:"text-lg font-bold text-slate-900 dark:text-white",children:D?.name??"Program"}),r.jsx("div",{className:"mt-1 text-sm text-slate-500 dark:text-slate-400 line-clamp-2",children:D?.description??""}),r.jsxs("div",{className:"mt-2 text-xs text-slate-400",children:["Started: ",es(S.startedAt)]})]}),r.jsx("button",{type:"button",className:"px-4 py-2 rounded-xl bg-student-primary text-white text-sm font-bold hover:bg-blue-600 transition-colors",onClick:()=>Re(S.id),children:"Open"})]})},S.id)})})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsx("h2",{className:"text-xl font-heading font-bold text-slate-800 dark:text-white",children:"Browse Programs"}),H.length===0?r.jsx(Ye,{className:"bg-slate-50 border-dashed dark:bg-slate-900/30",children:r.jsxs("div",{className:"py-10 text-center",children:[r.jsx("h3",{className:"text-lg font-bold text-slate-900 dark:text-white",children:"No templates published"}),r.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"Ask an admin to publish a program template with courses and tasks."})]})}):r.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:H.map(S=>r.jsx(Ye,{children:r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex items-start justify-between gap-3",children:[r.jsxs("div",{className:"min-w-0",children:[r.jsx("div",{className:"font-bold text-slate-900 dark:text-white",children:S.name}),r.jsx("div",{className:"mt-1 text-sm text-slate-500 dark:text-slate-400 line-clamp-2",children:S.description})]}),r.jsx(ts,{value:S.isActive?"active":"archived"})]}),r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsx("button",{type:"button",className:"px-4 py-2 rounded-xl bg-slate-900 text-white text-sm font-bold hover:bg-slate-800 transition-colors dark:bg-white dark:text-slate-900",onClick:()=>J(S.id),children:"Start"}),r.jsx("button",{type:"button",className:"px-4 py-2 rounded-xl border border-slate-200 text-slate-600 text-sm font-bold hover:bg-slate-50 transition-colors dark:border-slate-700 dark:text-slate-200",onClick:async()=>{try{await m(S.id),i("Template loaded. Start it to get a roadmap.","info")}catch(D){i(D?.message??"Failed to load template","error")}},children:"Preview"})]})]})},S.id))})]}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-heading font-bold text-slate-900 dark:text-white",children:"Programs"}),r.jsx("p",{className:"mt-2 text-lg text-slate-500 font-medium",children:"Browse and enroll in world-class entrepreneurship programs designed to help you scale."})]}),F.length>0&&r.jsxs("div",{className:"space-y-4",children:[r.jsxs("h2",{className:"text-xl font-heading font-bold text-slate-800 flex items-center gap-2",children:[r.jsx(Kn,{className:"h-5 w-5 text-student-primary"}),"My Programs"]}),r.jsx("div",{className:"grid gap-6 md:grid-cols-2",children:F.map(S=>{const D=O[S.id]??{},M=K(S.id);return r.jsxs("div",{className:"group relative overflow-hidden rounded-2xl bg-white p-6 shadow-sm border border-slate-100 transition-all hover:shadow-lg dark:bg-slate-800 dark:border-slate-700",children:[r.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-5 pointer-events-none",children:r.jsx(jn,{className:"h-32 w-32 rotate-12"})}),r.jsxs("div",{className:"flex items-start gap-4 relative z-10",children:[r.jsx("div",{className:"grid h-14 w-14 shrink-0 place-items-center rounded-2xl bg-gradient-to-br from-blue-500 to-indigo-600 text-white shadow-md",children:r.jsx(Al,{className:"h-7 w-7"})}),r.jsxs("div",{className:"min-w-0 flex-1 space-y-3",children:[r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-start justify-between gap-2",children:[r.jsx("h3",{className:"text-lg font-heading font-bold text-slate-900 dark:text-white group-hover:text-student-primary transition-colors",children:S.name}),r.jsx(ts,{value:S.status})]}),r.jsx("p",{className:"mt-2 text-sm text-slate-500 leading-relaxed line-clamp-2 dark:text-slate-400",children:S.description})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"flex justify-between text-xs font-bold uppercase text-slate-500",children:[r.jsx("span",{children:"Progress"}),r.jsxs("span",{children:[M,"%"]})]}),r.jsx("div",{className:"h-2 w-full rounded-full bg-slate-100 overflow-hidden",children:r.jsx("div",{className:"h-full bg-student-primary rounded-full transition-all duration-1000",style:{width:`${M}%`}})})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-3 text-xs font-medium text-slate-500 mt-2",children:[r.jsxs("div",{className:"flex items-center gap-2 bg-slate-50 p-2 rounded-lg",children:[r.jsx(gs,{className:"h-3.5 w-3.5 text-slate-400"}),D.sessions," sessions"]}),r.jsxs("div",{className:"flex items-center gap-2 bg-slate-50 p-2 rounded-lg",children:[r.jsx(jn,{className:"h-3.5 w-3.5 text-slate-400"}),D.deliverables," deliverables"]})]}),r.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-400 pt-2 border-t border-slate-50 mt-2",children:[r.jsx(dn,{className:"h-3 w-3"}),D.coaches&&D.coaches.length>0?r.jsxs("span",{children:["Mapped Coach: ",r.jsx("span",{className:"text-slate-700 font-bold",children:D.coaches.map(I=>I.name).join(", ")})]}):"No coach assigned"]})]})]})]},S.id)})})]}),r.jsxs("div",{className:"space-y-6 pt-4",children:[r.jsxs("h2",{className:"text-xl font-heading font-bold text-slate-800 flex items-center gap-2",children:[r.jsx(jn,{className:"h-5 w-5 text-indigo-500"}),"Available Programs ",r.jsx("span",{className:"text-sm font-medium text-slate-400 ml-2 bg-slate-100 px-2 py-0.5 rounded-full",children:V.length})]}),V.length===0?r.jsx(Ye,{className:"bg-slate-50 border-dashed",children:r.jsxs("div",{className:"py-12 text-center",children:[r.jsx("div",{className:"mx-auto h-16 w-16 bg-slate-100 rounded-full flex items-center justify-center text-slate-400 mb-4",children:r.jsx(Al,{className:"h-8 w-8"})}),r.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"No programs available"}),r.jsx("p",{className:"text-slate-500",children:"Check back later for new enrollment opportunities!"})]})}):r.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:V.map(S=>{const D=O[S.id]??{},M=(e?.applications??[]).find(ae=>ae.programId===S.id&&ae.studentId===s?.id),I=!!M,G=I?M.status==="pending"?"Application Submitted":M.status==="accepted"?"Accepted":M.status==="rejected"?"Rejected":"Applied":"Apply Now";return r.jsxs("div",{className:"flex flex-col rounded-2xl bg-white p-6 shadow-sm border border-slate-200 transition-all hover:shadow-xl hover:-translate-y-1",children:[r.jsxs("div",{className:"flex-1 space-y-4",children:[r.jsxs("div",{className:"flex items-start justify-between gap-2",children:[r.jsx("div",{className:"h-12 w-12 rounded-xl bg-slate-900 text-white flex items-center justify-center shadow-lg",children:r.jsx("span",{className:"font-heading font-bold text-xl",children:S.name.charAt(0)})}),r.jsx(ts,{value:S.status})]}),r.jsxs("div",{children:[R&&r.jsx(Pt,{isOpen:R,onClose:ze,title:o.find(ae=>ae.id===de?.templateId)?.name??"Program Roadmap",children:de?r.jsxs("div",{className:"space-y-6",children:[r.jsx("div",{className:"rounded-xl border border-slate-200 bg-slate-50 p-4 dark:border-slate-700 dark:bg-slate-900/30",children:r.jsxs("div",{className:"flex items-center justify-between gap-4",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-sm font-bold text-slate-900 dark:text-white",children:"Progress"}),r.jsx("div",{className:"text-xs text-slate-500 dark:text-slate-400",children:"Tasks approved drive milestones"})]}),r.jsxs("div",{className:"text-sm font-bold text-slate-900 dark:text-white",children:[ye.filter(ae=>ae.status==="approved").length," / ",ye.length," approved"]})]})}),Ae?.stages?.length?r.jsx("div",{className:"space-y-6",children:Ae.stages.map(ae=>{const xe=(Ae.contents??[]).filter(pe=>pe.stageId===ae.id),je=ye.filter(pe=>pe.stageId===ae.id),Se=je.filter(pe=>pe.status==="approved").length;return r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex items-start justify-between gap-4",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-lg font-bold text-slate-900 dark:text-white",children:ae.name}),ae.description?r.jsx("div",{className:"text-sm text-slate-500 dark:text-slate-400",children:ae.description}):null]}),r.jsxs("div",{className:"text-sm font-bold text-slate-700 dark:text-slate-200",children:[Se,"/",je.length," approved"]})]}),xe.length>0&&r.jsxs("div",{className:"rounded-xl border border-slate-200 p-4 dark:border-slate-700",children:[r.jsx("div",{className:"text-sm font-bold text-slate-900 dark:text-white",children:"Courses & Videos"}),r.jsx("div",{className:"mt-3 space-y-2",children:xe.map(pe=>r.jsx("a",{href:pe.url,target:"_blank",rel:"noreferrer",className:"block rounded-lg border border-slate-200 p-3 hover:bg-slate-50 transition-colors dark:border-slate-700 dark:hover:bg-slate-800",children:r.jsxs("div",{className:"flex items-center justify-between gap-3",children:[r.jsxs("div",{className:"min-w-0",children:[r.jsx("div",{className:"font-bold text-slate-900 dark:text-white truncate",children:pe.title}),r.jsxs("div",{className:"text-xs text-slate-500 dark:text-slate-400",children:[pe.contentType.toUpperCase(),pe.provider?`  ${pe.provider}`:"",pe.durationMinutes?`  ${pe.durationMinutes}m`:""]})]}),r.jsx("div",{className:"text-xs font-bold text-student-primary",children:"Open"})]})},pe.id))})]}),r.jsx("div",{className:"space-y-2",children:je.length===0?r.jsx("div",{className:"text-sm text-slate-500 dark:text-slate-400",children:"No tasks in this stage yet."}):je.map(pe=>r.jsxs("div",{className:"flex items-start justify-between gap-4 rounded-xl border border-slate-200 p-4 dark:border-slate-700",children:[r.jsxs("div",{className:"min-w-0",children:[r.jsx("div",{className:"font-bold text-slate-900 dark:text-white",children:pe.title}),pe.description?r.jsx("div",{className:"mt-1 text-sm text-slate-500 dark:text-slate-400",children:pe.description}):null,r.jsxs("div",{className:"mt-2 text-xs text-slate-400",children:["Status: ",r.jsx("span",{className:"font-bold",children:pe.status}),pe.deadline?`  Due: ${es(pe.deadline)}`:""]})]}),r.jsxs("div",{className:"shrink-0 flex items-center gap-2",children:[r.jsx(ts,{value:pe.status}),pe.status!=="approved"&&r.jsx("button",{type:"button",className:"px-3 py-2 rounded-xl bg-slate-900 text-white text-xs font-bold hover:bg-slate-800 transition-colors dark:bg-white dark:text-slate-900",onClick:()=>se(pe.id),children:"Submit"})]})]},pe.id))})]},ae.id)})}):r.jsx("div",{className:"text-sm text-slate-500",children:"Loading template stages"})]}):r.jsx("div",{className:"text-sm text-slate-500",children:"Loading instance"})}),r.jsx("h3",{className:"text-lg font-heading font-bold text-slate-900 mb-2",children:S.name}),r.jsx("p",{className:"text-sm text-slate-500 line-clamp-3 leading-relaxed",children:S.description})]}),r.jsxs("div",{className:"flex flex-wrap gap-2",children:[r.jsxs("span",{className:"inline-flex items-center gap-1.5 px-2.5 py-1 rounded-lg bg-slate-50 text-xs font-bold text-slate-600",children:[r.jsx(gs,{className:"h-3.5 w-3.5"}),D.sessions," Sessions"]}),r.jsxs("span",{className:"inline-flex items-center gap-1.5 px-2.5 py-1 rounded-lg bg-slate-50 text-xs font-bold text-slate-600",children:[r.jsx(dn,{className:"h-3.5 w-3.5"}),D.students," Enrolled"]})]}),r.jsxs("div",{className:"text-xs font-medium text-slate-400 flex items-center gap-2 pt-2 border-t border-slate-100",children:[r.jsx("span",{children:es(S.startDate)}),r.jsx("span",{className:"h-1 w-1 bg-slate-300 rounded-full"}),r.jsx("span",{children:es(S.endDate)})]})]}),r.jsx("button",{type:"button",className:`mt-6 w-full rounded-xl py-3 text-sm font-bold text-white shadow-lg transition-all active:scale-95 ${I?"bg-slate-400 cursor-not-allowed shadow-slate-400/20":"bg-slate-900 shadow-slate-900/20 hover:bg-slate-800 hover:shadow-xl"}`,onClick:()=>he(S),disabled:I,children:G})]},S.id)})})]}),k&&j&&r.jsx(Pt,{title:`Apply to ${j.name}`,onClose:()=>T(!1),footer:r.jsxs("div",{className:"flex gap-3 w-full sm:w-auto",children:[r.jsx("button",{type:"button",className:"flex-1 rounded-xl px-4 py-2.5 text-sm font-bold text-slate-600 hover:bg-slate-100 transition-colors",onClick:()=>T(!1),children:"Cancel"}),r.jsx("button",{type:"button",className:"flex-1 rounded-xl bg-student-primary px-6 py-2.5 text-sm font-bold text-white shadow-lg hover:bg-blue-600 active:scale-95 transition-all",onClick:we,children:"Confirm Application"})]}),children:r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"rounded-xl bg-slate-50 p-6 border border-slate-100",children:[r.jsx("h3",{className:"font-heading font-bold text-slate-900 text-lg mb-2",children:j.name}),r.jsx("p",{className:"text-sm text-slate-600 leading-relaxed",children:j.description})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex gap-3 items-start",children:[r.jsx(Kn,{className:"h-5 w-5 text-student-primary shrink-0 mt-0.5"}),r.jsx("p",{className:"text-sm text-slate-600",children:"I confirm that I can attend the scheduled sessions."})]}),r.jsxs("div",{className:"flex gap-3 items-start",children:[r.jsx(Kn,{className:"h-5 w-5 text-student-primary shrink-0 mt-0.5"}),r.jsx("p",{className:"text-sm text-slate-600",children:"I am committed to completing all required deliverables."})]})]})]})})]})}function QC(){const{currentUser:s}=gt(),{data:e}=yt(),a=_n(),i=v.useMemo(()=>!s?.id||!e?[]:(e.applications??[]).filter(f=>f.studentId===s.id).sort((f,m)=>new Date(m.submittedAt)-new Date(f.submittedAt)),[s,e]),o=v.useMemo(()=>{const f=i.filter(x=>x.status==="pending").length,m=i.filter(x=>x.status==="approved").length,p=i.filter(x=>x.status==="rejected").length;return{total:i.length,pending:f,approved:m,rejected:p}},[i]),u=f=>(e?.programs??[]).find(p=>p.id===f)?.name??"Unknown Program",d=f=>{switch(f){case"approved":return r.jsx(Kn,{className:"h-5 w-5"});case"rejected":return r.jsx(fv,{className:"h-5 w-5"});default:return r.jsx(Ca,{className:"h-5 w-5"})}};return i.length===0?r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-heading font-bold text-slate-900 dark:text-white",children:"My Applications"}),r.jsx("p",{className:"mt-2 text-lg text-slate-500 font-medium",children:"Track the status of your program applications."})]}),r.jsx(Aa,{icon:af,title:"No Applications Found",description:"You haven't applied to any programs yet. Browse available programs to get started.",actionLabel:"Browse Programs",onAction:()=>a("/student/programs")})]}):r.jsxs("div",{className:"space-y-8 animate-in fade-in duration-500",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-heading font-bold text-slate-900 dark:text-white",children:"My Applications"}),r.jsx("p",{className:"mt-2 text-lg text-slate-500 font-medium",children:"Track the status of your program applications."})]}),r.jsxs("div",{className:"grid gap-6 md:grid-cols-3",children:[r.jsxs("div",{className:"rounded-2xl bg-white p-6 shadow-sm border border-slate-200 flex items-center gap-4 dark:bg-slate-800 dark:border-slate-700",children:[r.jsx("div",{className:"rounded-xl bg-blue-50 p-3 text-blue-600 dark:bg-blue-900/20",children:r.jsx(af,{className:"h-6 w-6"})}),r.jsxs("div",{children:[r.jsx("p",{className:"text-xs font-bold uppercase tracking-wider text-slate-400",children:"Total"}),r.jsx("h3",{className:"text-2xl font-heading font-bold text-slate-900 dark:text-white",children:o.total})]})]}),r.jsxs("div",{className:"rounded-2xl bg-white p-6 shadow-sm border border-slate-200 flex items-center gap-4 dark:bg-slate-800 dark:border-slate-700",children:[r.jsx("div",{className:"rounded-xl bg-amber-50 p-3 text-amber-600 dark:bg-amber-900/20",children:r.jsx(Ca,{className:"h-6 w-6"})}),r.jsxs("div",{children:[r.jsx("p",{className:"text-xs font-bold uppercase tracking-wider text-slate-400",children:"Pending"}),r.jsx("h3",{className:"text-2xl font-heading font-bold text-slate-900 dark:text-white",children:o.pending})]})]}),r.jsxs("div",{className:"rounded-2xl bg-white p-6 shadow-sm border border-slate-200 flex items-center gap-4 dark:bg-slate-800 dark:border-slate-700",children:[r.jsx("div",{className:"rounded-xl bg-emerald-50 p-3 text-emerald-600 dark:bg-emerald-900/20",children:r.jsx(Kn,{className:"h-6 w-6"})}),r.jsxs("div",{children:[r.jsx("p",{className:"text-xs font-bold uppercase tracking-wider text-slate-400",children:"Approved"}),r.jsx("h3",{className:"text-2xl font-heading font-bold text-slate-900 dark:text-white",children:o.approved})]})]})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsx("h2",{className:"text-xl font-heading font-bold text-slate-900 dark:text-white",children:"Recent Applications"}),r.jsx("div",{className:"grid gap-4",children:i.map(f=>r.jsx("div",{className:"group relative overflow-hidden rounded-2xl bg-white p-6 shadow-sm border border-slate-200 transition-all hover:shadow-md hover:border-blue-200 dark:bg-slate-800 dark:border-slate-700",children:r.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-6",children:[r.jsxs("div",{className:"flex items-start gap-4",children:[r.jsx("div",{className:"hidden md:flex h-12 w-12 shrink-0 items-center justify-center rounded-xl bg-slate-100 text-slate-500 font-bold text-lg dark:bg-slate-700",children:u(f.programId).charAt(0)}),r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[r.jsx("h3",{className:"font-heading font-bold text-lg text-slate-900 dark:text-white",children:u(f.programId)}),r.jsxs("div",{className:`px-2.5 py-0.5 rounded-full text-[10px] font-bold uppercase tracking-wide border flex items-center gap-1 ${f.status==="approved"?"bg-emerald-50 text-emerald-700 border-emerald-200":f.status==="rejected"?"bg-red-50 text-red-700 border-red-200":"bg-amber-50 text-amber-700 border-amber-200"}`,children:[d(f.status),f.status]})]}),r.jsxs("p",{className:"text-sm text-slate-500 font-medium",children:["Submitted on ",es(f.submittedAt)]})]})]}),r.jsxs("div",{className:"flex items-center gap-4 md:ml-auto",children:[f.status==="approved"&&r.jsx("button",{onClick:()=>a("/student/programs"),className:"rounded-xl bg-student-primary px-5 py-2 text-sm font-bold text-white shadow-sm hover:bg-blue-600 transition-colors",children:"View Program"}),r.jsxs("div",{className:"text-right",children:[r.jsx("div",{className:"text-xs font-bold uppercase tracking-wider text-slate-400",children:"Application ID"}),r.jsx("div",{className:"text-sm font-mono text-slate-600",children:f.id.slice(0,8)})]})]})]})},f.id))})]})]})}function ZC(){const{currentUser:s}=gt(),{data:e}=yt(),[a,i]=v.useState(null),[o,u]=v.useState(""),d=v.useMemo(()=>!s?.id||!e?[]:(e.deliverables??[]).filter(p=>p.assignedStudentIds.includes(s.id)).map(p=>{const x=p.submissions?.find(j=>j.studentId===s.id);let b="Pending",y=null;return x&&(x.status==="graded"?(b=x.grade>=80?"Approved":"Needs Revision",y=x.feedback):x.status==="submitted"&&(b="Submitted")),{id:p.id,title:p.title,description:p.description,deadline:p.dueDate,programName:(e.programs??[]).find(j=>j.id===p.programId)?.name||"Unknown Program",status:b,score:x?.status==="graded"?x.grade:null,feedback:y,submittedAt:x?.submittedAt}}).sort((p,x)=>new Date(p.deadline)-new Date(x.deadline)),[s,e]),f=v.useMemo(()=>{if(!o)return d;const m=o.toLowerCase();return d.filter(p=>p.title.toLowerCase().includes(m)||p.programName.toLowerCase().includes(m))},[d,o]);return r.jsxs("div",{className:"space-y-8 animate-in fade-in duration-500",children:[r.jsxs("div",{className:"flex flex-col md:flex-row md:items-end justify-between gap-4",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-heading font-bold text-slate-900 dark:text-white",children:"Deliverables"}),r.jsx("p",{className:"mt-2 text-lg text-slate-500 font-medium",children:"Manage your assignments and project submissions."})]}),r.jsxs("div",{className:"hidden md:flex gap-4",children:[r.jsxs("div",{className:"rounded-2xl bg-white px-5 py-3 shadow-sm border border-slate-100 dark:bg-slate-800 dark:border-slate-700",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[r.jsx(Kl,{className:"h-4 w-4 text-slate-400"}),r.jsx("span",{className:"text-xs font-bold uppercase tracking-wider text-slate-400",children:"Total"})]}),r.jsx("div",{className:"text-2xl font-heading font-bold text-slate-900 dark:text-white",children:d.length})]}),r.jsxs("div",{className:"rounded-2xl bg-white px-5 py-3 shadow-sm border border-slate-100 dark:bg-slate-800 dark:border-slate-700",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[r.jsx(Ca,{className:"h-4 w-4 text-amber-500"}),r.jsx("span",{className:"text-xs font-bold uppercase tracking-wider text-slate-400",children:"Pending"})]}),r.jsx("div",{className:"text-2xl font-heading font-bold text-amber-600",children:d.filter(m=>m.status==="Pending"||m.status==="Needs Revision").length})]}),r.jsxs("div",{className:"rounded-2xl bg-white px-5 py-3 shadow-sm border border-slate-100 dark:bg-slate-800 dark:border-slate-700",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[r.jsx(Kn,{className:"h-4 w-4 text-emerald-500"}),r.jsx("span",{className:"text-xs font-bold uppercase tracking-wider text-slate-400",children:"Approved"})]}),r.jsx("div",{className:"text-2xl font-heading font-bold text-emerald-600",children:d.filter(m=>m.status==="Approved").length})]})]})]}),r.jsxs("div",{className:"relative",children:[r.jsx(Zn,{className:"absolute left-4 top-1/2 -translate-y-1/2 h-5 w-5 text-slate-400"}),r.jsx("input",{type:"text",placeholder:"Search deliverables...",value:o,onChange:m=>u(m.target.value),className:"w-full pl-12 pr-4 py-3 rounded-2xl border border-slate-200 bg-white text-sm outline-none focus:ring-2 focus:ring-slate-100 focus:border-slate-300 transition-all dark:bg-slate-800 dark:border-slate-700"})]}),r.jsx("div",{className:"rounded-2xl border border-slate-200 bg-white shadow-sm overflow-hidden dark:bg-slate-800 dark:border-slate-700",children:r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"w-full text-sm text-left",children:[r.jsx("thead",{className:"bg-slate-50 text-slate-500 font-bold font-heading uppercase tracking-wider text-xs border-b border-slate-200 dark:bg-slate-900/50 dark:border-slate-700 dark:text-slate-400",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-6 py-4",children:"Deliverable"}),r.jsx("th",{className:"px-6 py-4",children:"Due Date"}),r.jsx("th",{className:"px-6 py-4",children:"Status"}),r.jsx("th",{className:"px-6 py-4",children:"Score"}),r.jsx("th",{className:"px-6 py-4 text-right",children:"Actions"})]})}),r.jsxs("tbody",{className:"divide-y divide-slate-100 dark:divide-slate-700",children:[f.map(m=>r.jsxs("tr",{className:"group hover:bg-slate-50/80 transition-colors dark:hover:bg-slate-700/50",children:[r.jsx("td",{className:"px-6 py-4",children:r.jsxs("div",{children:[r.jsx("div",{className:"font-bold text-slate-900 text-base dark:text-white",children:m.title}),r.jsx("div",{className:"text-xs text-slate-500 mt-1 max-w-md truncate",children:m.description}),r.jsx("div",{className:"text-[10px] uppercase font-bold text-slate-400 tracking-wide mt-1",children:m.programName})]})}),r.jsx("td",{className:"px-6 py-4",children:r.jsxs("div",{className:"flex items-center gap-2 text-slate-600 dark:text-slate-300",children:[r.jsx(gs,{className:"h-4 w-4 text-slate-400"}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"font-medium text-sm",children:es(m.deadline)}),r.jsx("span",{className:"text-xs text-slate-400",children:ms(m.deadline).split(",")[1]})]})]})}),r.jsx("td",{className:"px-6 py-4",children:r.jsx(ts,{value:m.status})}),r.jsx("td",{className:"px-6 py-4",children:m.score!==null?r.jsxs("div",{className:`font-bold ${m.score>=80?"text-emerald-600":"text-amber-600"}`,children:[m.score,"/100"]}):r.jsx("span",{className:"text-slate-300",children:"-"})}),r.jsx("td",{className:"px-6 py-4 text-right",children:r.jsxs("div",{className:"flex items-center justify-end gap-2",children:[m.feedback&&r.jsx("button",{onClick:()=>i(m),className:"p-2 rounded-lg text-slate-400 hover:bg-blue-50 hover:text-blue-600 transition-colors",title:"View Feedback",children:r.jsx(yi,{className:"h-4 w-4"})}),r.jsx("button",{className:"rounded-lg bg-slate-900 px-4 py-2 text-xs font-bold text-white shadow-sm hover:bg-slate-800 transition-colors dark:bg-white dark:text-slate-900",children:m.status==="Pending"||m.status==="Needs Revision"?"Submit":"View"})]})})]},m.id)),f.length===0&&r.jsx("tr",{children:r.jsx("td",{colSpan:5,className:"px-6 py-12 text-center text-slate-400",children:"No deliverables found."})})]})]})})}),a&&r.jsx(Pt,{isOpen:!!a,onClose:()=>i(null),title:"Coach Feedback",footer:r.jsx("button",{className:"btn-primary w-full",onClick:()=>i(null),children:"Close"}),children:r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"h-10 w-10 bg-slate-100 rounded-full flex items-center justify-center text-slate-500",children:r.jsx(yi,{className:"h-5 w-5"})}),r.jsxs("div",{children:[r.jsx("h4",{className:"font-bold text-slate-900",children:a.title}),r.jsx("p",{className:"text-xs text-slate-500",children:"Feedback from Coach"})]})]}),r.jsx("div",{className:"rounded-xl bg-blue-50 p-5 text-sm text-blue-900 leading-relaxed border border-blue-100",children:a.feedback}),a.score&&r.jsxs("div",{className:"flex justify-end",children:[r.jsx("span",{className:"text-xs font-bold uppercase tracking-wider text-slate-400 mr-2 mt-1",children:"Grade"}),r.jsxs("span",{className:`text-xl font-bold ${a.score>=80?"text-emerald-600":"text-amber-600"}`,children:[a.score,"/100"]})]})]})})]})}function WC({templateItems:s,value:e,onChange:a}){const i=Array.isArray(s)?s:[],o=new Set(Array.isArray(e)?e:[]);return r.jsx("div",{className:"space-y-2",children:i.length===0?r.jsx("div",{className:"text-sm text-slate-500",children:"No checklist items."}):i.map(u=>r.jsxs("label",{className:"flex items-center gap-2 rounded-xl border border-slate-200 bg-white p-3",children:[r.jsx("input",{type:"checkbox",checked:o.has(u.id),onChange:d=>{const f=new Set(o);d.target.checked?f.add(u.id):f.delete(u.id),a(Array.from(f))}}),r.jsx("span",{className:"text-sm text-slate-800",children:u.text})]},u.id))})}function eA({open:s,task:e,onClose:a,onSubmit:i}){const o=String(e?.taskType??"").toUpperCase(),[u,d]=v.useState(""),[f,m]=v.useState(""),[p,x]=v.useState(null),[b,y]=v.useState([]),[j,N]=v.useState(!1),[k,T]=v.useState(null),R=v.useMemo(()=>j||!e?!1:o===Ze.text?!!u.trim():o===Ze.link?!!f.trim():o===Ze.file?!!p:o===Ze.checklist,[j,p,e,o,u,f]),A=()=>{d(""),m(""),x(null),y([]),T(null)},C=()=>e?o===Ze.text?r.jsx("textarea",{className:"input min-h-[140px]",placeholder:"Write your response",value:u,onChange:F=>d(F.target.value)}):o===Ze.link?r.jsx("input",{className:"input",placeholder:"https://",value:f,onChange:F=>m(F.target.value)}):o===Ze.file?r.jsxs("div",{className:"space-y-2",children:[r.jsx("input",{type:"file",onChange:F=>{const V=F.target.files?.[0]??null;x(V)}}),p?r.jsxs("div",{className:"text-xs text-slate-600",children:["Selected: ",p.name]}):null,r.jsx("div",{className:"text-xs text-slate-500",children:"(Mock-only) File is stored as name + local preview URL."})]}):o===Ze.checklist?r.jsx(WC,{templateItems:e?.checklistItems,value:b,onChange:y}):r.jsx("div",{className:"text-sm text-slate-500",children:"Unsupported task type."}):null,B=async()=>{if(e){T(null),N(!0);try{const F=(()=>{if(o===Ze.text)return{text:u.trim()};if(o===Ze.link)return{url:f.trim()};if(o===Ze.file){const V=p?URL.createObjectURL(p):null;return{fileName:p?.name??null,localUrl:V}}return o===Ze.checklist?{checkedItemIds:b}:null})();await i?.({taskId:e.id,submission:F}),A(),a?.()}catch(F){T(F?.message??"Failed to submit task")}finally{N(!1)}}};return r.jsxs(Pt,{open:s,title:e?`Submit task: ${e.title}`:"Submit task",onClose:()=>{A(),a?.()},children:[k?r.jsx("div",{className:"mb-4 rounded-xl border border-red-200 bg-red-50 p-4 text-sm text-red-700",children:k}):null,r.jsxs("div",{className:"space-y-4",children:[C(),r.jsxs("div",{className:"flex items-center justify-end gap-2",children:[r.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>a?.(),disabled:j,children:"Cancel"}),r.jsx("button",{type:"button",className:"btn-primary",onClick:B,disabled:!R,children:j?"Submitting":"Submit Task"})]})]})]})}function tA({task:s}){const e=String(s?.taskType??"").toUpperCase(),a=s?.studentSubmission??null;if(!a)return r.jsx("div",{className:"text-sm text-slate-500",children:"No submission yet."});if(e===Ze.text)return r.jsx("div",{className:"text-sm text-slate-700 whitespace-pre-wrap",children:a.text});if(e===Ze.link)return r.jsx("a",{className:"text-sm font-semibold text-blue-600 hover:underline",href:a.url,target:"_blank",rel:"noreferrer",children:a.url});if(e===Ze.file)return r.jsxs("div",{className:"space-y-2",children:[r.jsx("div",{className:"text-sm text-slate-700",children:a.fileName??"File"}),a.localUrl?r.jsx("a",{className:"text-sm font-semibold text-blue-600 hover:underline",href:a.localUrl,target:"_blank",rel:"noreferrer",children:"Open file"}):null]});if(e===Ze.checklist){const i=new Set(a.checkedItemIds??[]),o=s?.checklistItems??[];return r.jsx("div",{className:"space-y-2",children:o.map(u=>r.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-700",children:[r.jsx("input",{type:"checkbox",checked:i.has(u.id),readOnly:!0}),r.jsx("span",{children:u.text})]},u.id))})}return r.jsx("div",{className:"text-sm text-slate-500",children:"Submission details unavailable."})}function sA(){const{currentUser:s}=gt(),{getUserById:e,listTasksGroupedByProject:a,submitTask:i}=yt(),[o,u]=v.useState(null),d=s?.id?a?.({studentId:s.id})??[]:[],f=d.flatMap(x=>x.tasks??[]),m=d.flatMap(x=>x.tasks??[]).find(x=>x.id===o)??null,p=f.filter(x=>{const b=String(x.status??Xt.pending).toUpperCase();return b===Xt.pending||b===Xt.revision}).length;return r.jsxs("div",{className:"space-y-8 animate-in fade-in duration-500",children:[r.jsxs("div",{className:"flex flex-col md:flex-row md:items-end justify-between gap-4",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-heading font-bold text-slate-900 dark:text-white",children:"My Tasks"}),r.jsx("p",{className:"mt-2 text-lg text-slate-500 font-medium",children:"Submit work requested by your coach, per project."})]}),r.jsxs("div",{className:"hidden md:flex gap-4",children:[r.jsxs("div",{className:"rounded-2xl bg-white px-5 py-3 shadow-sm border border-slate-100 dark:bg-slate-800 dark:border-slate-700",children:[r.jsx("div",{className:"text-xs font-bold uppercase tracking-wider text-slate-400",children:"Total"}),r.jsx("div",{className:"text-2xl font-heading font-bold text-slate-900 dark:text-white",children:f.length})]}),r.jsxs("div",{className:"rounded-2xl bg-white px-5 py-3 shadow-sm border border-slate-100 dark:bg-slate-800 dark:border-slate-700",children:[r.jsx("div",{className:"text-xs font-bold uppercase tracking-wider text-slate-400",children:"Needs action"}),r.jsx("div",{className:"text-2xl font-heading font-bold text-amber-600",children:p})]})]})]}),f.length===0?r.jsx(Aa,{icon:jn,title:"No tasks yet",message:"When your coach creates tasks for your projects, they will appear here."}):r.jsx("div",{className:"space-y-6",children:d.map(({project:x,tasks:b})=>r.jsx(Ye,{title:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(mr,{className:"h-5 w-5 text-slate-500"}),r.jsx("span",{className:"font-heading font-bold text-slate-900",children:x?.title??"Project"})]}),subtitle:x?.studentId?`Student: ${e?.(x.studentId)?.name??x.studentId}`:null,children:(b??[]).length===0?r.jsx("div",{className:"text-sm text-slate-500",children:"No tasks for this project."}):r.jsx("div",{className:"space-y-4",children:(b??[]).map(y=>{const j=Kk(y.status),N=em(y.status);return r.jsxs(sw,{task:y,primaryAction:r.jsx("button",{type:"button",className:j?"btn-primary":"btn-secondary",onClick:()=>u(y.id),title:j?"Submit your work":"View task details",children:j?"Submit":"View"}),children:[r.jsxs("div",{className:"rounded-xl border border-slate-200 bg-slate-50 p-4",children:[r.jsx("div",{className:"text-xs font-bold uppercase tracking-wider text-slate-400",children:"Your submission"}),r.jsx("div",{className:"mt-2",children:r.jsx(tA,{task:y})})]}),y.coachFeedback?r.jsxs("div",{className:"rounded-xl border border-blue-200 bg-blue-50 p-4",children:[r.jsxs("div",{className:"text-xs font-bold uppercase tracking-wider text-blue-700",children:["Coach feedback (",N,")"]}),r.jsx("div",{className:"mt-2 text-sm text-blue-900 whitespace-pre-wrap",children:y.coachFeedback})]}):null]},y.id)})})},x?.id??"project"))}),r.jsx(eA,{open:!!o,task:m,onClose:()=>u(null),onSubmit:async({taskId:x,submission:b})=>{await i?.({taskId:x,submission:b})}})]})}const Sb={present:{label:"Present",icon:Kn,color:"text-success-700 bg-success-50 border-success-200"},absent:{label:"Absent",icon:fv,color:"text-danger-700 bg-danger-50 border-danger-200"},late:{label:"Late",icon:sf,color:"text-warning-700 bg-warning-50 border-warning-200"},pending:{label:"Upcoming",icon:Ca,color:"text-muted-foreground bg-muted border-border"}};function nA(){const{currentUser:s}=gt(),{data:e}=yt(),[a,i]=v.useState("all"),o=v.useMemo(()=>!s?.id||!e?[]:(e.coachingSessions??[]).filter(f=>f.attendeeStudentIds.includes(s.id)).map(f=>{const m=(e.users??[]).find(j=>j.id===f.coachId);let p="pending";if(f.status==="completed"){const j=f.attendance?.find(N=>N.studentId===s.id);j?p=j.status:p="present"}else new Date(f.startsAt)<new Date&&f.status!=="completed"&&(p="pending");const x=new Date(f.startsAt),b=new Date(f.endsAt),y=Math.round((b-x)/6e4);return{...f,coachName:m?.name??"Unknown Coach",duration:`${y} min`,attendanceStatus:p,isUpcoming:new Date(f.startsAt)>new Date}}).sort((f,m)=>new Date(f.startsAt)-new Date(m.startsAt)),[s,e]),u=v.useMemo(()=>{const d=new Date;return o.filter(f=>a==="upcoming"?new Date(f.startsAt)>=d:a==="past"?new Date(f.startsAt)<d:!0)},[o,a]);return o.length===0?r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-2xl font-heading font-bold text-slate-900 dark:text-white",children:"Coaching Sessions"}),r.jsx("p",{className:"mt-1 text-slate-500 font-medium",children:"Your schedule and attendance history"})]}),r.jsx(Aa,{icon:gs,title:"No Sessions Scheduled",description:"You don't have any coaching sessions scheduled yet."})]}):r.jsxs("div",{className:"space-y-8 animate-in fade-in duration-500",children:[r.jsxs("div",{className:"flex flex-col md:flex-row md:items-end justify-between gap-4",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-heading font-bold text-slate-900 dark:text-white",children:"Coaching Sessions"}),r.jsx("p",{className:"mt-2 text-slate-500 font-medium max-w-2xl",children:"Track your upcoming meetings with coaches and review your past attendance interaction records."})]}),r.jsxs("div",{className:"flex gap-4",children:[r.jsxs("div",{className:"rounded-2xl bg-white px-5 py-3 shadow-sm border border-slate-100 dark:bg-slate-800 dark:border-slate-700",children:[r.jsx("div",{className:"text-xs font-bold uppercase tracking-wider text-slate-400",children:"Upcoming"}),r.jsx("div",{className:"text-2xl font-heading font-bold text-student-primary",children:o.filter(d=>new Date(d.startsAt)>new Date).length})]}),r.jsxs("div",{className:"rounded-2xl bg-white px-5 py-3 shadow-sm border border-slate-100 dark:bg-slate-800 dark:border-slate-700",children:[r.jsx("div",{className:"text-xs font-bold uppercase tracking-wider text-slate-400",children:"Attendance"}),r.jsxs("div",{className:"text-2xl font-heading font-bold text-emerald-600",children:[Math.round(o.reduce((d,f)=>d+(f.status==="completed"?1:0),0)/Math.max(1,o.length)*100),"%"]})]})]})]}),r.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white shadow-sm overflow-hidden dark:bg-slate-800 dark:border-slate-700",children:[r.jsx("div",{className:"border-b border-slate-100 bg-slate-50/50 px-6 py-4 dark:border-slate-700 dark:bg-slate-800",children:r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("span",{className:"text-sm font-bold text-slate-700 dark:text-slate-300",children:"Filter Status:"}),r.jsx("div",{className:"flex bg-slate-200/50 p-1 rounded-xl dark:bg-slate-900/50",children:["all","upcoming","past"].map(d=>r.jsx("button",{onClick:()=>i(d),className:`px-4 py-1.5 rounded-lg text-xs font-bold uppercase tracking-wide transition-all ${a===d?"bg-white text-student-primary shadow-sm ring-1 ring-slate-200 dark:bg-slate-700 dark:ring-slate-600 dark:text-white":"text-slate-500 hover:text-slate-700 hover:bg-slate-200/50 dark:text-slate-400 dark:hover:bg-slate-800"}`,children:d},d))})]})}),r.jsx("div",{className:"divide-y divide-slate-100 dark:divide-slate-700",children:u.length===0?r.jsxs("div",{className:"p-12 text-center",children:[r.jsx("div",{className:"inline-flex h-12 w-12 items-center justify-center rounded-full bg-slate-100 text-slate-400 mb-3",children:r.jsx(gs,{className:"h-6 w-6"})}),r.jsx("div",{className:"text-slate-900 font-semibold",children:"No sessions found"}),r.jsx("div",{className:"text-slate-500 text-sm",children:"Try adjusting your filters"})]}):u.map(d=>{const f=Sb[d.attendanceStatus]||Sb.pending,m=f.icon;return r.jsx("div",{className:"group p-6 hover:bg-slate-50 transition-colors dark:hover:bg-slate-800/50",children:r.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-6",children:[r.jsxs("div",{className:"flex-shrink-0 w-32 flex flex-col items-center justify-center rounded-2xl bg-blue-50/50 p-3 border border-blue-100 dark:bg-blue-900/10 dark:border-blue-800",children:[r.jsx("span",{className:"text-xs font-bold uppercase tracking-wider text-blue-600 dark:text-blue-400",children:es(d.startsAt).split(",")[0]}),r.jsx("span",{className:"text-2xl font-heading font-bold text-slate-800 dark:text-white",children:new Date(d.startsAt).getDate()}),r.jsx("span",{className:"text-xs font-medium text-slate-500 dark:text-slate-400",children:ms(d.startsAt).split(",")[1].trim()})]}),r.jsxs("div",{className:"flex-1 min-w-0 py-1",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[r.jsx("h3",{className:"text-lg font-heading font-bold text-slate-800 dark:text-white group-hover:text-student-primary transition-colors",children:d.title}),d.isUpcoming&&r.jsx("span",{className:"inline-flex items-center gap-1 rounded-full bg-blue-600 px-2.5 py-0.5 text-[10px] font-bold uppercase text-white shadow-sm",children:"Upcoming"})]}),r.jsxs("div",{className:"flex flex-wrap gap-x-6 gap-y-2 text-sm text-slate-500 dark:text-slate-400 mb-3",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"h-6 w-6 rounded-full bg-indigo-100 flex items-center justify-center text-indigo-600",children:r.jsx(fr,{className:"h-3.5 w-3.5"})}),r.jsx("span",{className:"font-medium text-slate-700 dark:text-slate-300",children:d.coachName})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"h-6 w-6 rounded-full bg-slate-100 flex items-center justify-center text-slate-500",children:r.jsx(Ca,{className:"h-3.5 w-3.5"})}),r.jsx("span",{children:d.duration})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"h-6 w-6 rounded-full bg-slate-100 flex items-center justify-center text-slate-500",children:r.jsx(xv,{className:"h-3.5 w-3.5"})}),r.jsx("span",{children:d.location})]})]}),d.description&&r.jsx("p",{className:"text-sm text-slate-500 line-clamp-1 pl-1 border-l-2 border-slate-200 dark:border-slate-700",children:d.description})]}),r.jsx("div",{className:"flex-shrink-0 flex flex-col items-end gap-3 min-w-[140px]",children:d.status==="completed"?r.jsxs("div",{className:`flex w-full items-center justify-center gap-2 px-4 py-2 rounded-xl text-sm font-bold shadow-sm ring-1 ring-inset ${f.color} bg-opacity-10 ring-opacity-20`,children:[r.jsx(m,{className:"h-4 w-4"}),f.label]}):r.jsx("div",{children:d.isUpcoming?r.jsxs("button",{className:"flex w-full items-center justify-center gap-2 rounded-xl bg-student-primary px-4 py-2 text-sm font-bold text-white shadow-md hover:bg-blue-600 active:scale-95 transition-all",children:[r.jsx(Yl,{className:"h-4 w-4"}),"Join Room"]}):r.jsx(ts,{value:d.status})})})]})},d.id)})})]})]})}function aA(){const{currentUser:s,role:e}=gt(),{data:a,sendMessage:i,markAsRead:o,deleteMessageForMe:u,deleteMessageForEveryone:d,getUserById:f,getPresenceForUser:m}=yt(),{showToast:p}=mn(),[x,b]=v.useState(null),[y,j]=v.useState(""),[N,k]=v.useState(""),[T,R]=v.useState(!1),[A,C]=v.useState(!1),[B,F]=v.useState(null),V=v.useRef(null),[O,H]=v.useState(!1),te=v.useRef(null),me=v.useRef(null),de=v.useRef(null),ye=v.useRef(0),Ae=v.useRef(null),Re=v.useRef(null),ze=v.useRef(null),J=v.useRef(null);v.useEffect(()=>{Zv()},[]);const se=v.useMemo(()=>!s?.id||!a?[]:(a.messages??[]).filter(fe=>fe.receiverId===s.id||fe.senderId===s.id).sort((fe,ve)=>new Date(fe.sentAt)-new Date(ve.sentAt)),[s,a]),he=v.useMemo(()=>{if(!s)return new Map;const fe=new Map;for(const ve of se){const le=ve.senderId===s.id,Ee=le?ve.receiverId:ve.senderId;if(!fe.has(Ee)){const ot=f(Ee);fe.set(Ee,{peerId:Ee,peer:ot,peerName:ot?.name??"Unknown User",peerRole:ot?.role??"",messages:[],lastMessage:null,unreadCount:0})}const Ie=fe.get(Ee);Ie.messages.push(ve),Ie.lastMessage=ve,!le&&!ve.readAt&&Ie.unreadCount++}return fe},[se,s,f]),we=v.useMemo(()=>{const fe=Array.from(he.values());return(y.trim()?fe.filter(le=>le.peerName.toLowerCase().includes(y.toLowerCase())):fe).sort((le,Ee)=>{const Ie=le.lastMessage?new Date(le.lastMessage.sentAt):new Date(0);return(Ee.lastMessage?new Date(Ee.lastMessage.sentAt):new Date(0))-Ie})},[he,y]),K=v.useMemo(()=>x?he.get(x)||{peerId:x,peer:f(x),peerName:f(x)?.name??"User",peerRole:f(x)?.role??"",messages:[],unreadCount:0}:null,[he,x,f]),S=v.useMemo(()=>{if(!a||!e)return[];if(e==="student")return(a.users??[]).filter(fe=>fe.role==="coach");if(e==="coach"){const fe=(a.programs??[]).filter(le=>le.coachIds.includes(s?.id)).map(le=>le.id),ve=new Set((a.programs??[]).filter(le=>fe.includes(le.id)).flatMap(le=>le.participantStudentIds));return(a.users??[]).filter(le=>le.role==="student"&&ve.has(le.id))}return[]},[a,e,s]);v.useEffect(()=>{V.current&&V.current.scrollIntoView({behavior:"smooth"})},[K?.messages,O]),v.useEffect(()=>{if(x&&s&&K){const fe=K.messages.filter(ve=>ve.receiverId===s.id&&!ve.readAt).map(ve=>ve.id);fe.length>0&&o({messageIds:fe})}},[x,K,s,o]),v.useEffect(()=>{const fe=K?.messages??[];if(fe.length===0)return;const ve=fe[fe.length-1];if(Ae.current===null){Ae.current=ve.id;return}ve.id!==Ae.current&&(Ae.current=ve.id,ve.senderId===x&&Wv().catch(le=>console.warn("Sound play failed",le)))},[K,x]);const D=v.useMemo(()=>{if(!s?.id||!x)return null;const fe=String(s.id),ve=String(x);return fe<ve?`${fe}:${ve}`:`${ve}:${fe}`},[s?.id,x]),M=tw({currentUserId:s?.id,peerId:x,conversationKey:D});v.useEffect(()=>{if(Re.current)try{Re.current.srcObject=M.localStream??null}catch{}},[M.localStream]),v.useEffect(()=>{if(ze.current)try{ze.current.srcObject=M.remoteStream??null}catch{}if(J.current)try{J.current.srcObject=M.remoteStream??null}catch{}},[M.remoteStream]);const I=async()=>M.status==="incoming"?M.rejectCall():M.endCall(),G=async()=>{(await M.startAudioCall())?.success||p("Call failed (check mic permission / Supabase auth)","error")},ae=async()=>{(await M.startVideoCall())?.success||p("Call failed (check camera permission / Supabase auth)","error")};v.useEffect(()=>{if(Promise.resolve().then(()=>H(!1)),te.current&&(ce.removeChannel(te.current),te.current=null),!D||!x)return;const fe=ce.channel(`typing:${D}`).on("broadcast",{event:"typing"},ve=>{const le=ve?.payload?.from,Ee=!!ve?.payload?.isTyping;!le||le!==x||(H(Ee),me.current&&window.clearTimeout(me.current),Ee&&(me.current=window.setTimeout(()=>H(!1),5e3)))}).subscribe();return te.current=fe,()=>{ce.removeChannel(fe),me.current&&window.clearTimeout(me.current),de.current&&window.clearTimeout(de.current)}},[D,x]);const xe=async fe=>{if(fe?.preventDefault(),!N.trim()||!x)return;const ve=N;k("");try{await i({senderId:s.id,receiverId:x,content:ve,subject:"Message"}),D&&te.current&&(te.current.send({type:"broadcast",event:"typing",payload:{from:s.id,isTyping:!1}}),ye.current=0)}catch{p("Failed to send message","error"),k(ve)}},je=fe=>{if(k(fe.target.value),!D||!te.current)return;const ve=Date.now();de.current&&clearTimeout(de.current),ve-ye.current>2e3&&(te.current.send({type:"broadcast",event:"typing",payload:{from:s.id,isTyping:!0}}),ye.current=ve),de.current=setTimeout(()=>{te.current?.send({type:"broadcast",event:"typing",payload:{from:s.id,isTyping:!1}}),ye.current=0},1500)},Se={recipientId:"",message:""},[pe,qe]=v.useState(Se),Oe=async()=>{if(!pe.recipientId)return p("Select a recipient","error");if(!pe.message.trim())return p("Enter a message","error");try{await i({senderId:s.id,receiverId:pe.recipientId,content:pe.message,subject:"New Conversation"}),R(!1),b(pe.recipientId),qe(Se)}catch{p("Failed to start conversation","error")}};if(!s)return null;const Xe=x?m(x):null,vt=fe=>{fe?.id&&(F({id:fe.id,isMe:fe.senderId===s?.id}),C(!0))};return r.jsxs("div",{className:"h-[calc(100vh-8rem)] min-h-[500px] w-full max-w-7xl mx-auto bg-white rounded-2xl shadow-xl border border-slate-200 overflow-hidden flex font-sans",children:[r.jsxs("div",{className:"w-80 md:w-96 border-r border-slate-100 flex flex-col bg-slate-50/50",children:[r.jsxs("div",{className:"p-4 border-b border-slate-100 bg-white",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("h2",{className:"text-xl font-heading font-bold text-slate-900",children:"Chats"}),r.jsx("button",{onClick:()=>R(!0),className:"p-2 bg-blue-50 text-blue-600 rounded-full hover:bg-blue-100 transition-colors",title:"New Message",children:r.jsx(Yn,{className:"h-5 w-5"})})]}),r.jsxs("div",{className:"relative",children:[r.jsx(Zn,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400"}),r.jsx("input",{type:"text",placeholder:"Search messages...",className:"w-full pl-9 pr-4 py-2 bg-slate-100 border-none rounded-xl text-sm focus:ring-2 focus:ring-blue-500/20 text-slate-900 placeholder:text-slate-500",value:y,onChange:fe=>j(fe.target.value)})]})]}),r.jsx("div",{className:"flex-1 overflow-y-auto",children:we.length===0?r.jsxs("div",{className:"p-8 text-center text-slate-400",children:[r.jsx(Ol,{className:"h-12 w-12 mx-auto mb-2 opacity-20"}),r.jsx("p",{className:"text-sm",children:"No conversations yet"}),r.jsx("button",{onClick:()=>R(!0),className:"text-sm text-blue-600 font-semibold mt-2 hover:underline",children:"Start one"})]}):we.map(fe=>r.jsxs("button",{onClick:()=>b(fe.peerId),className:it("w-full p-4 flex items-center gap-3 hover:bg-white transition-colors border-l-4 border-transparent text-left",x===fe.peerId?"bg-white border-blue-600 shadow-sm z-10":"border-transparent hover:border-slate-300"),children:[r.jsxs("div",{className:"relative shrink-0",children:[r.jsx("div",{className:it("w-12 h-12 rounded-full flex items-center justify-center text-white font-heading font-bold text-lg",fe.peerRole==="student"?"bg-indigo-500":fe.peerRole==="coach"?"bg-emerald-500":"bg-slate-500"),children:fe.peerName.charAt(0)}),m(fe.peerId)?.online&&r.jsx("div",{className:"absolute bottom-0 right-0 w-3.5 h-3.5 bg-green-500 border-2 border-white rounded-full"})]}),r.jsxs("div",{className:"min-w-0 flex-1",children:[r.jsxs("div",{className:"flex justify-between items-baseline mb-1",children:[r.jsx("span",{className:it("font-semibold truncate",x===fe.peerId?"text-slate-900":"text-slate-700"),children:fe.peerName}),fe.lastMessage&&r.jsx("span",{className:"text-[10px] text-slate-400 shrink-0",children:ms(fe.lastMessage.sentAt).split(",")[0]})]}),r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("p",{className:it("text-sm truncate max-w-[140px]",fe.unreadCount>0?"font-bold text-slate-800":"text-slate-500"),children:fe.lastMessage?.content??"No messages"}),fe.unreadCount>0&&r.jsx("span",{className:"bg-blue-600 text-white text-[10px] h-5 min-w-[20px] px-1.5 rounded-full flex items-center justify-center font-bold",children:fe.unreadCount>9?"9+":fe.unreadCount})]})]})]},fe.peerId))})]}),r.jsx("div",{className:"flex-1 flex flex-col bg-white",children:x?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"h-16 px-6 border-b border-slate-100 flex items-center justify-between shrink-0 bg-white",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:it("w-10 h-10 rounded-full flex items-center justify-center text-white font-heading font-bold",K?.peerRole==="student"?"bg-indigo-500":K?.peerRole==="coach"?"bg-emerald-500":"bg-slate-500"),children:K?.peerName.charAt(0)}),r.jsxs("div",{children:[r.jsx("h3",{className:"font-heading font-bold text-slate-900 leading-none",children:K?.peerName}),r.jsx("div",{className:"text-xs text-slate-500 mt-1 flex items-center gap-1.5",children:Xe?.online?r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-green-500"}),r.jsx("span",{className:"font-medium text-green-600",children:"Online"})]}):Xe?.lastSeenAt?r.jsxs("span",{children:["Last seen ",new Date(Xe.lastSeenAt).toLocaleString()]}):r.jsx("span",{className:"uppercase tracking-wider text-[10px]",children:K?.peerRole})})]})]}),r.jsxs("div",{className:"flex items-center gap-2 text-slate-400",children:[r.jsx("button",{type:"button",onClick:G,className:"p-2 hover:bg-slate-100 rounded-full transition-colors",title:"Audio call",children:r.jsx(bv,{className:"h-5 w-5"})}),r.jsx("button",{type:"button",onClick:ae,className:"p-2 hover:bg-slate-100 rounded-full transition-colors",title:"Video call",children:r.jsx(Yl,{className:"h-5 w-5"})}),r.jsx("button",{className:"p-2 hover:bg-slate-100 rounded-full transition-colors",children:r.jsx(Rl,{className:"h-5 w-5"})})]})]}),r.jsx("div",{className:"flex-1 overflow-y-auto p-6 bg-slate-50/30",children:r.jsxs("div",{className:"flex flex-col gap-4",children:[K.messages.map((fe,ve)=>{const le=fe.senderId===s.id,Ee=!le&&(ve===0||K.messages[ve-1].senderId!==fe.senderId),Ie=!!fe.readAt;return r.jsxs("div",{className:it("flex w-full items-end gap-2 group",le?"justify-end":"justify-start"),children:[!le&&r.jsx("div",{className:"w-8 h-8 shrink-0 mb-1",children:Ee&&r.jsx("div",{className:it("w-8 h-8 rounded-full flex items-center justify-center text-white text-xs font-bold",K?.peerRole==="student"?"bg-indigo-500":K?.peerRole==="coach"?"bg-emerald-500":"bg-slate-500"),children:K?.peerName.charAt(0)})}),r.jsxs("div",{className:it("max-w-[70%] px-4 py-2.5 rounded-2xl shadow-sm text-sm leading-relaxed relative pr-12 group/bubble",le?"bg-blue-600 text-white rounded-br-none":"bg-white text-slate-800 border border-slate-100 rounded-bl-none"),children:[r.jsx("div",{className:"break-words",children:fe.content}),r.jsxs("div",{className:it("text-[10px] mt-1 text-right flex items-center justify-end gap-1 select-none",le?"text-blue-100/80":"text-slate-400"),children:[new Date(fe.sentAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),le&&(Ie?r.jsx("div",{className:"flex items-center gap-0.5",children:r.jsx(Lc,{className:"h-3.5 w-3.5 text-blue-200"})}):r.jsx(hv,{className:"h-3.5 w-3.5 text-blue-200/70"}))]}),r.jsx("button",{type:"button",onClick:ot=>{ot.stopPropagation(),vt(fe)},className:it("absolute top-1 right-1 opacity-0 group-hover/bubble:opacity-100 transition-opacity p-1 rounded-full",le?"hover:bg-blue-700 text-blue-100":"hover:bg-slate-100 text-slate-400"),title:"Options",children:r.jsx(Rl,{className:"h-3.5 w-3.5"})})]})]},fe.id)}),O&&r.jsxs("div",{className:"flex w-full items-end gap-2 justify-start",children:[r.jsx("div",{className:"w-8 h-8 shrink-0 mb-1",children:r.jsx("div",{className:it("w-8 h-8 rounded-full flex items-center justify-center text-white text-xs font-bold",K?.peerRole==="student"?"bg-indigo-500":K?.peerRole==="coach"?"bg-emerald-500":"bg-slate-500"),children:K?.peerName.charAt(0)})}),r.jsxs("div",{className:"bg-white px-4 py-3 rounded-2xl rounded-bl-none shadow-sm border border-slate-100 flex gap-1 items-center",children:[r.jsx("span",{className:"w-1.5 h-1.5 bg-slate-400 rounded-full animate-bounce"}),r.jsx("span",{className:"w-1.5 h-1.5 bg-slate-400 rounded-full animate-bounce [animation-delay:0.1s]"}),r.jsx("span",{className:"w-1.5 h-1.5 bg-slate-400 rounded-full animate-bounce [animation-delay:0.2s]"})]})]}),r.jsx("div",{ref:V})]})}),r.jsx("div",{className:"p-4 bg-white border-t border-slate-100",children:r.jsxs("form",{onSubmit:xe,className:"flex gap-3 items-end",children:[r.jsx("div",{className:"flex-1 bg-slate-100 rounded-2xl px-4 py-3 focus-within:ring-2 focus-within:ring-blue-100 focus-within:bg-white transition-all border border-transparent focus-within:border-blue-200",children:r.jsx("input",{type:"text",className:"w-full bg-transparent border-none focus:outline-none text-slate-800 placeholder:text-slate-400 text-sm max-h-32",placeholder:`Message ${K?.peerName}...`,value:N,onChange:je})}),r.jsx("button",{type:"submit",disabled:!N.trim(),className:"p-3 bg-blue-600 text-white rounded-xl hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors shadow-md active:scale-95 flex items-center justify-center",children:r.jsx(yv,{className:"h-5 w-5"})})]})}),r.jsx(ew,{open:M.status!=="idle"&&M.status!=="ended",status:M.status,direction:M.direction,callType:M.callType,peerName:K?.peerName,error:M.error,muted:M.muted,cameraOff:M.cameraOff,onAccept:M.acceptCall,onReject:M.rejectCall,onEnd:I,onToggleMute:M.toggleMute,onToggleCamera:M.toggleCamera,localVideoRef:Re,remoteVideoRef:ze,remoteAudioRef:J})]}):r.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center text-slate-300 p-8",children:[r.jsx("div",{className:"w-24 h-24 bg-slate-50 rounded-full flex items-center justify-center mb-4",children:r.jsx(Ol,{className:"h-10 w-10 text-slate-300"})}),r.jsx("h3",{className:"text-lg font-heading font-semibold text-slate-900 mb-1",children:"Your Messages"}),r.jsx("p",{className:"text-slate-500 text-center max-w-xs text-sm",children:"Select a conversation from the sidebar or start a new one to begin messaging."}),r.jsx("button",{onClick:()=>R(!0),className:"mt-6 px-6 py-2.5 bg-blue-600 text-white rounded-xl font-semibold hover:bg-blue-700 transition-colors shadow-md",children:"New Message"})]})}),T&&r.jsx(Pt,{title:"New Message",onClose:()=>R(!1),footer:r.jsxs(r.Fragment,{children:[r.jsx("button",{className:"btn-ghost",onClick:()=>R(!1),children:"Cancel"}),r.jsx("button",{className:"btn-primary",onClick:Oe,children:"Send Message"})]}),children:r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Recipient"}),r.jsxs("select",{className:"w-full rounded-lg border-slate-200 text-sm focus:ring-blue-500",value:pe.recipientId,onChange:fe=>qe({...pe,recipientId:fe.target.value}),children:[r.jsx("option",{value:"",children:"Select a user..."}),S.map(fe=>r.jsxs("option",{value:fe.id,children:[fe.name," (",fe.role,")"]},fe.id))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Message"}),r.jsx("textarea",{className:"w-full rounded-lg border-slate-200 text-sm focus:ring-blue-500",rows:4,placeholder:"Type your first message...",value:pe.message,onChange:fe=>qe({...pe,message:fe.target.value})})]})]})}),A&&B&&r.jsx(Pt,{title:"Delete Message",onClose:()=>{C(!1),F(null)},footer:r.jsxs("div",{className:"flex flex-col gap-2 w-full sm:flex-row sm:justify-end",children:[r.jsx("button",{className:"px-4 py-2 text-slate-600 hover:bg-slate-100 rounded-lg text-sm font-medium transition-colors",onClick:()=>{C(!1),F(null)},children:"Cancel"}),r.jsx("button",{className:"px-4 py-2 text-red-600 bg-red-50 hover:bg-red-100 rounded-lg text-sm font-medium transition-colors",onClick:async()=>{(await u?.({messageId:B.id}))?.success||p("Failed to delete","error"),C(!1),F(null)},children:"Delete for me"}),B.isMe&&r.jsx("button",{className:"px-4 py-2 bg-red-600 text-white hover:bg-red-700 rounded-lg text-sm font-medium shadow-sm transition-colors",onClick:async()=>{(await d?.({messageId:B.id}))?.success||p("Failed to delete","error"),C(!1),F(null)},children:"Delete for everyone"})]}),children:r.jsxs("div",{className:"text-sm text-slate-600 leading-relaxed",children:["Are you sure you want to delete this message?",B.isMe&&r.jsx("p",{className:"mt-2 text-xs text-slate-500 bg-slate-50 p-3 rounded-lg border border-slate-100",children:'"Delete for everyone" will remove the message for all participants. "Delete for me" only removes it from your view.'})]})})]})}const rA={first_submission:{label:"First Submission",icon:"",color:"bg-success-50 text-success-700"},perfect_attendance:{label:"Perfect Attendance",icon:"",color:"bg-secondary-50 text-secondary-700"},team_player:{label:"Team Player",icon:"",color:"bg-primary/10 text-primary"},top_performer:{label:"Top Performer",icon:"",color:"bg-warning-50 text-warning-700"}};function _b(){const{currentUser:s,role:e}=gt(),{data:a}=yt(),{showToast:i}=mn(),[o,u]=v.useState(!1),[d,f]=v.useState(!1),[m,p]=v.useState({name:s?.name??"",email:s?.email??"",university:s?.university??"",major:s?.major??"",bio:s?.bio??"",expertise:s?.expertise??""}),x=(a?.users??[]).find(A=>A.id===s?.id),b=x?.id?`${x.id.slice(0,8)}${x.id.slice(-4)}`:"",y=()=>{u(!0),p({name:x?.name??"",email:x?.email??"",university:x?.university??"",major:x?.major??"",bio:x?.bio??"",expertise:x?.expertise??""})},j=()=>{u(!1)},N=()=>{i("Profile updated successfully!","success"),u(!1)},k=(A,C)=>{p(B=>({...B,[A]:C}))},T=e==="coach"?(a?.programs??[]).filter(A=>A.coachIds.includes(x?.id)):(a?.programs??[]).filter(A=>A.participantStudentIds.includes(x?.id)),R=e==="student"?{xp:x?.xp??0,level:x?.level??1,badges:x?.badges??[],programsCount:T.length}:{programsCount:T.length,studentsCount:T.reduce((A,C)=>A+C.participantStudentIds.length,0)};return x?r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-2xl font-bold text-foreground",children:"My Profile"}),r.jsx("p",{className:"mt-1 text-muted-foreground",children:"Manage your profile information"})]}),o?r.jsxs("div",{className:"flex gap-2",children:[r.jsxs("button",{type:"button",className:"btn-ghost",onClick:j,children:[r.jsx(Qf,{className:"h-4 w-4"}),"Cancel"]}),r.jsxs("button",{type:"button",className:"btn-primary",onClick:N,children:[r.jsx(ak,{className:"h-4 w-4"}),"Save"]})]}):r.jsxs("button",{type:"button",className:"btn-primary",onClick:y,children:[r.jsx(Y_,{className:"h-4 w-4"}),"Edit Profile"]})]}),r.jsxs("div",{className:"grid gap-6 lg:grid-cols-3",children:[r.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[r.jsx(Ye,{title:"Basic Information",children:r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-foreground",children:"Name"}),o?r.jsx("input",{type:"text",className:"mt-2 w-full rounded-lg border border-border bg-background px-3 py-2 text-sm text-foreground focus:border-primary focus:outline-none focus:ring-1 focus:ring-primary",value:m.name,onChange:A=>k("name",A.target.value)}):r.jsxs("div",{className:"mt-2 flex items-center gap-2 text-foreground",children:[r.jsx(fr,{className:"h-4 w-4 text-muted-foreground"}),x.name]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-foreground",children:"Email"}),o?r.jsx("input",{type:"email",className:"mt-2 w-full rounded-lg border border-border bg-background px-3 py-2 text-sm text-foreground focus:border-primary focus:outline-none focus:ring-1 focus:ring-primary",value:m.email,onChange:A=>k("email",A.target.value)}):r.jsxs("div",{className:"mt-2 flex items-center gap-2 text-foreground",children:[r.jsx(gv,{className:"h-4 w-4 text-muted-foreground"}),x.email]})]})]}),e==="student"&&r.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-foreground",children:"University"}),o?r.jsx("input",{type:"text",className:"mt-2 w-full rounded-lg border border-border bg-background px-3 py-2 text-sm text-foreground focus:border-primary focus:outline-none focus:ring-1 focus:ring-primary",value:m.university,onChange:A=>k("university",A.target.value)}):r.jsxs("div",{className:"mt-2 flex items-center gap-2 text-foreground",children:[r.jsx(ik,{className:"h-4 w-4 text-muted-foreground"}),x.university]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-foreground",children:"Major"}),o?r.jsx("input",{type:"text",className:"mt-2 w-full rounded-lg border border-border bg-background px-3 py-2 text-sm text-foreground focus:border-primary focus:outline-none focus:ring-1 focus:ring-primary",value:m.major,onChange:A=>k("major",A.target.value)}):r.jsxs("div",{className:"mt-2 flex items-center gap-2 text-foreground",children:[r.jsx(Al,{className:"h-4 w-4 text-muted-foreground"}),x.major]})]})]}),e==="coach"&&x.expertise&&r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-foreground",children:"Expertise"}),o?r.jsx("input",{type:"text",className:"mt-2 w-full rounded-lg border border-border bg-background px-3 py-2 text-sm text-foreground focus:border-primary focus:outline-none focus:ring-1 focus:ring-primary",value:m.expertise,onChange:A=>k("expertise",A.target.value)}):r.jsx("div",{className:"mt-2 text-foreground",children:x.expertise})]}),x.bio&&r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-foreground",children:"Bio"}),o?r.jsx("textarea",{className:"mt-2 w-full rounded-lg border border-border bg-background px-3 py-2 text-sm text-foreground focus:border-primary focus:outline-none focus:ring-1 focus:ring-primary",rows:4,value:m.bio,onChange:A=>k("bio",A.target.value)}):r.jsx("p",{className:"mt-2 text-sm text-muted-foreground",children:x.bio})]})]})}),r.jsx(Ye,{title:"My Programs",children:T.length===0?r.jsx("div",{className:"py-8 text-center text-sm text-muted-foreground",children:"No programs yet"}):r.jsx("div",{className:"space-y-2",children:T.map(A=>r.jsx("div",{className:"flex items-center justify-between rounded-lg border border-border/50 bg-muted/30 p-3",children:r.jsxs("div",{children:[r.jsx("div",{className:"font-medium text-foreground",children:A.name}),r.jsxs("div",{className:"text-sm text-muted-foreground",children:[A.participantStudentIds.length," participant",A.participantStudentIds.length===1?"":"s"]})]})},A.id))})})]}),r.jsxs("div",{className:"space-y-6",children:[e==="student"&&r.jsxs(r.Fragment,{children:[r.jsx(Ye,{title:"Level & XP",children:r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx("div",{className:"grid h-16 w-16 place-items-center rounded-full bg-primary/10 text-primary",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-2xl font-bold",children:R.level}),r.jsx("div",{className:"text-xs",children:"Level"})]})}),r.jsxs("div",{children:[r.jsx("div",{className:"text-sm text-muted-foreground",children:"Total XP"}),r.jsx("div",{className:"text-2xl font-bold text-foreground",children:R.xp})]})]})}),R.badges.length>0&&r.jsx(Ye,{title:"Badges",subtitle:`${R.badges.length} earned`,children:r.jsx("div",{className:"flex flex-wrap gap-2",children:R.badges.map(A=>{const C=rA[A];return C?r.jsxs("div",{className:`flex items-center gap-2 rounded-full px-3 py-1.5 text-sm font-medium ${C.color}`,children:[r.jsx("span",{children:C.icon}),r.jsx("span",{children:C.label})]},A):null})})})]}),r.jsx(Ye,{title:"Statistics",children:r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-sm text-muted-foreground",children:"Programs"}),r.jsx("span",{className:"text-lg font-semibold text-foreground",children:R.programsCount})]}),e==="coach"&&r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-sm text-muted-foreground",children:"Students"}),r.jsx("span",{className:"text-lg font-semibold text-foreground",children:R.studentsCount})]})]})}),r.jsx(Ye,{title:"Account",children:r.jsxs("div",{className:"space-y-2 text-sm",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:"Role"}),r.jsx("span",{className:"font-medium capitalize text-foreground",children:e})]}),r.jsx("div",{className:"pt-1",children:r.jsx("button",{type:"button",onClick:()=>f(A=>!A),className:"text-xs font-semibold text-primary hover:text-primary-600 focus:outline-none focus:underline",children:d?"Hide advanced":"Show advanced"})}),d&&x?.id&&r.jsxs("div",{className:"flex items-center justify-between gap-3",children:[r.jsx("span",{className:"text-muted-foreground",children:"User ID"}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"font-mono text-xs text-foreground",title:x.id,children:b}),r.jsx("button",{type:"button",className:"rounded-md border border-border bg-background px-2 py-1 text-xs font-medium text-foreground hover:bg-muted",onClick:async()=>{try{await navigator.clipboard.writeText(x.id),i("User ID copied to clipboard","success")}catch{i("Could not copy User ID","error")}},children:"Copy"})]})]})]})})]})]})]}):r.jsx("div",{className:"flex items-center justify-center py-12",children:r.jsx("div",{className:"text-muted-foreground",children:"Loading..."})})}function iA(){return r.jsx("div",{className:"app-container flex min-h-screen items-center justify-center px-4",children:r.jsxs("div",{className:"surface p-6 text-center",children:[r.jsx("div",{className:"text-sm font-semibold text-foreground",children:"Unauthorized"}),r.jsx("div",{className:"mt-2 text-sm text-muted-foreground",children:"You do not have access to that page."}),r.jsx("div",{className:"mt-4",children:r.jsx(Zc,{className:"btn-primary",to:"/",children:"Go home"})})]})})}function lA(){return r.jsx("div",{className:"app-container flex min-h-screen items-center justify-center px-4",children:r.jsxs("div",{className:"surface p-6 text-center",children:[r.jsx("div",{className:"text-sm font-semibold text-foreground",children:"Page not found"}),r.jsx("div",{className:"mt-2 text-sm text-muted-foreground",children:"The page you requested does not exist."}),r.jsx("div",{className:"mt-4",children:r.jsx(Zc,{className:"btn-primary",to:"/",children:"Go home"})})]})})}function oA(){const{isAuthenticated:s,role:e}=gt();return s?e===on.admin?r.jsx(di,{to:"/admin",replace:!0}):e===on.coach?r.jsx(di,{to:"/coach",replace:!0}):r.jsx(di,{to:"/student",replace:!0}):r.jsx(di,{to:"/login",replace:!0})}function cA(){return r.jsxs(n2,{children:[r.jsx(et,{path:"/",element:r.jsx(oA,{})}),r.jsx(et,{path:"/login",element:r.jsx(Ok,{})}),r.jsx(et,{path:"/unauthorized",element:r.jsx(iA,{})}),r.jsxs(et,{path:"/admin",element:r.jsx(_h,{allowedRoles:[on.admin],children:r.jsx(Ak,{})}),children:[r.jsx(et,{index:!0,element:r.jsx(Lk,{})}),r.jsx(et,{path:"projects",element:r.jsx(Zk,{})}),r.jsx(et,{path:"programs",element:r.jsx($k,{})}),r.jsx(et,{path:"applications",element:r.jsx(Fk,{})}),r.jsx(et,{path:"users",element:r.jsx(Hk,{})}),r.jsx(et,{path:"sessions",element:r.jsx(bc,{title:"Sessions overview",message:"Coming next."})}),r.jsx(et,{path:"reports",element:r.jsx(bc,{title:"Reports",message:"System analytics coming soon."})}),r.jsx(et,{path:"communications",element:r.jsx(bc,{title:"Communications",message:"Platform messaging center."})}),r.jsx(et,{path:"settings",element:r.jsx(bc,{title:"Settings",message:"Platform configuration."})})]}),r.jsxs(et,{path:"/coach",element:r.jsx(_h,{allowedRoles:[on.coach],children:r.jsx(Rk,{})}),children:[r.jsx(et,{index:!0,element:r.jsx(Wk,{})}),r.jsx(et,{path:"projects",element:r.jsx(eT,{})}),r.jsx(et,{path:"tasks",element:r.jsx(GC,{})}),r.jsx(et,{path:"students",element:r.jsx(aT,{})}),r.jsx(et,{path:"programs",element:r.jsx(tT,{})}),r.jsx(et,{path:"sessions",element:r.jsx(sT,{})}),r.jsx(et,{path:"deliverables",element:r.jsx(nT,{})}),r.jsx(et,{path:"messages",element:r.jsx(zC,{})}),r.jsx(et,{path:"profile",element:r.jsx(_b,{})})]}),r.jsxs(et,{path:"/student",element:r.jsx(_h,{allowedRoles:[on.student],children:r.jsx(Dk,{})}),children:[r.jsx(et,{index:!0,element:r.jsx(FC,{})}),r.jsx(et,{path:"projects",element:r.jsx(XC,{})}),r.jsx(et,{path:"tasks",element:r.jsx(sA,{})}),r.jsx(et,{path:"programs",element:r.jsx(JC,{})}),r.jsx(et,{path:"applications",element:r.jsx(QC,{})}),r.jsx(et,{path:"deliverables",element:r.jsx(ZC,{})}),r.jsx(et,{path:"sessions",element:r.jsx(nA,{})}),r.jsx(et,{path:"messages",element:r.jsx(aA,{})}),r.jsx(et,{path:"profile",element:r.jsx(_b,{})})]}),r.jsx(et,{path:"*",element:r.jsx(lA,{})})]})}function uA({children:s}){const[e,a]=v.useState(null),[i,o]=v.useState(!0),u=v.useCallback(N=>N==="admin"||N==="coach"||N==="student"?N:"student",[]),d=v.useCallback((N,k)=>{const T=typeof N=="string"?N.trim():"";return T||(typeof k=="string"&&k.includes("@")?k.split("@")[0]:"User")},[]),f=v.useCallback(async N=>{try{const{data:k,error:T}=await ce.from("users").select("*").eq("id",N).maybeSingle();if(T)throw T;return k?(a({id:k.id,role:k.role,name:k.name,email:k.email}),!0):!1}catch(k){return console.error("Error fetching user details:",k),!1}finally{o(!1)}},[]),m=v.useCallback(async N=>{const k=N?.email??"",T=N?.user_metadata??{},R=u(T.role),A=d(T.name,k),{error:C}=await ce.from("users").insert({id:N.id,email:k,name:A,role:R});if(C)throw C},[d,u]),p=v.useCallback(async N=>{try{return await f(N.id)?!0:(await m(N),await f(N.id))}catch(k){return console.error("Error ensuring user profile:",k),o(!1),!1}},[m,f]);v.useEffect(()=>{ce.auth.getSession().then(({data:{session:k}})=>{k?.user?p(k.user):o(!1)});const{data:{subscription:N}}=ce.auth.onAuthStateChange((k,T)=>{T?.user?p(T.user):(a(null),o(!1))});return()=>N.unsubscribe()},[p]);const x=v.useCallback(async({email:N,password:k})=>{try{const{data:T,error:R}=await ce.auth.signInWithPassword({email:N,password:k});if(R)throw R;return T.session?.user&&!await p(T.session.user)?{success:!1,error:"Login successful, but user profile could not be created. Check RLS policies."}:{success:!0}}catch(T){return console.error("Login error:",T),{success:!1,error:T.message}}},[p]),b=v.useCallback(async({email:N,password:k,name:T,role:R})=>{try{const{data:A,error:C}=await ce.auth.signUp({email:N,password:k,options:{data:{name:T,role:R}}});if(C)throw C;if(!A.user)throw new Error("No user data returned");if(!A.session)return{success:!0,needsEmailConfirmation:!0};const{error:B}=await ce.from("users").insert({id:A.user.id,email:N,name:T,role:u(R)});if(B)throw await ce.auth.signOut(),new Error(`Profile creation failed: ${B.message}`);return{success:!0,needsEmailConfirmation:!1}}catch(A){return console.error("Signup error:",A),{success:!1,error:A.message}}},[u]),y=v.useCallback(async()=>{try{if(e?.id)try{await ce.from("user_presence").upsert({user_id:e.id,online:!1,last_seen_at:new Date().toISOString()})}catch{}const{error:N}=await ce.auth.signOut();if(N)throw N;a(null)}catch(N){console.error("Logout error:",N)}},[e]),j=v.useMemo(()=>({currentUser:e,isAuthenticated:!!e?.id,role:e?.role??null,loading:i,login:x,signup:b,logout:y}),[e,i,x,b,y]);return r.jsx(_v.Provider,{value:j,children:s})}function dA({children:s}){const[e,a]=v.useState(!1),[i,o]=v.useState(null),u=v.useRef(null),d=v.useRef(null),f=v.useRef({inbox:null,outbox:null}),m=v.useRef(null),p=v.useRef(null),[x,b]=v.useState({}),[y,j]=v.useState({users:[],programs:[],applications:[],coachingSessions:[],deliverables:[],messages:[],messageDeletions:[],projects:[],projectSubmissions:[],notifications:[],tasks:[]}),N=v.useCallback(_=>{const L=_.program_coaches?.map(z=>z.coach_id)||[],U=_.program_participants?.map(z=>z.student_id)||[];return{id:_.id,name:_.name,description:_.description,durationWeeks:_.duration_weeks,startDate:_.start_date,endDate:_.end_date,capacity:_.capacity,status:_.status,createdAt:_.created_at,updatedAt:_.updated_at,coachIds:L,participantStudentIds:U}},[]),k=v.useCallback(_=>({id:_.id,programId:_.program_id,studentId:_.student_id,status:_.status,motivation:_.motivation,decisionNote:_.decision_note,reviewedBy:_.reviewed_by,createdAt:_.created_at,updatedAt:_.updated_at}),[]),T=v.useCallback(_=>{const L=_.session_attendees?.map(U=>U.student_id)||[];return{id:_.id,programId:_.program_id,coachId:_.coach_id,title:_.title,description:_.description,startsAt:_.starts_at,endsAt:_.ends_at,location:_.location,status:_.status,notes:_.notes,createdAt:_.created_at,updatedAt:_.updated_at,attendeeStudentIds:L,attendance:_.session_attendees||[]}},[]),R=v.useCallback(_=>({id:_.id,deliverableId:_.deliverable_id,studentId:_.student_id,status:_.status,submittedAt:_.submitted_at,files:_.files,grade:_.grade,feedback:_.feedback,reviewedAt:_.reviewed_at,reviewerId:_.reviewer_id,createdAt:_.created_at,updatedAt:_.updated_at}),[]),A=v.useCallback(_=>{const L=_.deliverable_assignments?.map(z=>z.student_id)||[],U=(_.submissions||[]).map(R);return{id:_.id,programId:_.program_id,title:_.title,description:_.description,dueDate:_.due_date,maxScore:_.max_score,createdAt:_.created_at,updatedAt:_.updated_at,assignedStudentIds:L,submissions:U}},[R]),C=v.useCallback(_=>({id:_.id,senderId:_.sender_id,receiverId:_.recipient_id,subject:_.subject,content:_.body,sentAt:_.created_at,readAt:_.seen_at||(_.read?_.updated_at??_.created_at:null),seenAt:_.seen_at}),[]),B=v.useCallback(_=>({id:_.id,userId:_.user_id,messageId:_.message_id,deletedAt:_.deleted_at}),[]),F=v.useCallback(_=>({id:_.id,userId:_.user_id,type:_.type,title:_.title,message:_.message,linkUrl:_.link_url,meta:_.meta,createdAt:_.created_at,readAt:_.read_at}),[]),V=v.useCallback(_=>({id:_.id,projectId:_.project_id,submissionId:_.submission_id??null,title:_.title,description:_.description??null,taskType:Wx(_.task_type),status:Zx(_.status),deadline:_.deadline??null,checklistItems:_.checklist_items??null,studentSubmission:_.student_submission??null,coachFeedback:_.coach_feedback??null,createdBy:_.created_by,createdAt:_.created_at,updatedAt:_.updated_at,submittedAt:_.submitted_at??null,reviewedAt:_.reviewed_at??null,reviewedBy:_.reviewed_by??null}),[]),O=v.useCallback(_=>({id:_.id,studentId:_.student_id,title:_.title,stage:_.stage,createdAt:_.created_at,updatedAt:_.updated_at}),[]),H=v.useCallback(_=>({id:_.id,projectId:_.project_id,type:_.type,status:_.status,payload:_.payload,comments:_.comments,reviewerId:_.reviewer_id,reviewedAt:_.reviewed_at,createdAt:_.created_at,updatedAt:_.updated_at}),[]),te=v.useCallback(_=>{const L=_?.code,U=String(_?.message??"");if(L==="42P01")return!0;const z=U.toLowerCase();return!!(z.includes("could not find the table")||z.includes("relation")&&z.includes("does not exist")||z.includes("schema cache")&&z.includes("projects")||z.includes("schema cache")&&z.includes("project_submissions"))},[]),me=v.useCallback(_=>({userId:_.user_id,online:!!_.online,lastSeenAt:_.last_seen_at,updatedAt:_.updated_at}),[]),de=v.useCallback(async()=>{try{const[_,L,U,z,Z,re]=await Promise.all([ce.from("users").select("*"),ce.from("programs").select(`
          *,
          program_coaches(coach_id),
          program_participants(student_id)
        `),ce.from("applications").select("*"),ce.from("coaching_sessions").select(`
          *,
          session_attendees(student_id, attendance_status)
        `),ce.from("deliverables").select(`
          *,
          deliverable_assignments(student_id),
          submissions(*)
        `),ce.from("messages").select("*")]);let ue=[];try{const{data:mt}=await ce.from("message_deletions").select("*");ue=(mt||[]).map(B)}catch(mt){console.warn("Could not fetch message_deletions",mt)}const ge=(L.data||[]).map(N),be=(U.data||[]).map(k),Me=(z.data||[]).map(T),Be=(Z.data||[]).map(A),Ve=(re.data||[]).map(C);let nt=[],st=[];try{const[mt,St]=await Promise.all([ce.from("projects").select("*").order("updated_at",{ascending:!1}),ce.from("project_submissions").select("*").order("created_at",{ascending:!0})]);if(mt.error)throw mt.error;if(St.error)throw St.error;nt=(mt.data??[]).map(O),st=(St.data??[]).map(H)}catch(mt){console.error("Could not fetch projects from Supabase:",mt),nt=[],st=[]}let Gt=[];try{const{data:mt,error:St}=await ce.from("notifications").select("*").order("created_at",{ascending:!1});!St&&Array.isArray(mt)&&(Gt=mt.map(F))}catch{}let Tt=[];try{const{data:mt,error:St}=await ce.from("tasks").select("*").order("created_at",{ascending:!1});!St&&Array.isArray(mt)&&(Tt=mt.map(V))}catch(mt){console.warn("Could not fetch tasks from Supabase:",mt)}j({users:_.data||[],programs:ge,applications:be,coachingSessions:Me,deliverables:Be,messages:Ve,messageDeletions:ue,projects:nt,projectSubmissions:st,notifications:Gt,tasks:Tt}),a(!0)}catch(_){console.error("Error fetching data:",_),a(!0)}},[k,T,A,C,B,F,N,O,H,V]),ye=v.useCallback(async()=>{try{const[_,L]=await Promise.all([ce.from("projects").select("*").order("updated_at",{ascending:!1}),ce.from("project_submissions").select("*").order("created_at",{ascending:!0})]);if(_.error)throw _.error;if(L.error)throw L.error;const U=(_.data??[]).map(O),z=(L.data??[]).map(H);return j(Z=>({...Z,projects:U,projectSubmissions:z})),{success:!0}}catch(_){return te(_)?{success:!1,error:_,missingTable:!0}:{success:!1,error:_}}},[te,O,H]);v.useEffect(()=>{i&&de()},[de,i]),v.useEffect(()=>{if(!i)return;let _;try{_=ce.channel("realtime-projects").on("postgres_changes",{event:"*",schema:"public",table:"projects"},L=>{j(U=>{const z=U.projects??[],Z=L.eventType;if(Z==="DELETE"){const ge=L.old?.id;return{...U,projects:z.filter(be=>be.id!==ge)}}const re=L.new?O(L.new):null;if(!re)return U;const ue=z.some(ge=>ge.id===re.id);return Z==="INSERT"&&!ue?{...U,projects:[re,...z]}:Z==="UPDATE"&&ue?{...U,projects:z.map(ge=>ge.id===re.id?re:ge)}:ue?U:{...U,projects:[re,...z]}})}).on("postgres_changes",{event:"*",schema:"public",table:"project_submissions"},L=>{j(U=>{const z=U.projectSubmissions??[],Z=L.eventType;if(Z==="DELETE"){const ge=L.old?.id;return{...U,projectSubmissions:z.filter(be=>be.id!==ge)}}const re=L.new?H(L.new):null;if(!re)return U;const ue=z.some(ge=>ge.id===re.id);return Z==="INSERT"&&!ue?{...U,projectSubmissions:[...z,re]}:Z==="UPDATE"&&ue?{...U,projectSubmissions:z.map(ge=>ge.id===re.id?re:ge)}:ue?U:{...U,projectSubmissions:[...z,re]}})}).subscribe(),p.current=_}catch(L){console.warn("Projects realtime channel setup failed:",L)}return()=>{try{p.current&&(ce.removeChannel(p.current),p.current=null)}catch{}}},[i,O,H]),v.useEffect(()=>{if(d.current&&(ce.removeChannel(d.current),d.current=null),!i)return;const _=ce.channel("realtime-tasks").on("postgres_changes",{event:"*",schema:"public",table:"tasks"},L=>{j(U=>{const z=U.tasks??[],Z=L.eventType;if(Z==="DELETE"){const ge=L.old?.id;return{...U,tasks:z.filter(be=>be.id!==ge)}}const re=L.new?V(L.new):null;if(!re)return U;const ue=z.some(ge=>ge.id===re.id);return Z==="INSERT"&&!ue?{...U,tasks:[re,...z]}:Z==="UPDATE"&&ue?{...U,tasks:z.map(ge=>ge.id===re.id?re:ge)}:ue?U:{...U,tasks:[re,...z]}})}).subscribe(L=>{L==="SUBSCRIBED"&&ce.from("tasks").select("*").order("created_at",{ascending:!1}).then(({data:U,error:z})=>{!z&&Array.isArray(U)&&j(Z=>({...Z,tasks:U.map(V)}))}).catch(()=>{}),L==="CHANNEL_ERROR"&&console.warn("[Tasks] Realtime channel error. Common causes: `tasks` table not created yet, not added to `supabase_realtime` publication, or RLS/policies block SELECT.",{userId:i})});return d.current=_,()=>{ce.removeChannel(_),d.current===_&&(d.current=null)}},[i,V]),v.useEffect(()=>{let _=!0;ce.auth.getSession().then(({data:{session:U}})=>{_&&o(U?.user?.id??null)});const{data:{subscription:L}}=ce.auth.onAuthStateChange((U,z)=>{_&&o(z?.user?.id??null)});return()=>{_=!1,L.unsubscribe()}},[]);const Ae=v.useCallback(async()=>{try{const{data:_,error:L}=await ce.from("user_presence").select("*");if(L)return{success:!1,error:L};const U={};return(_??[]).forEach(z=>{const Z=me(z);U[Z.userId]=Z}),b(U),{success:!0}}catch(_){return{success:!1,error:_}}},[me]);v.useEffect(()=>{if(!i)return;let _=!1;const L=async()=>{try{const re=new Date().toISOString();await ce.from("user_presence").upsert({user_id:i,online:!0,last_seen_at:re},{onConflict:"user_id"})}catch{}},U=async()=>{try{const re=new Date().toISOString();await ce.from("user_presence").upsert({user_id:i,online:!1,last_seen_at:re},{onConflict:"user_id"})}catch{}};L();const z=window.setInterval(()=>{_||L()},2e4),Z=()=>{document.visibilityState==="hidden"?U():L()};return window.addEventListener("beforeunload",U),document.addEventListener("visibilitychange",Z),()=>{_=!0,window.clearInterval(z),window.removeEventListener("beforeunload",U),document.removeEventListener("visibilitychange",Z),U()}},[i]),v.useEffect(()=>{if(m.current&&(ce.removeChannel(m.current),m.current=null),!i)return;Ae();const _=ce.channel("user_presence").on("postgres_changes",{event:"*",schema:"public",table:"user_presence"},L=>{const U=L?.new;if(!U)return;const z=me(U);b(Z=>({...Z,[z.userId]:z}))}).subscribe();return m.current=_,()=>{ce.removeChannel(_),m.current===_&&(m.current=null)}},[i,me,Ae]);const Re=v.useCallback(({userId:_,unreadOnly:L,limit:U}={})=>{const z=y.notifications??[];let Z=_?z.filter(re=>re.userId===_):z;return L&&(Z=Z.filter(re=>!re.readAt)),Z=[...Z].sort((re,ue)=>new Date(ue.createdAt)-new Date(re.createdAt)),U&&Number.isFinite(U)&&(Z=Z.slice(0,Math.max(0,U))),Z},[y.notifications]),ze=v.useCallback(()=>(y.users??[]).filter(_=>_?.role==="admin"||_?.role==="coach").map(_=>_.id).filter(Boolean),[y.users]),J=v.useCallback(async()=>{try{const{data:_,error:L}=await ce.from("notifications").select("*").order("created_at",{ascending:!1});if(L)return{success:!1,error:L};const U=(_??[]).map(F);return j(z=>({...z,notifications:U})),{success:!0}}catch(_){return{success:!1,error:_}}},[F]);v.useEffect(()=>{if(u.current&&(ce.removeChannel(u.current),u.current=null),!i)return;J();const _=ce.channel(`notifications:${i}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"notifications",filter:`user_id=eq.${i}`},L=>{if(!L?.new)return;const U=F(L.new);j(z=>{const Z=z.notifications??[];return Z.some(re=>re.id===U.id)?z:{...z,notifications:[U,...Z]}})}).on("postgres_changes",{event:"UPDATE",schema:"public",table:"notifications",filter:`user_id=eq.${i}`},L=>{if(!L?.new)return;const U=F(L.new);j(z=>{const re=(z.notifications??[]).map(ue=>ue.id===U.id?{...ue,...U}:ue);return{...z,notifications:re}})}).subscribe(L=>{L==="SUBSCRIBED"&&J().catch(()=>{}),L==="CHANNEL_ERROR"&&console.warn("[Notifications] Realtime channel error. Ensure notifications is in supabase_realtime publication and policies allow SELECT.",{userId:i})});return u.current=_,()=>{ce.removeChannel(_),u.current===_&&(u.current=null)}},[i,F,J]),v.useEffect(()=>{if(f.current?.inbox&&(ce.removeChannel(f.current.inbox),f.current.inbox=null),f.current?.outbox&&(ce.removeChannel(f.current.outbox),f.current.outbox=null),!i)return;const _=z=>{if(z?.eventType==="DELETE"){const be=z?.old?.id;if(!be)return;j(Me=>({...Me,messages:(Me.messages??[]).filter(Be=>Be.id!==be)}));return}const re=z?.new;if(!re)return;const ue=C(re);if(j(ge=>{const be=ge.messages??[],Me=be.findIndex(Be=>Be.id===ue.id);if(Me>=0){const Be=[...be];return Be[Me]={...Be[Me],...ue},{...ge,messages:Be}}return{...ge,messages:[...be,ue]}}),typeof window<"u"){const ge=z?.eventType,be=re?.recipient_id===i&&re?.sender_id&&re?.sender_id!==i;ge==="INSERT"&&be&&(console.log("[DataContext] Dispatching sea:new-message",ue),window.dispatchEvent(new CustomEvent("sea:new-message",{detail:{message:ue}})))}},L=ce.channel(`messages:in:${i}`).on("postgres_changes",{event:"*",schema:"public",table:"messages",filter:`recipient_id=eq.${i}`},z=>_(z)).subscribe(),U=ce.channel(`messages:out:${i}`).on("postgres_changes",{event:"*",schema:"public",table:"messages",filter:`sender_id=eq.${i}`},z=>_(z)).subscribe();return f.current={inbox:L,outbox:U},()=>{ce.removeChannel(L),ce.removeChannel(U),f.current?.inbox===L&&(f.current.inbox=null),f.current?.outbox===U&&(f.current.outbox=null)}},[i,C]);const se=v.useCallback(async({userId:_,title:L,message:U,type:z,linkUrl:Z,meta:re}={})=>{if(!_)throw new Error("Missing userId");const{data:ue,error:ge}=await ce.from("notifications").insert({user_id:_,type:z??"info",title:L??"Notification",message:U??null,link_url:Z??null,meta:re??null}).select("*").single();if(ge)throw ge;const be=F(ue);return j(Me=>({...Me,notifications:[be,...Me.notifications??[]]})),be},[F]),he=v.useCallback(async({notificationId:_}={})=>{if(!_)throw new Error("Missing notificationId");const L=new Date().toISOString();try{await ce.from("notifications").update({read_at:L}).eq("id",_)}catch{}return j(U=>{const z=(U.notifications??[]).map(Z=>Z.id===_?{...Z,readAt:Z.readAt??L}:Z);return{...U,notifications:z}}),{success:!0}},[]),we=v.useCallback(async({userId:_}={})=>{if(!_)throw new Error("Missing userId");const L=new Date().toISOString();try{await ce.from("notifications").update({read_at:L}).eq("user_id",_).is("read_at",null)}catch{}return j(U=>{const z=(U.notifications??[]).map(Z=>Z.userId===_?{...Z,readAt:Z.readAt??L}:Z);return{...U,notifications:z}}),{success:!0}},[]),K=v.useCallback(_=>y.users.find(L=>L.id===_)??null,[y.users]),S=v.useCallback(_=>y.programs.find(L=>L.id===_)??null,[y.programs]),D=v.useCallback(({role:_}={})=>_?y.users.filter(L=>L.role===_):y.users,[y.users]),M=v.useCallback(({status:_}={})=>_?y.programs.filter(L=>L.status===_):y.programs,[y.programs]),I=v.useCallback(({status:_,programId:L,studentId:U}={})=>{let z=y.applications;return _&&(z=z.filter(Z=>Z.status===_)),L&&(z=z.filter(Z=>Z.programId===L)),U&&(z=z.filter(Z=>Z.studentId===U)),z},[y.applications]),G=v.useCallback(({programId:_,coachId:L}={})=>{let U=y.coachingSessions;return _&&(U=U.filter(z=>z.programId===_)),L&&(U=U.filter(z=>z.coachId===L)),U},[y.coachingSessions]),ae=v.useCallback(({programId:_}={})=>_?y.deliverables.filter(L=>L.programId===_):y.deliverables,[y.deliverables]),xe=v.useCallback(({userId:_}={})=>{if(!_)return y.messages;const L=new Set((y.messageDeletions??[]).filter(U=>U.userId===_).map(U=>U.messageId));return(y.messages??[]).filter(U=>U.senderId===_||U.receiverId===_).filter(U=>!L.has(U.id))},[y.messageDeletions,y.messages]),je=v.useCallback(async()=>{try{if(!i)return{success:!1,error:new Error("Not authenticated")};const{data:_,error:L}=await ce.from("message_deletions").select("*").eq("user_id",i);if(L)return{success:!1,error:L};const U=(_??[]).map(B);return j(z=>({...z,messageDeletions:U})),{success:!0}}catch(_){return{success:!1,error:_}}},[i,B]);v.useEffect(()=>{if(!i)return;je();const _=ce.channel(`message_deletions:${i}`).on("postgres_changes",{event:"*",schema:"public",table:"message_deletions",filter:`user_id=eq.${i}`},L=>{if(L?.eventType==="DELETE"){const ue=L?.old?.id;if(!ue)return;j(ge=>({...ge,messageDeletions:(ge.messageDeletions??[]).filter(be=>be.id!==ue)}));return}const z=L?.new;if(!z)return;const Z=B(z);j(re=>{const ue=re.messageDeletions??[],ge=ue.findIndex(be=>be.id===Z.id);if(ge>=0){const be=[...ue];return be[ge]={...be[ge],...Z},{...re,messageDeletions:be}}return{...re,messageDeletions:[...ue,Z]}})}).subscribe();return()=>{ce.removeChannel(_)}},[i,B,je]);const Se=v.useCallback(async({messageId:_})=>{try{if(!i)throw new Error("Not authenticated");if(!_)throw new Error("Missing messageId");const{data:L,error:U}=await ce.from("message_deletions").insert({user_id:i,message_id:_}).select("*").single();if(U)throw U;const z=B(L);return j(Z=>{const re=Z.messageDeletions??[];return re.some(ue=>ue.id===z.id)?Z:{...Z,messageDeletions:[...re,z]}}),{success:!0}}catch(L){return console.error("Error deleting message for me:",L),{success:!1,error:L}}},[i,B]),pe=v.useCallback(async({messageId:_})=>{try{if(!i)throw new Error("Not authenticated");if(!_)throw new Error("Missing messageId");const{error:L}=await ce.from("messages").delete().eq("id",_).eq("sender_id",i);if(L)throw L;return j(U=>({...U,messages:(U.messages??[]).filter(z=>z.id!==_)})),{success:!0}}catch(L){return console.error("Error deleting message for everyone:",L),{success:!1,error:L}}},[i]),qe=v.useCallback(_=>(y.projects??[]).find(L=>L.id===_)??null,[y.projects]),Oe=v.useCallback(({projectId:_}={})=>{const L=y.projectSubmissions??[];return[..._?L.filter(z=>z.projectId===_):L].sort((z,Z)=>new Date(z.createdAt)-new Date(Z.createdAt))},[y.projectSubmissions]),Xe=v.useCallback(({studentId:_,coachId:L}={})=>{let U=y.projects??[];if(_&&(U=U.filter(z=>z.studentId===_)),L){const z=(y.programs??[]).filter(re=>(re.coachIds??[]).includes(L)),Z=new Set;z.forEach(re=>(re.participantStudentIds??[]).forEach(ue=>Z.add(ue))),Z.size>0&&(U=U.filter(re=>Z.has(re.studentId)))}return[...U].sort((z,Z)=>new Date(Z.updatedAt)-new Date(z.updatedAt))},[y.projects,y.programs]),vt=v.useCallback(async({studentId:_,idea:L})=>{const U=Qx(L?.stage),z=lf({...L,stage:U});if(!z.ok)return{success:!1,errors:z.errors};const Z=new Date().toISOString(),re=wn("prj"),ue=wn("psub"),ge={id:re,studentId:_,title:String(L.title).trim(),stage:U,createdAt:Z,updatedAt:Z},be={id:ue,projectId:re,type:tt.idea,status:un.pending,payload:{title:String(L.title).trim(),problemStatement:String(L.problemStatement).trim(),targetUsers:String(L.targetUsers).trim(),proposedSolution:String(L.proposedSolution).trim(),stage:U},comments:[],reviewerId:null,reviewedAt:null,createdAt:Z,updatedAt:Z};try{const{data:Me,error:Be}=await ce.from("projects").insert({id:re,student_id:_,title:ge.title,stage:ge.stage,created_at:Z,updated_at:Z}).select("*").single();if(Be)throw Be;const{data:Ve,error:nt}=await ce.from("project_submissions").insert({id:ue,project_id:re,type:be.type,status:be.status,payload:be.payload,comments:be.comments,reviewer_id:null,reviewed_at:null,created_at:Z,updated_at:Z}).select("*").single();if(nt){try{await ce.from("projects").delete().eq("id",re)}catch{}throw nt}const st=O(Me),Gt=H(Ve);return j(Tt=>{const mt=[st,...(Tt.projects??[]).filter(gn=>gn.id!==st.id)],St=[...(Tt.projectSubmissions??[]).filter(gn=>gn.id!==Gt.id),Gt];return{...Tt,projects:mt,projectSubmissions:St}}),ye().catch(()=>{}),{success:!0,project:st,submission:Gt}}catch(Me){let Be="";try{Be=new URL("https://mdgyxdfbxlnrvvemksck.supabase.co").host}catch{Be=""}const Ve=`Failed to create project in Supabase.${Be?` Connected Supabase: ${Be}.`:""} Ensure you ran supabase-projects.sql in the same Supabase project and that RLS policies allow inserts/selects.`;return console.error(Ve,Me),{success:!1,errors:{form:Ve},error:Me}}},[O,H,ye]),fe=v.useCallback(async({projectId:_,type:L,payload:U})=>{if(!qe(_))return{success:!1,error:"Project not found"};const Z=Oe({projectId:_});if(L!==tt.idea&&!Rv(Z))return{success:!1,error:"Submit the IDEA first before adding other submission types."};if(L===tt.idea&&Z.some(ge=>ge.type===tt.idea))return{success:!1,error:"IDEA submission already exists for this project."};const re=new Date().toISOString(),ue={id:wn("psub"),projectId:_,type:L,status:un.pending,payload:U??{},comments:[],reviewerId:null,reviewedAt:null,createdAt:re,updatedAt:re};try{const{data:ge,error:be}=await ce.from("project_submissions").insert({id:ue.id,project_id:_,type:ue.type,status:ue.status,payload:ue.payload,comments:ue.comments,reviewer_id:null,reviewed_at:null,created_at:re,updated_at:re}).select("*").single();if(be)throw be;try{await ce.from("projects").update({updated_at:re}).eq("id",_)}catch{}const Me=H(ge);return j(Be=>{const Ve=[...(Be.projectSubmissions??[]).filter(st=>st.id!==Me.id),Me],nt=(Be.projects??[]).map(st=>st.id===_?{...st,updatedAt:re}:st);return{...Be,projects:nt,projectSubmissions:Ve}}),ye().catch(()=>{}),{success:!0,submission:Me}}catch(ge){return console.error("Error adding project submission in Supabase:",ge),{success:!1,error:ge}}},[qe,Oe,H,ye]),ve=v.useCallback(async({submissionId:_,authorId:L,text:U})=>{const z=String(U??"").trim();if(!z)return{success:!1,error:"Comment cannot be empty"};const Z=new Date().toISOString(),re={id:wn("c"),authorId:L,text:z,createdAt:Z},ue=(y.projectSubmissions??[]).find(be=>be.id===_)??null,ge=[...ue?.comments??[],re];try{const{data:be,error:Me}=await ce.from("project_submissions").update({comments:ge,updated_at:Z}).eq("id",_).select("*").single();if(Me)throw Me;const Be=H(be);j(Ve=>{const nt=(Ve.projectSubmissions??[]).map(st=>st.id===_?Be:st);return{...Ve,projectSubmissions:nt}}),ye().catch(()=>{});try{const Ve=ue?.projectId,nt=Ve?(y.projects??[]).find(St=>St.id===Ve):null,st=nt?.studentId,Gt=L?(y.users??[]).find(St=>St.id===L)?.role:null;if((Gt==="admin"||Gt==="coach")&&st&&await se({userId:st,type:"info",title:"New comment on your submission",message:nt?.title?`A coach/admin commented on ${nt.title}.`:"A coach/admin commented on your submission.",linkUrl:"/student/projects",meta:{submissionId:_,projectId:Ve,authorId:L},allowLocalFallback:!1}).catch(St=>(console.warn("Notification insert failed (staff comment -> student):",St),null)),Gt==="student"||L&&st&&String(L)===String(st)){const St=ze().filter(gn=>String(gn)!==String(L));St.length>0&&await Promise.all(St.map(gn=>se({userId:gn,type:"info",title:"New student comment",message:nt?.title?`New comment on ${nt.title}.`:"A student commented on a submission.",linkUrl:"/coach/projects",meta:{submissionId:_,projectId:Ve,authorId:L,studentId:st},allowLocalFallback:!1}).catch(to=>(console.warn("Notification insert failed (student comment -> staff):",to),null))))}}catch(Ve){console.warn("Notification fan-out failed (submission comment):",Ve)}return{success:!0,comment:re}}catch(be){return console.error("Error adding submission comment in Supabase:",be),{success:!1,error:be}}},[se,y.projects,y.projectSubmissions,y.users,ze,H,ye]),le=v.useCallback(async({submissionId:_,status:L,reviewerId:U})=>{const z=Object.values(un).includes(L)?L:un.pending,Z=new Date().toISOString(),re=(y.projectSubmissions??[]).find(be=>be.id===_)??null,ge=z!==un.pending?re?.reviewedAt??Z:null;try{const{data:be,error:Me}=await ce.from("project_submissions").update({status:z,reviewer_id:U??re?.reviewerId??null,reviewed_at:ge,updated_at:Z}).eq("id",_).select("*").single();if(Me)throw Me;const Be=H(be);j(Ve=>{const nt=(Ve.projectSubmissions??[]).map(st=>st.id===_?Be:st);return{...Ve,projectSubmissions:nt}}),ye().catch(()=>{})}catch(be){return console.error("Error setting submission status in Supabase:",be),{success:!1,error:be}}return{success:!0}},[y.projectSubmissions,H,ye]),Ee=v.useCallback(async({projectId:_,stage:L})=>{const U=Qx(L),z=new Date().toISOString();try{const{data:Z,error:re}=await ce.from("projects").update({stage:U,updated_at:z}).eq("id",_).select("*").single();if(re)throw re;const ue=O(Z);j(ge=>{const be=(ge.projects??[]).map(Me=>Me.id===_?ue:Me);return{...ge,projects:be}}),ye().catch(()=>{});try{const ge=i,be=ge?(y.users??[]).find(Be=>Be.id===ge)?.role:null;(be==="admin"||be==="coach")&&ue?.studentId&&await se({userId:ue.studentId,type:"info",title:"Project stage updated",message:`${ue.title} is now in stage: ${ue.stage}.`,linkUrl:"/student/projects",meta:{projectId:ue.id,stage:ue.stage,actorId:ge},allowLocalFallback:!1}).catch(Be=>(console.warn("Notification insert failed (stage update -> student):",Be),null))}catch(ge){console.warn("Notification fan-out failed (stage update):",ge)}return{success:!0}}catch(Z){return console.error("Error setting project stage in Supabase:",Z),{success:!1,error:Z}}},[i,se,y.users,O,ye]),Ie=v.useCallback(async _=>{try{const{data:L,error:U}=await ce.from("users").upsert(_).select().single();if(U)throw U;return j(z=>({...z,users:z.users.some(Z=>Z.id===L.id)?z.users.map(Z=>Z.id===L.id?L:Z):[...z.users,L]})),L}catch(L){throw console.error("Error upserting user:",L),L}},[]),ot=v.useCallback(async _=>{try{const{error:L}=await ce.from("users").delete().eq("id",_);if(L)throw L;j(U=>({...U,users:U.users.filter(z=>z.id!==_)}))}catch(L){throw console.error("Error deleting user:",L),L}},[]),ss=v.useCallback(async _=>{try{const{coachIds:L,participantStudentIds:U,...z}=_,Z=z?.id?(y.programs??[]).find(Ve=>Ve.id===z.id)??null:null,re=new Set(Z?.participantStudentIds??[]),ue={id:z.id,name:z.name,description:z.description,duration_weeks:z.durationWeeks,start_date:z.startDate,end_date:z.endDate,capacity:z.capacity,status:z.status};(ue.id===null||ue.id===""||ue.id===void 0)&&delete ue.id,Object.keys(ue).forEach(Ve=>{ue[Ve]===void 0&&delete ue[Ve]});const ge=!z?.id,{data:be,error:Me}=ge?await ce.from("programs").insert(ue).select().single():await ce.from("programs").upsert(ue).select().single();if(Me)throw Me;const Be=be?.id;if(L&&Be&&(await ce.from("program_coaches").delete().eq("program_id",Be),L.length>0&&await ce.from("program_coaches").insert(L.map(Ve=>({program_id:Be,coach_id:Ve})))),U&&Be&&(await ce.from("program_participants").delete().eq("program_id",Be),U.length>0&&await ce.from("program_participants").insert(U.map(Ve=>({program_id:Be,student_id:Ve})))),U&&U.length>0){const Ve=U.filter(nt=>!re.has(nt));if(Ve.length>0){const nt=z?.name??be?.name??"a program";await Promise.all(Ve.map(st=>se({userId:st,type:"info",title:"Added to program",message:`You were added to ${nt}.`,linkUrl:"/student/programs",meta:{programId:Be,programName:nt},allowLocalFallback:!1}).catch(Gt=>(console.warn("Notification insert failed (program participant):",Gt),null))))}}return await de(),be}catch(L){throw console.error("Error upserting program:",L),L}},[se,y.programs,de]),ks=v.useCallback(async _=>{try{const{error:L}=await ce.from("programs").delete().eq("id",_);if(L)throw L;j(U=>({...U,programs:U.programs.filter(z=>z.id!==_)}))}catch(L){throw console.error("Error deleting program:",L),L}},[]),pr=v.useCallback(async({applicationId:_,status:L,decisionNote:U,actorId:z})=>{try{const{data:Z,error:re}=await ce.from("applications").update({status:L,decision_note:U,reviewed_by:z}).eq("id",_).select().single();if(re)throw re;try{const ue=k(Z),ge=String(L??"").toLowerCase(),be=ge==="accepted"?"accepted":ge==="rejected"?"rejected":ge||"updated";ue?.studentId&&await se({userId:ue.studentId,type:be==="accepted"?"success":be==="rejected"?"danger":"info",title:"Application update",message:`Your program application was ${be}.`,linkUrl:"/student/applications",meta:{applicationId:ue.id,programId:ue.programId,status:ue.status},allowLocalFallback:!1})}catch{}if(L==="accepted"){const ue=y.applications.find(ge=>ge.id===_);ue&&await ce.from("program_participants").insert({program_id:ue.programId,student_id:ue.studentId})}return await de(),Z}catch(Z){throw console.error("Error updating application status:",Z),Z}},[se,y.applications,de,k]),Jt=v.useCallback(async({programId:_,studentId:L,motivation:U}={})=>{try{if(!_||!L)throw new Error("Missing programId or studentId");const{data:z,error:Z}=await ce.from("applications").insert({program_id:_,student_id:L,status:"pending",motivation:U??null}).select("*").single();if(Z)throw String(Z.code)==="23505"?new Error("You already applied to this program."):(Z.message||"").toLowerCase().includes("row-level security")?new Error("Application could not be submitted due to permissions (RLS)."):Z;const re=k(z);j(ue=>({...ue,applications:[re,...ue.applications??[]]}));try{const ue=ze().filter(be=>String(be)!==String(L)),ge=(y.programs??[]).find(be=>be.id===_)?.name??"a program";ue.length>0&&await Promise.all(ue.map(be=>se({userId:be,type:"info",title:"New program application",message:`A student applied to ${ge}.`,linkUrl:"/admin/applications",meta:{applicationId:re.id,programId:_,studentId:L},allowLocalFallback:!1}).catch(Me=>(console.warn("Notification insert failed (student application -> staff):",Me),null))))}catch(ue){console.warn("Notification fan-out failed (application create -> staff):",ue)}return re}catch(z){throw console.error("Error creating application:",z),z}},[se,y.programs,ze,k]),gr=v.useCallback(async({programId:_,coachId:L})=>{try{const{error:U}=await ce.from("program_coaches").insert({program_id:_,coach_id:L});if(U)throw U;await de()}catch(U){throw console.error("Error assigning coach:",U),U}},[de]),Ua=v.useCallback(async({programId:_,studentId:L})=>{try{const{error:U}=await ce.from("program_participants").insert({program_id:_,student_id:L});if(U)throw U;await de()}catch(U){throw console.error("Error assigning student:",U),U}},[de]),La=v.useCallback(async({senderId:_,receiverId:L,content:U,subject:z="New Message"})=>{try{const{data:Z,error:re}=await ce.from("messages").insert({sender_id:_,recipient_id:L,subject:z,body:U,read:!1}).select().single();if(re)throw re;const ue=C(Z);return j(ge=>{const be=ge.messages??[];return be.some(Me=>Me.id===ue.id)?ge:{...ge,messages:[...be,ue]}}),ue}catch(Z){throw console.error("Error sending message:",Z),Z}},[C]),kn=v.useCallback(async({messageIds:_})=>{try{if(!Array.isArray(_)||_.length===0||!i)return;const L=new Date().toISOString(),{error:U}=await ce.from("messages").update({seen_at:L,read:!0}).in("id",_).eq("recipient_id",i);if(U)throw U;j(z=>({...z,messages:z.messages.map(Z=>_.includes(Z.id)?{...Z,readAt:L,seenAt:L}:Z)}))}catch(L){throw console.error("Error marking messages as read:",L),L}},[i]),xr=v.useCallback(_=>{if(!_)return{online:!1,lastSeenAt:null};const L=x?.[_];if(!L?.updatedAt)return{online:!1,lastSeenAt:L?.lastSeenAt??null};const U=new Date(L.updatedAt).getTime();return{online:Date.now()-U<45e3,lastSeenAt:L.lastSeenAt??L.updatedAt??null}},[x]),Pa=v.useCallback(_=>(y.tasks??[]).find(L=>L.id===_)??null,[y.tasks]),Mt=v.useCallback(({projectId:_,submissionId:L,status:U,studentId:z}={})=>{let Z=y.tasks??[];if(_&&(Z=Z.filter(re=>re.projectId===_)),L&&(Z=Z.filter(re=>re.submissionId===L)),U&&(Z=Z.filter(re=>String(re.status)===String(U))),z){const re=new Set((y.projects??[]).filter(ue=>String(ue.studentId)===String(z)).map(ue=>ue.id));Z=Z.filter(ue=>re.has(ue.projectId))}return[...Z].sort((re,ue)=>{const ge=re.deadline??re.createdAt,be=ue.deadline??ue.createdAt;return new Date(ge).getTime()-new Date(be).getTime()})},[y.projects,y.tasks]),ds=v.useCallback(({studentId:_,coachId:L}={})=>(_?(y.projects??[]).filter(z=>String(z.studentId)===String(_)):L?Xe({coachId:L}):y.projects??[]).map(z=>({project:z,tasks:Mt({projectId:z.id})})),[y.projects,Xe,Mt]),pn=v.useCallback(async({projectId:_,submissionId:L,title:U,description:z,taskType:Z,deadline:re,checklistItems:ue}={})=>{if(!i)throw new Error("Not authenticated");if(!_)throw new Error("Missing projectId");if(!String(U??"").trim())throw new Error("Missing title");if((y.users??[]).find(Tt=>Tt.id===i)?.role!=="coach")throw new Error("Only coaches can create tasks");const be=(y.projects??[]).find(Tt=>Tt.id===_)??null;if(!be)throw new Error("Project not found");const Me=Wx(Z),Be=Me===Ze.checklist?(Array.isArray(ue)?ue:[]).map(Tt=>({id:Tt?.id??wn("chk"),text:String(Tt?.text??"").trim()})).filter(Tt=>Tt.text):null,Ve=wn("tsk"),{data:nt,error:st}=await ce.from("tasks").insert({id:Ve,project_id:_,submission_id:L??null,student_id:be.studentId,title:String(U).trim(),description:String(z??"").trim()||null,task_type:Me,status:Xt.pending,deadline:re??null,checklist_items:Be,created_by:i,student_submission:null,submitted_at:null,coach_feedback:null,reviewed_at:null,reviewed_by:null}).select("*").single();if(st)throw st;const Gt=V(nt);return j(Tt=>{const mt=Tt.tasks??[];return mt.some(St=>St.id===Gt.id)?Tt:{...Tt,tasks:[Gt,...mt]}}),Gt},[i,y.projects,y.users,V]),Qt=v.useCallback(async({taskId:_,submission:L}={})=>{if(!i)throw new Error("Not authenticated");if(!_)throw new Error("Missing taskId");const U=(y.tasks??[]).find(be=>be.id===_)??null;if(!U)throw new Error("Task not found");const z=(y.projects??[]).find(be=>be.id===U.projectId)??null;if(!z)throw new Error("Project not found");if(String(z.studentId)!==String(i))throw new Error("Only the project student can submit this task");const Z=new Date().toISOString(),{data:re,error:ue}=await ce.from("tasks").update({status:Xt.submitted,student_submission:L??null,submitted_at:Z}).eq("id",_).select("*").single();if(ue)throw ue;const ge=V(re);return j(be=>{const Me=be.tasks??[],Be=Me.some(Ve=>Ve.id===ge.id);return{...be,tasks:Be?Me.map(Ve=>Ve.id===ge.id?ge:Ve):[ge,...Me]}}),{success:!0}},[i,y.projects,y.tasks,V]),Ts=v.useCallback(async({taskId:_,status:L,feedback:U}={})=>{if(!i)throw new Error("Not authenticated");if(!_)throw new Error("Missing taskId");if((y.users??[]).find(Me=>Me.id===i)?.role!=="coach")throw new Error("Only coaches can review tasks");const Z=Zx(L),re=new Date().toISOString(),{data:ue,error:ge}=await ce.from("tasks").update({status:Z,coach_feedback:String(U??"").trim()||null,reviewed_at:re,reviewed_by:i}).eq("id",_).select("*").single();if(ge)throw ge;const be=V(ue);return j(Me=>{const Be=Me.tasks??[],Ve=Be.some(nt=>nt.id===be.id);return{...Me,tasks:Ve?Be.map(nt=>nt.id===be.id?be:nt):[be,...Be]}}),{success:!0}},[i,y.users,V]),Ht=v.useCallback(async()=>{await de()},[de]),W=v.useMemo(()=>({hydrated:e,data:y,reset:Ht,listNotifications:Re,refreshNotifications:J,createNotification:se,markNotificationRead:he,markAllNotificationsRead:we,getUserById:K,getProgramById:S,listUsers:D,listPrograms:M,listApplications:I,listSessions:G,listDeliverables:ae,listMessages:xe,getProjectById:qe,listProjects:Xe,listProjectSubmissions:Oe,createProjectWithIdea:vt,addProjectSubmission:fe,addProjectSubmissionComment:ve,setProjectSubmissionStatus:le,setProjectStage:Ee,sendMessage:La,markAsRead:kn,deleteMessageForMe:Se,deleteMessageForEveryone:pe,refreshPresence:Ae,getPresenceForUser:xr,upsertProgram:ss,deleteProgram:ks,upsertUser:Ie,deleteUser:ot,setApplicationStatus:pr,createApplication:Jt,assignCoachToProgram:gr,assignStudentToProgram:Ua,getTaskById:Pa,listTasks:Mt,listTasksGroupedByProject:ds,createTask:pn,submitTask:Qt,reviewTask:Ts}),[e,y,Ht,Re,J,se,he,we,K,S,D,M,I,G,ae,xe,qe,Xe,Oe,vt,fe,ve,le,Ee,La,kn,Se,pe,Ae,xr,ss,ks,Ie,ot,pr,Jt,gr,Ua,Pa,Mt,ds,pn,Qt,Ts]);return r.jsx(kv.Provider,{value:W,children:s})}const kb=s=>({id:s.id,name:s.name,description:s.description??"",isActive:!!s.is_active,createdBy:s.created_by??null,createdAt:s.created_at,updatedAt:s.updated_at}),Tb=s=>({id:s.id,templateId:s.template_id,name:s.name,description:s.description??"",orderIndex:s.order_index??0}),Eb=s=>({id:s.id,stageId:s.stage_id,contentType:s.content_type,title:s.title,description:s.description??"",url:s.url,provider:s.provider??"",durationMinutes:s.duration_minutes??null,orderIndex:s.order_index??0,meta:s.meta??{}}),Cb=s=>({id:s.id,stageId:s.stage_id,title:s.title,description:s.description??"",taskType:s.task_type??"general",orderIndex:s.order_index??0,dueOffsetDays:s.due_offset_days??null,requiresApproval:!!s.requires_approval,meta:s.meta??{}}),Ab=s=>({id:s.id,templateId:s.template_id,studentId:s.student_id,projectId:s.project_id??null,status:s.status,currentStageId:s.current_stage_id??null,startedAt:s.started_at,pausedAt:s.paused_at??null,completedAt:s.completed_at??null,createdAt:s.created_at,updatedAt:s.updated_at}),hA=s=>({id:s.id,instanceId:s.instance_id,stageId:s.stage_id??null,templateTaskId:s.template_task_id??null,title:s.title,description:s.description??"",taskType:s.task_type??"general",status:s.status,orderIndex:s.order_index??0,deadline:s.deadline??null,requiresApproval:!!s.requires_approval,studentSubmission:s.student_submission??null,submittedAt:s.submitted_at??null,coachFeedback:s.coach_feedback??null,approvedAt:s.approved_at??null,approvedBy:s.approved_by??null,createdAt:s.created_at,updatedAt:s.updated_at});function fA({children:s}){const{currentUser:e}=gt(),[a,i]=v.useState(!1),[o,u]=v.useState(!1),[d,f]=v.useState([]),[m,p]=v.useState({}),[x,b]=v.useState([]),[y,j]=v.useState({}),N=v.useRef(null),k=v.useCallback(async()=>{u(!0);try{const{data:K,error:S}=await ce.from("program_templates").select("*").order("updated_at",{ascending:!1});if(S)throw S;f((K??[]).map(kb))}finally{u(!1)}},[]),T=v.useCallback(async K=>{if(!K)return null;const S=await ce.from("program_template_stages").select("*").eq("template_id",K).order("order_index",{ascending:!0});if(S.error)throw S.error;const D=(S.data??[]).map(Tb),M=D.map(pe=>pe.id);if(M.length===0){const pe={templateId:K,stages:[],contents:[],taskTemplates:[]};return p(qe=>({...qe,[K]:pe})),pe}const[I,G]=await Promise.all([ce.from("program_template_contents").select("*").in("stage_id",M).order("order_index",{ascending:!0}),ce.from("program_task_templates").select("*").in("stage_id",M).order("order_index",{ascending:!0})]);if(I.error)throw I.error;if(G.error)throw G.error;const ae=new Map(D.map(pe=>[pe.id,pe.orderIndex])),xe=(I.data??[]).map(Eb).sort((pe,qe)=>{const Oe=ae.get(pe.stageId)??0,Xe=ae.get(qe.stageId)??0;return Oe!==Xe?Oe-Xe:(pe.orderIndex??0)-(qe.orderIndex??0)}),je=(G.data??[]).map(Cb).sort((pe,qe)=>{const Oe=ae.get(pe.stageId)??0,Xe=ae.get(qe.stageId)??0;return Oe!==Xe?Oe-Xe:(pe.orderIndex??0)-(qe.orderIndex??0)}),Se={templateId:K,stages:D,contents:xe,taskTemplates:je};return p(pe=>({...pe,[K]:Se})),Se},[]),R=v.useCallback(async({id:K,name:S,description:D,isActive:M}={})=>{if(!S)throw new Error("Template name is required");const I={...K?{id:K}:{},name:S,description:D??null,is_active:typeof M=="boolean"?M:!0,created_by:e?.id??null},{data:G,error:ae}=await ce.from("program_templates").upsert(I).select("*").single();if(ae)throw ae;const xe=kb(G);return f(je=>{const Se=je.filter(pe=>pe.id!==xe.id);return[xe,...Se]}),xe},[e?.id]),A=v.useCallback(async K=>{const{error:S}=await ce.from("program_templates").delete().eq("id",K);if(S)throw S;f(D=>D.filter(M=>M.id!==K)),p(D=>{const M={...D};return delete M[K],M})},[]),C=v.useCallback(async({templateId:K,name:S,description:D,orderIndex:M}={})=>{if(!K)throw new Error("templateId required");if(!S)throw new Error("Stage name required");const{data:I,error:G}=await ce.from("program_template_stages").insert({template_id:K,name:S,description:D??null,order_index:M??0}).select("*").single();if(G)throw G;const ae=Tb(I);return p(xe=>{const je=xe[K]??{templateId:K,stages:[],contents:[],taskTemplates:[]};return{...xe,[K]:{...je,stages:[...je.stages,ae].sort((Se,pe)=>Se.orderIndex-pe.orderIndex)}}}),ae},[]),B=v.useCallback(async({stageId:K,contentType:S,title:D,url:M,description:I,provider:G,durationMinutes:ae,orderIndex:xe,meta:je}={})=>{if(!K)throw new Error("stageId required");if(!S)throw new Error("contentType required");if(!D)throw new Error("title required");if(!M)throw new Error("url required");const{data:Se,error:pe}=await ce.from("program_template_contents").insert({stage_id:K,content_type:S,title:D,description:I??null,url:M,provider:G??null,duration_minutes:ae??null,order_index:xe??0,meta:je??{}}).select("*").single();if(pe)throw pe;const qe=Eb(Se);return p(Oe=>{const Xe={...Oe};for(const vt of Object.keys(Xe)){const fe=Xe[vt];fe&&fe.stages?.some(ve=>ve.id===K)&&(Xe[vt]={...fe,contents:[...fe.contents,qe].sort((ve,le)=>ve.stageId===le.stageId?ve.orderIndex-le.orderIndex:0)})}return Xe}),qe},[]),F=v.useCallback(async({stageId:K,title:S,description:D,taskType:M,orderIndex:I,dueOffsetDays:G,requiresApproval:ae,meta:xe}={})=>{if(!K)throw new Error("stageId required");if(!S)throw new Error("title required");const{data:je,error:Se}=await ce.from("program_task_templates").insert({stage_id:K,title:S,description:D??null,task_type:M??"general",order_index:I??0,due_offset_days:G??null,requires_approval:typeof ae=="boolean"?ae:!0,meta:xe??{}}).select("*").single();if(Se)throw Se;const pe=Cb(je);return p(qe=>{const Oe={...qe};for(const Xe of Object.keys(Oe)){const vt=Oe[Xe];vt&&vt.stages?.some(fe=>fe.id===K)&&(Oe[Xe]={...vt,taskTemplates:[...vt.taskTemplates,pe].sort((fe,ve)=>fe.stageId===ve.stageId?fe.orderIndex-ve.orderIndex:0)})}return Oe}),pe},[]),V=v.useCallback(async({templateId:K,stageId:S}={})=>{if(!K)throw new Error("templateId required");if(!S)throw new Error("stageId required");const{error:D}=await ce.from("program_template_stages").delete().eq("id",S);if(D)throw D;p(M=>{const I=M[K];if(!I)return M;const G={...M};return G[K]={...I,stages:(I.stages??[]).filter(ae=>ae.id!==S),contents:(I.contents??[]).filter(ae=>ae.stageId!==S),taskTemplates:(I.taskTemplates??[]).filter(ae=>ae.stageId!==S)},G})},[]),O=v.useCallback(async({contentId:K}={})=>{if(!K)throw new Error("contentId required");const{error:S}=await ce.from("program_template_contents").delete().eq("id",K);if(S)throw S;p(D=>{const M={...D};for(const I of Object.keys(M)){const G=M[I];G&&(G.contents??[]).some(ae=>ae.id===K)&&(M[I]={...G,contents:(G.contents??[]).filter(ae=>ae.id!==K)})}return M})},[]),H=v.useCallback(async({taskTemplateId:K}={})=>{if(!K)throw new Error("taskTemplateId required");const{error:S}=await ce.from("program_task_templates").delete().eq("id",K);if(S)throw S;p(D=>{const M={...D};for(const I of Object.keys(M)){const G=M[I];G&&(G.taskTemplates??[]).some(ae=>ae.id===K)&&(M[I]={...G,taskTemplates:(G.taskTemplates??[]).filter(ae=>ae.id!==K)})}return M})},[]),te=v.useCallback(async()=>{if(!e?.id){b([]);return}const{data:K,error:S}=await ce.from("program_instances").select("*").order("updated_at",{ascending:!1});if(S)throw S;const D=(K??[]).map(Ab);return b(D),D},[e?.id]),me=v.useCallback(async K=>{if(!K)return null;const[S,D]=await Promise.all([ce.from("program_instances").select("*").eq("id",K).single(),ce.from("program_instance_tasks").select("*").eq("instance_id",K).order("order_index",{ascending:!0})]);if(S.error)throw S.error;if(D.error)throw D.error;const M=Ab(S.data),I=(D.data??[]).map(hA),G={instance:M,tasks:I};return j(ae=>({...ae,[K]:G})),G},[]),de=v.useCallback(async({templateId:K,projectId:S}={})=>{if(!K)throw new Error("templateId required");const{data:D,error:M}=await ce.rpc("create_program_instance",{p_template_id:K,p_project_id:S??null});if(M)throw M;const I=D;return await te(),I&&await me(I),I},[me,te]),ye=v.useCallback(async({taskId:K,submission:S}={})=>{if(!K)throw new Error("taskId required");const{error:D}=await ce.rpc("submit_program_instance_task",{p_task_id:K,p_submission:S??{}});if(D)throw D;const M=y,I=Object.keys(M).find(G=>M[G]?.tasks?.some(ae=>ae.id===K));I&&await me(I)},[me,y]),Ae=v.useCallback(async({taskId:K,feedback:S,approved:D}={})=>{if(!K)throw new Error("taskId required");const{error:M}=await ce.rpc("approve_program_instance_task",{p_task_id:K,p_feedback:S??null,p_approved:typeof D=="boolean"?D:!0});if(M)throw M;const I=y,G=Object.keys(I).find(ae=>I[ae]?.tasks?.some(xe=>xe.id===K));G&&await me(G)},[me,y]),Re=v.useCallback(async({instanceId:K,orderedTaskIds:S}={})=>{if(!K)throw new Error("instanceId required");if(!Array.isArray(S)||S.length===0)return;const{error:D}=await ce.rpc("reorder_program_instance_tasks",{p_instance_id:K,p_task_ids:S});if(D)throw D;await me(K)},[me]),ze=v.useCallback(async({instanceId:K,stageId:S}={})=>{if(!K)throw new Error("instanceId required");if(!S)throw new Error("stageId required");const{error:D}=await ce.rpc("advance_program_instance_stage",{p_instance_id:K,p_stage_id:S});if(D)throw D;await me(K)},[me]),J=v.useCallback(async({instanceId:K,stageId:S,title:D,description:M,taskType:I,deadline:G,requiresApproval:ae}={})=>{if(!K)throw new Error("instanceId required");if(!S)throw new Error("stageId required");if(!D)throw new Error("title required");const{data:xe,error:je}=await ce.rpc("inject_program_instance_task",{p_instance_id:K,p_stage_id:S,p_title:D,p_description:M??null,p_task_type:I??"general",p_deadline:G??null,p_requires_approval:typeof ae=="boolean"?ae:!0});if(je)throw je;return await me(K),xe},[me]),se=v.useCallback(async({taskId:K,deadline:S}={})=>{if(!K)throw new Error("taskId required");if(!S)throw new Error("deadline required");const{error:D}=await ce.rpc("extend_program_instance_task_deadline",{p_task_id:K,p_deadline:S});if(D)throw D;const M=y,I=Object.keys(M).find(G=>M[G]?.tasks?.some(ae=>ae.id===K));I&&await me(I)},[me,y]),he=v.useCallback(async K=>{if(!K)return;N.current&&(ce.removeChannel(N.current),N.current=null);const S=ce.channel(`program_instance_tasks:${K}`).on("postgres_changes",{event:"*",schema:"public",table:"program_instance_tasks",filter:`instance_id=eq.${K}`},()=>{me(K).catch(()=>{})}).subscribe();N.current=S},[me]);v.useEffect(()=>{if(!e?.id){i(!0),f([]),b([]);return}let K=!1;return(async()=>{try{await Promise.all([k(),te()])}catch{}finally{K||i(!0)}})(),()=>{K=!0}},[e?.id,te,k]),v.useEffect(()=>()=>{N.current&&ce.removeChannel(N.current),N.current=null},[]);const we=v.useMemo(()=>({hydrated:a,busy:o,templates:d,templateDetailsById:m,instances:x,instanceDetailsById:y,fetchTemplates:k,fetchTemplateDetails:T,upsertTemplate:R,deleteTemplate:A,addStage:C,addContentItem:B,addTaskTemplate:F,deleteStage:V,deleteContentItem:O,deleteTaskTemplate:H,fetchMyInstances:te,fetchInstanceDetails:me,createInstanceFromTemplate:de,submitInstanceTask:ye,approveInstanceTask:Ae,reorderInstanceTasks:Re,advanceInstanceStage:ze,injectTask:J,extendTaskDeadline:se,subscribeToInstanceTasks:he}),[a,o,d,m,x,y,k,T,R,A,C,B,F,V,O,H,te,me,de,ye,Ae,Re,ze,J,se,he]);return r.jsx(Ev.Provider,{value:we,children:s})}function mA({children:s}){const[e,a]=v.useState([]),i=v.useCallback(f=>{a(m=>m.filter(p=>p.id!==f))},[]),o=v.useCallback(f=>{const m=f.id??wn("toast"),p={id:m,title:f.title??"Notification",message:f.message??"",type:f.type??"info",durationMs:f.durationMs??3500,onClick:typeof f.onClick=="function"?f.onClick:null};return a(x=>[p,...x].slice(0,5)),p.durationMs>0&&window.setTimeout(()=>i(m),p.durationMs),m},[i]),u=v.useCallback((f,m="info",p)=>{const x=m==="error"?"danger":m;return o({type:x,title:p??(x==="danger"?"Error":"Notification"),message:f??""})},[o]),d=v.useMemo(()=>({toasts:e,push:o,dismiss:i,showToast:u}),[e,o,i,u]);return r.jsx(Tv.Provider,{value:d,children:s})}const pA=v.createContext(null);function gA(){return!1}function Nc(s){return s==="dark"?!0:s==="light"?!1:gA()}function xA({children:s}){const[e,a]=v.useState("light"),i=v.useMemo(()=>Nc(e),[e]);v.useEffect(()=>{const u=document.documentElement;u.classList.toggle("dark",i),u.style.colorScheme=i?"dark":"light"},[i]),v.useEffect(()=>{if(e!=="system")return;const u=window.matchMedia?.("(prefers-color-scheme: dark)");if(!u)return;const d=()=>{const f=document.documentElement;f.classList.toggle("dark",Nc("system")),f.style.colorScheme=Nc("system")?"dark":"light"};return u.addEventListener?u.addEventListener("change",d):u.addListener(d),()=>{u.removeEventListener?u.removeEventListener("change",d):u.removeListener(d)}},[e]);const o=v.useMemo(()=>({mode:e,isDark:i,setMode:a,toggle:()=>a(u=>Nc(u)?"light":"dark")}),[e,i]);return r.jsx(pA.Provider,{value:o,children:s})}const lm=v.createContext({});function om(s){const e=v.useRef(null);return e.current===null&&(e.current=s()),e.current}const nw=typeof window<"u",aw=nw?v.useLayoutEffect:v.useEffect,nu=v.createContext(null);function cm(s,e){s.indexOf(e)===-1&&s.push(e)}function um(s,e){const a=s.indexOf(e);a>-1&&s.splice(a,1)}const Sn=(s,e,a)=>a>e?e:a<s?s:a;let dm=()=>{};const Qn={},rw=s=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(s);function iw(s){return typeof s=="object"&&s!==null}const lw=s=>/^0[^.\s]+$/u.test(s);function hm(s){let e;return()=>(e===void 0&&(e=s()),e)}const Qs=s=>s,bA=(s,e)=>a=>e(s(a)),Ql=(...s)=>s.reduce(bA),zl=(s,e,a)=>{const i=e-s;return i===0?1:(a-s)/i};class fm{constructor(){this.subscriptions=[]}add(e){return cm(this.subscriptions,e),()=>um(this.subscriptions,e)}notify(e,a,i){const o=this.subscriptions.length;if(o)if(o===1)this.subscriptions[0](e,a,i);else for(let u=0;u<o;u++){const d=this.subscriptions[u];d&&d(e,a,i)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const Xn=s=>s*1e3,Js=s=>s/1e3;function ow(s,e){return e?s*(1e3/e):0}const cw=(s,e,a)=>(((1-3*a+3*e)*s+(3*a-6*e))*s+3*e)*s,yA=1e-7,vA=12;function wA(s,e,a,i,o){let u,d,f=0;do d=e+(a-e)/2,u=cw(d,i,o)-s,u>0?a=d:e=d;while(Math.abs(u)>yA&&++f<vA);return d}function Zl(s,e,a,i){if(s===e&&a===i)return Qs;const o=u=>wA(u,0,1,s,a);return u=>u===0||u===1?u:cw(o(u),e,i)}const uw=s=>e=>e<=.5?s(2*e)/2:(2-s(2*(1-e)))/2,dw=s=>e=>1-s(1-e),hw=Zl(.33,1.53,.69,.99),mm=dw(hw),fw=uw(mm),mw=s=>(s*=2)<1?.5*mm(s):.5*(2-Math.pow(2,-10*(s-1))),pm=s=>1-Math.sin(Math.acos(s)),pw=dw(pm),gw=uw(pm),jA=Zl(.42,0,1,1),NA=Zl(0,0,.58,1),xw=Zl(.42,0,.58,1),SA=s=>Array.isArray(s)&&typeof s[0]!="number",bw=s=>Array.isArray(s)&&typeof s[0]=="number",_A={linear:Qs,easeIn:jA,easeInOut:xw,easeOut:NA,circIn:pm,circInOut:gw,circOut:pw,backIn:mm,backInOut:fw,backOut:hw,anticipate:mw},kA=s=>typeof s=="string",Rb=s=>{if(bw(s)){dm(s.length===4);const[e,a,i,o]=s;return Zl(e,a,i,o)}else if(kA(s))return _A[s];return s},Sc=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function TA(s,e){let a=new Set,i=new Set,o=!1,u=!1;const d=new WeakSet;let f={delta:0,timestamp:0,isProcessing:!1};function m(x){d.has(x)&&(p.schedule(x),s()),x(f)}const p={schedule:(x,b=!1,y=!1)=>{const N=y&&o?a:i;return b&&d.add(x),N.has(x)||N.add(x),x},cancel:x=>{i.delete(x),d.delete(x)},process:x=>{if(f=x,o){u=!0;return}o=!0,[a,i]=[i,a],a.forEach(m),a.clear(),o=!1,u&&(u=!1,p.process(x))}};return p}const EA=40;function yw(s,e){let a=!1,i=!0;const o={delta:0,timestamp:0,isProcessing:!1},u=()=>a=!0,d=Sc.reduce((C,B)=>(C[B]=TA(u),C),{}),{setup:f,read:m,resolveKeyframes:p,preUpdate:x,update:b,preRender:y,render:j,postRender:N}=d,k=()=>{const C=Qn.useManualTiming?o.timestamp:performance.now();a=!1,Qn.useManualTiming||(o.delta=i?1e3/60:Math.max(Math.min(C-o.timestamp,EA),1)),o.timestamp=C,o.isProcessing=!0,f.process(o),m.process(o),p.process(o),x.process(o),b.process(o),y.process(o),j.process(o),N.process(o),o.isProcessing=!1,a&&e&&(i=!1,s(k))},T=()=>{a=!0,i=!0,o.isProcessing||s(k)};return{schedule:Sc.reduce((C,B)=>{const F=d[B];return C[B]=(V,O=!1,H=!1)=>(a||T(),F.schedule(V,O,H)),C},{}),cancel:C=>{for(let B=0;B<Sc.length;B++)d[Sc[B]].cancel(C)},state:o,steps:d}}const{schedule:Nt,cancel:Ra,state:us,steps:Ih}=yw(typeof requestAnimationFrame<"u"?requestAnimationFrame:Qs,!0);let Rc;function CA(){Rc=void 0}const xs={now:()=>(Rc===void 0&&xs.set(us.isProcessing||Qn.useManualTiming?us.timestamp:performance.now()),Rc),set:s=>{Rc=s,queueMicrotask(CA)}},vw=s=>e=>typeof e=="string"&&e.startsWith(s),ww=vw("--"),AA=vw("var(--"),gm=s=>AA(s)?RA.test(s.split("/*")[0].trim()):!1,RA=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu;function Db(s){return typeof s!="string"?!1:s.split("/*")[0].includes("var(--")}const Si={test:s=>typeof s=="number",parse:parseFloat,transform:s=>s},Vl={...Si,transform:s=>Sn(0,1,s)},_c={...Si,default:1},_l=s=>Math.round(s*1e5)/1e5,xm=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function DA(s){return s==null}const OA=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,bm=(s,e)=>a=>!!(typeof a=="string"&&OA.test(a)&&a.startsWith(s)||e&&!DA(a)&&Object.prototype.hasOwnProperty.call(a,e)),jw=(s,e,a)=>i=>{if(typeof i!="string")return i;const[o,u,d,f]=i.match(xm);return{[s]:parseFloat(o),[e]:parseFloat(u),[a]:parseFloat(d),alpha:f!==void 0?parseFloat(f):1}},MA=s=>Sn(0,255,s),Bh={...Si,transform:s=>Math.round(MA(s))},cr={test:bm("rgb","red"),parse:jw("red","green","blue"),transform:({red:s,green:e,blue:a,alpha:i=1})=>"rgba("+Bh.transform(s)+", "+Bh.transform(e)+", "+Bh.transform(a)+", "+_l(Vl.transform(i))+")"};function UA(s){let e="",a="",i="",o="";return s.length>5?(e=s.substring(1,3),a=s.substring(3,5),i=s.substring(5,7),o=s.substring(7,9)):(e=s.substring(1,2),a=s.substring(2,3),i=s.substring(3,4),o=s.substring(4,5),e+=e,a+=a,i+=i,o+=o),{red:parseInt(e,16),green:parseInt(a,16),blue:parseInt(i,16),alpha:o?parseInt(o,16)/255:1}}const yf={test:bm("#"),parse:UA,transform:cr.transform},Wl=s=>({test:e=>typeof e=="string"&&e.endsWith(s)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${s}`}),_a=Wl("deg"),Nn=Wl("%"),ke=Wl("px"),LA=Wl("vh"),PA=Wl("vw"),Ob={...Nn,parse:s=>Nn.parse(s)/100,transform:s=>Nn.transform(s*100)},fi={test:bm("hsl","hue"),parse:jw("hue","saturation","lightness"),transform:({hue:s,saturation:e,lightness:a,alpha:i=1})=>"hsla("+Math.round(s)+", "+Nn.transform(_l(e))+", "+Nn.transform(_l(a))+", "+_l(Vl.transform(i))+")"},qt={test:s=>cr.test(s)||yf.test(s)||fi.test(s),parse:s=>cr.test(s)?cr.parse(s):fi.test(s)?fi.parse(s):yf.parse(s),transform:s=>typeof s=="string"?s:s.hasOwnProperty("red")?cr.transform(s):fi.transform(s),getAnimatableNone:s=>{const e=qt.parse(s);return e.alpha=0,qt.transform(e)}},IA=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function BA(s){return isNaN(s)&&typeof s=="string"&&(s.match(xm)?.length||0)+(s.match(IA)?.length||0)>0}const Nw="number",Sw="color",zA="var",VA="var(",Mb="${}",$A=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function $l(s){const e=s.toString(),a=[],i={color:[],number:[],var:[]},o=[];let u=0;const f=e.replace($A,m=>(qt.test(m)?(i.color.push(u),o.push(Sw),a.push(qt.parse(m))):m.startsWith(VA)?(i.var.push(u),o.push(zA),a.push(m)):(i.number.push(u),o.push(Nw),a.push(parseFloat(m))),++u,Mb)).split(Mb);return{values:a,split:f,indexes:i,types:o}}function _w(s){return $l(s).values}function kw(s){const{split:e,types:a}=$l(s),i=e.length;return o=>{let u="";for(let d=0;d<i;d++)if(u+=e[d],o[d]!==void 0){const f=a[d];f===Nw?u+=_l(o[d]):f===Sw?u+=qt.transform(o[d]):u+=o[d]}return u}}const qA=s=>typeof s=="number"?0:qt.test(s)?qt.getAnimatableNone(s):s;function HA(s){const e=_w(s);return kw(s)(e.map(qA))}const Da={test:BA,parse:_w,createTransformer:kw,getAnimatableNone:HA};function zh(s,e,a){return a<0&&(a+=1),a>1&&(a-=1),a<1/6?s+(e-s)*6*a:a<1/2?e:a<2/3?s+(e-s)*(2/3-a)*6:s}function GA({hue:s,saturation:e,lightness:a,alpha:i}){s/=360,e/=100,a/=100;let o=0,u=0,d=0;if(!e)o=u=d=a;else{const f=a<.5?a*(1+e):a+e-a*e,m=2*a-f;o=zh(m,f,s+1/3),u=zh(m,f,s),d=zh(m,f,s-1/3)}return{red:Math.round(o*255),green:Math.round(u*255),blue:Math.round(d*255),alpha:i}}function qc(s,e){return a=>a>0?e:s}const Ct=(s,e,a)=>s+(e-s)*a,Vh=(s,e,a)=>{const i=s*s,o=a*(e*e-i)+i;return o<0?0:Math.sqrt(o)},FA=[yf,cr,fi],KA=s=>FA.find(e=>e.test(s));function Ub(s){const e=KA(s);if(!e)return!1;let a=e.parse(s);return e===fi&&(a=GA(a)),a}const Lb=(s,e)=>{const a=Ub(s),i=Ub(e);if(!a||!i)return qc(s,e);const o={...a};return u=>(o.red=Vh(a.red,i.red,u),o.green=Vh(a.green,i.green,u),o.blue=Vh(a.blue,i.blue,u),o.alpha=Ct(a.alpha,i.alpha,u),cr.transform(o))},vf=new Set(["none","hidden"]);function YA(s,e){return vf.has(s)?a=>a<=0?s:e:a=>a>=1?e:s}function XA(s,e){return a=>Ct(s,e,a)}function ym(s){return typeof s=="number"?XA:typeof s=="string"?gm(s)?qc:qt.test(s)?Lb:ZA:Array.isArray(s)?Tw:typeof s=="object"?qt.test(s)?Lb:JA:qc}function Tw(s,e){const a=[...s],i=a.length,o=s.map((u,d)=>ym(u)(u,e[d]));return u=>{for(let d=0;d<i;d++)a[d]=o[d](u);return a}}function JA(s,e){const a={...s,...e},i={};for(const o in a)s[o]!==void 0&&e[o]!==void 0&&(i[o]=ym(s[o])(s[o],e[o]));return o=>{for(const u in i)a[u]=i[u](o);return a}}function QA(s,e){const a=[],i={color:0,var:0,number:0};for(let o=0;o<e.values.length;o++){const u=e.types[o],d=s.indexes[u][i[u]],f=s.values[d]??0;a[o]=f,i[u]++}return a}const ZA=(s,e)=>{const a=Da.createTransformer(e),i=$l(s),o=$l(e);return i.indexes.var.length===o.indexes.var.length&&i.indexes.color.length===o.indexes.color.length&&i.indexes.number.length>=o.indexes.number.length?vf.has(s)&&!o.values.length||vf.has(e)&&!i.values.length?YA(s,e):Ql(Tw(QA(i,o),o.values),a):qc(s,e)};function Ew(s,e,a){return typeof s=="number"&&typeof e=="number"&&typeof a=="number"?Ct(s,e,a):ym(s)(s,e)}const WA=s=>{const e=({timestamp:a})=>s(a);return{start:(a=!0)=>Nt.update(e,a),stop:()=>Ra(e),now:()=>us.isProcessing?us.timestamp:xs.now()}},Cw=(s,e,a=10)=>{let i="";const o=Math.max(Math.round(e/a),2);for(let u=0;u<o;u++)i+=Math.round(s(u/(o-1))*1e4)/1e4+", ";return`linear(${i.substring(0,i.length-2)})`},Hc=2e4;function vm(s){let e=0;const a=50;let i=s.next(e);for(;!i.done&&e<Hc;)e+=a,i=s.next(e);return e>=Hc?1/0:e}function e5(s,e=100,a){const i=a({...s,keyframes:[0,e]}),o=Math.min(vm(i),Hc);return{type:"keyframes",ease:u=>i.next(o*u).value/e,duration:Js(o)}}const t5=5;function Aw(s,e,a){const i=Math.max(e-t5,0);return ow(a-s(i),e-i)}const Ot={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},$h=.001;function s5({duration:s=Ot.duration,bounce:e=Ot.bounce,velocity:a=Ot.velocity,mass:i=Ot.mass}){let o,u,d=1-e;d=Sn(Ot.minDamping,Ot.maxDamping,d),s=Sn(Ot.minDuration,Ot.maxDuration,Js(s)),d<1?(o=p=>{const x=p*d,b=x*s,y=x-a,j=wf(p,d),N=Math.exp(-b);return $h-y/j*N},u=p=>{const b=p*d*s,y=b*a+a,j=Math.pow(d,2)*Math.pow(p,2)*s,N=Math.exp(-b),k=wf(Math.pow(p,2),d);return(-o(p)+$h>0?-1:1)*((y-j)*N)/k}):(o=p=>{const x=Math.exp(-p*s),b=(p-a)*s+1;return-$h+x*b},u=p=>{const x=Math.exp(-p*s),b=(a-p)*(s*s);return x*b});const f=5/s,m=a5(o,u,f);if(s=Xn(s),isNaN(m))return{stiffness:Ot.stiffness,damping:Ot.damping,duration:s};{const p=Math.pow(m,2)*i;return{stiffness:p,damping:d*2*Math.sqrt(i*p),duration:s}}}const n5=12;function a5(s,e,a){let i=a;for(let o=1;o<n5;o++)i=i-s(i)/e(i);return i}function wf(s,e){return s*Math.sqrt(1-e*e)}const r5=["duration","bounce"],i5=["stiffness","damping","mass"];function Pb(s,e){return e.some(a=>s[a]!==void 0)}function l5(s){let e={velocity:Ot.velocity,stiffness:Ot.stiffness,damping:Ot.damping,mass:Ot.mass,isResolvedFromDuration:!1,...s};if(!Pb(s,i5)&&Pb(s,r5))if(s.visualDuration){const a=s.visualDuration,i=2*Math.PI/(a*1.2),o=i*i,u=2*Sn(.05,1,1-(s.bounce||0))*Math.sqrt(o);e={...e,mass:Ot.mass,stiffness:o,damping:u}}else{const a=s5(s);e={...e,...a,mass:Ot.mass},e.isResolvedFromDuration=!0}return e}function Gc(s=Ot.visualDuration,e=Ot.bounce){const a=typeof s!="object"?{visualDuration:s,keyframes:[0,1],bounce:e}:s;let{restSpeed:i,restDelta:o}=a;const u=a.keyframes[0],d=a.keyframes[a.keyframes.length-1],f={done:!1,value:u},{stiffness:m,damping:p,mass:x,duration:b,velocity:y,isResolvedFromDuration:j}=l5({...a,velocity:-Js(a.velocity||0)}),N=y||0,k=p/(2*Math.sqrt(m*x)),T=d-u,R=Js(Math.sqrt(m/x)),A=Math.abs(T)<5;i||(i=A?Ot.restSpeed.granular:Ot.restSpeed.default),o||(o=A?Ot.restDelta.granular:Ot.restDelta.default);let C;if(k<1){const F=wf(R,k);C=V=>{const O=Math.exp(-k*R*V);return d-O*((N+k*R*T)/F*Math.sin(F*V)+T*Math.cos(F*V))}}else if(k===1)C=F=>d-Math.exp(-R*F)*(T+(N+R*T)*F);else{const F=R*Math.sqrt(k*k-1);C=V=>{const O=Math.exp(-k*R*V),H=Math.min(F*V,300);return d-O*((N+k*R*T)*Math.sinh(H)+F*T*Math.cosh(H))/F}}const B={calculatedDuration:j&&b||null,next:F=>{const V=C(F);if(j)f.done=F>=b;else{let O=F===0?N:0;k<1&&(O=F===0?Xn(N):Aw(C,F,V));const H=Math.abs(O)<=i,te=Math.abs(d-V)<=o;f.done=H&&te}return f.value=f.done?d:V,f},toString:()=>{const F=Math.min(vm(B),Hc),V=Cw(O=>B.next(F*O).value,F,30);return F+"ms "+V},toTransition:()=>{}};return B}Gc.applyToOptions=s=>{const e=e5(s,100,Gc);return s.ease=e.ease,s.duration=Xn(e.duration),s.type="keyframes",s};function jf({keyframes:s,velocity:e=0,power:a=.8,timeConstant:i=325,bounceDamping:o=10,bounceStiffness:u=500,modifyTarget:d,min:f,max:m,restDelta:p=.5,restSpeed:x}){const b=s[0],y={done:!1,value:b},j=H=>f!==void 0&&H<f||m!==void 0&&H>m,N=H=>f===void 0?m:m===void 0||Math.abs(f-H)<Math.abs(m-H)?f:m;let k=a*e;const T=b+k,R=d===void 0?T:d(T);R!==T&&(k=R-b);const A=H=>-k*Math.exp(-H/i),C=H=>R+A(H),B=H=>{const te=A(H),me=C(H);y.done=Math.abs(te)<=p,y.value=y.done?R:me};let F,V;const O=H=>{j(y.value)&&(F=H,V=Gc({keyframes:[y.value,N(y.value)],velocity:Aw(C,H,y.value),damping:o,stiffness:u,restDelta:p,restSpeed:x}))};return O(0),{calculatedDuration:null,next:H=>{let te=!1;return!V&&F===void 0&&(te=!0,B(H),O(H)),F!==void 0&&H>=F?V.next(H-F):(!te&&B(H),y)}}}function o5(s,e,a){const i=[],o=a||Qn.mix||Ew,u=s.length-1;for(let d=0;d<u;d++){let f=o(s[d],s[d+1]);if(e){const m=Array.isArray(e)?e[d]||Qs:e;f=Ql(m,f)}i.push(f)}return i}function c5(s,e,{clamp:a=!0,ease:i,mixer:o}={}){const u=s.length;if(dm(u===e.length),u===1)return()=>e[0];if(u===2&&e[0]===e[1])return()=>e[1];const d=s[0]===s[1];s[0]>s[u-1]&&(s=[...s].reverse(),e=[...e].reverse());const f=o5(e,i,o),m=f.length,p=x=>{if(d&&x<s[0])return e[0];let b=0;if(m>1)for(;b<s.length-2&&!(x<s[b+1]);b++);const y=zl(s[b],s[b+1],x);return f[b](y)};return a?x=>p(Sn(s[0],s[u-1],x)):p}function u5(s,e){const a=s[s.length-1];for(let i=1;i<=e;i++){const o=zl(0,e,i);s.push(Ct(a,1,o))}}function d5(s){const e=[0];return u5(e,s.length-1),e}function h5(s,e){return s.map(a=>a*e)}function f5(s,e){return s.map(()=>e||xw).splice(0,s.length-1)}function kl({duration:s=300,keyframes:e,times:a,ease:i="easeInOut"}){const o=SA(i)?i.map(Rb):Rb(i),u={done:!1,value:e[0]},d=h5(a&&a.length===e.length?a:d5(e),s),f=c5(d,e,{ease:Array.isArray(o)?o:f5(e,o)});return{calculatedDuration:s,next:m=>(u.value=f(m),u.done=m>=s,u)}}const m5=s=>s!==null;function wm(s,{repeat:e,repeatType:a="loop"},i,o=1){const u=s.filter(m5),f=o<0||e&&a!=="loop"&&e%2===1?0:u.length-1;return!f||i===void 0?u[f]:i}const p5={decay:jf,inertia:jf,tween:kl,keyframes:kl,spring:Gc};function Rw(s){typeof s.type=="string"&&(s.type=p5[s.type])}class jm{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(e=>{this.resolve=e})}notifyFinished(){this.resolve()}then(e,a){return this.finished.then(e,a)}}const g5=s=>s/100;class Nm extends jm{constructor(e){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:a}=this.options;a&&a.updatedAt!==xs.now()&&this.tick(xs.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),this.options.onStop?.())},this.options=e,this.initAnimation(),this.play(),e.autoplay===!1&&this.pause()}initAnimation(){const{options:e}=this;Rw(e);const{type:a=kl,repeat:i=0,repeatDelay:o=0,repeatType:u,velocity:d=0}=e;let{keyframes:f}=e;const m=a||kl;m!==kl&&typeof f[0]!="number"&&(this.mixKeyframes=Ql(g5,Ew(f[0],f[1])),f=[0,100]);const p=m({...e,keyframes:f});u==="mirror"&&(this.mirroredGenerator=m({...e,keyframes:[...f].reverse(),velocity:-d})),p.calculatedDuration===null&&(p.calculatedDuration=vm(p));const{calculatedDuration:x}=p;this.calculatedDuration=x,this.resolvedDuration=x+o,this.totalDuration=this.resolvedDuration*(i+1)-o,this.generator=p}updateTime(e){const a=Math.round(e-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=a}tick(e,a=!1){const{generator:i,totalDuration:o,mixKeyframes:u,mirroredGenerator:d,resolvedDuration:f,calculatedDuration:m}=this;if(this.startTime===null)return i.next(0);const{delay:p=0,keyframes:x,repeat:b,repeatType:y,repeatDelay:j,type:N,onUpdate:k,finalKeyframe:T}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-o/this.speed,this.startTime)),a?this.currentTime=e:this.updateTime(e);const R=this.currentTime-p*(this.playbackSpeed>=0?1:-1),A=this.playbackSpeed>=0?R<0:R>o;this.currentTime=Math.max(R,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=o);let C=this.currentTime,B=i;if(b){const H=Math.min(this.currentTime,o)/f;let te=Math.floor(H),me=H%1;!me&&H>=1&&(me=1),me===1&&te--,te=Math.min(te,b+1),te%2&&(y==="reverse"?(me=1-me,j&&(me-=j/f)):y==="mirror"&&(B=d)),C=Sn(0,1,me)*f}const F=A?{done:!1,value:x[0]}:B.next(C);u&&(F.value=u(F.value));let{done:V}=F;!A&&m!==null&&(V=this.playbackSpeed>=0?this.currentTime>=o:this.currentTime<=0);const O=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&V);return O&&N!==jf&&(F.value=wm(x,this.options,T,this.speed)),k&&k(F.value),O&&this.finish(),F}then(e,a){return this.finished.then(e,a)}get duration(){return Js(this.calculatedDuration)}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+Js(e)}get time(){return Js(this.currentTime)}set time(e){e=Xn(e),this.currentTime=e,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.playbackSpeed),this.driver?.start(!1)}get speed(){return this.playbackSpeed}set speed(e){this.updateTime(xs.now());const a=this.playbackSpeed!==e;this.playbackSpeed=e,a&&(this.time=Js(this.currentTime))}play(){if(this.isStopped)return;const{driver:e=WA,startTime:a}=this.options;this.driver||(this.driver=e(o=>this.tick(o))),this.options.onPlay?.();const i=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=i):this.holdTime!==null?this.startTime=i-this.holdTime:this.startTime||(this.startTime=a??i),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(xs.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.notifyFinished(),this.teardown(),this.state="finished",this.options.onComplete?.()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),this.options.onCancel?.()}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}attachTimeline(e){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),this.driver?.stop(),e.observe(this)}}function x5(s){for(let e=1;e<s.length;e++)s[e]??(s[e]=s[e-1])}const ur=s=>s*180/Math.PI,Nf=s=>{const e=ur(Math.atan2(s[1],s[0]));return Sf(e)},b5={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:s=>(Math.abs(s[0])+Math.abs(s[3]))/2,rotate:Nf,rotateZ:Nf,skewX:s=>ur(Math.atan(s[1])),skewY:s=>ur(Math.atan(s[2])),skew:s=>(Math.abs(s[1])+Math.abs(s[2]))/2},Sf=s=>(s=s%360,s<0&&(s+=360),s),Ib=Nf,Bb=s=>Math.sqrt(s[0]*s[0]+s[1]*s[1]),zb=s=>Math.sqrt(s[4]*s[4]+s[5]*s[5]),y5={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:Bb,scaleY:zb,scale:s=>(Bb(s)+zb(s))/2,rotateX:s=>Sf(ur(Math.atan2(s[6],s[5]))),rotateY:s=>Sf(ur(Math.atan2(-s[2],s[0]))),rotateZ:Ib,rotate:Ib,skewX:s=>ur(Math.atan(s[4])),skewY:s=>ur(Math.atan(s[1])),skew:s=>(Math.abs(s[1])+Math.abs(s[4]))/2};function _f(s){return s.includes("scale")?1:0}function kf(s,e){if(!s||s==="none")return _f(e);const a=s.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let i,o;if(a)i=y5,o=a;else{const f=s.match(/^matrix\(([-\d.e\s,]+)\)$/u);i=b5,o=f}if(!o)return _f(e);const u=i[e],d=o[1].split(",").map(w5);return typeof u=="function"?u(d):d[u]}const v5=(s,e)=>{const{transform:a="none"}=getComputedStyle(s);return kf(a,e)};function w5(s){return parseFloat(s.trim())}const _i=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],ki=new Set(_i),Vb=s=>s===Si||s===ke,j5=new Set(["x","y","z"]),N5=_i.filter(s=>!j5.has(s));function S5(s){const e=[];return N5.forEach(a=>{const i=s.getValue(a);i!==void 0&&(e.push([a,i.get()]),i.set(a.startsWith("scale")?1:0))}),e}const Ea={width:({x:s},{paddingLeft:e="0",paddingRight:a="0"})=>s.max-s.min-parseFloat(e)-parseFloat(a),height:({y:s},{paddingTop:e="0",paddingBottom:a="0"})=>s.max-s.min-parseFloat(e)-parseFloat(a),top:(s,{top:e})=>parseFloat(e),left:(s,{left:e})=>parseFloat(e),bottom:({y:s},{top:e})=>parseFloat(e)+(s.max-s.min),right:({x:s},{left:e})=>parseFloat(e)+(s.max-s.min),x:(s,{transform:e})=>kf(e,"x"),y:(s,{transform:e})=>kf(e,"y")};Ea.translateX=Ea.x;Ea.translateY=Ea.y;const dr=new Set;let Tf=!1,Ef=!1,Cf=!1;function Dw(){if(Ef){const s=Array.from(dr).filter(i=>i.needsMeasurement),e=new Set(s.map(i=>i.element)),a=new Map;e.forEach(i=>{const o=S5(i);o.length&&(a.set(i,o),i.render())}),s.forEach(i=>i.measureInitialState()),e.forEach(i=>{i.render();const o=a.get(i);o&&o.forEach(([u,d])=>{i.getValue(u)?.set(d)})}),s.forEach(i=>i.measureEndState()),s.forEach(i=>{i.suspendedScrollY!==void 0&&window.scrollTo(0,i.suspendedScrollY)})}Ef=!1,Tf=!1,dr.forEach(s=>s.complete(Cf)),dr.clear()}function Ow(){dr.forEach(s=>{s.readKeyframes(),s.needsMeasurement&&(Ef=!0)})}function _5(){Cf=!0,Ow(),Dw(),Cf=!1}class Sm{constructor(e,a,i,o,u,d=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...e],this.onComplete=a,this.name=i,this.motionValue=o,this.element=u,this.isAsync=d}scheduleResolve(){this.state="scheduled",this.isAsync?(dr.add(this),Tf||(Tf=!0,Nt.read(Ow),Nt.resolveKeyframes(Dw))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:a,element:i,motionValue:o}=this;if(e[0]===null){const u=o?.get(),d=e[e.length-1];if(u!==void 0)e[0]=u;else if(i&&a){const f=i.readValue(a,d);f!=null&&(e[0]=f)}e[0]===void 0&&(e[0]=d),o&&u===void 0&&o.set(e[0])}x5(e)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(e=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,e),dr.delete(this)}cancel(){this.state==="scheduled"&&(dr.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const k5=s=>s.startsWith("--");function T5(s,e,a){k5(e)?s.style.setProperty(e,a):s.style[e]=a}const E5=hm(()=>window.ScrollTimeline!==void 0),C5={};function A5(s,e){const a=hm(s);return()=>C5[e]??a()}const Mw=A5(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),wl=([s,e,a,i])=>`cubic-bezier(${s}, ${e}, ${a}, ${i})`,$b={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:wl([0,.65,.55,1]),circOut:wl([.55,0,1,.45]),backIn:wl([.31,.01,.66,-.59]),backOut:wl([.33,1.53,.69,.99])};function Uw(s,e){if(s)return typeof s=="function"?Mw()?Cw(s,e):"ease-out":bw(s)?wl(s):Array.isArray(s)?s.map(a=>Uw(a,e)||$b.easeOut):$b[s]}function R5(s,e,a,{delay:i=0,duration:o=300,repeat:u=0,repeatType:d="loop",ease:f="easeOut",times:m}={},p=void 0){const x={[e]:a};m&&(x.offset=m);const b=Uw(f,o);Array.isArray(b)&&(x.easing=b);const y={delay:i,duration:o,easing:Array.isArray(b)?"linear":b,fill:"both",iterations:u+1,direction:d==="reverse"?"alternate":"normal"};return p&&(y.pseudoElement=p),s.animate(x,y)}function Lw(s){return typeof s=="function"&&"applyToOptions"in s}function D5({type:s,...e}){return Lw(s)&&Mw()?s.applyToOptions(e):(e.duration??(e.duration=300),e.ease??(e.ease="easeOut"),e)}class O5 extends jm{constructor(e){if(super(),this.finishedTime=null,this.isStopped=!1,this.manualStartTime=null,!e)return;const{element:a,name:i,keyframes:o,pseudoElement:u,allowFlatten:d=!1,finalKeyframe:f,onComplete:m}=e;this.isPseudoElement=!!u,this.allowFlatten=d,this.options=e,dm(typeof e.type!="string");const p=D5(e);this.animation=R5(a,i,o,p,u),p.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!u){const x=wm(o,this.options,f,this.speed);this.updateMotionValue?this.updateMotionValue(x):T5(a,i,x),this.animation.cancel()}m?.(),this.notifyFinished()}}play(){this.isStopped||(this.manualStartTime=null,this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){this.animation.finish?.()}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:e}=this;e==="idle"||e==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){this.isPseudoElement||this.animation.commitStyles?.()}get duration(){const e=this.animation.effect?.getComputedTiming?.().duration||0;return Js(Number(e))}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+Js(e)}get time(){return Js(Number(this.animation.currentTime)||0)}set time(e){this.manualStartTime=null,this.finishedTime=null,this.animation.currentTime=Xn(e)}get speed(){return this.animation.playbackRate}set speed(e){e<0&&(this.finishedTime=null),this.animation.playbackRate=e}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return this.manualStartTime??Number(this.animation.startTime)}set startTime(e){this.manualStartTime=this.animation.startTime=e}attachTimeline({timeline:e,observe:a}){return this.allowFlatten&&this.animation.effect?.updateTiming({easing:"linear"}),this.animation.onfinish=null,e&&E5()?(this.animation.timeline=e,Qs):a(this)}}const Pw={anticipate:mw,backInOut:fw,circInOut:gw};function M5(s){return s in Pw}function U5(s){typeof s.ease=="string"&&M5(s.ease)&&(s.ease=Pw[s.ease])}const qh=10;class L5 extends O5{constructor(e){U5(e),Rw(e),super(e),e.startTime!==void 0&&(this.startTime=e.startTime),this.options=e}updateMotionValue(e){const{motionValue:a,onUpdate:i,onComplete:o,element:u,...d}=this.options;if(!a)return;if(e!==void 0){a.set(e);return}const f=new Nm({...d,autoplay:!1}),m=Math.max(qh,xs.now()-this.startTime),p=Sn(0,qh,m-qh);a.setWithVelocity(f.sample(Math.max(0,m-p)).value,f.sample(m).value,p),f.stop()}}const qb=(s,e)=>e==="zIndex"?!1:!!(typeof s=="number"||Array.isArray(s)||typeof s=="string"&&(Da.test(s)||s==="0")&&!s.startsWith("url("));function P5(s){const e=s[0];if(s.length===1)return!0;for(let a=0;a<s.length;a++)if(s[a]!==e)return!0}function I5(s,e,a,i){const o=s[0];if(o===null)return!1;if(e==="display"||e==="visibility")return!0;const u=s[s.length-1],d=qb(o,e),f=qb(u,e);return!d||!f?!1:P5(s)||(a==="spring"||Lw(a))&&i}function Af(s){s.duration=0,s.type="keyframes"}const B5=new Set(["opacity","clipPath","filter","transform"]),z5=hm(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function V5(s){const{motionValue:e,name:a,repeatDelay:i,repeatType:o,damping:u,type:d}=s;if(!(e?.owner?.current instanceof HTMLElement))return!1;const{onUpdate:m,transformTemplate:p}=e.owner.getProps();return z5()&&a&&B5.has(a)&&(a!=="transform"||!p)&&!m&&!i&&o!=="mirror"&&u!==0&&d!=="inertia"}const $5=40;class q5 extends jm{constructor({autoplay:e=!0,delay:a=0,type:i="keyframes",repeat:o=0,repeatDelay:u=0,repeatType:d="loop",keyframes:f,name:m,motionValue:p,element:x,...b}){super(),this.stop=()=>{this._animation&&(this._animation.stop(),this.stopTimeline?.()),this.keyframeResolver?.cancel()},this.createdAt=xs.now();const y={autoplay:e,delay:a,type:i,repeat:o,repeatDelay:u,repeatType:d,name:m,motionValue:p,element:x,...b},j=x?.KeyframeResolver||Sm;this.keyframeResolver=new j(f,(N,k,T)=>this.onKeyframesResolved(N,k,y,!T),m,p,x),this.keyframeResolver?.scheduleResolve()}onKeyframesResolved(e,a,i,o){this.keyframeResolver=void 0;const{name:u,type:d,velocity:f,delay:m,isHandoff:p,onUpdate:x}=i;this.resolvedAt=xs.now(),I5(e,u,d,f)||((Qn.instantAnimations||!m)&&x?.(wm(e,i,a)),e[0]=e[e.length-1],Af(i),i.repeat=0);const y={startTime:o?this.resolvedAt?this.resolvedAt-this.createdAt>$5?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:a,...i,keyframes:e},j=!p&&V5(y),N=y.motionValue?.owner?.current,k=j?new L5({...y,element:N}):new Nm(y);k.finished.then(()=>{this.notifyFinished()}).catch(Qs),this.pendingTimeline&&(this.stopTimeline=k.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=k}get finished(){return this._animation?this.animation.finished:this._finished}then(e,a){return this.finished.finally(e).then(()=>{})}get animation(){return this._animation||(this.keyframeResolver?.resume(),_5()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(e){this.animation.time=e}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(e){this.animation.speed=e}get startTime(){return this.animation.startTime}attachTimeline(e){return this._animation?this.stopTimeline=this.animation.attachTimeline(e):this.pendingTimeline=e,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this._animation&&this.animation.cancel(),this.keyframeResolver?.cancel()}}function Iw(s,e,a,i=0,o=1){const u=Array.from(s).sort((p,x)=>p.sortNodePosition(x)).indexOf(e),d=s.size,f=(d-1)*i;return typeof a=="function"?a(u,d):o===1?u*i:f-u*i}const H5=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function G5(s){const e=H5.exec(s);if(!e)return[,];const[,a,i,o]=e;return[`--${a??i}`,o]}function Bw(s,e,a=1){const[i,o]=G5(s);if(!i)return;const u=window.getComputedStyle(e).getPropertyValue(i);if(u){const d=u.trim();return rw(d)?parseFloat(d):d}return gm(o)?Bw(o,e,a+1):o}const F5={type:"spring",stiffness:500,damping:25,restSpeed:10},K5=s=>({type:"spring",stiffness:550,damping:s===0?2*Math.sqrt(550):30,restSpeed:10}),Y5={type:"keyframes",duration:.8},X5={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},J5=(s,{keyframes:e})=>e.length>2?Y5:ki.has(s)?s.startsWith("scale")?K5(e[1]):F5:X5,Q5=s=>s!==null;function Z5(s,{repeat:e,repeatType:a="loop"},i){const o=s.filter(Q5),u=e&&a!=="loop"&&e%2===1?0:o.length-1;return o[u]}function _m(s,e){return s?.[e]??s?.default??s}function W5({when:s,delay:e,delayChildren:a,staggerChildren:i,staggerDirection:o,repeat:u,repeatType:d,repeatDelay:f,from:m,elapsed:p,...x}){return!!Object.keys(x).length}const km=(s,e,a,i={},o,u)=>d=>{const f=_m(i,s)||{},m=f.delay||i.delay||0;let{elapsed:p=0}=i;p=p-Xn(m);const x={keyframes:Array.isArray(a)?a:[null,a],ease:"easeOut",velocity:e.getVelocity(),...f,delay:-p,onUpdate:y=>{e.set(y),f.onUpdate&&f.onUpdate(y)},onComplete:()=>{d(),f.onComplete&&f.onComplete()},name:s,motionValue:e,element:u?void 0:o};W5(f)||Object.assign(x,J5(s,x)),x.duration&&(x.duration=Xn(x.duration)),x.repeatDelay&&(x.repeatDelay=Xn(x.repeatDelay)),x.from!==void 0&&(x.keyframes[0]=x.from);let b=!1;if((x.type===!1||x.duration===0&&!x.repeatDelay)&&(Af(x),x.delay===0&&(b=!0)),(Qn.instantAnimations||Qn.skipAnimations)&&(b=!0,Af(x),x.delay=0),x.allowFlatten=!f.type&&!f.ease,b&&!u&&e.get()!==void 0){const y=Z5(x.keyframes,f);if(y!==void 0){Nt.update(()=>{x.onUpdate(y),x.onComplete()});return}}return f.isSync?new Nm(x):new q5(x)};function Hb(s){const e=[{},{}];return s?.values.forEach((a,i)=>{e[0][i]=a.get(),e[1][i]=a.getVelocity()}),e}function Tm(s,e,a,i){if(typeof e=="function"){const[o,u]=Hb(i);e=e(a!==void 0?a:s.custom,o,u)}if(typeof e=="string"&&(e=s.variants&&s.variants[e]),typeof e=="function"){const[o,u]=Hb(i);e=e(a!==void 0?a:s.custom,o,u)}return e}function bi(s,e,a){const i=s.getProps();return Tm(i,e,a!==void 0?a:i.custom,s)}const zw=new Set(["width","height","top","left","right","bottom",..._i]),Gb=30,eR=s=>!isNaN(parseFloat(s));class tR{constructor(e,a={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=i=>{const o=xs.now();if(this.updatedAt!==o&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(i),this.current!==this.prev&&(this.events.change?.notify(this.current),this.dependents))for(const u of this.dependents)u.dirty()},this.hasAnimated=!1,this.setCurrent(e),this.owner=a.owner}setCurrent(e){this.current=e,this.updatedAt=xs.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=eR(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,a){this.events[e]||(this.events[e]=new fm);const i=this.events[e].add(a);return e==="change"?()=>{i(),Nt.read(()=>{this.events.change.getSize()||this.stop()})}:i}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,a){this.passiveEffect=e,this.stopPassiveEffect=a}set(e){this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e)}setWithVelocity(e,a,i){this.set(a),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-i}jump(e,a=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,a&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){this.events.change?.notify(this.current)}addDependent(e){this.dependents||(this.dependents=new Set),this.dependents.add(e)}removeDependent(e){this.dependents&&this.dependents.delete(e)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=xs.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>Gb)return 0;const a=Math.min(this.updatedAt-this.prevUpdatedAt,Gb);return ow(parseFloat(this.current)-parseFloat(this.prevFrameValue),a)}start(e){return this.stop(),new Promise(a=>{this.hasAnimated=!0,this.animation=e(a),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.dependents?.clear(),this.events.destroy?.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function vi(s,e){return new tR(s,e)}const Rf=s=>Array.isArray(s);function sR(s,e,a){s.hasValue(e)?s.getValue(e).set(a):s.addValue(e,vi(a))}function nR(s){return Rf(s)?s[s.length-1]||0:s}function aR(s,e){const a=bi(s,e);let{transitionEnd:i={},transition:o={},...u}=a||{};u={...u,...i};for(const d in u){const f=nR(u[d]);sR(s,d,f)}}const fs=s=>!!(s&&s.getVelocity);function rR(s){return!!(fs(s)&&s.add)}function Df(s,e){const a=s.getValue("willChange");if(rR(a))return a.add(e);if(!a&&Qn.WillChange){const i=new Qn.WillChange("auto");s.addValue("willChange",i),i.add(e)}}function Em(s){return s.replace(/([A-Z])/g,e=>`-${e.toLowerCase()}`)}const iR="framerAppearId",Vw="data-"+Em(iR);function $w(s){return s.props[Vw]}function lR({protectedKeys:s,needsAnimating:e},a){const i=s.hasOwnProperty(a)&&e[a]!==!0;return e[a]=!1,i}function qw(s,e,{delay:a=0,transitionOverride:i,type:o}={}){let{transition:u=s.getDefaultTransition(),transitionEnd:d,...f}=e;i&&(u=i);const m=[],p=o&&s.animationState&&s.animationState.getState()[o];for(const x in f){const b=s.getValue(x,s.latestValues[x]??null),y=f[x];if(y===void 0||p&&lR(p,x))continue;const j={delay:a,..._m(u||{},x)},N=b.get();if(N!==void 0&&!b.isAnimating&&!Array.isArray(y)&&y===N&&!j.velocity)continue;let k=!1;if(window.MotionHandoffAnimation){const R=$w(s);if(R){const A=window.MotionHandoffAnimation(R,x,Nt);A!==null&&(j.startTime=A,k=!0)}}Df(s,x),b.start(km(x,b,y,s.shouldReduceMotion&&zw.has(x)?{type:!1}:j,s,k));const T=b.animation;T&&m.push(T)}return d&&Promise.all(m).then(()=>{Nt.update(()=>{d&&aR(s,d)})}),m}function Of(s,e,a={}){const i=bi(s,e,a.type==="exit"?s.presenceContext?.custom:void 0);let{transition:o=s.getDefaultTransition()||{}}=i||{};a.transitionOverride&&(o=a.transitionOverride);const u=i?()=>Promise.all(qw(s,i,a)):()=>Promise.resolve(),d=s.variantChildren&&s.variantChildren.size?(m=0)=>{const{delayChildren:p=0,staggerChildren:x,staggerDirection:b}=o;return oR(s,e,m,p,x,b,a)}:()=>Promise.resolve(),{when:f}=o;if(f){const[m,p]=f==="beforeChildren"?[u,d]:[d,u];return m().then(()=>p())}else return Promise.all([u(),d(a.delay)])}function oR(s,e,a=0,i=0,o=0,u=1,d){const f=[];for(const m of s.variantChildren)m.notify("AnimationStart",e),f.push(Of(m,e,{...d,delay:a+(typeof i=="function"?0:i)+Iw(s.variantChildren,m,i,o,u)}).then(()=>m.notify("AnimationComplete",e)));return Promise.all(f)}function cR(s,e,a={}){s.notify("AnimationStart",e);let i;if(Array.isArray(e)){const o=e.map(u=>Of(s,u,a));i=Promise.all(o)}else if(typeof e=="string")i=Of(s,e,a);else{const o=typeof e=="function"?bi(s,e,a.custom):e;i=Promise.all(qw(s,o,a))}return i.then(()=>{s.notify("AnimationComplete",e)})}const uR={test:s=>s==="auto",parse:s=>s},Hw=s=>e=>e.test(s),Gw=[Si,ke,Nn,_a,PA,LA,uR],Fb=s=>Gw.find(Hw(s));function dR(s){return typeof s=="number"?s===0:s!==null?s==="none"||s==="0"||lw(s):!0}const hR=new Set(["brightness","contrast","saturate","opacity"]);function fR(s){const[e,a]=s.slice(0,-1).split("(");if(e==="drop-shadow")return s;const[i]=a.match(xm)||[];if(!i)return s;const o=a.replace(i,"");let u=hR.has(e)?1:0;return i!==a&&(u*=100),e+"("+u+o+")"}const mR=/\b([a-z-]*)\(.*?\)/gu,Mf={...Da,getAnimatableNone:s=>{const e=s.match(mR);return e?e.map(fR).join(" "):s}},Kb={...Si,transform:Math.round},pR={rotate:_a,rotateX:_a,rotateY:_a,rotateZ:_a,scale:_c,scaleX:_c,scaleY:_c,scaleZ:_c,skew:_a,skewX:_a,skewY:_a,distance:ke,translateX:ke,translateY:ke,translateZ:ke,x:ke,y:ke,z:ke,perspective:ke,transformPerspective:ke,opacity:Vl,originX:Ob,originY:Ob,originZ:ke},Cm={borderWidth:ke,borderTopWidth:ke,borderRightWidth:ke,borderBottomWidth:ke,borderLeftWidth:ke,borderRadius:ke,borderTopLeftRadius:ke,borderTopRightRadius:ke,borderBottomRightRadius:ke,borderBottomLeftRadius:ke,width:ke,maxWidth:ke,height:ke,maxHeight:ke,top:ke,right:ke,bottom:ke,left:ke,inset:ke,insetBlock:ke,insetBlockStart:ke,insetBlockEnd:ke,insetInline:ke,insetInlineStart:ke,insetInlineEnd:ke,padding:ke,paddingTop:ke,paddingRight:ke,paddingBottom:ke,paddingLeft:ke,paddingBlock:ke,paddingBlockStart:ke,paddingBlockEnd:ke,paddingInline:ke,paddingInlineStart:ke,paddingInlineEnd:ke,margin:ke,marginTop:ke,marginRight:ke,marginBottom:ke,marginLeft:ke,marginBlock:ke,marginBlockStart:ke,marginBlockEnd:ke,marginInline:ke,marginInlineStart:ke,marginInlineEnd:ke,fontSize:ke,backgroundPositionX:ke,backgroundPositionY:ke,...pR,zIndex:Kb,fillOpacity:Vl,strokeOpacity:Vl,numOctaves:Kb},gR={...Cm,color:qt,backgroundColor:qt,outlineColor:qt,fill:qt,stroke:qt,borderColor:qt,borderTopColor:qt,borderRightColor:qt,borderBottomColor:qt,borderLeftColor:qt,filter:Mf,WebkitFilter:Mf},Fw=s=>gR[s];function Kw(s,e){let a=Fw(s);return a!==Mf&&(a=Da),a.getAnimatableNone?a.getAnimatableNone(e):void 0}const xR=new Set(["auto","none","0"]);function bR(s,e,a){let i=0,o;for(;i<s.length&&!o;){const u=s[i];typeof u=="string"&&!xR.has(u)&&$l(u).values.length&&(o=s[i]),i++}if(o&&a)for(const u of e)s[u]=Kw(a,o)}class yR extends Sm{constructor(e,a,i,o,u){super(e,a,i,o,u,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:a,name:i}=this;if(!a||!a.current)return;super.readKeyframes();for(let x=0;x<e.length;x++){let b=e[x];if(typeof b=="string"&&(b=b.trim(),gm(b))){const y=Bw(b,a.current);y!==void 0&&(e[x]=y),x===e.length-1&&(this.finalKeyframe=b)}}if(this.resolveNoneKeyframes(),!zw.has(i)||e.length!==2)return;const[o,u]=e,d=Fb(o),f=Fb(u),m=Db(o),p=Db(u);if(m!==p&&Ea[i]){this.needsMeasurement=!0;return}if(d!==f)if(Vb(d)&&Vb(f))for(let x=0;x<e.length;x++){const b=e[x];typeof b=="string"&&(e[x]=parseFloat(b))}else Ea[i]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:a}=this,i=[];for(let o=0;o<e.length;o++)(e[o]===null||dR(e[o]))&&i.push(o);i.length&&bR(e,i,a)}measureInitialState(){const{element:e,unresolvedKeyframes:a,name:i}=this;if(!e||!e.current)return;i==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Ea[i](e.measureViewportBox(),window.getComputedStyle(e.current)),a[0]=this.measuredOrigin;const o=a[a.length-1];o!==void 0&&e.getValue(i,o).jump(o,!1)}measureEndState(){const{element:e,name:a,unresolvedKeyframes:i}=this;if(!e||!e.current)return;const o=e.getValue(a);o&&o.jump(this.measuredOrigin,!1);const u=i.length-1,d=i[u];i[u]=Ea[a](e.measureViewportBox(),window.getComputedStyle(e.current)),d!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=d),this.removedTransforms?.length&&this.removedTransforms.forEach(([f,m])=>{e.getValue(f).set(m)}),this.resolveNoneKeyframes()}}function vR(s,e,a){if(s==null)return[];if(s instanceof EventTarget)return[s];if(typeof s=="string"){let i=document;const o=a?.[s]??i.querySelectorAll(s);return o?Array.from(o):[]}return Array.from(s).filter(i=>i!=null)}const Yw=(s,e)=>e&&typeof s=="number"?e.transform(s):s;function Uf(s){return iw(s)&&"offsetHeight"in s}const{schedule:Am}=yw(queueMicrotask,!1),nn={x:!1,y:!1};function Xw(){return nn.x||nn.y}function wR(s){return s==="x"||s==="y"?nn[s]?null:(nn[s]=!0,()=>{nn[s]=!1}):nn.x||nn.y?null:(nn.x=nn.y=!0,()=>{nn.x=nn.y=!1})}function Jw(s,e){const a=vR(s),i=new AbortController,o={passive:!0,...e,signal:i.signal};return[a,o,()=>i.abort()]}function Yb(s){return!(s.pointerType==="touch"||Xw())}function jR(s,e,a={}){const[i,o,u]=Jw(s,a),d=f=>{if(!Yb(f))return;const{target:m}=f,p=e(m,f);if(typeof p!="function"||!m)return;const x=b=>{Yb(b)&&(p(b),m.removeEventListener("pointerleave",x))};m.addEventListener("pointerleave",x,o)};return i.forEach(f=>{f.addEventListener("pointerenter",d,o)}),u}const Qw=(s,e)=>e?s===e?!0:Qw(s,e.parentElement):!1,Rm=s=>s.pointerType==="mouse"?typeof s.button!="number"||s.button<=0:s.isPrimary!==!1,NR=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function Zw(s){return NR.has(s.tagName)||s.isContentEditable===!0}const Dc=new WeakSet;function Xb(s){return e=>{e.key==="Enter"&&s(e)}}function Hh(s,e){s.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const SR=(s,e)=>{const a=s.currentTarget;if(!a)return;const i=Xb(()=>{if(Dc.has(a))return;Hh(a,"down");const o=Xb(()=>{Hh(a,"up")}),u=()=>Hh(a,"cancel");a.addEventListener("keyup",o,e),a.addEventListener("blur",u,e)});a.addEventListener("keydown",i,e),a.addEventListener("blur",()=>a.removeEventListener("keydown",i),e)};function Jb(s){return Rm(s)&&!Xw()}function _R(s,e,a={}){const[i,o,u]=Jw(s,a),d=f=>{const m=f.currentTarget;if(!Jb(f))return;Dc.add(m);const p=e(m,f),x=(j,N)=>{window.removeEventListener("pointerup",b),window.removeEventListener("pointercancel",y),Dc.has(m)&&Dc.delete(m),Jb(j)&&typeof p=="function"&&p(j,{success:N})},b=j=>{x(j,m===window||m===document||a.useGlobalTarget||Qw(m,j.target))},y=j=>{x(j,!1)};window.addEventListener("pointerup",b,o),window.addEventListener("pointercancel",y,o)};return i.forEach(f=>{(a.useGlobalTarget?window:f).addEventListener("pointerdown",d,o),Uf(f)&&(f.addEventListener("focus",p=>SR(p,o)),!Zw(f)&&!f.hasAttribute("tabindex")&&(f.tabIndex=0))}),u}function Ww(s){return iw(s)&&"ownerSVGElement"in s}function kR(s){return Ww(s)&&s.tagName==="svg"}const TR=[...Gw,qt,Da],ER=s=>TR.find(Hw(s)),Qb=()=>({translate:0,scale:1,origin:0,originPoint:0}),mi=()=>({x:Qb(),y:Qb()}),Zb=()=>({min:0,max:0}),Yt=()=>({x:Zb(),y:Zb()}),Lf={current:null},ej={current:!1},CR=typeof window<"u";function AR(){if(ej.current=!0,!!CR)if(window.matchMedia){const s=window.matchMedia("(prefers-reduced-motion)"),e=()=>Lf.current=s.matches;s.addEventListener("change",e),e()}else Lf.current=!1}const RR=new WeakMap;function au(s){return s!==null&&typeof s=="object"&&typeof s.start=="function"}function ql(s){return typeof s=="string"||Array.isArray(s)}const Dm=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],Om=["initial",...Dm];function ru(s){return au(s.animate)||Om.some(e=>ql(s[e]))}function tj(s){return!!(ru(s)||s.variants)}function DR(s,e,a){for(const i in e){const o=e[i],u=a[i];if(fs(o))s.addValue(i,o);else if(fs(u))s.addValue(i,vi(o,{owner:s}));else if(u!==o)if(s.hasValue(i)){const d=s.getValue(i);d.liveStyle===!0?d.jump(o):d.hasAnimated||d.set(o)}else{const d=s.getStaticValue(i);s.addValue(i,vi(d!==void 0?d:o,{owner:s}))}}for(const i in a)e[i]===void 0&&s.removeValue(i);return e}const Wb=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];let Fc={};function sj(s){Fc=s}function OR(){return Fc}class MR{scrapeMotionValuesFromProps(e,a,i){return{}}constructor({parent:e,props:a,presenceContext:i,reducedMotionConfig:o,blockInitialAnimation:u,visualState:d},f={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=Sm,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const y=xs.now();this.renderScheduledAt<y&&(this.renderScheduledAt=y,Nt.render(this.render,!1,!0))};const{latestValues:m,renderState:p}=d;this.latestValues=m,this.baseTarget={...m},this.initialValues=a.initial?{...m}:{},this.renderState=p,this.parent=e,this.props=a,this.presenceContext=i,this.depth=e?e.depth+1:0,this.reducedMotionConfig=o,this.options=f,this.blockInitialAnimation=!!u,this.isControllingVariants=ru(a),this.isVariantNode=tj(a),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:x,...b}=this.scrapeMotionValuesFromProps(a,{},this);for(const y in b){const j=b[y];m[y]!==void 0&&fs(j)&&j.set(m[y])}}mount(e){this.current=e,RR.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((a,i)=>this.bindToMotionValue(i,a)),this.reducedMotionConfig==="never"?this.shouldReduceMotion=!1:this.reducedMotionConfig==="always"?this.shouldReduceMotion=!0:(ej.current||AR(),this.shouldReduceMotion=Lf.current),this.parent?.addChild(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),Ra(this.notifyUpdate),Ra(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent?.removeChild(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const a=this.features[e];a&&(a.unmount(),a.isMounted=!1)}this.current=null}addChild(e){this.children.add(e),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(e)}removeChild(e){this.children.delete(e),this.enteringChildren&&this.enteringChildren.delete(e)}bindToMotionValue(e,a){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const i=ki.has(e);i&&this.onBindTransform&&this.onBindTransform();const o=a.on("change",d=>{this.latestValues[e]=d,this.props.onUpdate&&Nt.preRender(this.notifyUpdate),i&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let u;typeof window<"u"&&window.MotionCheckAppearSync&&(u=window.MotionCheckAppearSync(this,e,a)),this.valueSubscriptions.set(e,()=>{o(),u&&u(),a.owner&&a.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in Fc){const a=Fc[e];if(!a)continue;const{isEnabled:i,Feature:o}=a;if(!this.features[e]&&o&&i(this.props)&&(this.features[e]=new o(this)),this.features[e]){const u=this.features[e];u.isMounted?u.update():(u.mount(),u.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Yt()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,a){this.latestValues[e]=a}update(e,a){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=a;for(let i=0;i<Wb.length;i++){const o=Wb[i];this.propEventSubscriptions[o]&&(this.propEventSubscriptions[o](),delete this.propEventSubscriptions[o]);const u="on"+o,d=e[u];d&&(this.propEventSubscriptions[o]=this.on(o,d))}this.prevMotionValues=DR(this,this.scrapeMotionValuesFromProps(e,this.prevProps||{},this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const a=this.getClosestVariantNode();if(a)return a.variantChildren&&a.variantChildren.add(e),()=>a.variantChildren.delete(e)}addValue(e,a){const i=this.values.get(e);a!==i&&(i&&this.removeValue(e),this.bindToMotionValue(e,a),this.values.set(e,a),this.latestValues[e]=a.get())}removeValue(e){this.values.delete(e);const a=this.valueSubscriptions.get(e);a&&(a(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,a){if(this.props.values&&this.props.values[e])return this.props.values[e];let i=this.values.get(e);return i===void 0&&a!==void 0&&(i=vi(a===null?void 0:a,{owner:this}),this.addValue(e,i)),i}readValue(e,a){let i=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:this.getBaseTargetFromProps(this.props,e)??this.readValueFromInstance(this.current,e,this.options);return i!=null&&(typeof i=="string"&&(rw(i)||lw(i))?i=parseFloat(i):!ER(i)&&Da.test(a)&&(i=Kw(e,a)),this.setBaseTarget(e,fs(i)?i.get():i)),fs(i)?i.get():i}setBaseTarget(e,a){this.baseTarget[e]=a}getBaseTarget(e){const{initial:a}=this.props;let i;if(typeof a=="string"||typeof a=="object"){const u=Tm(this.props,a,this.presenceContext?.custom);u&&(i=u[e])}if(a&&i!==void 0)return i;const o=this.getBaseTargetFromProps(this.props,e);return o!==void 0&&!fs(o)?o:this.initialValues[e]!==void 0&&i===void 0?void 0:this.baseTarget[e]}on(e,a){return this.events[e]||(this.events[e]=new fm),this.events[e].add(a)}notify(e,...a){this.events[e]&&this.events[e].notify(...a)}scheduleRenderMicrotask(){Am.render(this.render)}}class nj extends MR{constructor(){super(...arguments),this.KeyframeResolver=yR}sortInstanceNodePosition(e,a){return e.compareDocumentPosition(a)&2?1:-1}getBaseTargetFromProps(e,a){const i=e.style;return i?i[a]:void 0}removeValueFromRenderState(e,{vars:a,style:i}){delete a[e],delete i[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;fs(e)&&(this.childSubscription=e.on("change",a=>{this.current&&(this.current.textContent=`${a}`)}))}}class Ma{constructor(e){this.isMounted=!1,this.node=e}update(){}}function aj({top:s,left:e,right:a,bottom:i}){return{x:{min:e,max:a},y:{min:s,max:i}}}function UR({x:s,y:e}){return{top:e.min,right:s.max,bottom:e.max,left:s.min}}function LR(s,e){if(!e)return s;const a=e({x:s.left,y:s.top}),i=e({x:s.right,y:s.bottom});return{top:a.y,left:a.x,bottom:i.y,right:i.x}}function Gh(s){return s===void 0||s===1}function Pf({scale:s,scaleX:e,scaleY:a}){return!Gh(s)||!Gh(e)||!Gh(a)}function rr(s){return Pf(s)||rj(s)||s.z||s.rotate||s.rotateX||s.rotateY||s.skewX||s.skewY}function rj(s){return ey(s.x)||ey(s.y)}function ey(s){return s&&s!=="0%"}function Kc(s,e,a){const i=s-a,o=e*i;return a+o}function ty(s,e,a,i,o){return o!==void 0&&(s=Kc(s,o,i)),Kc(s,a,i)+e}function If(s,e=0,a=1,i,o){s.min=ty(s.min,e,a,i,o),s.max=ty(s.max,e,a,i,o)}function ij(s,{x:e,y:a}){If(s.x,e.translate,e.scale,e.originPoint),If(s.y,a.translate,a.scale,a.originPoint)}const sy=.999999999999,ny=1.0000000000001;function PR(s,e,a,i=!1){const o=a.length;if(!o)return;e.x=e.y=1;let u,d;for(let f=0;f<o;f++){u=a[f],d=u.projectionDelta;const{visualElement:m}=u.options;m&&m.props.style&&m.props.style.display==="contents"||(i&&u.options.layoutScroll&&u.scroll&&u!==u.root&&gi(s,{x:-u.scroll.offset.x,y:-u.scroll.offset.y}),d&&(e.x*=d.x.scale,e.y*=d.y.scale,ij(s,d)),i&&rr(u.latestValues)&&gi(s,u.latestValues))}e.x<ny&&e.x>sy&&(e.x=1),e.y<ny&&e.y>sy&&(e.y=1)}function pi(s,e){s.min=s.min+e,s.max=s.max+e}function ay(s,e,a,i,o=.5){const u=Ct(s.min,s.max,o);If(s,e,a,u,i)}function gi(s,e){ay(s.x,e.x,e.scaleX,e.scale,e.originX),ay(s.y,e.y,e.scaleY,e.scale,e.originY)}function lj(s,e){return aj(LR(s.getBoundingClientRect(),e))}function IR(s,e,a){const i=lj(s,a),{scroll:o}=e;return o&&(pi(i.x,o.offset.x),pi(i.y,o.offset.y)),i}const BR={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},zR=_i.length;function VR(s,e,a){let i="",o=!0;for(let u=0;u<zR;u++){const d=_i[u],f=s[d];if(f===void 0)continue;let m=!0;if(typeof f=="number")m=f===(d.startsWith("scale")?1:0);else{const p=parseFloat(f);m=d.startsWith("scale")?p===1:p===0}if(!m||a){const p=Yw(f,Cm[d]);if(!m){o=!1;const x=BR[d]||d;i+=`${x}(${p}) `}a&&(e[d]=p)}}return i=i.trim(),a?i=a(e,o?"":i):o&&(i="none"),i}function Mm(s,e,a){const{style:i,vars:o,transformOrigin:u}=s;let d=!1,f=!1;for(const m in e){const p=e[m];if(ki.has(m)){d=!0;continue}else if(ww(m)){o[m]=p;continue}else{const x=Yw(p,Cm[m]);m.startsWith("origin")?(f=!0,u[m]=x):i[m]=x}}if(e.transform||(d||a?i.transform=VR(e,s.transform,a):i.transform&&(i.transform="none")),f){const{originX:m="50%",originY:p="50%",originZ:x=0}=u;i.transformOrigin=`${m} ${p} ${x}`}}function oj(s,{style:e,vars:a},i,o){const u=s.style;let d;for(d in e)u[d]=e[d];o?.applyProjectionStyles(u,i);for(d in a)u.setProperty(d,a[d])}function ry(s,e){return e.max===e.min?0:s/(e.max-e.min)*100}const yl={correct:(s,e)=>{if(!e.target)return s;if(typeof s=="string")if(ke.test(s))s=parseFloat(s);else return s;const a=ry(s,e.target.x),i=ry(s,e.target.y);return`${a}% ${i}%`}},$R={correct:(s,{treeScale:e,projectionDelta:a})=>{const i=s,o=Da.parse(s);if(o.length>5)return i;const u=Da.createTransformer(s),d=typeof o[0]!="number"?1:0,f=a.x.scale*e.x,m=a.y.scale*e.y;o[0+d]/=f,o[1+d]/=m;const p=Ct(f,m,.5);return typeof o[2+d]=="number"&&(o[2+d]/=p),typeof o[3+d]=="number"&&(o[3+d]/=p),u(o)}},Bf={borderRadius:{...yl,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:yl,borderTopRightRadius:yl,borderBottomLeftRadius:yl,borderBottomRightRadius:yl,boxShadow:$R};function cj(s,{layout:e,layoutId:a}){return ki.has(s)||s.startsWith("origin")||(e||a!==void 0)&&(!!Bf[s]||s==="opacity")}function Um(s,e,a){const i=s.style,o=e?.style,u={};if(!i)return u;for(const d in i)(fs(i[d])||o&&fs(o[d])||cj(d,s)||a?.getValue(d)?.liveStyle!==void 0)&&(u[d]=i[d]);return u}function qR(s){return window.getComputedStyle(s)}class HR extends nj{constructor(){super(...arguments),this.type="html",this.renderInstance=oj}readValueFromInstance(e,a){if(ki.has(a))return this.projection?.isProjecting?_f(a):v5(e,a);{const i=qR(e),o=(ww(a)?i.getPropertyValue(a):i[a])||0;return typeof o=="string"?o.trim():o}}measureInstanceViewportBox(e,{transformPagePoint:a}){return lj(e,a)}build(e,a,i){Mm(e,a,i.transformTemplate)}scrapeMotionValuesFromProps(e,a,i){return Um(e,a,i)}}const GR={offset:"stroke-dashoffset",array:"stroke-dasharray"},FR={offset:"strokeDashoffset",array:"strokeDasharray"};function KR(s,e,a=1,i=0,o=!0){s.pathLength=1;const u=o?GR:FR;s[u.offset]=`${-i}`,s[u.array]=`${e} ${a}`}const YR=["offsetDistance","offsetPath","offsetRotate","offsetAnchor"];function uj(s,{attrX:e,attrY:a,attrScale:i,pathLength:o,pathSpacing:u=1,pathOffset:d=0,...f},m,p,x){if(Mm(s,f,p),m){s.style.viewBox&&(s.attrs.viewBox=s.style.viewBox);return}s.attrs=s.style,s.style={};const{attrs:b,style:y}=s;b.transform&&(y.transform=b.transform,delete b.transform),(y.transform||b.transformOrigin)&&(y.transformOrigin=b.transformOrigin??"50% 50%",delete b.transformOrigin),y.transform&&(y.transformBox=x?.transformBox??"fill-box",delete b.transformBox);for(const j of YR)b[j]!==void 0&&(y[j]=b[j],delete b[j]);e!==void 0&&(b.x=e),a!==void 0&&(b.y=a),i!==void 0&&(b.scale=i),o!==void 0&&KR(b,o,u,d,!1)}const dj=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]),hj=s=>typeof s=="string"&&s.toLowerCase()==="svg";function XR(s,e,a,i){oj(s,e,void 0,i);for(const o in e.attrs)s.setAttribute(dj.has(o)?o:Em(o),e.attrs[o])}function fj(s,e,a){const i=Um(s,e,a);for(const o in s)if(fs(s[o])||fs(e[o])){const u=_i.indexOf(o)!==-1?"attr"+o.charAt(0).toUpperCase()+o.substring(1):o;i[u]=s[o]}return i}class JR extends nj{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Yt}getBaseTargetFromProps(e,a){return e[a]}readValueFromInstance(e,a){if(ki.has(a)){const i=Fw(a);return i&&i.default||0}return a=dj.has(a)?a:Em(a),e.getAttribute(a)}scrapeMotionValuesFromProps(e,a,i){return fj(e,a,i)}build(e,a,i){uj(e,a,this.isSVGTag,i.transformTemplate,i.style)}renderInstance(e,a,i,o){XR(e,a,i,o)}mount(e){this.isSVGTag=hj(e.tagName),super.mount(e)}}const QR=Om.length;function mj(s){if(!s)return;if(!s.isControllingVariants){const a=s.parent?mj(s.parent)||{}:{};return s.props.initial!==void 0&&(a.initial=s.props.initial),a}const e={};for(let a=0;a<QR;a++){const i=Om[a],o=s.props[i];(ql(o)||o===!1)&&(e[i]=o)}return e}function pj(s,e){if(!Array.isArray(e))return!1;const a=e.length;if(a!==s.length)return!1;for(let i=0;i<a;i++)if(e[i]!==s[i])return!1;return!0}const ZR=[...Dm].reverse(),WR=Dm.length;function e4(s){return e=>Promise.all(e.map(({animation:a,options:i})=>cR(s,a,i)))}function t4(s){let e=e4(s),a=iy(),i=!0;const o=m=>(p,x)=>{const b=bi(s,x,m==="exit"?s.presenceContext?.custom:void 0);if(b){const{transition:y,transitionEnd:j,...N}=b;p={...p,...N,...j}}return p};function u(m){e=m(s)}function d(m){const{props:p}=s,x=mj(s.parent)||{},b=[],y=new Set;let j={},N=1/0;for(let T=0;T<WR;T++){const R=ZR[T],A=a[R],C=p[R]!==void 0?p[R]:x[R],B=ql(C),F=R===m?A.isActive:null;F===!1&&(N=T);let V=C===x[R]&&C!==p[R]&&B;if(V&&i&&s.manuallyAnimateOnMount&&(V=!1),A.protectedKeys={...j},!A.isActive&&F===null||!C&&!A.prevProp||au(C)||typeof C=="boolean")continue;const O=s4(A.prevProp,C);let H=O||R===m&&A.isActive&&!V&&B||T>N&&B,te=!1;const me=Array.isArray(C)?C:[C];let de=me.reduce(o(R),{});F===!1&&(de={});const{prevResolvedValues:ye={}}=A,Ae={...ye,...de},Re=se=>{H=!0,y.has(se)&&(te=!0,y.delete(se)),A.needsAnimating[se]=!0;const he=s.getValue(se);he&&(he.liveStyle=!1)};for(const se in Ae){const he=de[se],we=ye[se];if(j.hasOwnProperty(se))continue;let K=!1;Rf(he)&&Rf(we)?K=!pj(he,we):K=he!==we,K?he!=null?Re(se):y.add(se):he!==void 0&&y.has(se)?Re(se):A.protectedKeys[se]=!0}A.prevProp=C,A.prevResolvedValues=de,A.isActive&&(j={...j,...de}),i&&s.blockInitialAnimation&&(H=!1);const ze=V&&O;H&&(!ze||te)&&b.push(...me.map(se=>{const he={type:R};if(typeof se=="string"&&i&&!ze&&s.manuallyAnimateOnMount&&s.parent){const{parent:we}=s,K=bi(we,se);if(we.enteringChildren&&K){const{delayChildren:S}=K.transition||{};he.delay=Iw(we.enteringChildren,s,S)}}return{animation:se,options:he}}))}if(y.size){const T={};if(typeof p.initial!="boolean"){const R=bi(s,Array.isArray(p.initial)?p.initial[0]:p.initial);R&&R.transition&&(T.transition=R.transition)}y.forEach(R=>{const A=s.getBaseTarget(R),C=s.getValue(R);C&&(C.liveStyle=!0),T[R]=A??null}),b.push({animation:T})}let k=!!b.length;return i&&(p.initial===!1||p.initial===p.animate)&&!s.manuallyAnimateOnMount&&(k=!1),i=!1,k?e(b):Promise.resolve()}function f(m,p){if(a[m].isActive===p)return Promise.resolve();s.variantChildren?.forEach(b=>b.animationState?.setActive(m,p)),a[m].isActive=p;const x=d(m);for(const b in a)a[b].protectedKeys={};return x}return{animateChanges:d,setActive:f,setAnimateFunction:u,getState:()=>a,reset:()=>{a=iy()}}}function s4(s,e){return typeof e=="string"?e!==s:Array.isArray(e)?!pj(e,s):!1}function nr(s=!1){return{isActive:s,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function iy(){return{animate:nr(!0),whileInView:nr(),whileHover:nr(),whileTap:nr(),whileDrag:nr(),whileFocus:nr(),exit:nr()}}function ly(s,e){s.min=e.min,s.max=e.max}function tn(s,e){ly(s.x,e.x),ly(s.y,e.y)}function oy(s,e){s.translate=e.translate,s.scale=e.scale,s.originPoint=e.originPoint,s.origin=e.origin}const gj=1e-4,n4=1-gj,a4=1+gj,xj=.01,r4=0-xj,i4=0+xj;function bs(s){return s.max-s.min}function l4(s,e,a){return Math.abs(s-e)<=a}function cy(s,e,a,i=.5){s.origin=i,s.originPoint=Ct(e.min,e.max,s.origin),s.scale=bs(a)/bs(e),s.translate=Ct(a.min,a.max,s.origin)-s.originPoint,(s.scale>=n4&&s.scale<=a4||isNaN(s.scale))&&(s.scale=1),(s.translate>=r4&&s.translate<=i4||isNaN(s.translate))&&(s.translate=0)}function Tl(s,e,a,i){cy(s.x,e.x,a.x,i?i.originX:void 0),cy(s.y,e.y,a.y,i?i.originY:void 0)}function uy(s,e,a){s.min=a.min+e.min,s.max=s.min+bs(e)}function o4(s,e,a){uy(s.x,e.x,a.x),uy(s.y,e.y,a.y)}function dy(s,e,a){s.min=e.min-a.min,s.max=s.min+bs(e)}function Yc(s,e,a){dy(s.x,e.x,a.x),dy(s.y,e.y,a.y)}function hy(s,e,a,i,o){return s-=e,s=Kc(s,1/a,i),o!==void 0&&(s=Kc(s,1/o,i)),s}function c4(s,e=0,a=1,i=.5,o,u=s,d=s){if(Nn.test(e)&&(e=parseFloat(e),e=Ct(d.min,d.max,e/100)-d.min),typeof e!="number")return;let f=Ct(u.min,u.max,i);s===u&&(f-=e),s.min=hy(s.min,e,a,f,o),s.max=hy(s.max,e,a,f,o)}function fy(s,e,[a,i,o],u,d){c4(s,e[a],e[i],e[o],e.scale,u,d)}const u4=["x","scaleX","originX"],d4=["y","scaleY","originY"];function my(s,e,a,i){fy(s.x,e,u4,a?a.x:void 0,i?i.x:void 0),fy(s.y,e,d4,a?a.y:void 0,i?i.y:void 0)}function py(s){return s.translate===0&&s.scale===1}function bj(s){return py(s.x)&&py(s.y)}function gy(s,e){return s.min===e.min&&s.max===e.max}function h4(s,e){return gy(s.x,e.x)&&gy(s.y,e.y)}function xy(s,e){return Math.round(s.min)===Math.round(e.min)&&Math.round(s.max)===Math.round(e.max)}function yj(s,e){return xy(s.x,e.x)&&xy(s.y,e.y)}function by(s){return bs(s.x)/bs(s.y)}function yy(s,e){return s.translate===e.translate&&s.scale===e.scale&&s.originPoint===e.originPoint}function Xs(s){return[s("x"),s("y")]}function f4(s,e,a){let i="";const o=s.x.translate/e.x,u=s.y.translate/e.y,d=a?.z||0;if((o||u||d)&&(i=`translate3d(${o}px, ${u}px, ${d}px) `),(e.x!==1||e.y!==1)&&(i+=`scale(${1/e.x}, ${1/e.y}) `),a){const{transformPerspective:p,rotate:x,rotateX:b,rotateY:y,skewX:j,skewY:N}=a;p&&(i=`perspective(${p}px) ${i}`),x&&(i+=`rotate(${x}deg) `),b&&(i+=`rotateX(${b}deg) `),y&&(i+=`rotateY(${y}deg) `),j&&(i+=`skewX(${j}deg) `),N&&(i+=`skewY(${N}deg) `)}const f=s.x.scale*e.x,m=s.y.scale*e.y;return(f!==1||m!==1)&&(i+=`scale(${f}, ${m})`),i||"none"}const vj=["TopLeft","TopRight","BottomLeft","BottomRight"],m4=vj.length,vy=s=>typeof s=="string"?parseFloat(s):s,wy=s=>typeof s=="number"||ke.test(s);function p4(s,e,a,i,o,u){o?(s.opacity=Ct(0,a.opacity??1,g4(i)),s.opacityExit=Ct(e.opacity??1,0,x4(i))):u&&(s.opacity=Ct(e.opacity??1,a.opacity??1,i));for(let d=0;d<m4;d++){const f=`border${vj[d]}Radius`;let m=jy(e,f),p=jy(a,f);if(m===void 0&&p===void 0)continue;m||(m=0),p||(p=0),m===0||p===0||wy(m)===wy(p)?(s[f]=Math.max(Ct(vy(m),vy(p),i),0),(Nn.test(p)||Nn.test(m))&&(s[f]+="%")):s[f]=p}(e.rotate||a.rotate)&&(s.rotate=Ct(e.rotate||0,a.rotate||0,i))}function jy(s,e){return s[e]!==void 0?s[e]:s.borderRadius}const g4=wj(0,.5,pw),x4=wj(.5,.95,Qs);function wj(s,e,a){return i=>i<s?0:i>e?1:a(zl(s,e,i))}function b4(s,e,a){const i=fs(s)?s:vi(s);return i.start(km("",i,e,a)),i.animation}function Hl(s,e,a,i={passive:!0}){return s.addEventListener(e,a,i),()=>s.removeEventListener(e,a)}const y4=(s,e)=>s.depth-e.depth;class v4{constructor(){this.children=[],this.isDirty=!1}add(e){cm(this.children,e),this.isDirty=!0}remove(e){um(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(y4),this.isDirty=!1,this.children.forEach(e)}}function w4(s,e){const a=xs.now(),i=({timestamp:o})=>{const u=o-a;u>=e&&(Ra(i),s(u-e))};return Nt.setup(i,!0),()=>Ra(i)}function Oc(s){return fs(s)?s.get():s}class j4{constructor(){this.members=[]}add(e){cm(this.members,e),e.scheduleRender()}remove(e){if(um(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const a=this.members[this.members.length-1];a&&this.promote(a)}}relegate(e){const a=this.members.findIndex(o=>e===o);if(a===0)return!1;let i;for(let o=a;o>=0;o--){const u=this.members[o];if(u.isPresent!==!1){i=u;break}}return i?(this.promote(i),!0):!1}promote(e,a){const i=this.lead;if(e!==i&&(this.prevLead=i,this.lead=e,e.show(),i)){i.instance&&i.scheduleRender(),e.scheduleRender();const o=i.options.layoutDependency,u=e.options.layoutDependency;o!==void 0&&u!==void 0&&o===u||(e.resumeFrom=i,a&&(e.resumeFrom.preserveOpacity=!0),i.snapshot&&(e.snapshot=i.snapshot,e.snapshot.latestValues=i.animationValues||i.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0));const{crossfade:f}=e.options;f===!1&&i.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:a,resumingFrom:i}=e;a.onExitComplete&&a.onExitComplete(),i&&i.options.onExitComplete&&i.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}const Mc={hasAnimatedSinceResize:!0,hasEverUpdated:!1},Fh=["","X","Y","Z"],N4=1e3;let S4=0;function Kh(s,e,a,i){const{latestValues:o}=e;o[s]&&(a[s]=o[s],e.setStaticValue(s,0),i&&(i[s]=0))}function jj(s){if(s.hasCheckedOptimisedAppear=!0,s.root===s)return;const{visualElement:e}=s.options;if(!e)return;const a=$w(e);if(window.MotionHasOptimisedAnimation(a,"transform")){const{layout:o,layoutId:u}=s.options;window.MotionCancelOptimisedAnimation(a,"transform",Nt,!(o||u))}const{parent:i}=s;i&&!i.hasCheckedOptimisedAppear&&jj(i)}function Nj({attachResizeListener:s,defaultParent:e,measureScroll:a,checkIsScrollRoot:i,resetTransform:o}){return class{constructor(d={},f=e?.()){this.id=S4++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.layoutVersion=0,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(T4),this.nodes.forEach(R4),this.nodes.forEach(D4),this.nodes.forEach(E4)},this.resolvedRelativeTargetAt=0,this.linkedParentVersion=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=d,this.root=f?f.root||f:this,this.path=f?[...f.path,f]:[],this.parent=f,this.depth=f?f.depth+1:0;for(let m=0;m<this.path.length;m++)this.path[m].shouldResetTransform=!0;this.root===this&&(this.nodes=new v4)}addEventListener(d,f){return this.eventHandlers.has(d)||this.eventHandlers.set(d,new fm),this.eventHandlers.get(d).add(f)}notifyListeners(d,...f){const m=this.eventHandlers.get(d);m&&m.notify(...f)}hasListeners(d){return this.eventHandlers.has(d)}mount(d){if(this.instance)return;this.isSVG=Ww(d)&&!kR(d),this.instance=d;const{layoutId:f,layout:m,visualElement:p}=this.options;if(p&&!p.current&&p.mount(d),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(m||f)&&(this.isLayoutDirty=!0),s){let x,b=0;const y=()=>this.root.updateBlockedByResize=!1;Nt.read(()=>{b=window.innerWidth}),s(d,()=>{const j=window.innerWidth;j!==b&&(b=j,this.root.updateBlockedByResize=!0,x&&x(),x=w4(y,250),Mc.hasAnimatedSinceResize&&(Mc.hasAnimatedSinceResize=!1,this.nodes.forEach(_y)))})}f&&this.root.registerSharedNode(f,this),this.options.animate!==!1&&p&&(f||m)&&this.addEventListener("didUpdate",({delta:x,hasLayoutChanged:b,hasRelativeLayoutChanged:y,layout:j})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const N=this.options.transition||p.getDefaultTransition()||P4,{onLayoutAnimationStart:k,onLayoutAnimationComplete:T}=p.getProps(),R=!this.targetLayout||!yj(this.targetLayout,j),A=!b&&y;if(this.options.layoutRoot||this.resumeFrom||A||b&&(R||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const C={..._m(N,"layout"),onPlay:k,onComplete:T};(p.shouldReduceMotion||this.options.layoutRoot)&&(C.delay=0,C.type=!1),this.startAnimation(C),this.setAnimationOrigin(x,A)}else b||_y(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=j})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const d=this.getStack();d&&d.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),Ra(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(O4),this.animationId++)}getTransformTemplate(){const{visualElement:d}=this.options;return d&&d.getProps().transformTemplate}willUpdate(d=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&jj(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let x=0;x<this.path.length;x++){const b=this.path[x];b.shouldResetTransform=!0,b.updateScroll("snapshot"),b.options.layoutRoot&&b.willUpdate(!1)}const{layoutId:f,layout:m}=this.options;if(f===void 0&&!m)return;const p=this.getTransformTemplate();this.prevTransformTemplateValue=p?p(this.latestValues,""):void 0,this.updateSnapshot(),d&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(Ny);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(Sy);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(A4),this.nodes.forEach(_4),this.nodes.forEach(k4)):this.nodes.forEach(Sy),this.clearAllSnapshots();const f=xs.now();us.delta=Sn(0,1e3/60,f-us.timestamp),us.timestamp=f,us.isProcessing=!0,Ih.update.process(us),Ih.preRender.process(us),Ih.render.process(us),us.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,Am.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(C4),this.sharedNodes.forEach(M4)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Nt.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Nt.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!bs(this.snapshot.measuredBox.x)&&!bs(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let m=0;m<this.path.length;m++)this.path[m].updateScroll();const d=this.layout;this.layout=this.measure(!1),this.layoutVersion++,this.layoutCorrected=Yt(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:f}=this.options;f&&f.notify("LayoutMeasure",this.layout.layoutBox,d?d.layoutBox:void 0)}updateScroll(d="measure"){let f=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===d&&(f=!1),f&&this.instance){const m=i(this.instance);this.scroll={animationId:this.root.animationId,phase:d,isRoot:m,offset:a(this.instance),wasRoot:this.scroll?this.scroll.isRoot:m}}}resetTransform(){if(!o)return;const d=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,f=this.projectionDelta&&!bj(this.projectionDelta),m=this.getTransformTemplate(),p=m?m(this.latestValues,""):void 0,x=p!==this.prevTransformTemplateValue;d&&this.instance&&(f||rr(this.latestValues)||x)&&(o(this.instance,p),this.shouldResetTransform=!1,this.scheduleRender())}measure(d=!0){const f=this.measurePageBox();let m=this.removeElementScroll(f);return d&&(m=this.removeTransform(m)),I4(m),{animationId:this.root.animationId,measuredBox:f,layoutBox:m,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:d}=this.options;if(!d)return Yt();const f=d.measureViewportBox();if(!(this.scroll?.wasRoot||this.path.some(B4))){const{scroll:p}=this.root;p&&(pi(f.x,p.offset.x),pi(f.y,p.offset.y))}return f}removeElementScroll(d){const f=Yt();if(tn(f,d),this.scroll?.wasRoot)return f;for(let m=0;m<this.path.length;m++){const p=this.path[m],{scroll:x,options:b}=p;p!==this.root&&x&&b.layoutScroll&&(x.wasRoot&&tn(f,d),pi(f.x,x.offset.x),pi(f.y,x.offset.y))}return f}applyTransform(d,f=!1){const m=Yt();tn(m,d);for(let p=0;p<this.path.length;p++){const x=this.path[p];!f&&x.options.layoutScroll&&x.scroll&&x!==x.root&&gi(m,{x:-x.scroll.offset.x,y:-x.scroll.offset.y}),rr(x.latestValues)&&gi(m,x.latestValues)}return rr(this.latestValues)&&gi(m,this.latestValues),m}removeTransform(d){const f=Yt();tn(f,d);for(let m=0;m<this.path.length;m++){const p=this.path[m];if(!p.instance||!rr(p.latestValues))continue;Pf(p.latestValues)&&p.updateSnapshot();const x=Yt(),b=p.measurePageBox();tn(x,b),my(f,p.latestValues,p.snapshot?p.snapshot.layoutBox:void 0,x)}return rr(this.latestValues)&&my(f,this.latestValues),f}setTargetDelta(d){this.targetDelta=d,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(d){this.options={...this.options,...d,crossfade:d.crossfade!==void 0?d.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==us.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(d=!1){const f=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=f.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=f.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=f.isSharedProjectionDirty);const m=!!this.resumingFrom||this!==f;if(!(d||m&&this.isSharedProjectionDirty||this.isProjectionDirty||this.parent?.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:x,layoutId:b}=this.options;if(!this.layout||!(x||b))return;this.resolvedRelativeTargetAt=us.timestamp;const y=this.getClosestProjectingParent();y&&this.linkedParentVersion!==y.layoutVersion&&!y.options.layoutRoot&&this.removeRelativeTarget(),!this.targetDelta&&!this.relativeTarget&&(y&&y.layout?this.createRelativeTarget(y,this.layout.layoutBox,y.layout.layoutBox):this.removeRelativeTarget()),!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=Yt(),this.targetWithTransforms=Yt()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),o4(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):tn(this.target,this.layout.layoutBox),ij(this.target,this.targetDelta)):tn(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget&&(this.attemptToResolveRelativeTarget=!1,y&&!!y.resumingFrom==!!this.resumingFrom&&!y.options.layoutScroll&&y.target&&this.animationProgress!==1?this.createRelativeTarget(y,this.target,y.target):this.relativeParent=this.relativeTarget=void 0))}getClosestProjectingParent(){if(!(!this.parent||Pf(this.parent.latestValues)||rj(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}createRelativeTarget(d,f,m){this.relativeParent=d,this.linkedParentVersion=d.layoutVersion,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Yt(),this.relativeTargetOrigin=Yt(),Yc(this.relativeTargetOrigin,f,m),tn(this.relativeTarget,this.relativeTargetOrigin)}removeRelativeTarget(){this.relativeParent=this.relativeTarget=void 0}calcProjection(){const d=this.getLead(),f=!!this.resumingFrom||this!==d;let m=!0;if((this.isProjectionDirty||this.parent?.isProjectionDirty)&&(m=!1),f&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(m=!1),this.resolvedRelativeTargetAt===us.timestamp&&(m=!1),m)return;const{layout:p,layoutId:x}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(p||x))return;tn(this.layoutCorrected,this.layout.layoutBox);const b=this.treeScale.x,y=this.treeScale.y;PR(this.layoutCorrected,this.treeScale,this.path,f),d.layout&&!d.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(d.target=d.layout.layoutBox,d.targetWithTransforms=Yt());const{target:j}=d;if(!j){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(oy(this.prevProjectionDelta.x,this.projectionDelta.x),oy(this.prevProjectionDelta.y,this.projectionDelta.y)),Tl(this.projectionDelta,this.layoutCorrected,j,this.latestValues),(this.treeScale.x!==b||this.treeScale.y!==y||!yy(this.projectionDelta.x,this.prevProjectionDelta.x)||!yy(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",j))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(d=!0){if(this.options.visualElement?.scheduleRender(),d){const f=this.getStack();f&&f.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=mi(),this.projectionDelta=mi(),this.projectionDeltaWithTransform=mi()}setAnimationOrigin(d,f=!1){const m=this.snapshot,p=m?m.latestValues:{},x={...this.latestValues},b=mi();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!f;const y=Yt(),j=m?m.source:void 0,N=this.layout?this.layout.source:void 0,k=j!==N,T=this.getStack(),R=!T||T.members.length<=1,A=!!(k&&!R&&this.options.crossfade===!0&&!this.path.some(L4));this.animationProgress=0;let C;this.mixTargetDelta=B=>{const F=B/1e3;ky(b.x,d.x,F),ky(b.y,d.y,F),this.setTargetDelta(b),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Yc(y,this.layout.layoutBox,this.relativeParent.layout.layoutBox),U4(this.relativeTarget,this.relativeTargetOrigin,y,F),C&&h4(this.relativeTarget,C)&&(this.isProjectionDirty=!1),C||(C=Yt()),tn(C,this.relativeTarget)),k&&(this.animationValues=x,p4(x,p,this.latestValues,F,A,R)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=F},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(d){this.notifyListeners("animationStart"),this.currentAnimation?.stop(),this.resumingFrom?.currentAnimation?.stop(),this.pendingAnimation&&(Ra(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Nt.update(()=>{Mc.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=vi(0)),this.currentAnimation=b4(this.motionValue,[0,1e3],{...d,velocity:0,isSync:!0,onUpdate:f=>{this.mixTargetDelta(f),d.onUpdate&&d.onUpdate(f)},onStop:()=>{},onComplete:()=>{d.onComplete&&d.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const d=this.getStack();d&&d.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(N4),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const d=this.getLead();let{targetWithTransforms:f,target:m,layout:p,latestValues:x}=d;if(!(!f||!m||!p)){if(this!==d&&this.layout&&p&&Sj(this.options.animationType,this.layout.layoutBox,p.layoutBox)){m=this.target||Yt();const b=bs(this.layout.layoutBox.x);m.x.min=d.target.x.min,m.x.max=m.x.min+b;const y=bs(this.layout.layoutBox.y);m.y.min=d.target.y.min,m.y.max=m.y.min+y}tn(f,m),gi(f,x),Tl(this.projectionDeltaWithTransform,this.layoutCorrected,f,x)}}registerSharedNode(d,f){this.sharedNodes.has(d)||this.sharedNodes.set(d,new j4),this.sharedNodes.get(d).add(f);const p=f.options.initialPromotionConfig;f.promote({transition:p?p.transition:void 0,preserveFollowOpacity:p&&p.shouldPreserveFollowOpacity?p.shouldPreserveFollowOpacity(f):void 0})}isLead(){const d=this.getStack();return d?d.lead===this:!0}getLead(){const{layoutId:d}=this.options;return d?this.getStack()?.lead||this:this}getPrevLead(){const{layoutId:d}=this.options;return d?this.getStack()?.prevLead:void 0}getStack(){const{layoutId:d}=this.options;if(d)return this.root.sharedNodes.get(d)}promote({needsReset:d,transition:f,preserveFollowOpacity:m}={}){const p=this.getStack();p&&p.promote(this,m),d&&(this.projectionDelta=void 0,this.needsReset=!0),f&&this.setOptions({transition:f})}relegate(){const d=this.getStack();return d?d.relegate(this):!1}resetSkewAndRotation(){const{visualElement:d}=this.options;if(!d)return;let f=!1;const{latestValues:m}=d;if((m.z||m.rotate||m.rotateX||m.rotateY||m.rotateZ||m.skewX||m.skewY)&&(f=!0),!f)return;const p={};m.z&&Kh("z",d,p,this.animationValues);for(let x=0;x<Fh.length;x++)Kh(`rotate${Fh[x]}`,d,p,this.animationValues),Kh(`skew${Fh[x]}`,d,p,this.animationValues);d.render();for(const x in p)d.setStaticValue(x,p[x]),this.animationValues&&(this.animationValues[x]=p[x]);d.scheduleRender()}applyProjectionStyles(d,f){if(!this.instance||this.isSVG)return;if(!this.isVisible){d.visibility="hidden";return}const m=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,d.visibility="",d.opacity="",d.pointerEvents=Oc(f?.pointerEvents)||"",d.transform=m?m(this.latestValues,""):"none";return}const p=this.getLead();if(!this.projectionDelta||!this.layout||!p.target){this.options.layoutId&&(d.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,d.pointerEvents=Oc(f?.pointerEvents)||""),this.hasProjected&&!rr(this.latestValues)&&(d.transform=m?m({},""):"none",this.hasProjected=!1);return}d.visibility="";const x=p.animationValues||p.latestValues;this.applyTransformsToTarget();let b=f4(this.projectionDeltaWithTransform,this.treeScale,x);m&&(b=m(x,b)),d.transform=b;const{x:y,y:j}=this.projectionDelta;d.transformOrigin=`${y.origin*100}% ${j.origin*100}% 0`,p.animationValues?d.opacity=p===this?x.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:x.opacityExit:d.opacity=p===this?x.opacity!==void 0?x.opacity:"":x.opacityExit!==void 0?x.opacityExit:0;for(const N in Bf){if(x[N]===void 0)continue;const{correct:k,applyTo:T,isCSSVariable:R}=Bf[N],A=b==="none"?x[N]:k(x[N],p);if(T){const C=T.length;for(let B=0;B<C;B++)d[T[B]]=A}else R?this.options.visualElement.renderState.vars[N]=A:d[N]=A}this.options.layoutId&&(d.pointerEvents=p===this?Oc(f?.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(d=>d.currentAnimation?.stop()),this.root.nodes.forEach(Ny),this.root.sharedNodes.clear()}}}function _4(s){s.updateLayout()}function k4(s){const e=s.resumeFrom?.snapshot||s.snapshot;if(s.isLead()&&s.layout&&e&&s.hasListeners("didUpdate")){const{layoutBox:a,measuredBox:i}=s.layout,{animationType:o}=s.options,u=e.source!==s.layout.source;o==="size"?Xs(x=>{const b=u?e.measuredBox[x]:e.layoutBox[x],y=bs(b);b.min=a[x].min,b.max=b.min+y}):Sj(o,e.layoutBox,a)&&Xs(x=>{const b=u?e.measuredBox[x]:e.layoutBox[x],y=bs(a[x]);b.max=b.min+y,s.relativeTarget&&!s.currentAnimation&&(s.isProjectionDirty=!0,s.relativeTarget[x].max=s.relativeTarget[x].min+y)});const d=mi();Tl(d,a,e.layoutBox);const f=mi();u?Tl(f,s.applyTransform(i,!0),e.measuredBox):Tl(f,a,e.layoutBox);const m=!bj(d);let p=!1;if(!s.resumeFrom){const x=s.getClosestProjectingParent();if(x&&!x.resumeFrom){const{snapshot:b,layout:y}=x;if(b&&y){const j=Yt();Yc(j,e.layoutBox,b.layoutBox);const N=Yt();Yc(N,a,y.layoutBox),yj(j,N)||(p=!0),x.options.layoutRoot&&(s.relativeTarget=N,s.relativeTargetOrigin=j,s.relativeParent=x)}}}s.notifyListeners("didUpdate",{layout:a,snapshot:e,delta:f,layoutDelta:d,hasLayoutChanged:m,hasRelativeLayoutChanged:p})}else if(s.isLead()){const{onExitComplete:a}=s.options;a&&a()}s.options.transition=void 0}function T4(s){s.parent&&(s.isProjecting()||(s.isProjectionDirty=s.parent.isProjectionDirty),s.isSharedProjectionDirty||(s.isSharedProjectionDirty=!!(s.isProjectionDirty||s.parent.isProjectionDirty||s.parent.isSharedProjectionDirty)),s.isTransformDirty||(s.isTransformDirty=s.parent.isTransformDirty))}function E4(s){s.isProjectionDirty=s.isSharedProjectionDirty=s.isTransformDirty=!1}function C4(s){s.clearSnapshot()}function Ny(s){s.clearMeasurements()}function Sy(s){s.isLayoutDirty=!1}function A4(s){const{visualElement:e}=s.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),s.resetTransform()}function _y(s){s.finishAnimation(),s.targetDelta=s.relativeTarget=s.target=void 0,s.isProjectionDirty=!0}function R4(s){s.resolveTargetDelta()}function D4(s){s.calcProjection()}function O4(s){s.resetSkewAndRotation()}function M4(s){s.removeLeadSnapshot()}function ky(s,e,a){s.translate=Ct(e.translate,0,a),s.scale=Ct(e.scale,1,a),s.origin=e.origin,s.originPoint=e.originPoint}function Ty(s,e,a,i){s.min=Ct(e.min,a.min,i),s.max=Ct(e.max,a.max,i)}function U4(s,e,a,i){Ty(s.x,e.x,a.x,i),Ty(s.y,e.y,a.y,i)}function L4(s){return s.animationValues&&s.animationValues.opacityExit!==void 0}const P4={duration:.45,ease:[.4,0,.1,1]},Ey=s=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(s),Cy=Ey("applewebkit/")&&!Ey("chrome/")?Math.round:Qs;function Ay(s){s.min=Cy(s.min),s.max=Cy(s.max)}function I4(s){Ay(s.x),Ay(s.y)}function Sj(s,e,a){return s==="position"||s==="preserve-aspect"&&!l4(by(e),by(a),.2)}function B4(s){return s!==s.root&&s.scroll?.wasRoot}const z4=Nj({attachResizeListener:(s,e)=>Hl(s,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body?.scrollLeft||0,y:document.documentElement.scrollTop||document.body?.scrollTop||0}),checkIsScrollRoot:()=>!0}),Yh={current:void 0},_j=Nj({measureScroll:s=>({x:s.scrollLeft,y:s.scrollTop}),defaultParent:()=>{if(!Yh.current){const s=new z4({});s.mount(window),s.setOptions({layoutScroll:!0}),Yh.current=s}return Yh.current},resetTransform:(s,e)=>{s.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:s=>window.getComputedStyle(s).position==="fixed"}),Lm=v.createContext({transformPagePoint:s=>s,isStatic:!1,reducedMotion:"never"});function Ry(s,e){if(typeof s=="function")return s(e);s!=null&&(s.current=e)}function V4(...s){return e=>{let a=!1;const i=s.map(o=>{const u=Ry(o,e);return!a&&typeof u=="function"&&(a=!0),u});if(a)return()=>{for(let o=0;o<i.length;o++){const u=i[o];typeof u=="function"?u():Ry(s[o],null)}}}}function $4(...s){return v.useCallback(V4(...s),s)}class q4 extends v.Component{getSnapshotBeforeUpdate(e){const a=this.props.childRef.current;if(a&&e.isPresent&&!this.props.isPresent){const i=a.offsetParent,o=Uf(i)&&i.offsetWidth||0,u=Uf(i)&&i.offsetHeight||0,d=this.props.sizeRef.current;d.height=a.offsetHeight||0,d.width=a.offsetWidth||0,d.top=a.offsetTop,d.left=a.offsetLeft,d.right=o-d.width-d.left,d.bottom=u-d.height-d.top}return null}componentDidUpdate(){}render(){return this.props.children}}function H4({children:s,isPresent:e,anchorX:a,anchorY:i,root:o}){const u=v.useId(),d=v.useRef(null),f=v.useRef({width:0,height:0,top:0,left:0,right:0,bottom:0}),{nonce:m}=v.useContext(Lm),p=s.props?.ref??s?.ref,x=$4(d,p);return v.useInsertionEffect(()=>{const{width:b,height:y,top:j,left:N,right:k,bottom:T}=f.current;if(e||!d.current||!b||!y)return;const R=a==="left"?`left: ${N}`:`right: ${k}`,A=i==="bottom"?`bottom: ${T}`:`top: ${j}`;d.current.dataset.motionPopId=u;const C=document.createElement("style");m&&(C.nonce=m);const B=o??document.head;return B.appendChild(C),C.sheet&&C.sheet.insertRule(`
          [data-motion-pop-id="${u}"] {
            position: absolute !important;
            width: ${b}px !important;
            height: ${y}px !important;
            ${R}px !important;
            ${A}px !important;
          }
        `),()=>{B.contains(C)&&B.removeChild(C)}},[e]),r.jsx(q4,{isPresent:e,childRef:d,sizeRef:f,children:v.cloneElement(s,{ref:x})})}const G4=({children:s,initial:e,isPresent:a,onExitComplete:i,custom:o,presenceAffectsLayout:u,mode:d,anchorX:f,anchorY:m,root:p})=>{const x=om(F4),b=v.useId();let y=!0,j=v.useMemo(()=>(y=!1,{id:b,initial:e,isPresent:a,custom:o,onExitComplete:N=>{x.set(N,!0);for(const k of x.values())if(!k)return;i&&i()},register:N=>(x.set(N,!1),()=>x.delete(N))}),[a,x,i]);return u&&y&&(j={...j}),v.useMemo(()=>{x.forEach((N,k)=>x.set(k,!1))},[a]),v.useEffect(()=>{!a&&!x.size&&i&&i()},[a]),d==="popLayout"&&(s=r.jsx(H4,{isPresent:a,anchorX:f,anchorY:m,root:p,children:s})),r.jsx(nu.Provider,{value:j,children:s})};function F4(){return new Map}function kj(s=!0){const e=v.useContext(nu);if(e===null)return[!0,null];const{isPresent:a,onExitComplete:i,register:o}=e,u=v.useId();v.useEffect(()=>{if(s)return o(u)},[s]);const d=v.useCallback(()=>s&&i&&i(u),[u,i,s]);return!a&&i?[!1,d]:[!0]}const kc=s=>s.key||"";function Dy(s){const e=[];return v.Children.forEach(s,a=>{v.isValidElement(a)&&e.push(a)}),e}const K4=({children:s,custom:e,initial:a=!0,onExitComplete:i,presenceAffectsLayout:o=!0,mode:u="sync",propagate:d=!1,anchorX:f="left",anchorY:m="top",root:p})=>{const[x,b]=kj(d),y=v.useMemo(()=>Dy(s),[s]),j=d&&!x?[]:y.map(kc),N=v.useRef(!0),k=v.useRef(y),T=om(()=>new Map),R=v.useRef(new Set),[A,C]=v.useState(y),[B,F]=v.useState(y);aw(()=>{N.current=!1,k.current=y;for(let H=0;H<B.length;H++){const te=kc(B[H]);j.includes(te)?(T.delete(te),R.current.delete(te)):T.get(te)!==!0&&T.set(te,!1)}},[B,j.length,j.join("-")]);const V=[];if(y!==A){let H=[...y];for(let te=0;te<B.length;te++){const me=B[te],de=kc(me);j.includes(de)||(H.splice(te,0,me),V.push(me))}return u==="wait"&&V.length&&(H=V),F(Dy(H)),C(y),null}const{forceRender:O}=v.useContext(lm);return r.jsx(r.Fragment,{children:B.map(H=>{const te=kc(H),me=d&&!x?!1:y===B||j.includes(te),de=()=>{if(R.current.has(te))return;if(R.current.add(te),T.has(te))T.set(te,!0);else return;let ye=!0;T.forEach(Ae=>{Ae||(ye=!1)}),ye&&(O?.(),F(k.current),d&&b?.(),i&&i())};return r.jsx(G4,{isPresent:me,initial:!N.current||a?void 0:!1,custom:e,presenceAffectsLayout:o,mode:u,root:p,onExitComplete:me?void 0:de,anchorX:f,anchorY:m,children:H},te)})})},Tj=v.createContext({strict:!1}),Oy={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]};let My=!1;function Y4(){if(My)return;const s={};for(const e in Oy)s[e]={isEnabled:a=>Oy[e].some(i=>!!a[i])};sj(s),My=!0}function Ej(){return Y4(),OR()}function X4(s){const e=Ej();for(const a in s)e[a]={...e[a],...s[a]};sj(e)}const J4=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Xc(s){return s.startsWith("while")||s.startsWith("drag")&&s!=="draggable"||s.startsWith("layout")||s.startsWith("onTap")||s.startsWith("onPan")||s.startsWith("onLayout")||J4.has(s)}let Cj=s=>!Xc(s);function Q4(s){typeof s=="function"&&(Cj=e=>e.startsWith("on")?!Xc(e):s(e))}try{Q4(require("@emotion/is-prop-valid").default)}catch{}function Z4(s,e,a){const i={};for(const o in s)o==="values"&&typeof s.values=="object"||(Cj(o)||a===!0&&Xc(o)||!e&&!Xc(o)||s.draggable&&o.startsWith("onDrag"))&&(i[o]=s[o]);return i}const iu=v.createContext({});function W4(s,e){if(ru(s)){const{initial:a,animate:i}=s;return{initial:a===!1||ql(a)?a:void 0,animate:ql(i)?i:void 0}}return s.inherit!==!1?e:{}}function eD(s){const{initial:e,animate:a}=W4(s,v.useContext(iu));return v.useMemo(()=>({initial:e,animate:a}),[Uy(e),Uy(a)])}function Uy(s){return Array.isArray(s)?s.join(" "):s}const Pm=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function Aj(s,e,a){for(const i in e)!fs(e[i])&&!cj(i,a)&&(s[i]=e[i])}function tD({transformTemplate:s},e){return v.useMemo(()=>{const a=Pm();return Mm(a,e,s),Object.assign({},a.vars,a.style)},[e])}function sD(s,e){const a=s.style||{},i={};return Aj(i,a,s),Object.assign(i,tD(s,e)),i}function nD(s,e){const a={},i=sD(s,e);return s.drag&&s.dragListener!==!1&&(a.draggable=!1,i.userSelect=i.WebkitUserSelect=i.WebkitTouchCallout="none",i.touchAction=s.drag===!0?"none":`pan-${s.drag==="x"?"y":"x"}`),s.tabIndex===void 0&&(s.onTap||s.onTapStart||s.whileTap)&&(a.tabIndex=0),a.style=i,a}const Rj=()=>({...Pm(),attrs:{}});function aD(s,e,a,i){const o=v.useMemo(()=>{const u=Rj();return uj(u,e,hj(i),s.transformTemplate,s.style),{...u.attrs,style:{...u.style}}},[e]);if(s.style){const u={};Aj(u,s.style,s),o.style={...u,...o.style}}return o}const rD=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function Im(s){return typeof s!="string"||s.includes("-")?!1:!!(rD.indexOf(s)>-1||/[A-Z]/u.test(s))}function iD(s,e,a,{latestValues:i},o,u=!1,d){const m=(d??Im(s)?aD:nD)(e,i,o,s),p=Z4(e,typeof s=="string",u),x=s!==v.Fragment?{...p,...m,ref:a}:{},{children:b}=e,y=v.useMemo(()=>fs(b)?b.get():b,[b]);return v.createElement(s,{...x,children:y})}function lD({scrapeMotionValuesFromProps:s,createRenderState:e},a,i,o){return{latestValues:oD(a,i,o,s),renderState:e()}}function oD(s,e,a,i){const o={},u=i(s,{});for(const y in u)o[y]=Oc(u[y]);let{initial:d,animate:f}=s;const m=ru(s),p=tj(s);e&&p&&!m&&s.inherit!==!1&&(d===void 0&&(d=e.initial),f===void 0&&(f=e.animate));let x=a?a.initial===!1:!1;x=x||d===!1;const b=x?f:d;if(b&&typeof b!="boolean"&&!au(b)){const y=Array.isArray(b)?b:[b];for(let j=0;j<y.length;j++){const N=Tm(s,y[j]);if(N){const{transitionEnd:k,transition:T,...R}=N;for(const A in R){let C=R[A];if(Array.isArray(C)){const B=x?C.length-1:0;C=C[B]}C!==null&&(o[A]=C)}for(const A in k)o[A]=k[A]}}}return o}const Dj=s=>(e,a)=>{const i=v.useContext(iu),o=v.useContext(nu),u=()=>lD(s,e,i,o);return a?u():om(u)},cD=Dj({scrapeMotionValuesFromProps:Um,createRenderState:Pm}),uD=Dj({scrapeMotionValuesFromProps:fj,createRenderState:Rj}),dD=Symbol.for("motionComponentSymbol");function hD(s,e,a){const i=v.useRef(a);v.useInsertionEffect(()=>{i.current=a});const o=v.useRef(null);return v.useCallback(u=>{u&&s.onMount?.(u),e&&(u?e.mount(u):e.unmount());const d=i.current;if(typeof d=="function")if(u){const f=d(u);typeof f=="function"&&(o.current=f)}else o.current?(o.current(),o.current=null):d(u);else d&&(d.current=u)},[e])}const Oj=v.createContext({});function jl(s){return s&&typeof s=="object"&&Object.prototype.hasOwnProperty.call(s,"current")}function fD(s,e,a,i,o,u){const{visualElement:d}=v.useContext(iu),f=v.useContext(Tj),m=v.useContext(nu),p=v.useContext(Lm).reducedMotion,x=v.useRef(null),b=v.useRef(!1);i=i||f.renderer,!x.current&&i&&(x.current=i(s,{visualState:e,parent:d,props:a,presenceContext:m,blockInitialAnimation:m?m.initial===!1:!1,reducedMotionConfig:p,isSVG:u}),b.current&&x.current&&(x.current.manuallyAnimateOnMount=!0));const y=x.current,j=v.useContext(Oj);y&&!y.projection&&o&&(y.type==="html"||y.type==="svg")&&mD(x.current,a,o,j);const N=v.useRef(!1);v.useInsertionEffect(()=>{y&&N.current&&y.update(a,m)});const k=a[Vw],T=v.useRef(!!k&&!window.MotionHandoffIsComplete?.(k)&&window.MotionHasOptimisedAnimation?.(k));return aw(()=>{b.current=!0,y&&(N.current=!0,window.MotionIsMounted=!0,y.updateFeatures(),y.scheduleRenderMicrotask(),T.current&&y.animationState&&y.animationState.animateChanges())}),v.useEffect(()=>{y&&(!T.current&&y.animationState&&y.animationState.animateChanges(),T.current&&(queueMicrotask(()=>{window.MotionHandoffMarkAsComplete?.(k)}),T.current=!1),y.enteringChildren=void 0)}),y}function mD(s,e,a,i){const{layoutId:o,layout:u,drag:d,dragConstraints:f,layoutScroll:m,layoutRoot:p,layoutCrossfade:x}=e;s.projection=new a(s.latestValues,e["data-framer-portal-id"]?void 0:Mj(s.parent)),s.projection.setOptions({layoutId:o,layout:u,alwaysMeasureLayout:!!d||f&&jl(f),visualElement:s,animationType:typeof u=="string"?u:"both",initialPromotionConfig:i,crossfade:x,layoutScroll:m,layoutRoot:p})}function Mj(s){if(s)return s.options.allowProjection!==!1?s.projection:Mj(s.parent)}function Xh(s,{forwardMotionProps:e=!1,type:a}={},i,o){i&&X4(i);const u=a?a==="svg":Im(s),d=u?uD:cD;function f(p,x){let b;const y={...v.useContext(Lm),...p,layoutId:pD(p)},{isStatic:j}=y,N=eD(p),k=d(p,j);if(!j&&nw){gD();const T=xD(y);b=T.MeasureLayout,N.visualElement=fD(s,k,y,o,T.ProjectionNode,u)}return r.jsxs(iu.Provider,{value:N,children:[b&&N.visualElement?r.jsx(b,{visualElement:N.visualElement,...y}):null,iD(s,p,hD(k,N.visualElement,x),k,j,e,u)]})}f.displayName=`motion.${typeof s=="string"?s:`create(${s.displayName??s.name??""})`}`;const m=v.forwardRef(f);return m[dD]=s,m}function pD({layoutId:s}){const e=v.useContext(lm).id;return e&&s!==void 0?e+"-"+s:s}function gD(s,e){v.useContext(Tj).strict}function xD(s){const e=Ej(),{drag:a,layout:i}=e;if(!a&&!i)return{};const o={...a,...i};return{MeasureLayout:a?.isEnabled(s)||i?.isEnabled(s)?o.MeasureLayout:void 0,ProjectionNode:o.ProjectionNode}}function bD(s,e){if(typeof Proxy>"u")return Xh;const a=new Map,i=(u,d)=>Xh(u,d,s,e),o=(u,d)=>i(u,d);return new Proxy(o,{get:(u,d)=>d==="create"?i:(a.has(d)||a.set(d,Xh(d,void 0,s,e)),a.get(d))})}const yD=(s,e)=>e.isSVG??Im(s)?new JR(e):new HR(e,{allowProjection:s!==v.Fragment});class vD extends Ma{constructor(e){super(e),e.animationState||(e.animationState=t4(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();au(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:a}=this.node.prevProps||{};e!==a&&this.updateAnimationControlsSubscription()}unmount(){this.node.animationState.reset(),this.unmountControls?.()}}let wD=0;class jD extends Ma{constructor(){super(...arguments),this.id=wD++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:a}=this.node.presenceContext,{isPresent:i}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===i)return;const o=this.node.animationState.setActive("exit",!e);a&&!e&&o.then(()=>{a(this.id)})}mount(){const{register:e,onExitComplete:a}=this.node.presenceContext||{};a&&a(this.id),e&&(this.unmount=e(this.id))}unmount(){}}const ND={animation:{Feature:vD},exit:{Feature:jD}};function eo(s){return{point:{x:s.pageX,y:s.pageY}}}const SD=s=>e=>Rm(e)&&s(e,eo(e));function El(s,e,a,i){return Hl(s,e,SD(a),i)}const Uj=({current:s})=>s?s.ownerDocument.defaultView:null,Ly=(s,e)=>Math.abs(s-e);function _D(s,e){const a=Ly(s.x,e.x),i=Ly(s.y,e.y);return Math.sqrt(a**2+i**2)}const Py=new Set(["auto","scroll"]);class Lj{constructor(e,a,{transformPagePoint:i,contextWindow:o=window,dragSnapToOrigin:u=!1,distanceThreshold:d=3,element:f}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.scrollPositions=new Map,this.removeScrollListeners=null,this.onElementScroll=j=>{this.handleScroll(j.target)},this.onWindowScroll=()=>{this.handleScroll(window)},this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const j=Qh(this.lastMoveEventInfo,this.history),N=this.startEvent!==null,k=_D(j.offset,{x:0,y:0})>=this.distanceThreshold;if(!N&&!k)return;const{point:T}=j,{timestamp:R}=us;this.history.push({...T,timestamp:R});const{onStart:A,onMove:C}=this.handlers;N||(A&&A(this.lastMoveEvent,j),this.startEvent=this.lastMoveEvent),C&&C(this.lastMoveEvent,j)},this.handlePointerMove=(j,N)=>{this.lastMoveEvent=j,this.lastMoveEventInfo=Jh(N,this.transformPagePoint),Nt.update(this.updatePoint,!0)},this.handlePointerUp=(j,N)=>{this.end();const{onEnd:k,onSessionEnd:T,resumeAnimation:R}=this.handlers;if((this.dragSnapToOrigin||!this.startEvent)&&R&&R(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const A=Qh(j.type==="pointercancel"?this.lastMoveEventInfo:Jh(N,this.transformPagePoint),this.history);this.startEvent&&k&&k(j,A),T&&T(j,A)},!Rm(e))return;this.dragSnapToOrigin=u,this.handlers=a,this.transformPagePoint=i,this.distanceThreshold=d,this.contextWindow=o||window;const m=eo(e),p=Jh(m,this.transformPagePoint),{point:x}=p,{timestamp:b}=us;this.history=[{...x,timestamp:b}];const{onSessionStart:y}=a;y&&y(e,Qh(p,this.history)),this.removeListeners=Ql(El(this.contextWindow,"pointermove",this.handlePointerMove),El(this.contextWindow,"pointerup",this.handlePointerUp),El(this.contextWindow,"pointercancel",this.handlePointerUp)),f&&this.startScrollTracking(f)}startScrollTracking(e){let a=e.parentElement;for(;a;){const i=getComputedStyle(a);(Py.has(i.overflowX)||Py.has(i.overflowY))&&this.scrollPositions.set(a,{x:a.scrollLeft,y:a.scrollTop}),a=a.parentElement}this.scrollPositions.set(window,{x:window.scrollX,y:window.scrollY}),window.addEventListener("scroll",this.onElementScroll,{capture:!0,passive:!0}),window.addEventListener("scroll",this.onWindowScroll,{passive:!0}),this.removeScrollListeners=()=>{window.removeEventListener("scroll",this.onElementScroll,{capture:!0}),window.removeEventListener("scroll",this.onWindowScroll)}}handleScroll(e){const a=this.scrollPositions.get(e);if(!a)return;const i=e===window,o=i?{x:window.scrollX,y:window.scrollY}:{x:e.scrollLeft,y:e.scrollTop},u={x:o.x-a.x,y:o.y-a.y};u.x===0&&u.y===0||(i?this.lastMoveEventInfo&&(this.lastMoveEventInfo.point.x+=u.x,this.lastMoveEventInfo.point.y+=u.y):this.history.length>0&&(this.history[0].x-=u.x,this.history[0].y-=u.y),this.scrollPositions.set(e,o),Nt.update(this.updatePoint,!0))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),this.removeScrollListeners&&this.removeScrollListeners(),this.scrollPositions.clear(),Ra(this.updatePoint)}}function Jh(s,e){return e?{point:e(s.point)}:s}function Iy(s,e){return{x:s.x-e.x,y:s.y-e.y}}function Qh({point:s},e){return{point:s,delta:Iy(s,Pj(e)),offset:Iy(s,kD(e)),velocity:TD(e,.1)}}function kD(s){return s[0]}function Pj(s){return s[s.length-1]}function TD(s,e){if(s.length<2)return{x:0,y:0};let a=s.length-1,i=null;const o=Pj(s);for(;a>=0&&(i=s[a],!(o.timestamp-i.timestamp>Xn(e)));)a--;if(!i)return{x:0,y:0};const u=Js(o.timestamp-i.timestamp);if(u===0)return{x:0,y:0};const d={x:(o.x-i.x)/u,y:(o.y-i.y)/u};return d.x===1/0&&(d.x=0),d.y===1/0&&(d.y=0),d}function ED(s,{min:e,max:a},i){return e!==void 0&&s<e?s=i?Ct(e,s,i.min):Math.max(s,e):a!==void 0&&s>a&&(s=i?Ct(a,s,i.max):Math.min(s,a)),s}function By(s,e,a){return{min:e!==void 0?s.min+e:void 0,max:a!==void 0?s.max+a-(s.max-s.min):void 0}}function CD(s,{top:e,left:a,bottom:i,right:o}){return{x:By(s.x,a,o),y:By(s.y,e,i)}}function zy(s,e){let a=e.min-s.min,i=e.max-s.max;return e.max-e.min<s.max-s.min&&([a,i]=[i,a]),{min:a,max:i}}function AD(s,e){return{x:zy(s.x,e.x),y:zy(s.y,e.y)}}function RD(s,e){let a=.5;const i=bs(s),o=bs(e);return o>i?a=zl(e.min,e.max-i,s.min):i>o&&(a=zl(s.min,s.max-o,e.min)),Sn(0,1,a)}function DD(s,e){const a={};return e.min!==void 0&&(a.min=e.min-s.min),e.max!==void 0&&(a.max=e.max-s.min),a}const zf=.35;function OD(s=zf){return s===!1?s=0:s===!0&&(s=zf),{x:Vy(s,"left","right"),y:Vy(s,"top","bottom")}}function Vy(s,e,a){return{min:$y(s,e),max:$y(s,a)}}function $y(s,e){return typeof s=="number"?s:s[e]||0}const MD=new WeakMap;class UD{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Yt(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=e}start(e,{snapToCursor:a=!1,distanceThreshold:i}={}){const{presenceContext:o}=this.visualElement;if(o&&o.isPresent===!1)return;const u=b=>{a?(this.stopAnimation(),this.snapToCursor(eo(b).point)):this.pauseAnimation()},d=(b,y)=>{this.stopAnimation();const{drag:j,dragPropagation:N,onDragStart:k}=this.getProps();if(j&&!N&&(this.openDragLock&&this.openDragLock(),this.openDragLock=wR(j),!this.openDragLock))return;this.latestPointerEvent=b,this.latestPanInfo=y,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Xs(R=>{let A=this.getAxisMotionValue(R).get()||0;if(Nn.test(A)){const{projection:C}=this.visualElement;if(C&&C.layout){const B=C.layout.layoutBox[R];B&&(A=bs(B)*(parseFloat(A)/100))}}this.originPoint[R]=A}),k&&Nt.postRender(()=>k(b,y)),Df(this.visualElement,"transform");const{animationState:T}=this.visualElement;T&&T.setActive("whileDrag",!0)},f=(b,y)=>{this.latestPointerEvent=b,this.latestPanInfo=y;const{dragPropagation:j,dragDirectionLock:N,onDirectionLock:k,onDrag:T}=this.getProps();if(!j&&!this.openDragLock)return;const{offset:R}=y;if(N&&this.currentDirection===null){this.currentDirection=LD(R),this.currentDirection!==null&&k&&k(this.currentDirection);return}this.updateAxis("x",y.point,R),this.updateAxis("y",y.point,R),this.visualElement.render(),T&&T(b,y)},m=(b,y)=>{this.latestPointerEvent=b,this.latestPanInfo=y,this.stop(b,y),this.latestPointerEvent=null,this.latestPanInfo=null},p=()=>Xs(b=>this.getAnimationState(b)==="paused"&&this.getAxisMotionValue(b).animation?.play()),{dragSnapToOrigin:x}=this.getProps();this.panSession=new Lj(e,{onSessionStart:u,onStart:d,onMove:f,onSessionEnd:m,resumeAnimation:p},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:x,distanceThreshold:i,contextWindow:Uj(this.visualElement),element:this.visualElement.current})}stop(e,a){const i=e||this.latestPointerEvent,o=a||this.latestPanInfo,u=this.isDragging;if(this.cancel(),!u||!o||!i)return;const{velocity:d}=o;this.startAnimation(d);const{onDragEnd:f}=this.getProps();f&&Nt.postRender(()=>f(i,o))}cancel(){this.isDragging=!1;const{projection:e,animationState:a}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.endPanSession();const{dragPropagation:i}=this.getProps();!i&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),a&&a.setActive("whileDrag",!1)}endPanSession(){this.panSession&&this.panSession.end(),this.panSession=void 0}updateAxis(e,a,i){const{drag:o}=this.getProps();if(!i||!Tc(e,o,this.currentDirection))return;const u=this.getAxisMotionValue(e);let d=this.originPoint[e]+i[e];this.constraints&&this.constraints[e]&&(d=ED(d,this.constraints[e],this.elastic[e])),u.set(d)}resolveConstraints(){const{dragConstraints:e,dragElastic:a}=this.getProps(),i=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):this.visualElement.projection?.layout,o=this.constraints;e&&jl(e)?this.constraints||(this.constraints=this.resolveRefConstraints()):e&&i?this.constraints=CD(i.layoutBox,e):this.constraints=!1,this.elastic=OD(a),o!==this.constraints&&i&&this.constraints&&!this.hasMutatedConstraints&&Xs(u=>{this.constraints!==!1&&this.getAxisMotionValue(u)&&(this.constraints[u]=DD(i.layoutBox[u],this.constraints[u]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:a}=this.getProps();if(!e||!jl(e))return!1;const i=e.current,{projection:o}=this.visualElement;if(!o||!o.layout)return!1;const u=IR(i,o.root,this.visualElement.getTransformPagePoint());let d=AD(o.layout.layoutBox,u);if(a){const f=a(UR(d));this.hasMutatedConstraints=!!f,f&&(d=aj(f))}return d}startAnimation(e){const{drag:a,dragMomentum:i,dragElastic:o,dragTransition:u,dragSnapToOrigin:d,onDragTransitionEnd:f}=this.getProps(),m=this.constraints||{},p=Xs(x=>{if(!Tc(x,a,this.currentDirection))return;let b=m&&m[x]||{};d&&(b={min:0,max:0});const y=o?200:1e6,j=o?40:1e7,N={type:"inertia",velocity:i?e[x]:0,bounceStiffness:y,bounceDamping:j,timeConstant:750,restDelta:1,restSpeed:10,...u,...b};return this.startAxisValueAnimation(x,N)});return Promise.all(p).then(f)}startAxisValueAnimation(e,a){const i=this.getAxisMotionValue(e);return Df(this.visualElement,e),i.start(km(e,i,0,a,this.visualElement,!1))}stopAnimation(){Xs(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){Xs(e=>this.getAxisMotionValue(e).animation?.pause())}getAnimationState(e){return this.getAxisMotionValue(e).animation?.state}getAxisMotionValue(e){const a=`_drag${e.toUpperCase()}`,i=this.visualElement.getProps(),o=i[a];return o||this.visualElement.getValue(e,(i.initial?i.initial[e]:void 0)||0)}snapToCursor(e){Xs(a=>{const{drag:i}=this.getProps();if(!Tc(a,i,this.currentDirection))return;const{projection:o}=this.visualElement,u=this.getAxisMotionValue(a);if(o&&o.layout){const{min:d,max:f}=o.layout.layoutBox[a],m=u.get()||0;u.set(e[a]-Ct(d,f,.5)+m)}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:a}=this.getProps(),{projection:i}=this.visualElement;if(!jl(a)||!i||!this.constraints)return;this.stopAnimation();const o={x:0,y:0};Xs(d=>{const f=this.getAxisMotionValue(d);if(f&&this.constraints!==!1){const m=f.get();o[d]=RD({min:m,max:m},this.constraints[d])}});const{transformTemplate:u}=this.visualElement.getProps();this.visualElement.current.style.transform=u?u({},""):"none",i.root&&i.root.updateScroll(),i.updateLayout(),this.resolveConstraints(),Xs(d=>{if(!Tc(d,e,null))return;const f=this.getAxisMotionValue(d),{min:m,max:p}=this.constraints[d];f.set(Ct(m,p,o[d]))})}addListeners(){if(!this.visualElement.current)return;MD.set(this.visualElement,this);const e=this.visualElement.current,a=El(e,"pointerdown",m=>{const{drag:p,dragListener:x=!0}=this.getProps(),b=m.target,y=b!==e&&Zw(b);p&&x&&!y&&this.start(m)}),i=()=>{const{dragConstraints:m}=this.getProps();jl(m)&&m.current&&(this.constraints=this.resolveRefConstraints())},{projection:o}=this.visualElement,u=o.addEventListener("measure",i);o&&!o.layout&&(o.root&&o.root.updateScroll(),o.updateLayout()),Nt.read(i);const d=Hl(window,"resize",()=>this.scalePositionWithinConstraints()),f=o.addEventListener("didUpdate",(({delta:m,hasLayoutChanged:p})=>{this.isDragging&&p&&(Xs(x=>{const b=this.getAxisMotionValue(x);b&&(this.originPoint[x]+=m[x].translate,b.set(b.get()+m[x].translate))}),this.visualElement.render())}));return()=>{d(),a(),u(),f&&f()}}getProps(){const e=this.visualElement.getProps(),{drag:a=!1,dragDirectionLock:i=!1,dragPropagation:o=!1,dragConstraints:u=!1,dragElastic:d=zf,dragMomentum:f=!0}=e;return{...e,drag:a,dragDirectionLock:i,dragPropagation:o,dragConstraints:u,dragElastic:d,dragMomentum:f}}}function Tc(s,e,a){return(e===!0||e===s)&&(a===null||a===s)}function LD(s,e=10){let a=null;return Math.abs(s.y)>e?a="y":Math.abs(s.x)>e&&(a="x"),a}class PD extends Ma{constructor(e){super(e),this.removeGroupControls=Qs,this.removeListeners=Qs,this.controls=new UD(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Qs}update(){const{dragControls:e}=this.node.getProps(),{dragControls:a}=this.node.prevProps||{};e!==a&&(this.removeGroupControls(),e&&(this.removeGroupControls=e.subscribe(this.controls)))}unmount(){this.removeGroupControls(),this.removeListeners(),this.controls.isDragging||this.controls.endPanSession()}}const qy=s=>(e,a)=>{s&&Nt.postRender(()=>s(e,a))};class ID extends Ma{constructor(){super(...arguments),this.removePointerDownListener=Qs}onPointerDown(e){this.session=new Lj(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:Uj(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:a,onPan:i,onPanEnd:o}=this.node.getProps();return{onSessionStart:qy(e),onStart:qy(a),onMove:i,onEnd:(u,d)=>{delete this.session,o&&Nt.postRender(()=>o(u,d))}}}mount(){this.removePointerDownListener=El(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}let Zh=!1;class BD extends v.Component{componentDidMount(){const{visualElement:e,layoutGroup:a,switchLayoutGroup:i,layoutId:o}=this.props,{projection:u}=e;u&&(a.group&&a.group.add(u),i&&i.register&&o&&i.register(u),Zh&&u.root.didUpdate(),u.addEventListener("animationComplete",()=>{this.safeToRemove()}),u.setOptions({...u.options,layoutDependency:this.props.layoutDependency,onExitComplete:()=>this.safeToRemove()})),Mc.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:a,visualElement:i,drag:o,isPresent:u}=this.props,{projection:d}=i;return d&&(d.isPresent=u,e.layoutDependency!==a&&d.setOptions({...d.options,layoutDependency:a}),Zh=!0,o||e.layoutDependency!==a||a===void 0||e.isPresent!==u?d.willUpdate():this.safeToRemove(),e.isPresent!==u&&(u?d.promote():d.relegate()||Nt.postRender(()=>{const f=d.getStack();(!f||!f.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),Am.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:a,switchLayoutGroup:i}=this.props,{projection:o}=e;Zh=!0,o&&(o.scheduleCheckAfterUnmount(),a&&a.group&&a.group.remove(o),i&&i.deregister&&i.deregister(o))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function Ij(s){const[e,a]=kj(),i=v.useContext(lm);return r.jsx(BD,{...s,layoutGroup:i,switchLayoutGroup:v.useContext(Oj),isPresent:e,safeToRemove:a})}const zD={pan:{Feature:ID},drag:{Feature:PD,ProjectionNode:_j,MeasureLayout:Ij}};function Hy(s,e,a){const{props:i}=s;s.animationState&&i.whileHover&&s.animationState.setActive("whileHover",a==="Start");const o="onHover"+a,u=i[o];u&&Nt.postRender(()=>u(e,eo(e)))}class VD extends Ma{mount(){const{current:e}=this.node;e&&(this.unmount=jR(e,(a,i)=>(Hy(this.node,i,"Start"),o=>Hy(this.node,o,"End"))))}unmount(){}}class $D extends Ma{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Ql(Hl(this.node.current,"focus",()=>this.onFocus()),Hl(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function Gy(s,e,a){const{props:i}=s;if(s.current instanceof HTMLButtonElement&&s.current.disabled)return;s.animationState&&i.whileTap&&s.animationState.setActive("whileTap",a==="Start");const o="onTap"+(a==="End"?"":a),u=i[o];u&&Nt.postRender(()=>u(e,eo(e)))}class qD extends Ma{mount(){const{current:e}=this.node;e&&(this.unmount=_R(e,(a,i)=>(Gy(this.node,i,"Start"),(o,{success:u})=>Gy(this.node,o,u?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const Vf=new WeakMap,Wh=new WeakMap,HD=s=>{const e=Vf.get(s.target);e&&e(s)},GD=s=>{s.forEach(HD)};function FD({root:s,...e}){const a=s||document;Wh.has(a)||Wh.set(a,{});const i=Wh.get(a),o=JSON.stringify(e);return i[o]||(i[o]=new IntersectionObserver(GD,{root:s,...e})),i[o]}function KD(s,e,a){const i=FD(e);return Vf.set(s,a),i.observe(s),()=>{Vf.delete(s),i.unobserve(s)}}const YD={some:0,all:1};class XD extends Ma{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:a,margin:i,amount:o="some",once:u}=e,d={root:a?a.current:void 0,rootMargin:i,threshold:typeof o=="number"?o:YD[o]},f=m=>{const{isIntersecting:p}=m;if(this.isInView===p||(this.isInView=p,u&&!p&&this.hasEnteredView))return;p&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",p);const{onViewportEnter:x,onViewportLeave:b}=this.node.getProps(),y=p?x:b;y&&y(m)};return KD(this.node.current,d,f)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:a}=this.node;["amount","margin","root"].some(JD(e,a))&&this.startObserver()}unmount(){}}function JD({viewport:s={}},{viewport:e={}}={}){return a=>s[a]!==e[a]}const QD={inView:{Feature:XD},tap:{Feature:qD},focus:{Feature:$D},hover:{Feature:VD}},ZD={layout:{ProjectionNode:_j,MeasureLayout:Ij}},WD={...ND,...QD,...zD,...ZD},e3=bD(WD,yD),Fy={info:"border-white/20 bg-white/50 dark:border-white/10 dark:bg-slate-950/30",success:"border-success-500/30 bg-success-50/70 dark:bg-success-500/10",warning:"border-warning-500/30 bg-warning-50/70 dark:bg-warning-500/10",danger:"border-danger-500/30 bg-danger-50/70 dark:bg-danger-500/10"};function t3(){const{toasts:s,dismiss:e}=mn();return r.jsx("div",{className:"fixed right-4 top-4 z-[60] flex w-[92vw] max-w-sm flex-col gap-2","aria-live":"polite","aria-relevant":"additions",children:r.jsx(K4,{initial:!1,children:s.map(a=>r.jsxs(e3.div,{layout:!0,initial:{opacity:0,y:-12,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-12,scale:.98},transition:{duration:.18,ease:"easeOut"},className:`surface flex items-start justify-between gap-3 border p-3 shadow-soft ${Fy[a.type]??Fy.info}`,role:"status",onClick:typeof a.onClick=="function"?()=>{try{a.onClick()}finally{e(a.id)}}:void 0,tabIndex:typeof a.onClick=="function"?0:void 0,onKeyDown:typeof a.onClick=="function"?i=>{if(i.key==="Enter"||i.key===" "){i.preventDefault();try{a.onClick()}finally{e(a.id)}}}:void 0,style:typeof a.onClick=="function"?{cursor:"pointer"}:void 0,children:[r.jsxs("div",{className:"min-w-0",children:[r.jsx("div",{className:"text-sm font-semibold text-foreground",children:a.title}),a.message?r.jsx("div",{className:"mt-1 break-words text-sm text-muted-foreground",children:a.message}):null]}),r.jsx("button",{type:"button",className:"btn-ghost -mr-1 -mt-1 p-2",onClick:i=>{i.stopPropagation(),e(a.id)},"aria-label":"Dismiss notification",children:r.jsx(Qf,{className:"h-4 w-4"})})]},a.id))})})}aS.createRoot(document.getElementById("root")).render(r.jsx(v.StrictMode,{children:r.jsx(T2,{basename:"/",children:r.jsx(xA,{children:r.jsx(mA,{children:r.jsx(dA,{children:r.jsx(uA,{children:r.jsxs(fA,{children:[r.jsx(cA,{}),r.jsx(t3,{})]})})})})})})}));
